{"path":".obsidian/plugins/text-extractor/cache/1cd0a7eb885a282a86107e2a87c6ece3.json","text":"CPSC 317 Computer Networking Transport Layer Lost Segments and Time Out Maryam R.Aliabadi mraiyata@cs.ubc.ca 1CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi READING â€¢ Reading: 3.4.1, 3.5.3 2CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Learning goals â€¢ Describe/build/execute/trace the various versions of the alternating bit protocol (stop and wait) protocol â€¢ Explain how corruption in segments are detected and at what layer(s) in the protocol stack this is done â€¢ Explain how data loss is handled by a reliable delivery protocol â€¢ For a given scenario determine an appropriate timeout value 3CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Review: Alternating Bit Protocol 4 â€¢ Receiver â€¢ Sender Idle 0 Wait for ACK 0 Data to send Send data 0 Receive ACK 0 ^ Receive NAK/corrupt Re-send data 0 Wait for data 0 Receive data 0 Deliver data Send ACK 0 Receive corrupt data Send NAK Idle 1 Wait for ACK 1 Wait for data 1 Data to send Send data 1 Receive ACK 1 ^ Receive NAK/corrupt Re-send data 1 Receive data 1 Deliver data Send ACK 1 Receive corrupt data Send NAK Receive data 0 Send ACK 0 Receive data 1 Send ACK 1 CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Review: alternating Bit Protocol (no NAK) 5 â€¢ Receiver â€¢ Sender Idle 0 Wait for ACK 0 Data to send Send data 0 Receive ACK 0 ^ Receive ACK 1/corrupt Re-send data 0 Wait for data 0 Receive data 0 Deliver data Send ACK 0 Idle 1 Wait for ACK 1 Wait for data 1 Data to send Send data 1 Receive ACK 1 ^ Receive ACK 0/corrupt Re-send data 1 Receive data 1 Deliver data Send ACK 1 Receive data 0 or corrupt Send ACK 0 Receive data 1 or corrupt Send ACK 1 CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Features To Handle Corruption â€¢ Checksums â€“ to detect errors â€¢ ACK packets â€“ to detect last correctly received data â€¢ Retransmissions â€“ to overcome errors â€¢ Sequence numbers â€“ to detect duplicates 6CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Building a Reliable Protocol (v.2) â€¢ Letâ€™s create a protocol for reliable delivery â€¢ Send only one segment at a time â€¢ Identify when sending is allowable action â€¢ Identify when re-sending is required â€¢ Enumerate events and actions for both sender and receiver â€¢ Draw state machine â€¢ Next scenario assumptions â€¢ One sender, one receiver â€¢ Data to send comes from upper layer â€¢ Segments can be lost or corrupted 7CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi What if a segment is lost? â€¢ What happens if a data segment is lost? â€¢ What happens if an ACK is lost? â€¢ How to determine if a data segment or ACK is lost? â€¢ Who determines it? Sender or receiver? 8CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi What if a segment is lost? â€¢ What happens if a data segment is lost? â€¢ What happens if an ACK is lost? â€¢ How to determine if a data segment or ACK is lost? â€¢ Who determines it? Sender or receiver? â€¢ What changes are needed on the receiver? â€¢ What changes are needed on the sender? 9CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Corrupt or Lost? â€¢ Does it make sense to distinguish corrupt data from lost data? â€¢ If something is corrupt, we donâ€™t know whatâ€™s corrupt â€¢ Headers may have been corrupted too â€¢ The corrupt segment may not even be for you!!! â€¢ So, corrupt data becomes lost data (usually at link layer) 10CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Alternating Bit Protocol (no NAK) 11 â€¢ Receiver â€¢ Sender Idle 0 Wait for ACK 0 Data to send Send data 0 Receive ACK 0 ^ Receive ACK 1/corrupt Re-send data 0 Wait for data 0 Receive data 0 Deliver data Send ACK 0 Idle 1 Wait for ACK 1 Wait for data 1 Data to send Send data 1 Receive ACK 1 ^ Receive ACK 0/corrupt Re-send data 1 Receive data 1 Deliver data Send ACK 1 Receive data 0 or corrupt Send ACK 0 Receive data 1 or corrupt Send ACK 1 CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Eliminate Corrupt Segments 12 â€¢ Receiver â€¢ Sender Wait for ACK 0 Data to send Send data 0 Receive ACK 0 ^ Receive ACK 1 Re-send data 0 Wait for data 0 Receive data 0 Deliver data Send ACK 0 Idle 1 Wait for ACK 1 Wait for data 1 Data to send Send data 1 Receive ACK 1 ^ Receive ACK 0 Re-send data 1 Receive data 1 Deliver data Send ACK 1 Receive data 0 Send ACK 0 Receive data 1 Send ACK 1 Idle 0 / / CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Handle lost segments 13 â€¢ Receiver â€¢ Sender Wait for ACK 0 Data to send Send data 0 Start timer Receive ACK 0 Cancel timer Receive ACK 1 Re-send data 0 Wait for data 0 Receive data 0 Deliver data Send ACK 0 Idle 1 Wait for ACK 1 Wait for data 1 Data to send Send data 1 Start timer Receive ACK 1 Cancel timer Receive ACK 0 Re-send data 1 Receive data 1 Deliver data Send ACK 1 Receive data 0 Send ACK 0 Receive data 1 Send ACK 1 Idle 0 /timeout /timeout CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Clicker question Is this state machine complete? A. Yes B. No 14 Receiver Sender 14 Wait for ACK 0 Data to send Send data 0 Start timer Receive ACK 0 Cancel timer Receive ACK 1/timeout Re-send data 0 Wait for data 0 Receive data 0 Deliver data Send ACK 0 Idle 1 Wait for ACK 1 Wait for data 1 Data to send Send data 1 Start timer Receive ACK 1 Cancel timer Receive ACK 0/timeout Re-send data 1 Receive data 1 Deliver data Send ACK 1 Receive data 0 Send ACK 0 Receive data 1 Send ACK 1 Idle 0 CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Answer Is this state machine complete? A. Yes B. No 15 Receiver Sender 15 Wait for ACK 0 Data to send Send data 0 Start timer Receive ACK 0 Cancel timer Receive ACK 1/timeout Re-send data 0 Wait for data 0 Receive data 0 Deliver data Send ACK 0 Idle 1 Wait for ACK 1 Wait for data 1 Data to send Send data 1 Start timer Receive ACK 1 Cancel timer Receive ACK 0/timeout Re-send data 1 Receive data 1 Deliver data Send ACK 1 Receive data 0 Send ACK 0 Receive data 1 Send ACK 1 Idle 0 CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Time Out Too Soon 16 Sender Receiver data 0 data 0 ACK 0 ACK 0 CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Alternating Bit Protocol (Timeout) 17 â€¢ Receiver â€¢ Sender Wait for ACK 0 Data to send Send data 0 Start timer Receive ACK 0 Cancel timer Receive ACK 1/timeout Re-send data 0 Wait for data 0 Receive data 0 Deliver data Send ACK 0 Idle 1 Wait for ACK 1 Wait for data 1 Data to send Send data 1 Start timer Receive ACK 1 Cancel timer Receive ACK 0/timeout Re-send data 1 Receive data 1 Deliver data Send ACK 1 Receive data 0 Send ACK 0 Receive data 1 Send ACK 1 Receive anything ^ Receive anything ^ Idle 0 CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi How long should the Timeout be? â€¢ Should it be the same across connections? â€¢ Should it always be the same for the same connection? â€¢ What happens if the timeout is too long? â€¢ What happens if the timeout is too short? â€¢ What measurable metric can be used to infer a proper timeout? 18CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi How Long Should The Timeout Be? â€¢ Assume sequential segments experience the following sequence of RTTs. What should the timeout be? â€¢ 10, 10, 10, 10, 10, 10, 10, 10 â€¢ 100, 10, 100, 100, 100, 100, 100 â€¢ 1000, 10, 10, 10, 10, 10, 10, 10 â€¢ 10, 100, 10, 100, 10, 100, 10, 100 â€¢ 1, 1, 1, 5, 5, 5, 10, 10, 40, 40, 40, 60, 100, 100, 2, 2, 2, 4, 2 â€¢ Discussion in more detail: textbook 3.5.3 19CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Timeout Formula â€¢ Assuming measured RTT of ğ‘¡ â€¢ Estimated RTT: ğ¸ğ‘…ğ‘‡ğ‘‡ğ‘– = 1 âˆ’ ğ›¼ Ã— ğ¸ğ‘…ğ‘‡ğ‘‡ğ‘–âˆ’1 + ğ›¼ Ã— ğ‘¡ â€¢ Deviation of RTT (captures jitter): Î”ğ‘…ğ‘‡ğ‘‡ğ‘– = 1 âˆ’ ğ›½ Ã— Î”ğ‘…ğ‘‡ğ‘‡ğ‘–âˆ’1 + ğ›½ Ã— ğ‘¡ âˆ’ ğ¸ğ‘…ğ‘‡ğ‘‡ğ‘–âˆ’1 â€¢ Timeout: ğ¸ğ‘…ğ‘‡ğ‘‡ğ‘– + 4 Ã— Î”ğ‘…ğ‘‡ğ‘‡ğ‘– â€¢ Suggested values: ğ›¼ = 0.125, ğ›½ = 0.25 21CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Features To Support Reliable Transport â€¢ Checksums â€“ to detect errors â€¢ ACK packets â€“ to detect last correctly received data â€¢ Retransmissions â€“ to overcome errors, data loss â€¢ Sequence numbers â€“ to detect duplicates â€¢ Timers â€“ to handle data loss 22CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Performance â€¢ Alternating bit protocol aka stop-and-wait protocol â€¢ Sender does not send next segment until previous segment acknowledged 23CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Clicker question â€¢ Assume a connection from Vancouver to Montreal â€¢ Two-way propagation delay is 30 ms â€¢ Link speed (bandwidth) is 1Gbps â€¢ Segment size is 1000 bytes, including overhead â€¢ How much of the link are we actually using? ( Link Utilization = Throughput/Bandwidth) 24CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Answer â€¢ Assume a connection from Vancouver to Montreal â€¢ Two-way propagation delay is 30 ms â€¢ Link speed (bandwidth) is 1Gbps â€¢ Segment size is 1000 bytes, including overhead â€¢ How much of the link are we actually using? â€¢ Transmission delay, one segment: 8000 109 = 0.008 ğ‘šğ‘  â€¢ Throughput: 8000 (30+0.008)/1000 ğ‘ğ‘–ğ‘¡ğ‘ /ğ‘  = 0.267 ğ‘€ğ‘ğ‘ğ‘  â€¢ Utilization: Throughput/Bandwidth = 0.267 ğ‘€ğ‘ğ‘ğ‘  1 ğºğ‘ğ‘ğ‘  = 0.00027 (or 0.027%) 25CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi 0.027% Utilization?? â€¢ What can we do about this? 27CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi In-class activity â€¢ ICA43 28CPSC 317 â€“ Computer Networking : Transport Layer â€“ Lost Segments Maryam R.Aliabadi Next Topic Windowing Protocols 29","libVersion":"0.2.1","langs":""}
{"path":".obsidian/plugins/text-extractor/cache/2dbee8df79866b1d3c8222585e519fc7.json","text":"CPSC 317 Computer Networking Application Layer Peer to Peer (P2P) Applications Maryam R.Aliabadi mraiyata@cs.ubc.ca 1CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Mature Students’ Club 2CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Course Survey – Part 1 3CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi READING • Reading: 2.5 4CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Learning goals – Peer-to-Peer • Describe the architecture of a peer-to-peer application • Describe the design goals for the bit-torrent protocol • Explain the performance benefit of peer-to-peer file sharing over a single server • Describe the design goals for block-chain protocols • Understand the costs 5CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi P2P Applications • No always-on server • Arbitrary end systems directly communicate • Peers are intermittently connected and change IP addresses. Examples • File sharing (Bit Torrent) • Block chain (Bit Coin) • VoIP (Skype) • Streaming (KanKan) 6CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Case study: Bit-Torrent • Purpose: file sharing • Initially designed in 2001 • Protocol v2 in 2017 • Mostly upgrading the hash function • Each node functions as both a consumer and provider of data 7CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi File Sharing Examples In Real World • Gaming • Software updates • e.g., Android updates to billions of mobile phones 8CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi File Sharing Scenario • Suppose some N machines have a file (N might be just 1) • Suppose some other M machines want the file (M might be very large) • If the N machines share the file with the M machines, it might be very slow • Limited to the throughput possible by those N machines • Imagine if N is 1 and M is 1000 9 server client1 clientM... B B B CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi A Brief Digression on Units • What do kilo, mega, giga mean? • When applied to sizes of things, we use 2(N*10) • A kilobyte is 210 bytes • A megabyte is 220 bytes • A gigabyte is 230 bytes • When applied to network speeds we use 10(N*3) • A kilobit/second is 103 bits per second • A megabit/second is 106 bits per second • A gigabit/second is 109 bits per second 10CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Clicker question Suppose there is one server with a 1Gbyte file and a 1Gbps network connection. Suppose 1000 clients want a copy of the file. How long will it take the server to deliver the file to the 1000 clients? (Choose the closest answer) A. 2 days B. 2 hours C. 2 minutes D. 2 seconds 11CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Suppose there is one server with a 1Gbyte file and a 1Gbps network connection. Suppose 1000 clients want a copy of the file. How long will it take the server to deliver the file to the 1000 clients? Time takes to send the file to one client= File size/Bandwidth = 1*8* 230 / 109 = 8.589 seconds Time takes to send the file to 1000 client= 1000*8.589 = 8589 seconds = 143 minutes = 2.4 hours Clicker answer 12CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Bit-Torrent • All N+M machines participate as both sources and sinks of data • The N hosts are called “seeds” • All hosts are called “peers” • As soon as one of the M peers has a portion of the file it can share it with other peers 13 peer1 peer2 peerM... B CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Assume that all peers have a 1Gbps network connection. Suppose there is 1 peer (seed) with a 1Gbyte file. Suppose 1000 peers want a copy of the file. How long will it take the seed to deliver the file to the 1000 peers (assuming the seed is clever)? (Choose the closest answer) A. 2 days B. 3 hours C. 5 minutes D. 17 seconds Clicker question 14CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Clicker answer Assume that all peers have a 1Gbps network connection. Suppose there is 1 peer (seed) with a 1Gbyte file. Suppose 1000 peers want a copy of the file. How long will it take the seed to deliver the file to the 1000 peers (assuming the seed is clever)? (Choose the closest answer) A. The seed sends a (different) 1/1000 portion of the file to each peer. This takes 230 * 8 / 109 = 8.59 s. Each peer now shares its block with the other 1000 peers, this takes another 8.59s. Closest answer: 17s. 15CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi PTP File Distribution: BitTorrent 16CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Client-Server Vs. P2P : Example 17 F: File size U: Client upload rate N : Number of peers (clients) Us: Server download/upload rate d_min: Min client upload rate CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi A few details The file is broken into many pieces • Fixed size (except for the last one) • Protected by a cryptographic hash (we’ll talk about these in the last module) • Allows reliable detection of corruption A summary (torrent file) gives the necessary start up information: • How many pieces • The hash of each piece • Somewhere to start looking for peers (Seeds, Trackers) 19CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Basic operation Finding other peers • Seeds or trackers to start with • Peer exchange: Each peer tells the other peers it is talking to regarding the peers it knows about • The group of peers for one particular file is a “torrent” • Each peer talks to some subset of the “torrent” at any time Finding pieces • Each peer shares the identity of the pieces it has with the peers it is talking to • A peer who doesn’t have a piece asks a peer who has to share it 20CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Adding a New Peer 21CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi A few policy questions Which piece does a peer ask for first? • Rarest first • Increases the overall “health” of a file Which of all the peers in a torrent should a peer send data to? • The ones that are sending the most data to it (preferred peers) • Tit-for-tat • Random “opportunistic unchoking” 22CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Implementation • Bit-torrent is an open protocol with many implementations • Most use TCP as the transport mechanism • Some use μTP – a UDP-based reliable transport protocol 23CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Block Chain 24CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Case study: Blockchain • Purpose: unmodifiable transaction history • Initially designed in 2008 (based on earlier work) by someone(s) using the pseudonym Satoshi Nakamoto • Uses cryptography to ensure that records added to the history can never be changed or removed • Foundation of bitcoin and many other cryptocurrencies 25CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Centralized or de-centralized • Blockchain can be implemented both ways • The primary value of the de-centralized approach is that it doesn’t require a trusted agent • The group of peers collaborate to decide which next “link” in the chain is accepted 26CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Mechanism • All changes are broadcast (using gossip) to every other peer • Changes are grouped into blocks • When a block fills up, it is added to the chain • There is no central repository of the “truth” • Every peer holds all of the history • This makes it very hard to forget the history since it is replicated very, very heavily 27CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Blockchain case study: Bitcoin • There are about 10,000 active computers in the bitcoin peer-to-peer network (2019) • Anyone can join • Initial peers found via DNS • Communication is built on top of TCP • Gossip-based • Share what you know that your neighbors don’t 29CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Costs – energy • Bitcoin is estimated to consume as much electrical energy (121 terawatt hours per year) as Argentina and more than the Netherlands (109) (22% of Canada’s 545) • Each bitcoin transaction costs 708 kilowatt-hours • Electricity in BC (residential) costs $0.126 per kwh • 708 * 0.126 = $89.20 CAD 31CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Costs – storage • Bitcoin’s block chain is growing rapidly 32 Year Size 2014 20GB 2015 30GB 2016 50GB 2017 100GB 2020 >200GB CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi In-class activity • ICA35 33CPSC 317 – Computer Networking : Application Layer – P2P Maryam R.Aliabadi Next Topic: Transport Layer 34","libVersion":"0.2.1","langs":""}
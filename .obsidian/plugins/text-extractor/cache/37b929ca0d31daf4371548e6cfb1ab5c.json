{"path":".obsidian/plugins/text-extractor/cache/37b929ca0d31daf4371548e6cfb1ab5c.json","text":"CPSC 317 Computer Networking Transport Layer State Machines Maryam R.Aliabadi mraiyata@cs.ubc.ca 1CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Quiz 1 Stat 2CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi PA1 Stats 3 1st Survey Responses • Overall, 84% of students enjoy the lectures and the course content. • Lecture pace • 29%: too fast, 2%: too slow, 69%: just right • More time on iClicker calculations • Not graded – formulating the response rather than calculations • Request for ICA within class time • Move questions to after lecture time • More resources are required • Lecture /Tutorial recordings, Practice questions, ICAs, Quizzes and textbook, and YouTube videos… • Lack of familiarity with some terminologies • Please stop me and ask • Mic/Voice quality issues • Will follow up with media recording folks 4CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi READING • Reading: 3.4.1 CPSC 317 2023W2 © 2021 5CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Transport Layer Protocols 6 “I promise to deliver your data without 'losing' any of it... unless you’re using UDP!” 'Hey, I threw your message out there. Good luck finding it!' CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Learning goals Protocols and state machines • Given a protocol, express it as a set of communicating finite state machines (FSMs) • Given a set of communicating FSMs, trace the execution of the protocol for various event scenarios • Given a set of communicating FSMs, analyze the execution of the state machines to determine whether or not the protocol operates correctly and propose ways to solve any problems 7CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Reminder: Protocols • From the textbook: A protocol defines the format and the order of messages exchanged between two or more communicating entities, as well as the actions taken on the transmission and/or receipt of a message or other event • Key concepts: • Format and order of messages • Actions to be taken on events • A fully-defined protocol must provide a proper action for any event in any state 8 A few years ago, the Queen visited UBC CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Protocol Example: Greeting the Queen • Don't speak until spoken to • Upon presentation to the Queen • Men do a neck bow • Women a slight curtsy • Queen speaks to you • First salutation is “Your Majesty” • Subsequently it is “Ma'am” 10CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Queen greeting protocol State Machine 11 Wait for Queen Introduced Conversation Go Home Queen presented Bow/curtsy Queen speaks to you Respond, using “Your Majesty” Queen speaks to you Respond, using “Ma’am” Queen leaves Leave Queen leaves Leave Queen skips you Leave CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Building a Reliable Protocol (v.0) • Let’s create a protocol for reliable delivery • Send only one segment at a time • Identify when sending is allowable action • Enumerate events and actions for both sender and receiver • Draw state machine • Initial scenario assumptions • One sender, one receiver • Data to send comes from upper layer • Segments are never lost, never corrupted 12CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi State Machine: Reliable Channel 13 • Receiver • Sender Idle Data to send Send data Wait for data Receive data Deliver data CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi What Could Go Wrong? • We have assumed that nothing bad ever happens • What bad things could happen in a real-world scenario? 14CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Building a Reliable Protocol (V.1) • Let’s create a protocol for reliable delivery • Send only one segment at a time • Identify when sending is allowable action • Identify when re-sending is required • Enumerate events and actions for both sender and receiver • Draw state machine • Next scenario assumptions • One sender, one receiver • Data to send comes from upper layer • Segments are never lost, but may be corrupted 15CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Possible Events and Actions 16 • Receiver • Segment received without problems • Send ACK • Segment received corrupted • Send NAK • Sender • Data ready to send • Send data • Receive ACK • Get ready to send more data • Receive NAK • Re-send data CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi State Machine: Corruption Scenario 17 • Receiver • Sender Idle Wait for ACK Data to send Send data Receive ACK ^ Receive NAK Re-send data Wait for data Receive valid data Deliver data Send ACK Receive corrupt data Send NAK CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi The ACK/NAK might be corrupted • What if the ACK/NAK is corrupted? • Sender cannot be sure if the receiver received the previous segment • What can the sender do after receiving a corrupted ACK/NAK? • Ignore the corrupt ACK/NAK? • Everything will stop • Treat it as an ACK? • Treat it as a NAK? 18CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi State Machine: Corruption Option I 19 • Receiver • Sender Idle Wait for ACK Data to send Send data Receive ACK ^ Receive NAK Re-send data Wait for data Receive valid data Deliver data Send ACK Receive corrupt data Send NAK Receive corrupted ACK/NAK ^ CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi The ACK/NAK might be Corrupted • What if the ACK/NAK is corrupted? • Sender cannot be sure if the receiver received the previous segment • What can the sender do after receiving a corrupted ACK/NAK? • Ignore the corrupt ACK/NAK? • Everything stops • Treat it as an ACK? • If it was a NAK, the receiver never receives the data • Treat it as a NAK? 20CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi State Machine: Corruption Option II 21 • Receiver • Sender Idle Wait for ACK Data to send Send data Receive ACK or corrupt ^ Receive NAK Re-send data Wait for data Receive valid data Deliver data Send ACK Receive corrupt data Send NAK CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi The ACK/NAK might be Corrupted • What if the ACK/NAK is corrupted? • Sender cannot be sure if the receiver received the previous segment • What can the sender do after receiving a corrupted ACK/NAK? • Ignore the corrupt ACK/NAK? • Everything stops • Treat it as an ACK? • If it was a NAK, the receiver never receives the data • Treat it as a NAK? • If it was an ACK, the receiver receives the data twice 22CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi State Machine: Corruption option III 23 • Receiver • Sender Idle Wait for ACK Data to send Send data Receive ACK ^ Receive NAK or corrupt Re-send data Wait for data Receive valid data Deliver data Send ACK Receive corrupt data Send NAK CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Dealing With Duplicate Transfer • How can the receiver deal with a duplicate segment? • What information needs to be included to allow receiver to identify segment as duplicate? • Reminder: scenario does not lose data, only corrupts 24 → One Bit Alternating CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Possible Events 25 • Receiver • Segment 0 received without problems • Segment 1 received without problems • Segment received corrupted • Sender • Data ready to send • Receive ACK 0 • Receive ACK 1 • Receive NAK • Receive corrupt response CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Alternating Bit Protocol 26 • Receiver • Sender Idle 0 Wait for ACK 0 Data to send Send data Receive ACK ^ Receive NAK/corrupt Re-send data Wait for data Receive data Deliver data Send ACK Receive corrupt data Send NAK CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Alternating Bit Protocol 27 • Receiver • Sender Idle 0 Wait for ACK 0 Data to send Send data 0 Receive ACK 0 ^ Receive NAK/corrupt Re-send data 0 Wait for data 0 Receive data 0 Deliver data Send ACK 0 Receive corrupt data Send NAK Idle 1 Wait for ACK 1 Wait for data 1 Data to send Send data 1 Receive ACK 1 ^ Receive NAK/corrupt Re-send data 1 Receive data 1 Deliver data Send ACK 1 Receive corrupt data Send NAK Receive data 1 Send ACK 1 CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Alternating Bit Protocol (No NAK) 28 • Receiver • Sender Idle 0 Wait for ACK 0 Data to send Send data 0 Receive ACK 0 ^ Receive ACK 1/corrupt Re-send data 0 Wait for data 0 Receive data 0 Deliver data Send ACK 0 Idle 1 Wait for ACK 1 Wait for data 1 Data to send Send data 1 Receive ACK 1 ^ Receive data 1 Deliver data Send ACK 1 Receive data 0 or corrupt Send ACK 0 Receive data 1 or corrupt Send ACK 1 CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Clicker question Is this state machine complete? A. Yes B. No CPSC 317 2023W2 © 2021 29 Receiver Sender 29 Idle 0 Wait for ACK 0 Data to send Send data 0 Receive ACK 0 ^ Receive ACK 1/corrupt Re-send data 0 Wait for data 0 Receive data 0 Deliver data Send ACK 0 Idle 1 Wait for ACK 1 Wait for data 1 Data to send Send data 1 Receive ACK 1 ^ Receive ACK 0/corrupt Re-send data 1 Receive data 1 Deliver data Send ACK 1 Receive data 0 or corrupt Send ACK 0 Receive data 1 or corrupt Send ACK 1 CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Answer Is this state machine complete? A. Yes B. No CPSC 317 2023W2 © 2021 30 Receiver Sender 30 Idle 0 Wait for ACK 0 Data to send Send data 0 Receive ACK 0 ^ Receive ACK 1/corrupt Re-send data 0 Wait for data 0 Receive data 0 Deliver data Send ACK 0 Idle 1 Wait for ACK 1 Wait for data 1 Data to send Send data 1 Receive ACK 1 ^ Receive ACK 0/corrupt Re-send data 1 Receive data 1 Deliver data Send ACK 1 Receive data 0 or corrupt Send ACK 0 Receive data 1 or corrupt Send ACK 1 CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi In-class activity • ICA42 • Create FSMs for DNS servers CPSC 317 2023W2 © 2021 31CPSC 317 – Computer Networking : Transport Layer – State Machine Maryam R.Aliabadi Next Topic Lost Segments and Time Out 32","libVersion":"0.2.1","langs":""}
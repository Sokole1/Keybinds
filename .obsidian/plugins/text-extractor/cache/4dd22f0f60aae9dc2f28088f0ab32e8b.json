{"path":".obsidian/plugins/text-extractor/cache/4dd22f0f60aae9dc2f28088f0ab32e8b.json","text":"ELEMENTARY NUMBER THEORY ��onnect learn • .,..., 1 Succeed\" Seventh Edition David M. Burton University of New Hampshire The McGraw·Hill Companies • .-..,�Connect Learn Succeed'· � ELEMENTARY NUMBER THEORY, SEVENTH EDITION Published by McGraw-Hill, a business unit of The McGraw-Hill Companies, Inc., 1221 Avenue of the Americas, New York, NY 10020. Copyright© 2011 by The McGraw-Hill Companies, Inc. All rights reserved. Previous editions© 2007, 2002, and 1998. No part of this publication may be reproduced or distributed in any form or by any means, or stored in a database or retrieval system, without the prior written consent of The McGraw-Hill Companies, Inc., including, but not limited to, in any network or other electronic storage or transmission, or broadcast for distance learning. Some ancillaries, including electronic and print components, may not be available to customers outside the United States. This book is printed on acid-free paper. 1 2 3 4 5 6 7 8 9 0 DOC/DOC 1 0 9 8 7 6 5 4 3 2 1 0 ISBN 978-0-07-338314-9 MHID 0-07-338314-7 Vice President & Editor-in-Chief: Martin Lange Vice President EDP & Central Publishing Services: Kimberly Meriwether David Editorial Director: Stewart K. Mattson Sponsoring Editor: Bill Stenquist Developmental Editor: Eve L. Lipton Marketing Coordinator: Sabina Navsariwala-Horrocks Project Manager: Melissa M. Leick Senior Production Supervisor: Kara Kudronowicz Design Coordinator: Brenda A. Rolwes Cover Designer: Studio Montage, St. Louis, Missouri (USE) Cover Image: © Tom Grilli Getty Images Senior Photo Research Coordinator: John C. Leland Compositor: Glyph International Typeface: 10.5/12 Times Roman Printer: R. R. Donnelley All credits appearing on page or at the end of the book are considered to be an extension of the copyright page. Library of Congress Cataloging-in-Publication Data Burton, David M. Elementary number theory I David M. Burton. -7th ed. p. cm. Includes bibliographical references and index. ISBN 978-0-07-338314-9 (alk. paper) 1. Number theory. I. Title. QA241.B83 2010 512.7'2-dc22 www.rnhhe.com 2009044311 TO MARTHA ABOUT THE AUTHOR David M. Burton received his B.A. from Clark University and his M.A. and Ph.D. degrees from the University of Rochester. He joined the faculty of the University of New Hampshire, where he is now Professor Emeritus of Mathematics, in 1959. His teaching experience also includes a year at Yale University, numerous summer insti­ tutes for high school teachers, and presentations at meetings of high school teachers' organizations. Professor Burton is also the author of The History of Mathematics: An Introduction (McGraw-Hill, Seventh edition, 2009) and five textbooks on abstract and linear algebra. In addition to his work in mathematics, he spent 16 years coaching a high school girls' track and field team. When not writing, he is likely to be found jogging or reading (mainly history and detective fiction). He is married and has 3 grown children and a brown Doberman pinscher. iv PREFACE ix offenders, when it comes to celebrating the uselessness of their subject, have been number theorists themselves. G. H. Hardy, the best known figure of 20th century British mathematics, once wrote, \"Both Gauss and lesser mathematicians may be justified in rejoicing that there is one science at any rate, and that their own, whose very remoteness from ordinary human activities should keep it clean and gentle.\" The prominent role that this \"clean and gentle\" science played in the public-key cryptosystems (Section 10.1) may serve as something of a reply to Hardy. Leaving practical applications aside, the importance of number theory derives from its central position in mathematics; its concepts and problems have been instrumental in the creation of large parts of mathematics. Few branches of the discipline have absolutely no connection with the theory of numbers. The past few years have seen a dramatic shift in focus in the undergraduate curriculum away from the more abstract areas of mathematics and toward applied and computational mathematics. With the increasing latitude in course choices, one commonly encounters the mathematics major who knows little or no number theory. This is especially unfortunate, because the elementary theory of numbers should be one of the very best subjects for early mathematical instruction. It requires no long preliminary training, the content is tangible and familiar, and-more than in any other part of mathematics-the methods of inquiry adhere to the scientific approach. The student working in the field must rely to a large extent upon trial and error, in combination with his or her own curiosity, intuition, and ingenuity; nowhere else in the mathematical disciplines is rigorous proof so often preceded by patient, plodding experiment. If the going occasionally becomes slow and difficult, one can take comfort in knowing that nearly every noted mathematician of the past has traveled the same arduous road. There is a dictum that anyone who desires to get at the root of a subject should first study its history. Endorsing this, we have taken pains to fit the material into the larger historical frame. In addition to enlivening the theoretical side of the text, the historical remarks woven into the presentation bring out the point that number theory is not a dead art, but a living one fed by the efforts of many practitioners. They reveal that the discipline developed bit by bit, with the work of each individual contributor built upon the research of many others; often centuries of endeavor were required before significant steps were made. A student who is aware of how people of genius stumbled and groped their way through the creative process to arrive piecemeal at their results is less likely to be discouraged by his or her own fumblings with the homework problems. A word about the problems. Most sections close with a substantial number of them ranging in difficulty from the purely mechanical to challenging theoretical questions. These are an integral part of the book and require the reader's active participation, for nobody can learn number theory without solving problems. The computational exercises develop basic techniques and test understanding of con­ cepts, whereas those of a theoretical nature give practice in constructing proofs. Besides conveying additional information about the material covered earlier, the problems introduce a variety of ideas not treated in the body of the text. We have on the whole resisted the temptation to use the problems to introduce results that will be needed thereafter. As a consequence, the reader need not work all the exercises PREFACE Plato said, \"God is a geometer.\" Jacobi changed this to, \"God is an arithmetician.\" Then came Kronecker and fashioned the memorable expression, \"God created the natural numbers, and all the rest is the work of man.\" FELIX KLEIN The purpose of this volume is to give a simple account of classical number theory and to impart some of the historical background in which the subject evolved. Although primarily intended for use as a textbook in a one-semester course at the undergraduate level, it is designed to be used in teachers' institutes or as supplementary reading in mathematics survey courses. The work is well suited for prospective secondary school teachers for whom a little familiarity with number theory may be particularly helpful. The theory of numbers has always occupied a unique position in the world of mathematics. This is due to the unquestioned historical importance of the subject: it is one of the few disciplines having demonstrable results that predate the very idea of a university or an academy. Nearly every century since classical antiquity has witnessed new and fascinating discoveries relating to the properties of numbers; and, at some point in their careers, most of the great masters of the mathematical sciences have contributed to this body of knowledge. Why has number theory held such an irresistible appeal for the leading mathematicians and for thousands of amateurs? One answer lies in the basic nature of its problems. Although many questions in the field are extremely hard to decide, they can be formulated in terms simple enough to arouse the interest and curiosity of those with little mathematical training. Some of the simplest sounding questions have withstood intellectual assaults for ages and remain among the most elusive unsolved problems in the whole of mathematics. It therefore comes as something of a surprise to find that many students look upon number theory with good-humored indulgence, regarding it as a frippery on the edge of mathematics. This no doubt stems from the widely held view that it is the purest branch of pure mathematics and from the attendant suspicion that it can have few substantive applications to real-world problems. Some of the worst viii X PREFACE in order to digest the rest of the book. Problems whose solutions do not appear straightforward are frequently accompanied by hints. The text was written with the mathematics major in mind; it is equally valuable for education or computer science majors minoring in mathematics. Very little is demanded in the way of specific prerequisites. A significant portion of the book can be profitably read by anyone who has taken the equivalent of a first-year college course in mathematics. Those who have had additional courses will generally be better prepared, if only because of their enhanced mathematical maturity. In particular, a knowledge of the concepts of abstract algebra is not assumed. When the book is used by students who have had an exposure to such matter, much of the first four chapters can be omitted. Our treatment is structured for use in a wide range of number theory courses, of varying length and content. Even a cursory glance at the table of contents makes plain that there is more material than can be conveniently presented in an introductory one-semester course, perhaps even enough for a full-year course. This provides flexibility with regard to the audience and allows topics to be selected in accordance with personal taste. Experience has taught us that a semester-length course having the Quadratic Reciprocity Law as a goal can be built up from Chapters 1 through 9. It is unlikely that every section in these chapters need be covered; some or all of Sections 5.4, 6.2, 6.3, 6.4, 7.4, 8.3, 8.4, and 9.4 can be omitted from the program without destroying the continuity in our development. The text is also suited to serve a quarter-term course or a six-week summer session. For such shorter courses, segments of further chapters can be chosen after completing Chapter 4 to construct a rewarding account of number theory. Chapters 10 through 16 are almost entirely independent of one another and so may be taken up or omitted as the instructor wishes. (Probably most users will want to continue with parts of Chapter 10, while Chapter 14 on Fibonacci numbers seems to be a frequent choice.) These latter chapters furnish the opportunity for additional reading in the subject, as well as being available for student presentations, seminars, or extra-credit projects. Number theory is by nature a discipline that demands a high standard of rigor. Thus, our presentation necessarily has its formal aspect, with care taken to present clear and detailed arguments. An understanding of the statement of a theorem, not the proof, is the important issue. But a little perseverance with the demonstration will reap a generous harvest, for our hope is to cultivate the reader's ability to follow a causal chain of facts, to strengthen intuition with logic. Regrettably, it is all too easy for some students to become discouraged by what may be their first intensive experience in reading and constructing proofs. An instructor might ease the way by approaching the beginnings of the book at a more leisurely pace, as well as restraining the urge to attempt all the interesting problems. NEW TO THIS EDITION Readers familiar with the previous edition will find that this one has the same general organization and content. Nevertheless, the preparation of this seventh edition has PREFACE Xi provided the opportunity for making a number of small improvements and several more significant ones. The advent and general accessibility of fast computers have had a profound ef­ fect on almost all aspects of number theory. This influence has been particularly felt in the areas of primality testing, integers factorization, and cryptographic applica­ tions. Consequently, the discussion of public key cryptosystems has been expanded and furnished with an additional illustration. The knapsack cryptosystem has like­ wise been given a further example. The most notable difference between the present edition and the previous one is the inclusion, in Chapter 15, of a new section deal­ ing with Farey fractions. The notion provides a straightforward means of closely approximating irrational numbers by rational values. (Its location should not deter the reader from taking up the topic earlier.) There are other, less pronounced but equally noteworthy, changes in the text. The concept of universal quadratics is briefly introduced in Section 13.3, and Bernoulli numbers receive some attention in Section 16.4. Also, the ever-expanding list of Mersenne numbers has been moved from the narrative of the text to Table 6 in the Tables section of the Appendixes. ACKNOWLEDGMENTS I would like to express my deep appreciation to those mathematicians who read the manuscript for the seventh edition and offered valuable suggestions leading to its improvement. The advice of the following reviewers was particularly helpful: Fred Howard, Wake Forest University Sheldon Kamienny, The University of Southern California Christopher Simons, Rowan University Tara Smith, The University of Cincinnati John Watkins, Colorado College I remain grateful to those people who served as reviewers of the earlier editions of the book; their academic affiliations at the time of reviewing are indicated. Hubert Barry, Jacksonville State University L. A. Best, The Open University Ethan Bolker, University of Massachusetts - Boston Joseph Bonin, George Washington University Jack Ceder, University of California at Santa Barbara Robert A. Chaffer, Central Michigan University Joel Cohen, University of Maryland Daniel Drucker, Wayne State University Martin Erickson, Truman State University Howard Eves, University of Maine Davida Fischman, California State University, San Bernardino Daniel Flath, University of Southern Alabama Kothandaraman Ganesan, Tennessee State University Xii PREFACE Shamita Dutta Gupta, Florida International University David Hart, Rochester Institute of Technology Gabor Hetyei, University of North Carolina - Charlotte Frederick Hoffman, Florida Atlantic University Corlis Johnson, Mississippi State University Mikhail Kapranov, University of Toronto Larry Matthews, Concordia College Neal McCoy, Smith College David E. McKay, California State University, Long Beach David Outcalt, University of California at Santa Barbara Manley Perkel, Wright State University Michael Rich, Temple University David Roeder, Colorado College Thomas Schulte, California State University at Sacramento William W. Smith, University of North Carolina Kenneth Stolarsky, University of Illinois Virginia Taylor, Lowell Technical Institute Robert Tubbs, University of Colorado David Urion, Winona State University Gang Yu, University of South Carolina Paul Vicknair, California State University at San Bernardino Neil M. Wigley, University of Windsor I'm also indebted to Abby Tanenbaum for confirming the numerical answers in the back of the book. A special debt of gratitude must go to my wife, Martha, whose generous assis­ tance with the book at all stages of development was indispensable. The author must, of course, accept the responsibility for any errors or shortcom­ ings that remain. David M. Burton Durham, New Hampshire CHAPTER 1 PRELIMINARIES Number was born in superstition and reared in mystery, ... numbers were once made the foundation of religion and philosophy, and the tricks of figures have had a marvellous effect on a credulous people. F. W. PARKER 1.1 MATHEMATICAL INDUCTION The theory of numbers is concerned, at least in its elementary aspects, with properties of the integers and more particularly with the positive integers 1, 2, 3, ... (also known as the natural numbers). The origin of this misnomer harks back to the early Greeks for whom the word number meant positive integer, and nothing else. The natural numbers have been known to us for so long that the mathematician Leopold Kronecker once remarked, \"God created the natural numbers, and all the rest is the work of man.\" Far from being a gift from Heaven, number theory has had a long and sometimes painful evolution, a story that is told in the ensuing pages. We shall make no attempt to construct the integers axiomatically, assuming instead that they are already given and that any reader of this book is familiar with many elementary facts about them. Among these is the Well-Ordering Principle, stated here to refresh the memory. Well-Ordering Principle. Every nonempty set S of nonnegative integers contains a least element; that is, there is some integer a in S such that a ::S b for all h's belonging to S. 1 CHAPTER 1 PRELIMINARIES Number was born in superstition and reared in mystery, ... numbers were once made the foundation of religion and philosophy, and the tricks of figures have had a marvellous effect on a credulous people. F. W. PARKER 1.1 MATHEMATICAL INDUCTION The theory of numbers is concerned, at least in its elementary aspects, with properties of the integers and more particularly with the positive integers 1, 2, 3, ... (also known as the natural numbers). The origin of this misnomer harks back to the early Greeks for whom the word number meant positive integer, and nothing else. The natural numbers have been known to us for so long that the mathematician Leopold Kronecker once remarked, \"God created the natural numbers, and all the rest is the work of man.\" Far from being a gift from Heaven, number theory has had a long and sometimes painful evolution, a story that is told in the ensuing pages. We shall make no attempt to construct the integers axiomatically, assuming instead that they are already given and that any reader of this book is familiar with many elementary facts about them. Among these is the Well-Ordering Principle, stated here to refresh the memory. Well-Ordering Principle. Every nonempty set S of nonnegative integers contains a least element; that is, there is some integer a in S such that a ::S b for all h's belonging to S. 1 2 ELEMENTARY NUMBER THEORY Because this principle plays a critical role in the proofs here and in subsequent chapters, let us use it to show that the set of positive integers has what is known as the Archimedean property. Theorem 1.1 Archimedean property. If a and b are any positive integers, then there exists a positive integer n such that na :=::: b. Proof. Assume that the statement of the theorem is not true, so that for some a and b, na < b for every positive integer n. Then the set S = {b - na I n a positive integer} consists entirely of positive integers. By the Well-Ordering Principle, S will possess a least element, say, b - ma. Notice that b - (m + l)a also lies in S, because S contains all integers of this form. Furthermore, we have b - (m + l)a = (b - ma) - a < b - ma contrary to the choice of b - ma as the smallest integer in S. This contradiction arose out of our original assumption that the Archimedean property did not hold; hence, this property is proven true. With the Well-Ordering Principle available, it is an easy matter to derive the First Principle of Finite Induction, which provides a basis for a method of proof called mathematical induction. Loosely speaking, the First Principle of Finite Induction asserts that if a set of positive integers has two specific properties, then it is the set of all positive integers. To be less cryptic, we state this principle in Theorem 1.2. Theorem 1.2 First Principle of Finite Induction. Let S be a set of positive integers with the following properties: (a) The integer 1 belongs to S. (b) Whenever the integer k is in S, the next integer k + 1 must also be in S. Then S is the set of all positive integers. Proof. Let T be the set of all positive integers not in S, and assume that T is nonempty. The Well-Ordering Principle tells us that T possesses a least element, which we denote by a. Because 1 is in S, certainly a > 1, and so 0 < a - 1 < a. The choice of a as the smallest positive integer in T implies that a - 1 is not a member of T, or equivalently that a - 1 belongs to S. By hypothesis, S must also contain (a - 1) + 1 =a, which contradicts the fact that a lies in T. We conclude that the set T is empty and in consequence that S contains all the positive integers. Here is a typical formula that can be established by mathematical induction: 12 + 22 + 32 + ... + n2 = n(2n + l)(n + 1) 6 (1) for n = 1, 2, 3, .... In anticipation of using Theorem 1.2, let S denote the set of all positive integers n for which Eq. (1) is true. We observe that when n = 1, the PRELIMINARIES 3 formula becomes 12 = 1 (2 + 1 )(1 + 1) = 1 6 This means that 1 is in S. Next, assume that k belongs to S (where k is a fixed but unspecified integer) so that 12 + 22 + 32 + . . . + k2 = k(2k + l)(k + 1) 6 (2) To obtain the sum of the first k + 1 squares, we merely add the next one, (k + 1)2, to both sides of Eq. (2). This gives k(2k + l)(k + 1) 12 + 22 + ... + k2 + (k + 1)2 = + (k + 1)2 6 After some algebraic manipulation, the right-hand side becomes [ k(2k + 1) + 6(k + 1)] [ 2k2 + ?k + 6] (k + 1) 6 = (k + 1) 6 (k + 1)(2k + 3)(k + 2) 6 which is precisely the right-hand member ofEq. (1) when n = k + 1. Our reasoning shows that the set S contains the integer k + 1 whenever it contains the integer k. By Theorem 1.2, S must be all the positive integers; that is, the given formula is true for n = 1, 2, 3, .... Although mathematical induction provides a standard technique for attempting to prove a statement about the positive integers, one disadvantage is that it gives no aid in formulating such statements. Of course, if we can make an \"educated guess\" at a property that we believe might hold in general, then its validity can often be tested by the induction principle. Consider, for instance, the list of equalities 1 = 1 1+2=3 1+2 + 22 = 7 1+2 + 22 + 23 = 15 1 + 2 + 22 + 23 + 24 = 31 1 + 2 + 22 + 23 + 24 + 25 = 63 We seek a rule that gives the integers on the right-hand side. After a little reflection, the reader might notice that 1=2-1 15 = 24 -1 3 = 22 -1 31 = 25 -1 7 = 23 -1 63 = 26 -1 (How one arrives at this observation is hard to say, but experience helps.) The pattern emerging from these few cases suggests a formula for obtaining the value of the 4 ELEMENTARY NUMBER THEORY expression 1 + 2 + 22 + 23 + · · · + 2n-l; namely, 1 + 2 + 22 + 23 + · · · + 2n-l = 2n - 1 for every positive integer n. (3) To confirm that our guess is correct, let S be the set of positive integers n for which Eq. (3) holds. For n = 1, Eq. (3) is certainly true, whence 1 belongs to the set S. We assume that Eq. (3) is true for a fixed integer k, so that for this k 1 + 2 + 22 + ... + 2k-l = 2k - 1 and we attempt to prove the validity of the formula for k + 1. Addition of the term 2k to both sides of the last-written equation leads to 1 + 2 + 22 + ... + 2k-l + 2k = 2k - 1 + 2k = 2 . 2k - 1 = 2k+ 1 - 1 But this says that Eq. (3) holds when n = k + 1, putting the integer k + 1 in S so that k + 1 is in S whenever k is in S. According to the induction principle, S must be the set of all positive integers. Remark. When giving induction proofs, we shall usually shorten the argument by eliminating all reference to the set S, and proceed to show simply that the result in question is true for the integer 1, and if true for the integer k is then also true for k + 1. We should inject a word of caution at this point, to wit, that one must be careful to establish both conditions of Theorem 1.2 before drawing any conclusions; neither is sufficient alone. The proof of condition (a) is usually called the basis for the induction, and the proof of (b) is called the induction step. The assumptions made in carrying out the induction step are known as the induction hypotheses. The induction situation has been likened to an infinite row of dominoes all standing on edge and arranged in such a way that when one falls it knocks down the next in line. If either no domino is pushed over (that is, there is no basis for the induction) or if the spacing is too large (that is, the induction step fails), then the complete line will not fall. The validity of the induction step does not necessarily depend on the truth of the statement that one is endeavoring to prove. Let us look at the false formula 1 + 3 + 5 + · · · + (2n - 1) = n2 + 3 (4) Assume that this holds for n = k; in other words, 1 + 3 + 5 + ... + (2k - 1) = k2 + 3 Knowing this, we then obtain 1 + 3 + 5 + ... + (2k - 1) + (2k + 1) = k2 + 3 + 2k + 1 = (k + 1)2 + 3 which is precisely the form that Eq. (4) should take when n = k + 1. Thus, if Eq. (4) holds for a given integer, then it also holds for the succeeding integer. It is not possible, however, to find a value of n for which the formula is true. PRELIMINARIES 5 There is a variant of the induction principle that is often used when Theorem 1.2 alone seems ineffective. As with the first version, this Second Principle of Finite In­ duction gives two conditions that guarantee a certain set of positive integers actually consists of all positive integers. This is what happens: we retain requirement (a), but (b) is replaced by (b') If k is a positive integer such that 1, 2, ... , k belong to S, then k + 1 must also be in S. The proof that S consists of all positive integers has the same flavor as that of Theorem 1.2. Again, let T represent the set of positive integers not in S. Assuming that T is nonempty, we choose n to be the smallest integer in T. Then n > 1, by supposition (a). The minimal nature of n allows us to conclude that none of the integers 1, 2, ... , n - 1 lies in T, or, if we prefer a positive assertion, 1, 2, ... , n - 1 all belong to S. Property (b') then puts n = (n - 1) + 1 in S, which is an obvious contradiction. The result of all this is to make T empty. The First Principle of Finite Induction is used more often than is the Second; however, there are occasions when the Second is favored and the reader should be familiar with both versions. It sometimes happens that in attempting to show that k + 1 is a member of S, we require proof of the fact that not only k, but all positive integers that precede k, lie in S. Our formulation of these induction principles has been for the case in which the induction begins with 1. Each form can be generalized to start with any positive integer n0. In this circumstance, the conclusion reads as \"Then Sis the set of all positive integers n ;::: n0.\" Mathematical induction is often used as a method of definition as well as a method of proof. For example, a common way of introducing the symbol n ! (pro­ nounced \"n factorial\") is by means of the inductive definition (a) 1! = 1, (b) n ! = n · (n - 1) ! for n > 1. This pair of conditions provides a rule whereby the meaning of n ! is specified for each positive integer n. Thus, by (a), 1 ! = 1; (a) and (b) yield 2! = 2. 1! = 2. 1 while by (b ), again, 3!=3·2!=3·2·1 Continuing in this manner, using condition (b) repeatedly, the numbers 1 ! , 2 ! , 3 ! , ... , n ! are defined in succession up to any chosen n. In fact, n ! = n · (n - 1) · · · 3 · 2 · 1 Induction enters in showing that n ! , as a function on the positive integers, exists and is unique; however, we shall make no attempt to give the argument. It will be convenient to extend the definition of n ! to the case in which n = 0 by stipulating that O! = 1. 6 ELEMENTARY NUMBER THEORY Example 1.1. To illustrate a proof that requires the Second Principle of Finite Induc­ tion, consider the so-called Lucas sequence: 1,3,4, 7, 11, 18,29,47, 76, ... Except for the first two terms, each term of this sequence is the sum of the preceding two, so that the sequence may be defined inductively by for all n =:::: 3 We contend that the inequality an < (7 /4t holds for every positive integer n. The argument used is interesting because in the inductive step, it is necessary to know the truth of this inequality for two successive values of n to establish its truth for the following value. First of all, for n = 1 and 2, we have a 1 = 1 < (7I4)1 = 7 / 4 and a1 = 3 < (7 /4)2 = 49/16 whence the inequality in question holds in these two cases. This provides a basis for the induction. For the induction step, choose an integer k =:::: 3 and assume that the inequality is valid for n = 1, 2, ... , k - 1. Then, in particular, ak-1 < (7 /4)k-l and ak-2 < (7 /4)k-2 By the way in which the Lucas sequence is formed, it follows that ak = ak-1 + ak-2 < (7 /4)k-l + (7 /4)k-2 = (7 /4)k-2(7 /4 + 1) = (7 /4)k-2(11/4) < (7 /4)k-2(7 /4)2 = (7 /4)k Because the inequality is true for n = k whenever it is true for the integers 1, 2, ... , k - 1, we conclude by the second induction principle that an < (7 / 4 r for all n ::::: 1. Among other things, this example suggests that if objects are defined inductively, then mathematical induction is an important tool for establishing the properties of these objects. PROBLEMS 1.1 1. Establish the formulas below by mathematical induction: n(n + 1) (a) 1 + 2 + 3 + · · · + n = 2 for all n =:::: 1. (b) 1 + 3 + 5 + · · · + (2n - 1) = n2 for all n =:::: 1. n(n + l)(n + 2) (c) 1 · 2 + 2 · 3 + 3 · 4 + · · · + n(n + 1) = 3 for all n =:::: 1. PRELIMINARIES 7 (d) 12 + 32 + 52 + ... + (2n - 1)2 = n(2n - l1(2n + l) for all n � 1. [ n(n + 1)] 2 (e) 13 + 23 + 33 + · · · + n3 = 2 for all n � 1. 2. If r # 1, show that for any positive integer n, a(rn+l - 1) a + ar + ar2 + · · · + arn = ---­ r - 1 3. Use the Second Principle of Finite Induction to establish that for all n � 1, an - 1 = (a - l)(an-l + an-2 + an-3 +···+a + 1) [Hint: an+l - 1 = (a + l)(an - 1) - a(an-l - 1). ] 4. Prove that the cube of any integer can be written as the difference of two squares. [Hint: Notice that n3 = (13 + 23 + · · · + n3) - (13 + 23 + · · · + (n - 1)3). ] 5. (a) Find the values of n :::; 7 for which n ! + 1 is a perfect square (it is unknown whether n! + 1 is a square for any n > 7). (b) True or false? For positive integers m and n, (mn)! = m !n! and (m + n)! = m ! + n!. 6. Prove that n ! > n2 for every integer n � 4, whereas n ! > n3 for every integer n � 6. 7. Use mathematical induction to derive the following formula for all n � 1: 1(1!) + 2(2!) + 3(3!) + · · · + n(n!) = (n + l)! - 1 8. (a) Verify that for all n � 1, (2n)! 2 · 6 · 10 · 14 · · · · · (4n - 2) = -­ n! (b) Use part (a) to obtain the inequality 2n(n!)2 :::; (2n)! for all n � 1. 9. Establish the Bernoulli inequality: If 1 + a > 0, then (1 +at� 1 + na for all n � 1. 10. For all n � 1, prove the following by mathematical induction: 1 1 1 1 1 (a) -+ -+ -+ · · · + - < 2 - -. 12 22 32 n2 - n 1 2 3 n n+2 (b) - +-+-+ ... +- =2 - -- . 2 22 23 2n 2n 11. Show that the expression (2n)!/2nn! is an integer for all n � 0. 12. Consider the function defined by T(n) = 2 { 3n + 1 for n odd � for n even The 3n + 1 conjecture is the claim that starting from any integer n > 1, the sequence of iterates T(n), T(T(n)), T(T(T(n))), ... , eventually reaches the integer 1 and subse­ quently runs through the values 1 and 2. This has been verified for all n :::; 1016. Confirm the conjecture in the cases n = 21 and n = 23. PRELIMINARIES 9 Falling back on the definition of the factorial function, this says that n! n! (n+ l)! ���-+ = �����- k!(n - k)! (k - l)!(n - k + 1)! k!(n + 1 - k)! from which Pascal's rule follows. This relation gives rise to a configuration, known as Pascal's triangle, in which the binomial coefficient( � ) appears as the (k + l)th number in the nth row: 1 1 1 2 1 1 3 3 1 1 4 6 4 1 1 5 10 10 5 1 1 6 15 20 15 6 1 The rule of formation should be clear. The borders of the triangle are composed of 1 's; a number not on the border is the sum of the two numbers nearest it in the row immediately above. The so-called binomial theorem is in reality a formula for the complete expansion of (a+ b)n, n � 1, into a sum of powers of a and b. This expression appears with great frequency in all phases of number theory, and it is well worth our time to look at it now. By direct multiplication, it is easy to verify that (a+ b)1 =a+ b (a+ b)2 = a2 + 2ab + b2 (a+ b)3 = a3 + 3a2b + 3ab2 + b3 (a+ b)4 = a4 + 4a3b + 6a2b2 + 4ab3 + b4, etc. The question is how to predict the coefficients. A clue lies in the observation that the coefficients of these first few expansions form the successive rows of Pascal's triangle. This leads us to suspect that the general binomial expansion takes the form (a+b)\" =(�)a•+ C)a•-1b+ G)a•-2b2 + ... + ( n n 1 ) abn-1 + (:) b\" or, written more compactly, (a+ ht= t (n) an-kbk k=O k Mathematical induction provides the best means for confirming this guess. When n = 1, the conjectured formula reduces to (a +b)1 = f�� G) a1-kbk = G) a1b\" + c) a\"b! =a +b 10 ELEMENTARY NUMBER THEORY which is certainly correct. Assuming that the formula holds for some fixed integer m, we go on to show that it also must hold for m + 1. The starting point is to notice that (a + br+1 = a(a + br + b(a + br Under the induction hypothesis, and Upon adding these expressions, we obtain which is the formula in the case n = m + 1. This establishes the binomial theorem by induction. Before abandoning these ideas, we might remark that the first acceptable for­ mulation of the method of mathematical induction appears in the treatise Traite du Triangle Arithmetique, by the 17th century French mathematician and philosopher Blaise Pascal. This short work was written in 1653, but not printed until 1665 be­ cause Pascal had withdrawn from mathematics (at the age of 25) to dedicate his talents to religion. His careful analysis of the properties of the binomial coefficients helped lay the foundations of probability theory. PROBLEMS 1.2 1. (a) Derive Newton's identity (b) Use part (a) to express ( �) in terms of its predecessor: ( n) =n-k+l ( n ) k k k-1 2. If 2 :::; k :::; n - 2, show that 3. For n ::'.'.: 1, derive each of the identities below: (a) ( �) + ( �) + ( �) + ... + (:) = 2n. [Hint: Let a = b = 1 in the binomial theorem.] Cb) ( � ) -( �) + ( �) -... + c-1r (:) = o. (c) ( �) + 2 ( �) + 3 ( �) + ... + n (:) = n2n-l. PRELIMINARIES 11 [Hint: After expanding n(l + br-1 by the binomial theorem, let b = 1; note also that n ( n � 1) = (k + 1) ( k: 1) .] ( d) ( �) + 2 ( � ) + 22 ( �) + ... + 2n (: ) = 3n. (e) ( �) + ( �) + ( �) + ( �) + .. . = ( � ) + ( � ) + ( � ) + ... = 2n- l. [Hint: Use parts (a) and (b).] (t) ( n) _ � ( n) + � ( n) _ ... + (-l )n ( n) = _ 1 . 0 2 1 3 2 n+l n n+l [Hint: The left-hand side equals 4. Prove the following for n ::'.'.: 1: (a) (;) < (r: 1) if and onlyifO:::; r < 4 (n -1). (b) (;) > ( r: 1) if and only if n -1 ::: r > 4 (n -1). (c) (;) = ( r: 1) if and only if n is an odd integer, and r = 4 (n -1). 12 ELEMENTARY NUMBER THEORY 5. (a) For n � 2, prove that [Hint: Use induction and Pascal's rule.] (b) From part (a), and the relation m2 = 2( � ) + m form � 2, deduce the formula 12 + 22 + 32 + ... + n2 = n(n + 1)(2n + 1) 6 (c) Apply the formula in part (a) to obtain a proof that n(n + l)(n + 2) 1 · 2 + 2 · 3 + · · · + n(n + 1) = 3 [Hint: Observe that (m - l)m = 2( � ).] 6. Derive the binomial identity ( 2) ( 4) ( 6) . . . ( 2n) = n(n + 1)(4n - 1) 2 + 2 + 2 + + 2 6 [Hint: Form � 2, (2;') = 2( � ) + m2 .] 7. For n � 1, verify that 12 + 32 + 52 + ... + (2n _ 1)2 = ( 2n: 1 ) 8. Show that, for n � 1, ( 2n ) = 1 · 3 · 5 · · · (2n - 1) 22n n 2· 4· 6··· 2n 9. Establish the inequality zn < ( 2nn) < 22n, for n > 1. n � 2 [Hint: Put x = 2 · 4 · 6 · · · (2n), y = 1 · 3 · 5 · · · (2n - 1), and z = 1 · 2 · 3 · · · n; show that x > y > z, hence x2 > xy > xz.] 10. The Catalan numbers, defined by 1 ( 2n) (2n)! Cn = n + 1 n = n!(n + l)! n = 0, 1, 2, ... form the sequence 1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, .... They first appeared in 1838 when Eugene Catalan (1814-1894) showed that there are Cn ways of parenthesizing a nonassociative product of n + 1 factors. [For instance, when n = 3 there are five ways: ((ab)c)d, (a(bc))d, a((bc)d), a(b(cd)), (ab)(ac).] For n � 1, prove that Cn can be given inductively by 2(2n - 1) Cn = Cn-l n+l CHAPTER 2 DIVISIBILITY THEORY IN THE INTEGERS Integral numbers are the fountainhead of all mathematics. H. MINKOWSKI 2.1 EARLY NUMBER THEORY Before becoming weighted down with detail, we should say a few words about the origin of number theory. The theory of numbers is one of the oldest branches of mathematics; an enthusiast, by stretching a point here and there, could extend its roots back to a surprisingly remote date. Although it seems probable that the Greeks were largely indebted to the Babylonians and ancient Egyptians for a core of information about the properties of the natural numbers, the first rudiments of an actual theory are generally credited to Pythagoras and his disciples. Our knowledge of the life of Pythagoras is scanty, and little can be said with any certainty. According to the best estimates, he was born between 580 and 562 B.C. on the Aegean island of Samos. It seems that he studied not only in Egypt, but may even have extended his journeys as far east as Babylonia. When Pythagoras reappeared after years of wandering, he sought out a favorable place for a school and finally settled upon Croton, a prosperous Greek settlement on the heel of the Italian boot. The school concentrated on four mathemata, or subjects of study: arithmetica (arith­ metic, in the sense of number theory, rather than the art of calculating), harmonia (music), geometria (geometry), and astrologia (astronomy). This fourfold division of knowledge became known in the Middle Ages as the quadrivium, to which was added the trivium of logic, grammar, and rhetoric. These seven liberal arts came to be looked upon as the necessary course of study for an educated person. 13 14 ELEMENTARY NUMBER THEORY Pythagoras divided those who attended his lectures into two groups: the Pro­ bationers (or listeners) and the Pythagoreans. After three years in the first class, a listener could be initiated into the second class, to whom were confided the main discoveries of the school. The Pythagoreans were a closely knit brotherhood, hold­ ing all worldly goods in common and bound by an oath not to reveal the founder's secrets. Legend has it that a talkative Pythagorean was drowned in a shipwreck as the gods' punishment for publicly boasting that he had added the dodecahedron to the number of regular solids enumerated by Pythagoras. For a time, the autocratic Pythagoreans succeeded in dominating the local government in Croton, but a pop­ ular revolt in 501 B.C. led to the murder of many of its prominent members, and Pythagoras himself was killed shortly thereafter. Although the political influence of the Pythagoreans thus was destroyed, they continued to exist for at least two centuries more as a philosophical and mathematical society. To the end, they remained a secret order, publishing nothing and, with noble self-denial, ascribing all their discoveries to the Master. The Pythagoreans believed that the key to an explanation of the universe lay in number and form, their general thesis being that \"Everything is Number.\" (By num­ ber, they meant, of course, a positive integer. ) For a rational understanding of nature, they considered it sufficient to analyze the properties of certain numbers. Pythagoras himself, we are told \"seems to have attached supreme importance to the study of arithmetic, which he advanced and took out of the realm of commercial utility.\" The Pythagorean doctrine is a curious mixture of cosmic philosophy and number mysticism, a sort of supernumerology that assigned to everything material or spiritual a definite integer. Among their writings, we find that 1 represented reason, for reason could produce only one consistent body of truth; 2 stood for man and 3 for woman; 4 was the Pythagorean symbol for justice, being the first number that is the product of equals; 5 was identified with marriage, because it is formed by the union of 2 and 3; and so forth. All the even numbers, after the first one, were capable of separation into other numbers; hence, they were prolific and were considered as feminine and earthy-and somewhat less highly regarded in general. Being a predominantly male society, the Pythagoreans classified the odd numbers, after the first two, as masculine and divine. Although these speculations about numbers as models of \"things\" appear friv­ olous today, it must be borne in mind that the intellectuals of the classical Greek period were largely absorbed in philosophy and that these same men, because they had such intellectual interests, were the very ones who were engaged in laying the foundations for mathematics as a system of thought. To Pythagoras and his followers, mathematics was largely a means to an end, the end being philosophy. Only with the founding of the School of Alexandria do we enter a new phase in which the cultivation of mathematics was pursued for its own sake. It was at Alexandria, not Athens, that a science of numbers divorced from mystic philosophy first began to develop. For nearly a thousand years, until its destruction by the Arabs in 641 A.D., Alexandria stood at the cultural and commercial center of the Hellenistic world. (After the fall of Alexandria, most of its scholars migrated to Constantinople. During the next 800 years, while formal learning in the West all but disappeared, this enclave at Constantinople preserved for us the mathematical works DIVISIBILITY THEORY IN THE INTEGERS 15 of the various Greek schools.) The so-called Alexandrian Museum, a forerunner of the modern university, brought together the leading poets and scholars of the day ; adjacent to it there was established an enormous library, reputed to hold over 700,000 volumes-hand-copied-at its height. Of all the distinguished names connected with the museum, that of Euclid (fl. c.300 B.c.), founder of the School of Mathematics, is in a special class. Posterity has come to know him as the author of the Elements, the oldest Greek treatise on mathematics to reach us in its entirety. The Elements is a compilation of much of the mathematical know ledge available at that time, organized into 13 parts or Books, as they are called. The name of Euclid is so often associated with geometry that one tends to forget that three of the Books-VII, VIII, and IX-are devoted to number theory. Euclid's Elements constitutes one of the great success stories of world literature. Scarcely any other book save the Bible has been more widely circulated or stud­ ied. Over a thousand editions of it have appeared since the first printed version in 1482, and before its printing, manuscript copies dominated much of the teaching of mathematics in Western Europe. Unfortunately, no copy of the work has been found that actually dates from Euclid's own time; the modem editions are descendants of a revision prepared by Theon of Alexandria, a commentator of the 4th century AD. PROBLEMS 2.1 1. Each of the numbers 1=1, 3 = 1+2, 6 = 1+2 + 3, 10 = 1+2 + 3 + 4, ... represents the number of dots that can be arranged evenly in an equilateral triangle: • • • • • • • • • • • • • • • • • • • • This led the ancient Greeks to call a number triangular if it is the sum of consecutive integers, beginning with 1. Prove the following facts concerning triangular numbers: (a) A number is triangular if and only if it is of the form n(n + 1)/2 for some n 2: 1. (Pythagoras, circa 550 B.C.) (b) The integer n is a triangular number if and only if 8n + 1 is a perfect square. (Plutarch, circa 100 AD.) ( c) The sum of any two consecutive triangular numbers is a perfect square. (Nicomachus, circa 100 AD.) (d) If n is a triangular number, then so are 9n + 1, 25n + 3, and 49n + 6. (Euler, 1775) 2. If tn denotes the nth triangular number, prove that in terms of the binomial coefficients, _ (n + 1) fn - \\ 2 n 2: 1 3. Derive the following formula for the sum of triangular numbers, attributed to the Hindu mathematician Aryabhata (circa 500 A.o.): n(n + l)(n + 2) t1 + t2 + t3 + · · · + tn = 6 n 2: 1 [Hint: Group the terms on the left-hand side in pairs, noting the identity tk-I + tk = k2 .] 16 ELEMENTARY NUMBER THEORY 4. Prove that the square of any odd multiple of 3 is the difference of two triangular numbers; specifically, that 9(2n + 1) 2 = t9n+4 - t3n+l 5. In the sequence of triangular numbers, find the following: (a) Two triangular numbers whose sum and difference are also triangular numbers. (b) Three successive triangular numbers whose product is a perfect square. ( c) Three successive triangular numbers whose sum is a perfect square. 6. (a) If the triangular number tn is a perfect square, prove that t4n(n+l) is also a square. (b) Use part (a) to find three examples of squares that are also triangular numbers. 7. Show that the difference between the squares of two consecutive triangular numbers is always a cube. 8. Prove that the sum of the reciprocals of the first n triangular numbers is less than 2; that IS, 1 1 1 1 1 - + - + - + - + ··· + - <2 1 3 6 10 � [Hint: Observe that n(n�l) = 2(� - n�l ).] 9. (a) Establish the identity tx = ty + tz, where n(n + 3) x = + 1 2 y=n +l z= n(n + 3) 2 and n 2:: 1, thereby proving that there are infinitely many triangular numbers that are the sum of two other such numbers. (b) Find three examples of triangular numbers that are sums of two other triangular numbers. 10. Each of the numbers 1, 5 = 1+ 4, 12 = 1+ 4 + 7, 22 = 1+ 4 + 7 + 10, ... represents the number of dots that can be arranged evenly in a pentagon: oW The ancient Greeks called these pentagonal numbers. If Pn denotes the nth pentagonal number, where P1 = 1 and Pn = Pn-1 + (3n - 2) for n 2:: 2, prove that n(3n - 1) Pn = 2 n 2:: 1 11. For n 2:: 2, verify the following relations between the pentagonal, square, and triangular numbers: (a) Pn = tn-l + n2 (b) Pn = 3tn-l + n = 2tn-l + tn 2.2 THE DIVISION ALGORITHM DIVISIBILITY THEORY IN THE INTEGERS 17 We have been exposed to relationships between integers for several pages and, as yet, not a single divisibility property has been derived. It is time to remedy this situation. One theorem, the Division Algorithm, acts as the foundation stone upon which our whole development rests. The result is familiar to most of us; roughly, it asserts that an integer a can be \"divided\" by a positive integer b in such a way that the remainder is smaller than is b. The exact statement of this fact is Theorem 2.1. Theorem 2.1 Division Algorithm. Given integers a and b, with b > 0, there exist unique integers q and r satisfying a= qb + r O�r<b The integers q and r are called, respectively, the quoti ent and remainder in the division of a by b. Proof. We begin by proving that the set S = {a -xb Ix an integer; a -xb '.::'.: O} is nonempty. To do this, it suffices to exhibit a value of x making a -xb nonnegative. Because the integer b '.::'.: 1, we have I a I b '.::'.: I a I, and so a - ( -I a l)b = a + I a I b '.::'.: a + I a I '.::'.: 0 For the choice x = -I a I, then, a -x b lies in S. This paves the way for an application of the Well-Ordering Principle (Chapter 1 ), from which we infer that the set S contains a smallest integer; call it r. By the definition of S, there exists an integer q satisfying r =a -qb 0 � r We argue that r < b. If this were not the case, then r '.::'.: b and a - (q + l)b =(a -qb) - b = r - b '.::'.: 0 The implication is that the integer a - (q + l)b has the proper form to belong to the set S. But a - (q + l)b = r - b < r, leading to a contradiction of the choice of r as the smallest member of S. Hence, r < b. Next we tum to the task of showing the uniqueness of q and r. Suppose that a has two representations of the desired form, say, a = qb + r = q'b + r' where 0 � r < b, 0 � r' < b. Then r' - r = b(q -q') and, owing to the fact that the absolute value of a product is equal to the product of the absolute values, I r' - r I = b I q -q' I Upon adding the two inequalities -b < -r � 0 and 0 � r' < b, we obtain -b < r' - r < b or, in equivalent terms, Ir' - r I < b. Thus, b I q -q' I < b, which yields o �I q -q' I< 1 Because I q -q' I is a nonnegative integer, the only possibility is that I q -q' I = 0, whence q = q'; this, in tum, gives r = r', ending the proof . 18 ELEMENTARY NUMBER THEORY A more general version of the Division Algorithm is obtained on replacing the restriction that b must be positive by the simple requirement that b -=f. 0. Corollary. If a and b are integers, with b # 0, then there exist unique integers q and r such that a= qb + r o::::: r <lb I Proof. It is enough to consider the case in which b is negative. Then I b I > 0, and Theorem 2.1 produces unique integers q' and r for which a= q' lb I+ r o::::: r <lb I Noting that I b I = -b, we maytakeq = -q' to arrive at a= qb + r, withO::::; r < I b I· To illustrate the Division Algorithm when b < 0, let us take b = -7. Then, for the choices of a = 1, -2, 61, and -59, we obtain the expressions 1=0(-7) + 1 -2 = 1(-7) + 5 61 = (-8)(-7)+5 -59 = 9(-7) + 4 We wish to focus our attention on the applications of the Division Algorithm, and not so much on the algorithm itself. As a first illustration, note that with b = 2 the possible remainders are r = 0 and r = 1. When r = 0, the integer a has the form a = 2q and is called even; when r = 1, the integer a has the form a = 2q + 1 and is calledodd.Nowa 2 is either of theform (2q)2 = 4kor (2q + 1)2 = 4(q 2+q)+1 = 4k + 1. The point to be made is that the square of an integer leaves the remainder 0 or 1 upon division by 4. We also can show the following: the square of any odd integer is of the form 8k + 1. For, by the Division Algorithm, any integer is representable as one of the four forms: 4q, 4q + 1, 4q + 2, 4q + 3. In this classification, only those integers of the forms 4q + 1 and 4q + 3 are odd. When the latter are squared, we find that ( 4q + 1) 2 = 8(2q2 + q) + 1 = 8k + 1 and similarly (4q + 3)2 = 8(2q2 + 3q + 1) + 1 = 8k + 1 As examples, the square of the odd integer 7 is 7 2 = 49 = 8 · 6 + 1, and the square of 13 is 132 = 169 = 8 · 21 + 1. As these remarks indicate, the advantage of the Division Algorithm is that it allows us to prove assertions about all the integers by considering only a finite number of cases. Let us illustrate this with one final example. Example 2.1. We propose to show that the expression a(a2 + 2)/3 is an integer for all a :=:::: 1. According to the Division Algorithm, every a is of the form 3q, 3q + 1, or DIVISIBILITY THEORY IN THE INTEGERS 19 3q + 2. Assume the first of these cases. Then a(a2 + 2) = q(9q2 + 2) 3 which clearly is an integer. Similarly, if a = 3q + 1, then (3q + 1)((3q + 1)2 + 2) = (3q + 1)(3q2 + 2q + 1) 3 and a(a2 + 2)/3 is an integer in this instance also. Finally, for a = 3q + 2, we obtain (3q + 2)((3q + 2)2 + 2) = (3q + 2)(3q2 + 4q + 2) 3 an integer once more. Consequently, our result is established in all cases. PROBLEMS 2.2 1. Prove that if a and b are integers, with b > 0, then there exist unique integers q and r satisfying a = qb + r, where 2b :::::: r < 3b. 2. Show that any integer of the form 6k + 5 is also of the form 3 j + 2, but not conversely. 3. Use the Division Algorithm to establish the following: (a) The square of any integer is either of the form 3k or 3k + 1. (b) The cube of any integer has one of the forms: 9k, 9k + 1, or 9k + 8. ( c) The fourth power of any integer is either of the form 5k or 5k + 1. 4. Prove that 3a2 - 1 is never a perfect square. [Hint: Problem 3(a).] 5. For n '.:\".: 1, prove that n(n + 1)(2n + 1)/6 is an integer. [Hint: By the Division Algorithm, n has one of the forms 6k, 6k + 1, ... , 6k + 5; estab­ lish the result in each of these six cases.] 6. Show that the cube of any integer is of the form 7k or 7k ± 1. 7. Obtain the following version of the Division Algorithm: For integers a and b, with b =j:. 0, there exist unique integers q and r that satisfy a = q b + r, where - ! I b I < r :::::: ! I b I. [Hint: First write a = q'b + r', where 0:::::: r' < I b I. When 0:::::: r' :::::: !I b I, letr = r' and q = q'; when ! I b I < r' < I b I, let r = r' - I b I and q = q' + 1 if b > 0 or q = q' - 1 if b < O.] 8. Prove that no integer in the following sequence is a perfect square: 11, 111, 1111, 11111, ... [Hint: A typical term 111 · · · 111 can be written as 111 ... 111 = 111 ... 108 + 3 = 4k + 3.] 9. Verify that if an integer is simultaneously a square and a cube (as is the case with 64 = 82 = 43), then it must be either of the form 7k or 7k + 1. 10. For n '.:\".: 1, establish that the integer n (7 n 2 + 5) is of the form 6k. 11. If n is an odd integer, show that n4 + 4n2 + 11 is of the form 16k. 2.3 THE GREATEST COMMON DIVISOR Of special significance is the case in which the remainder in the Division Algorithm turns out to be zero. Let us look into this situation now. 20 ELEMENTARY NUMBER THEORY Definition 2.1. An integer b is said to be divisible by an integer a f. 0, in symbols a I b, if there exists some integer c such that b = ac. We write a )' b to indicate that b is not divisible by a. Thus, for example, -12 is divisible by 4, because -12 = 4(-3). However, 10 is not divisible by 3; for there is no integer c that makes the statement 10 = 3c true. There is other language for expressing the divisibility relation a I b. We could say that a is a divisor of b, that a is afactor of b, or that bis a multiple of a. Notice that in Definition 2.1 there is a restriction on the divisor a: whenever the notation a Ib is employed, it is understood that a is different from zero. If a is a divisor of b, then bis also divisible by -a (indeed, b = ac implies that b = (-a)(-c)), so that the divisors of an integer always occur in pairs. To find all the divisors of a given integer, it is sufficient to obtain the positive divisors and then adjoin to them the corresponding negative integers. For this reason, we shall usually limit ourselves to a consideration of positive divisors. It will be helpful to list some immediate consequences of Definition 2.1. (The reader is again reminded that, although not stated, divisors are assumed to be nonzero.) Theorem 2.2. For integers a, b, c, the following hold: (a) a I 0, 11 a, a I a. (b) a 11 if and only if a = ± 1. (c) If a I band c Id, then ac I bd. (d) If a I band b I c, then a I c. (e) a I band b I a if and only if a = ±b. (f) If a I b and b f. 0, then I a I :S I b I. (g) If a I band a I c, then a I (bx + cy) for arbitrary integers x and y. Proof. We shall prove assertions (f) and (g), leaving the other parts as an exercise. If a I b, then there exists an integer c such that b = ac; also, b f. 0 implies that c f. 0. Upon taking absolute values, we get I b I = I ac I = I a I I c I. Because c f. 0, it follows that I c I � 1, whence I b I = I a 11 c I � I a 1. As regards (g), the relations a I b and a I c ensure that b = ar and c = as for suitable integers r and s. But then whatever the choice of x and y, bx+ cy = arx + asy = a(rx + sy) Because rx + sy is an integer, this says that a I (bx + cy), as desired. It is worth pointing out that property (g ) of Theorem 2.2 extends by induction to sums of more than two terms. That is, if a I bk fork = 1, 2, ... , n, then a I (b1x1 + b2x2 + · · · + bnXn ) for all integers x1, x2, ... , Xn. The few details needed for the proof are so straight­ forward that we omit them. If a and b are arbitrary integers, then an integer d is said to be a common divisor of a and b if both d I a and d I b. Because 1 is a divisor of every integer, DIVISIBILITY THEORY IN THE INTEGERS 21 1 is a common divisor of a and b; hence, their set of positive common divisors is nonempty. Now every integer divides zero, so that if a = b = 0, then every integer serves as a common divisor of a and b. In this instance, the set of positive common divisors of a and b is infinite. However, when at least one of a or b is different from zero, there are only a finite number of positive common divisors. Among these, there is a largest one, called the greatest common divisor of a and b. We frame this as Definition 2.2. Definition 2.2. Let a and b be given integers, with at least one of them different from zero. The greatest common divisor of a and b, denoted by gcd(a, b), is the positive integer d satisfying the following: (a) d I a and d I b. (b) If c I a and c I b, then c :::; d. Example 2.2. The positive divisors of -12 are 1, 2, 3, 4, 6, 12, whereas those of 30 are 1, 2, 3, 5, 6, 10, 15, 30; hence, the positive common divisors of -12 and 30 are 1, 2, 3, 6. Because 6 is the largest of these integers, it follows that gcd(-12, 30) = 6. In the same way, we can show that gcd(-5, 5) = 5 gcd(8, 17) = 1 gcd(-8, -36) = 4 The next theorem indicates that gcd(a, b) can be represented as a linear combi­ nation of a and b. (By a linear combination of a and b, we mean an expression of the form ax + by, where x and y are integers.) This is illustrated by, say, gcd(-12, 30) = 6 = (-12)2 + 30 · 1 or gcd(-8, -36) = 4 = (-8)4 + (-36)(-1) Now for the theorem. Theorem 2.3. Given integers a and b, not both of which are zero, there exist integers x and y such that gcd(a, b) =ax+ by Proof. Consider the set S of all positive linear combinations of a and b: S = {au+ bv I au+ bv > O; u, v integers} Notice first that S is not empty. For example, if a # 0, then the integer I a I = au + b · 0 lies in S, where we choose u = 1 or u = -1 according as a is positive or negative. By virtue of the Well-Ordering Principle, S must contain a smallest element d. Thus, from the very definition of S, there exist integers x and y for which d = ax + by. We claim that d = gcd(a, b). 22 ELEMENTARY NUMBER THEORY Taking stock of the Division Algorithm, we can obtain integers q and r such that a = qd + r, where 0:::; r < d. Then r can be written in the form r =a - qd =a - q(ax +by) = a(l - qx) + b(-qy) If r were positive, then this representation would imply that r is a member of S, contradicting the fact that d is the least integer in S (recall that r < d). Therefore, r = 0, and so a = qd, or equivalently d I a. By similar reasoning, d I b, the effect of which is to make d a common divisor of a and b. Now if c is an arbitrary positive common divisor of the integers a and b, then part (g) of Theorem 2.2 allows us to conclude that c I (ax + by); that is, c I d. By part (f) of the same theorem, c = I c I :::; I d I = d, so that d is greater than every positive common divisor of a and b. Piecing the bits of information together, we see that d = gcd(a, b). It should be noted that the foregoing argument is merely an \"existence\" proof and does not provide a practical method for finding the values of x and y. This will come later. A perusal of the proof of Theorem 2.3 reveals that the greatest common divisor of a and b may be described as the smallest positive integer of the form ax + by. Consider the case in which a = 6 and b = 15. Here, the set S becomes s = {6(-2 ) + 15. 1, 6(-1 ) + 15. 1, 6 . 1 + 15. 0, ... } = { 3, 9, 6, ... } We observe that 3 is the smallest integer in S, whence 3 = gcd(6, 15). The nature of the members of S appearing in this illustration suggests another result, which we give in the next corollary. Corollary. If a and b are given integers, not both zero, then the set T ={ax+ by Ix, y are integers} is precisely the set of all multiples of d = gcd(a, b ). Proof. Because d I a and d I b, we know that d I (ax+ by) for all integers x, y. Thus, every member of T is a multiple of d. Conversely, d may be written as d = axo + byo for suitable integers x0 and y0, so that any multiple nd of d is of the form nd = n(axo + byo) = a(nxo) + b(nyo) Hence, nd is a linear combination of a and b, and, by definition, lies in T. It may happen that 1 and -1 are the only common divisors of a given pair of integers a and b, whence gcd(a, b) = 1. For example: gcd(2, 5) = gcd(-9, 16 ) = gcd(-27, -35) = 1 This situation occurs often enough to prompt a definition. Definition 2.3. Two integers a and b, not both of which are zero, are said to be relatively prime whenever gcd(a, b) = 1. DIVISIBILITY THEORY IN THE INTEGERS 23 The following theorem characterizes relatively prime integers in terms of linear combinations. Theorem 2.4. Let a and b be integers, not both zero. Then a and b are relatively prime if and only if there exist integers x and y such that 1 = ax + by. Proof. If a and b are relatively prime so that gcd(a, b) = 1, then Theorem 2.3 guar­ antees the existence of integers x and y satisfying 1 = ax + by. As for the converse, suppose that 1 = ax + by for some choice of x and y, and that d = gcd(a, b ). Because d I a and d I b, Theorem 2.2 yields d I (ax+ by), or d 11. Inasmuch as dis a positive integer, this last divisibility condition forces d to equal 1 (part (b) of Theorem 2.2 plays a role here), and the desired conclusion follows. This result leads to an observation that is useful in certain situations; namely, Corollary 1. If gcd(a, b) = d, then gcd(a/d, b/d) = 1. Proof. Before starting with the proof proper, we should observe that although a/ d and b / d have the appearance of fractions, in fact, they are integers because d is a divisor both of a and of b. Now, knowing that gcd(a, b) = d, it is possible to find integers x and y such that d = ax + by. Upon dividing each side of this equation by d, we obtain the expression Because a/ d and b / d are integers, an appeal to the theorem is legitimate. The conclu­ sion is that a/ d and b / d are relatively prime. For an illustration of the last corollary, let us observe that gcd(-12, 30) = 6 and gcd(-12/6, 30/6) = gcd(-2, 5) = 1 as it should be. It is not true, without adding an extra condition, that a I c and b I c together give ab I c. For instance, 6124 and 8 124, but 6 · 8 l 24. If 6 and 8 were relatively prime, of course, this situation would not arise. This brings us to Corollary 2. Corollary 2. If a I c and b I c, with gcd(a, b) = 1, then ab I c. Proof. Inasmuch as a I c and b I c, integers r and s can be found such that c = ar = bs. Now the relation gcd(a, b) = 1 allows us to write 1 =ax+ by for some choice of integers x and y. Multiplying the last equation by c, it appears that c = c · 1 = c(ax + by) = acx + bey If the appropriate substitutions are now made on the right-hand side, then c = a(bs)x + b(ar)y = ab(sx + ry) or, as a divisibility statement, ab I c. 24 ELEMENTARY NUMBER THEORY Our next result seems mild enough, but is of fundamental importance. Theorem 2.5 Euclid's lemma. If a I be, with gcd(a, b) = 1, then a I e. Proof. We start again from Theorem 2.3, writing 1 = ax + by, where x and y are integers. Multiplication of this equation by e produces e = 1 · e = (ax + by )e = aex + bey Because a I ae and a I be, it follows that a I (aex +bey), which can be recast as a I e. If a and b are not relatively prime, then the conclusion of Euclid's lemma may fail to hold. Here is a specific example: 1219 · 8, but 12 l 9 and 12 l 8. The subsequent theorem often serves as a definition of gcd(a, b). The advantage of using it as a definition is that order relationship is not involved. Thus, it may be used in algebraic systems having no order relation. Theorem 2.6. Let a, b be integers, not both zero. For a positive integer d, d = gcd(a, b) if and only if (a) d I a and d I b. (b) Whenever e I a and e I b, then e Id. Proof. To begin, suppose that d = gcd(a, b). Certainly, d I a and d I b, so that (a) holds. In light of Theorem 2.3, d is expressible as d = ax + by for some integers x, y. Thus, if e I a and e I b, then e I (ax+ by), or rather e Id. In short, condition (b) holds. Conversely, let d be any positive integer satisfying the stated conditions. Given any common divisor e of a and b, we have e Id from hypothesis (b). The implication is that d � e, and consequently dis the greatest common divisor of a and b. PROBLEMS 2.3 1. If a I b, show that (-a) I b, a I (-b), and (-a) I (-b). 2. Given integers a, b, e, d, verify the following: (a) lf alb, then albe. (b) If a I b and a I e, then a2 I be. (c) a I b if and only if ae I be, where e f. 0. (d) If a I b and e Id, then ae I bd. 3. Prove or disprove: If a I (b + e), then either a I b or a I c. 4. For n � 1, use mathematical induction to establish each of the following divisibility statements: (a) 8 i 52n + 7. [Hint: 52Ck+l) + 7 = 52 (52k + 7) + (7 - 52 · 7).] (b) 15 I 24n - l. (c) 5 I 33n+l + 2n+1. (d) 21 I 4n+l + 52n-1. ( e) 24 I 2 · 7n + 3 . 5n - 5. 5. Prove that for any integer a, one of the integers a, a+ 2, a + 4 is divisible by 3. 6. For an arbitrary integer a, verify the following: (a) 21 a(a + 1), and 31 a(a + l)(a + 2). (b) 31 a(2a2+7). (c) If a is odd, then 321 (a2 + 3)(a2 + 7). DIVISIBILITY THEORY IN THE INTEGERS 25 7. Prove that if a and bare both odd integers, then 161 a4 + b4 - 2. 8. Prove the following: (a) The sum of the squares of two odd integers cannot be a perfect square. (b) The product of four consecutive integers is 1 less than a perfect square. 9. Establish that the difference of two consecutive cubes is never divisible by 2. 10. For a nonzero integer a, show that gcd(a, 0) = I a I, gcd(a, a)= I a I, and gcd(a, 1) = 1. 11. If a and b are integers, not both of which are zero, verify that gcd(a, b) = gcd(-a, b) = gcd(a, -b) = gcd( -a, -b) 12. Prove that, for a positive integer n and any integer a, gcd(a, a+ n) divides n; hence, gcd(a, a+ 1) = 1. 13. Given integers a and b, prove the following: (a) There exist integers x and y for which c =ax+ by if and only if gcd(a, b) I c. (b) If there exist integers x and y for which ax+ by= gcd(a, b), then gcd(x, y) = 1. 14. For any integer a, show the following: (a) gcd(2a + 1, 9a + 4) = 1. (b) gcd(5a + 2, ?a+ 3) = 1. (c) If a is odd, then gcd(3a, 3a + 2) = 1. 15. If a and b are integers, not both of which are zero, prove that gcd(2a - 3b, 4a - 5b) divides b; hence, gcd(2a + 3, 4a + 5) = 1. 16. Given an odd integer a, establish that a2 +(a+ 2)2 +(a+ 4)2 + 1 is divisible by 12. 17. Prove that the expression (3n)!/(3!)n is an integer for all n =:::: 0. 18. Prove: The product of any three consecutive integers is divisible by 6; the product of any four consecutive integers is divisible by 24; the product of any five consecutive integers is divisible by 120. [Hint: See Corollary 2 to Theorem 2.4.] 19. Establish each of the assertions below: (a) If a is an arbitrary integer, then 61 a(a2 + 11). (b) If a is an odd integer, then 241 a(a2 - 1). [Hint: The square of an odd integer is of the form 8k + 1.] (c) If a and bare odd integers, then 81 (a2 - b2). (d) If a is an integer not divisible by 2 or 3, then 241(a2+23). (e) If a is an arbitrary integer, then 360 I a2(a2 - l)(a2 - 4). 20. Confirm the following properties of the greatest common divisor: (a) If gcd(a, b) = 1, and gcd(a, c) = 1, then gcd(a, be)= 1. [Hint: Because 1 =ax+ by= au+ cv for some x, y, u, v, 1 =(ax+ by)(au + cv) = a(aux + cvx + byu) + bc(yv).] (b) If gcd(a, b) = 1, and c I a, then gcd(b, c) = 1. (c) If gcd(a, b) = 1, then gcd(ac, b) = gcd(c, b). (d) If gcd(a, b) = 1, and c I a+ b, then gcd(a, c) = gcd(b, c) = 1. [Hint: Let d = gcd(a, c). Then d I a, d I c implies that d I (a+ b) - a, or d I b.] (e) If gcd(a, b) = 1, d I ac, and d I be, then d I c. (f ) If gcd(a, b) = 1, then gcd(a2, b2) = 1. [Hint: First show that gcd(a, b2) = gcd(a2, b) = l.] 26 ELEMENTARY NUMBER THEORY 21. (a) Prove that if d I n, then 2d - 1 12n - 1. [Hint: Use the identity xk - 1 = (x - l)(x k- l + xk- 2 + · · · + x + l).] (b) Verify that 235 - 1 is divisible by 31 and 127. 22. Let tn denote the nth triangular number. For what values of n does tn divide the sum ti + t1 + · · · + tn? [Hint: See Problem l(c), Section 1.1.] 23. If a I be, show that a I gcd(a, b) gcd(a, c). 2.4 THE EUCLIDEAN ALGORITHM The greatest common divisor of two integers can be found by listing all their pos­ itive divisors and choosing the largest one common to each; but this is cumber­ some for large numbers. A more efficient process, involving repeated application of the Division Algorithm, is given in the seventh book of the Elements. Although there is historical evidence that this method predates Euclid, today it is referred to as the Euclidean Algorithm. The Euclidean Algorithm may be described as follows: Let a and b be two inte­ gers whose greatest common divisor is desired. Because gcd(I a I, I b I)= gcd(a, b), there is no harm in assuming that a > b > 0. The first step is to apply the Division Algorithm to a and b to get a = qib + ri 0 < ri < b If it happens that r1 = 0, then b I a and gcd(a, b) = b. When r1 =fa 0, divide b by r1 to produce integers q2 and r2 satisfying b = q2r1 + r2 0 � r2 < rl If r2 = 0, then we stop; otherwise, proceed as before to obtain This division process continues until some zero remainder appears, say, at the (n + l)th stage where rn-1 is divided by rn (a zero remainder occurs sooner or later because the decreasing sequence b > r1 > r2 > · · · > 0 cannot contain more than b integers). The result is the following system of equations: a= qlb + rl b = q2r1 + r2 rl = q3r2 + r3 0 < rl < b 0 < r2 < rl 0 < r3 < r2 rn-2 = qnrn-1 + rn 0 < rn < rn-1 rn-1 = qn+lrn + 0 We argue that rn, the last nonzero remainder that appears in this manner, is equal to gcd(a, b). Our proof is based on the lemma below. Lemma. If a= qb + r, then gcd(a, b) = gcd(b, r). DIVISIBILITY THEORY IN THE INTEGERS 27 Proof. If d = gcd(a, b), then the relations d I a and d I b together imply that d I (a - qb), or d I r. Thus, d is a common divisor of both b and r. On the other hand, if c is an arbitrary common divisor of b and r, then c I (qb + r), whence c I a. This makes ca common divisor of a and b, so that c :S d. It now follows from the definition of gcd(b, r) that d = gcd(b, r). Using the result of this lemma, we simply work down the displayed system of equations, obtaining gcd(a, b) = gcd(b, ri) = · · · = gcd(rn-1, rn) = gcd(rn, 0) = rn as claimed. Theorem 2.3 asserts that gcd(a, b) can be expressed in the form ax+ by, but the proof of the theorem gives no hint as to how to determine the integers x and y. For this, we fall back on the Euclidean Algorithm. Starting with the next-to-last equation arising from the algorithm, we write Now solve the preceding equation in the algorithm for rn-1 and substitute to obtain Tn = Tn-2 - qn(Tn-3 - qn-lTn-2) = (1 + qnqn-1)rn-2 + (-qn)rn-3 This represents rn as a linear combination of rn-2 and rn-3· Continuing backward through the system of equations, we successively eliminate the remainders r n-l • rn_2, ... , r2, r1 until a stage is reached where rn = gcd(a, b) is expressed as a linear combination of a and b. Example 2.3. Let us see how the Euclidean Algorithm works in a concrete case by calculating, say, gcd(12378, 3054). The appropriate applications of the Division Algorithm produce the equations 12378 = 4. 3054 + 162 3054 = 18 . 162 + 138 162 = 1 . 138 + 24 138 = 5. 24 + 18 24 = 1. 18 + 6 18 = 3. 6 + 0 Our previous discussion tells us that the last nonzero remainder appearing in these equations, namely, the integer 6, is the greatest common divisor of 12378 and 3054: 6 = gcd(12378,3054) To represent 6 as a linear combination of the integers 12378 and 3054, we start with the next-to-last of the displayed equations and successively eliminate the remainders 28 ELEMENTARY NUMBER THEORY 18, 24, 138, and 162: Thus, we have 6 = 24 - 18 = 24 - (138 - 5. 24) = 6. 24 - 138 = 6(162 - 138) - 138 = 6 . 162 - 7 . 138 = 6. 162 - 7(3054 - 18. 162) = 132. 162 - 7. 3054 = 132(12378 - 4. 3054) - 7. 3054 = 132. 12378 + (-535)3054 6 = gcd(l2378, 3054) = 12378x + 3054y where x = 132 and y = -535. Note that this is not the only way to express the integer 6 as a linear combination of 12378 and 3054; among other possibilities, we could add and subtract 3054 · 12378 to get 6 = (132 + 3054)12378 + (-535 - 12378)3054 = 3186. 12378 + (-12913)3054 The French mathematician Gabriel Lame (1795-1870) proved that the number of steps required in the Euclidean Algorithm is at most five times the number of digits in the smaller integer. In Example 2.3, the smaller integer (namely, 3054) has four digits, so that the total number of divisions cannot be greater than 20; in actuality only six divisions were needed. Another observation of interest is that for each n > 0, it is possible to find integers an and bn such that exactly n divisions are required to compute gcd(an, bn) by the Euclidean Algorithm. We shall prove this fact in Chapter 14. One more remark is necessary. The number of steps in the Euclidean Algorithm usually can be reduced by selecting remainders rk+ 1 such that I rk+ 1 I < rk /2, that is, by working with least absolute remainders in the divisions. Thus, repeating Example 2.3, it is more efficient to write 12378 = 4. 3054 + 162 3054 = 19 . 162 - 24 162 = 7 . 24 - 6 24 = (-4)(-6) + 0 As evidenced by this set of equations, this scheme is apt to produce the negative of the value of the greatest common divisor of two integers (the last nonzero remainder being -6), rather than the greatest common divisor itself. An important consequence of the Euclidean Algorithm is the following theorem. Theorem 2.7. If k > 0, then gcd(ka, kb)= k gcd(a, b). DIVISIBILITY THEORY IN THE INTEGERS 29 Proof. If each of the equations appearing in the Euclidean Algorithm for a and b (see page 28) is multiplied by k, we obtain ak = qi(bk) + r1k 0 < r1k <bk bk= q1(r1k) + r2k 0 < r2k < rik rn-2k = qn(Yn-1k) + rnk 0 < rnk < Yn-lk rn-1k = qn+l(rnk) + 0 But this is clearly the Euclidean Algorithm applied to the integers ak and bk, so that their greatest common divisor is the last nonzero remainder r nk; that is, gcd(ka, kb)= rnk = k gcd(a, b) as stated in the theorem. Corollary. For any integer k i= 0, gcd(ka, kb)= I k I gcd(a, b). Proof. It suffices to consider the case in which k < 0. Then -k = I k I > 0 and, by Theorem 2.7, gcd(ak, bk)= gcd(-ak, -bk) = gcd(a I kl, b I kl) = I k I gcd( a, b) An alternate proof of Theorem 2.7 runs very quickly as follows: gcd(ak, bk) is the smallest positive integer of the form (ak)x + (bk)y, which, in turn, is equal to k times the smallest positive integer of the form ax+ by; the latter value is equal to k gcd(a, b). By way of illustrating Theorem 2.7, we see that gcd(l2, 30) = 3 gcd(4, 10) = 3 · 2 gcd(2, 5) = 6 · 1 = 6 There is a concept parallel to that of the greatest common divisor of two integers, known as their least common multiple; but we shall not have much occasion to make use of it. An integer c is said to be a common multiple of two nonzero integers a and b whenever a I c and b I c. Evidently, zero is a common multiple of a and b. To see there exist common multiples that are not trivial, just note that the products ab and -(ab) are both common multiples of a and b, and one of these is positive. By the Well-Ordering Principle, the set of positive common multiples of a and b must contain a smallest integer; we call it the least common multiple of a and b. For the record, here is the official definition. Definition 2.4. The least common multiple of two nonzero integers a and b, denoted by lcm(a, b), is the positive integer m satisfying the following: (a) a Im and b Im. (b) If a I c and b I c, with c > 0, then m :S c. 30 ELEMENTARY NUMBER THEORY As an example, the positive common multiples of the integers -12 and 30 are 60, 120, 180, ... ; hence, lcm(-12, 30) = 60. The following remark is clear from our discussion: given nonzero integers a and b, lcm(a, b) always exists and lcm(a, b) < I ab I. We lack a relationship between the ideas of greatest common divisor and least common multiple. This gap is filled by Theorem 2.8. Theorem 2.8. For positive integers a and b gcd(a, b) lcm(a, b) =ab Proof. To begin, put d = gcd(a, b) and write a= dr, b = ds for integers r ands. If m = ab/ d, then m = as = r b, the effect of which is to make m a (positive) common multiple of a and b. Now let c be any positive integer that is a common multiple of a and b; say, for definiteness, c = au = bv . As we know, there exist integers x and y satisfying d = ax + by. In consequence, !:._ = cd = c(ax +by) = (-=-) x + (-=-) y = vx + uy m ab ab b a This equation states that m I c, allowing us to conclude that m ::'.:: c. Thus, in accordance with Definition 2.4, m = lcm(a, b); that is, ab ab lcm(a, b) = -= --- d gcd(a, b) which is what we started out to prove. Theorem 2.8 has a corollary that is worth a separate statement. Corollary. For any choice of positive integers a and b, lcm(a, b) = ab if and only if gcd(a, b) = 1. Perhaps the chief virtue of Theorem 2.8 is that it makes the calculation of the least common multiple of two integers dependent on the value of their greatest common divisor-which, in tum, can be calculated from the Euclidean Algorithm. When considering the positive integers 3054 and 12378, for instance, we found that gcd(3054, 12378) = 6; whence, 3054 . 12378 lcm(3054, 12378) = 6 = 6300402 Before moving on to other matters, let us observe that the notion of greatest common divisor can be extended to more than two integers in an obvious way. In the case of three integers, a, b, c, not all zero, gcd( a, b, c) is defined to be the positive integer d having the following properties: (a) dis a divisor of each of a, b, c. (b) If e divides the integers a, b, c, then e � d. We cite two examples: gcd(39, 42, 54) = 3 and DIVISIBILITY THEORY IN THE INTEGERS 31 gcd(49, 210, 350) = 7 The reader is cautioned that it is possible for three integers to be relatively prime as a triple (in other words, gcd(a, b, c) = 1), yet not relatively prime in pairs; this is brought out by the integers 6, 10, and 15. PROBLEMS 2.4 1. Find gcd(143, 227), gcd(306, 657), and gcd(272, 1479). 2. Use the Euclidean Algorithm to obtain integers x and y satisfying the following: (a) gcd(56, 72) = 56x + 72y. (b) gcd(24, 138) = 24x + 138y. (c) gcd(119, 272) = 119x + 272y. (d) gcd(l 769, 2378) = 1769x + 2378y. 3. Prove that if d is a common divisor of a and b, then d = gcd(a, b) if and only if gcd(a/d, b/d) = 1. [Hint: Use Theorem 2.7.] 4. Assuming that gcd(a, b) = 1, prove the following: (a) gcd(a + b, a - b) = 1or2. [Hint: Let d = gcd(a + b, a - b) and show that d I 2a, d I 2b, and thus that d ::S gcd(2a, 2b) = 2 gcd(a, b).] (b) gcd(2a + b, a+ 2b) = 1or3. (c) gcd(a + b, a2 + b2) = 1or2. [Hint: a2 + b2 =(a+ b)(a - b) + 2b2.] (d) gcd(a + b, a2 - ab+ b2) = 1or3. [Hint: a2 - ab+ b2 = (a+ b)2 - 3ab.] 5. For n ::'.'.: 1, and positive integers a, b, show the following: (a) If gcd(a, b) = 1, then gcd(an, bn) = 1. [Hint: See Problem 20(a), Section 2.2.] (b) The relation an I bn implies that a I b. [Hint:Put d = gcd(a,b) and write a = rd,b = sd,where gcd(r,s) = 1.By part (a), gcd(rn, sn) = 1. Show that r = 1, whence a = d.] 6. Prove that if gcd(a, b) = 1, then gcd(a + b, ab)= 1. 7. For nonzero integers a and b, verify that the following conditions are equivalent: (a) a I b. (b) gcd(a, b) = I a I. (c) lcm(a, b) = I b I. 8. Find lcm(143, 227), lcm(306, 657), and lcm(272, 1479). 9. Prove that the greatest common divisor of two positive integers divides their least common multiple. 10. Given nonzero integers a and b, establish the following facts concerning lcm(a, b): (a) gcd(a, b) = lcm(a, b) if and only if a = ±b. (b) If k > 0, then lcm(ka, kb)= k lcm(a, b). (c) If mis any common multiple of a and b, then lcm(a, b) Im. [Hint: Putt = lcm(a, b) and use the Division Algorithm to write m = qt + r, where 0 ::S r < t. Show that r is a common multiple of a and b.] 11. Let a, b, c be integers, no two of which are zero, and d = gcd(a, b, c) . Show that d = gcd(gcd(a, b), c) = gcd(a, gcd(b, c)) = gcd(gcd(a, c) , b) 32 ELEMENTARY NUMBER THEORY 12. Find integers x, y, z satisfying gcd(l98, 288, 512) = 198x + 288y + 512z [Hint: Put d = gcd(198, 288). Because gcd(198, 288, 512) = gcd(d, 512), first find integers u and v for which gcd(d, 512) =du+ 512v.] 2.5 THE DIOPHANTINE EQUATION ax +by = c We now change focus somewhat and take up the study of Diophantine equations. The name honors the mathematician Diophantus, who initiated the study of such equations. Practically nothing is known of Diophantus as an individual, save that he lived in Alexandria sometime around 250 A.D. The only positive evidence as to the date of his activity is that the Bishop of Laodicea, who began his episcopate in 270, dedicated a book on Egyptian computation to his friend Diophantus. Although Diophantus 's works were written in Greek and he displayed the Greek genius for the­ oretical abstraction, he was most likely a Hellenized Babylonian. The only personal particulars we have of his career come from the wording of an epigram-problem (apparently dating from the 4th century): his boyhood lasted 1/6 of his life; his beard grew after 1/12 more; after 117 more he married, and his son was born 5 years later; the son lived to half his father's age and the father died 4 years after his son. If x was the age at which Diophantus died, these data lead to the equation 1 1 1 1 -x + -x + -x + 5 + -x + 4 = x 6 12 7 2 with solution x = 84. Thus, he must have reached an age of 84, but in what year or even in what century is not certain. The great work upon which the reputation of Diophantus rests is his Arithmetic a, which may be described as the earliest treatise on algebra. Only six books of the original thirteen have been preserved. It is in the Arithmetica that we find the first systematic use of mathematical notation, although the signs employed are of the nature of abbreviations for words rather than algebraic symbols in the sense with which we use them today. Special symbols are introduced to represent frequently occurring concepts, such as the unknown quantity in an equation and the different powers of the unknown up to the sixth power; Diophantus also had a symbol to express subtraction, and another for equality. The part of the Arithmetica that has come down to us consists of some 200 problems, which we could now express as equations, together with their worked­ out solutions in specific numbers. Considerable attention was devoted to problems involving squares or cubes. Even for problems with infinitely many solutions, Dio­ phantus was content with finding just one. Solutions were usually given in terms of positive rational numbers, sometimes admitting positive integers; there was no notion at that time of negative numbers as mathematical entities. Although the Arithmetica does not fall into the realm of number theory, which involves properties of the integers, it nevertheless gave great impetus to subsequent European development of the subject. In the mid-17th century, the French mathe­ matician Pierre de Fermat acquired a Latin translation of the rediscovered books of 34 ELEMENTARY NUMBER THEORY this relation is multiplied by t, we get c = dt = (axo + byo)t = a(txo) + b(tyo) Hence, the Diophantine equation ax+ by = c has x = tx0 and y = ty0 as a partic­ ular solution. This proves part of our next theorem. Theorem 2.9. The linear Diophantine equation ax + by = c has a solution if and only if d I c, where d = gcd(a, b ) . If xo, Yo is any particular solution of this equation, then all other solutions are given by X =XO+ (�) t where t is an arbitrary integer. Proof. To establish the second assertion of the theorem, let us suppose that a solution x0, y0 of the given equation is known. If x', y' is any other solution, then axo + byo = c = ax' + by' which is equivalent to a(x' - xo) = b(yo - y') By the corollary to Theorem 2.4, there exist relatively prime integers r ands such that a = dr, b = ds. Substituting these values into the last-written equation and canceling the common factor d, we find that r(x' - xo) = s(yo - y') The situation is now this: r I s(y0 - y'), with gcd(r, s) = 1. Using Euclid's lemma, it must be the case that r I (y0 - y'); or, in other words, y0 - y' = rt for some integer t. Substituting, we obtain x' - xo =st This leads us to the formulas x' = xo + st = xo + ( �) t y' =Yo -rt = Yo - (�) t It is easy to see that these values satisfy the Diophantine equation, regardless of the choice of the integer t; for ax'+ by' = a [ xo + ( �) t] + b [Yo - (�) t J = (axo + byo) + ( a: - a:) t =c+ O·t =c Thus, there are an infinite number of solutions of the given equation, one for each value of t. DIVISIBILITY THEORY IN THE INTEGERS 35 Example 2.4. Consider the linear Diophantine equation 172x + 20y = 1000 Applying the Euclidean's Algorithm to the evaluation of gcd(l 72, 20), we find that 172 = 8. 20 + 12 20 = 1. 12 + 8 12 = 1. 8 + 4 8 = 2·4 whence gcd(l 72, 20) = 4. Because 411000, a solution to this equation exists. To obtain the integer 4 as a linear combination of 172 and 20, we work backward through the previous calculations, as follows: 4 = 12 - 8 = 12 - (20 - 12) = 2. 12 - 20 = 2(172 - 8 . 20) - 20 = 2. 172 + (-17)20 Upon multiplying this relation by 250, we arrive at 1000 = 250. 4 = 250[2. 172 + (-17)20] = 500 . 172 + ( -4250)20 so that x = 500 and y = -4250 provide one solution to the Diophantine equation in question. All other solutions are expressed by x = 500 + (20/4)t = 500 + 5t y = -4250 - (l 72/4)t = -4250 - 43t for some integer t. A little further effort produces the solutions in the positive integers, if any happen to exist. For this, t must be chosen to satisfy simultaneously the inequalities 5t + 500 > 0 or, what amounts to the same thing, - 43t - 4250 > 0 36 -98- > t > -100 43 Because t must be an integer, we are forced to conclude that t = -99. Thus, our Diophantine equation has a unique positive solution x = 5, y = 7 corresponding to the value t = -99. It might be helpful to record the form that Theorem 2.9 takes when the coeffi­ cients are relatively prime integers. Corollary. If gcd(a, b) = 1 and if xo, Yo is a particular solution of the linear Diophan­ tine equation ax + by = c, then all solutions are given by X =XO+ bt for integral values of t. y =Yo - at 36 ELEMENTARY NUMBER THEORY Here is an example. The equation 5x + 22y = 18 has x0 = 8, y0 = -1 as one solution; from the corollary, a complete solution is given by x = 8 + 22t, y = -1 - St for arbitrary t. Diophantine equations frequently arise when solving certain types of traditional word problems, as evidenced by Example 2.5. Example 2.5. A customer bought a dozen pieces of fruit, apples and oranges, for $1.32. If an apple costs 3 cents more than an orange and more apples than oranges were purchased, how many pieces of each kind were bought? To set up this problem as a Diophantine equation, let x be the number of apples and y be the number of oranges purchased; in addition, let z represent the cost (in cents) of an orange. Then the conditions of the problem lead to (z + 3)x + zy = 132 or equivalently 3x + (x + y)z = 132 Because x + y = 12, the previous equation may be replaced by 3x + 12z = 132 which, in turn, simplifies to x + 4z = 44. Stripped of inessentials, the object is to find integers x and z satisfying the Diophantine equation x + 4z = 44 (1) Inasmuch as gcd (1, 4) = 1 is a divisor of 44, there is a solution to this equation. Upon multiplying the relation 1 = 1(-3) + 4 · 1by44 to get 44 = 1(-132) + 4 . 44 it follows that xo = -132, zo = 44 serves as one solution. All other solutions of Eq. (1) are of the form x = -132 + 4t z=44 -t where t is an integer. Not all of the choices for t furnish solutions to the original problem. Only values of t that ensure 12 � x > 6 should be considered. This requires obtaining those values oft such that 12 � -132 + 4t > 6 Now, 12 � -132 + 4t implies that t :'.S 36, whereas -132 + 4t > 6 gives t > 34� . The only integral values of t to satisfy both inequalities are t = 35 and t = 36. Thus, there are two possible purchases: a dozen apples costing 11 cents apiece (the case where t = 36), or 8 apples at 12 cents each and 4 oranges at 9 cents each (the case where t = 35). Linear indeterminate problems such as these have a long history, occurring as early as the 1st century in the Chinese mathematical literature. Owing to a lack of algebraic symbolism, they often appeared in the guise of rhetorical puzzles or riddles. DIVISIBILITY THEORY IN THE INTEGERS 37 The contents of the Mathematical Class ic of Chang Ch' iu-chien (6th century ) attest to the algebraic abilities of the Chinese scholars. This elaborate treatise contains one of the most famous problems in indeterminate equations, in the sense of transmission to other societies-the problem of the \"hundred fowls.\" The problem states: If a cock is worth 5 coins, a hen 3 coins, and three chicks together 1 coin, how many cocks, hens, and chicks, totaling 100, can be bought for 100 coins? In terms of equations, the problem would be written (if x equals the number of cocks, y the number of hens, z the number of chicks): 1 5x + 3y + 3z = 100 x + y + z = 100 Eliminating one of the unknowns, we are left with a linear Diophantine equation in the two other unknowns. Specifically, because the quantity z = 100 - x - y, we have 5x + 3y + iClOO - x - y) = 100, or 1x +4y = 100 This equation has the general solution x = 4t, y = 25 - 1t, so that z = 75 + 3t, where tis an arbitrary integer. Chang himself gave several answers: x=4 y = 18 z = 78 x=8 y = 11 z = 81 x = 12 y=4 z = 84 A little further effort produces all solutions in the positive integers. For this, t must be chosen to satisfy simultaneously the inequalities 4t > 0 25 - 1t > 0 75 + 3t > 0 The last two of these are equivalent to the requirement - 25 < t < 3 �. Because t must have a positive value, we conclude that t = 1, 2, 3, leading to precisely the values Chang obtained. PROBLEMS 2.5 1. Which of the following Diophantine equations cannot be solved? (a) 6x +Sly = 22. (b) 33x + 14y = 115. (c) 14x + 35y = 93. 2. Determine all solutions in the integers of the following Diophantine equations: (a) 56x + 72y = 40. (b) 24x + 138y = 18. (c) 221x + 35y = 11. 3. Determine all solutions in the positive integers of the following Diophantine equations: (a) 18x + 5y = 48. (b) 54x + 21y = 906. (c) 123x + 360y = 99. (d) 158x - 57y = 7. 38 ELEMENTARY NUMBER THEORY 4. If a and b are relatively prime positive integers, prove that the Diophantine equation ax - by = c has infinitely many solutions in the positive integers. [Hint: There exist integers xo and Yo such that axo + byo = c. For any integer t, which is larger than both I xo I / b and I Yo I /a, a positive solution of the given equation is x = xo + bt, y =-(yo - at).] 5. (a) A man has $4.55 in change composed entirely of dimes and quarters. What are the maximum and minimum number of coins that he can have? Is it possible for the number of dimes to equal the number of quarters? (b) The neighborhood theater charges $1.80 for adult admissions and $.75 for children. On a particular evening the total receipts were $90. Assuming that more adults than children were present, how many people attended? (c) A certain number of sixes and nines is added to give a sum of 126; if the number of sixes and nines is interchanged, the new sum is 114. How many of each were there originally? 6. A farmer purchased 100 head of livestock for a total cost of $4000. Prices were as follow: calves, $120 each; lambs, $50 each; piglets, $25 each. If the farmer obtained at least one animal of each type, how many of each did he buy? 7. When Mr. Smith cashed a check at his bank, the teller mistook the number of cents for the number of dollars and vice versa. Unaware of this, Mr. Smith spent 68 cents and then noticed to his surprise that he had twice the amount of the original check. Determine the smallest value for which the check could have been written. [Hint: If x denotes the number of dollars and y the number of cents in the check, then lOOy + x - 68 = 2(100x + y).] 8. Solve each of the puzzle-problems below: (a) Alcuin of York, 775. One hundred bushels of grain are distributed among 100 persons in such a way that each man receives 3 bushels, each woman 2 bushels, and each child ! bushel. How many men, women, and children are there? (b) Mahaviracarya, 850. There were 63 equal piles of plantain fruit put together and 7 single fruits. They were divided evenly among 23 travelers. What is the number of fruits in each pile? [Hint: Consider the Diophantine equation 63x + 7 = 23y.] (c) Yen Kung, 1372. We have an unknown number of coins. If you make 77 strings of them, you are 50 coins short; but if you make 78 strings, it is exact. How many coins are there? [Hint: If N is the number of coins, then N = 77x + 27 = 78y for integers x and y.] ( d) Christoff Rudolff, 1526. Find the number of men, women, and children in a company of 20 persons if together they pay 20 coins, each man paying 3, each woman 2, and each child ! . (e) Euler, 1770. Divide 100 into two summands such that one is divisible by 7 and the other by 11. CHAPTER 3 PRIMES AND THEIR DISTRIBUTION Mighty are numbers, joined with art resistless. 3.1 THE FUNDAMENTAL THEOREM OF ARITHMETIC EURIPIDES Essential to everything discussed herein-in fact, essential to every aspect of number theory-is the notion of a prime number. We have previously observed that any integer a > 1 is divisible by ±1 and± a; if these exhaust the divisors of a, then it is said to be a prime number. In Definition 3.1 we state this somewhat differently. Definition 3.1. An integer p > 1 is called a prime number, or simply a prime, if its only positive divisors are 1 and p. An integer greater than 1 that is not a prime is termed composite. Among the first 10 positive integers, 2, 3, 5, 7 are primes and 4, 6, 8, 9, 10 are composite numbers. Note that the integer 2 is the only even prime, and according to our definition the integer 1 plays a special role, being neither prime nor composite. In the rest of this book, the letters p and q will be reserved, so far as is possible, for primes. Proposition 14 of Book IX of Euclid's Elements embodies the result that later became known as the Fundamental Theorem of Arithmetic, namely, that every inte­ ger greater than 1 can, except for the order of the factors, be represented as a product of primes in one and only one way. To quote the proposition itself: \"If a number be the least that is measured by prime numbers, it will not be measured by any other 39 40 ELEMENTARY NUMBER THEORY prime except those originally measuring it.\" Because every number a > 1 is either a prime or, by the Fundamental Theorem, can be broken down into unique prime factors and no further, the primes serve as the building blocks from which all other integers can be made. Accordingly, the prime numbers have intrigued mathemati­ cians through the ages, and although a number of remarkable theorems relating to their distribution in the sequence of positive integers have been proved, even more remarkable is what remains unproved. The open questions can be counted among the outstanding unsolved problems in all of mathematics. To begin on a simpler note, we observe that the prime 3 divides the integer 36, where 36 may be written as any one of the products 6. 6 = 9. 4 = 12 . 3 = 18. 2 In each instance, 3 divides at least one of the factors involved in the product. This is ty pical of the general situation, the precise result being Theorem 3 .1. Theorem 3.1. If pis a prime and p I ab, then p I a or p I b. Proof. If p I a, then we need go no further, so let us assume that p J a. Because the only positive divisors of p are 1 and p itself, this implies that gcd(p, a) = 1. (In general, gcd(p, a) = p or gcd(p, a) = 1 according as p I a or p )' a.) Hence, citing Euclid's lemma, we get p I b. This theorem easily extends to products of more than two terms. Corollary 1. If p is a prime and p I a i a2 · · · an , then p I ak for some k, where 1 s k s n. Proof. We proceed by induction on n, the number of factors. When n = 1, the stated conclusion obviously holds; whereas when n = 2, the result is the content of Theorem 3.1. Suppose, as the induction hypothesis, that n > 2 and that whenever p divides a product of less than n factors, it divides at least one of the factors. Now p I a1a2 ···an. From Theorem 3 .1, either p I an or p I a 1 a2 · · · an- l. If p I an , then we are through. As regards the case where p I a1a2 · · · an _ 1, the induction hypothesis ensures that p I ak for some choice of k, with 1 :::; k :::; n - 1. In any event, p divides one of the integers ai, a2, ... , an . Corollary 2. If p, qi, q2, ... , qn are all primes and p I qiq2 · · · qn, then p = qk for some k, where 1 :::; k:::; n. Proof. By virtue of Corollary 1, we know that p I qk for some k, with 1 :::; k :::; n. Being a prime, qk is not divisible by any positive integer other than 1 or qk itself. Because p > 1, we are forced to conclude that p = qk. With this preparation out of the way, we arrive at one of the cornerstones of our development, the Fundamental Theorem of Arithmetic. As indicated earlier, this theorem asserts that every integer greater than 1 can be factored into primes in essentially one way; the linguistic ambiguity essentially means that 2 · 3 · 2 is not considered as being a different factorization of 12 from 2 · 2 · 3. We state this precisely in Theorem 3.2. PRIMES AND THEIR DISTRIBUTION 41 Theorem 3.2 Fundamental Theorem of Arithmetic. Every positive integer n > 1 is either a prime or a product of primes; this representation is unique, apart from the order in which the factors occur. Proof. Either n is a prime or it is composite; in the former case, there is nothing more to prove. If n is composite, then there exists an integer d satisfying d I n and 1 < d < n. Among all such integers d, choose p1 to be the smallest (this is possible by the Well-Ordering Principle). Then Pl must be a prime number. Otherwise it too would have a divisor q with 1 < q < Pl; but then q I Pl and Pl I n imply that q I n, which contradicts the choice of p1 as the smallest positive divisor, not equal to 1, of n. We therefore may write n = p1n1, where Pl is prime and 1 < n1 < n. If n1 happens to be a prime, then we have our representation. In the contrary case, the argument is repeated to produce a second prime number p2 such that n1 = p2n2; that is, If n2 is a prime, then it is not necessary to go further. Otherwise, write n2 = p3n3, with p3 apnme: The decreasing sequence n > n1 > n2 > · · · > 1 cannot continue indefinitely, so that after a finite number of steps nk-l is a prime, call it, Pk· This leads to the prime factorization n = P1P2 ···Pk To establish the second part of the proof-the uniqueness of the prime factorization-let us suppose that the integer n can be represented as a product of primes in two ways; say, r�s where the Pi and qj are all primes, written in increasing magnitude so that P1 � P2 �···�Pr Because Pl I q1q2 · · · qs, Corollary 2 of Theorem 3.1 tells us that P1 = qk for some k; but then P1 � q1. Similar reasoning gives q1 � p1, whence P1 = q1. We may cancel this common factor and obtain P2P3 ... Pr = q1q3 ... qs Now repeat the process to get p2 = q1 and, in tum, p3p4 ···Pr = q3q4 · · · qs Continue in this fashion. If the inequality r < s were to hold, we would eventually arrive at 1 = qr+lqr+2 · · · qs which is absurd, because each qj > 1. Hence, r = s and making the two factorizations of n identical. The proof is now complete. 42 ELEMENTARY NUMBER THEORY Of course, several of the primes that appear in the factorization of a given positive integer may be repeated, as is the case with 360 = 2 · 2 · 2 · 3 · 3 · 5. By collecting like primes and replacing them by a single factor, we can rephrase Theorem 3 .2 as a corollary. Corollary. Any positive integer n > 1 can be written uniquely in a canonical form ki kz kr n = P1 P2 ···Pr where, for i = 1, 2, ... , r, each ki is a positive integer and each Pi is a prime, with P1 < P2 < · · · < Pr· To illustrate, the canonical form of the integer 360 is 360 = 23 · 32 · 5. As further examples we cite 4725 = 33 · 52 · 7 and 17460 = 23 . 32 . 5 . 72 Prime factorizations provide another means of calculating greatest common divisors. For suppose that Pl, p 2, ... , Pn are the distinct primes that divide either of a or b. Allowing zero exponents, we can write Then b _ phph pjn - 1 2 · .. n gcd(a, b) = p�1 p;2 • • • p�\" where ri = min(ki, ji ), the smaller of the two exponents associated with Pi in the two representations. In the case a = 4725 and b = 17460, we would have 4725 = 2° . 33 . 52 . 7 7460 = 23 . 32 . 5 . 72 ' and so gcd(4725, 17460) = 2° · 32 · 5 · 7· = 315 This is an opportune moment to insert a famous result of Pythagoras. Mathematics as a science began with Pythagoras (569-500 B.C.), and much of the content of Euclid's Elements is due to Pythagoras and his school. The Pythagoreans deserve the credit for being the first to classify numbers into odd and even, prime and composite. Theorem 3.3 Pythagoras. The number ../2 is irrational. Proof. Suppose, to the contrary, that ../2 is a rational number, say, ../2 = a/ b, where a and b are both integers with gcd(a, b) = 1. Squaring, we get a2 = 2b2, so that b I a2. If b > 1, then the Fundamental Theorem of Arithmetic guarantees the existence of a prime p such that p I b. It follows that p I a2 and, by Theorem 3.1, that p I a; hence, gcd(a, b) :::: p. We therefore arrive at a contradiction, unless b = 1. But if this happens, then a2 = 2, which is impossible (we assume that the reader is willing to grant that no integer can be multiplied by itself to give 2). Our supposition that ../2 is a rational number is untenable, and so ../2 must be irrational. PRIMES AND THEIR DISTRIBUTION 43 There is an interesting variation on the proof of Theorem 3.3. If�= a/b with gcd(a, b) = 1, there must exist integers rands satisfying ar + bs = 1. As a result, J2 = J2(ar + bs) = cha)r + (J2b)s = 2br +as This representation of � leads us to conclude that � is an integer, an obvious impossibility. PROBLEMS 3.1 1. It has been conjectured that there are infinitely many primes of the form n2 - 2. Exhibit five such primes. 2. Give an example to show that the following conjecture is not true: Every positive integer can be written in the form p + a2, where pis either a prime or 1, and a ::::: 0. 3. Prove each of the assertions below: (a) Any prime of the form 3n + 1 is also of the form 6m + 1. (b) Each integer of the form 3n + 2 has a prime factor of this form. (c) The only prime of the form n3 - 1is 7. [Hint: Write n3 - 1 as (n - l)(n2 + n + l).] (d) The only prime p for which 3p + 1 is a perfect square is p = 5. (e) The only prime of the form n2 - 4 is 5. 4. If p ::=:: 5 is a prime number, show that p 2 + 2 is composite. [Hint: p takes one of the forms 6k + 1 or 6k + 5.] 5. (a) Given that p is a prime and p I an, prove that pn I an. (b) If gcd(a, b) = p, a prime, what are the possible values of gcd(a2, b2), gcd(a2, b) and gcd(a3, b2)? 6. Establish each of the following statements: (a) Every integer of the form n4 + 4, with n > 1, is composite. [Hint: Write n4 + 4 as a product of two quadratic factors.] (b) If n > 4 is composite, then n divides (n - 1) !. (c) Any integer of the form gn + 1, where n ::=:: 1, is composite. [Hint: 2n + 1 I 23n + l.] ( d) Each integer n > 11 can be written as the sum of two composite numbers. [Hint: If n is even, say n = 2k, then n - 6 = 2(k - 3); for n odd, consider the integer n - 9.] 7. Find all prime numbers that divide 50!. 8. If p ::=:: q ::=:: 5 and p and q are both primes, prove that 241 p 2 - q2• 9. (a) An unanswered question is whether there are infinitely many primes that are 1 more than a power of 2, such as 5 = 2 2 + 1. Find two more of these primes. (b) A more general conjecture is that there exist infinitely many primes of the form n2 + 1; for example, 257 = 162 + 1. Exhibit five more primes of this type. 10. If p =f. 5 is an odd prime, prove that either p 2 - 1 or p 2 + 1 is divisible by 10. 11. Another unproven conjecture is that there are an infinitude of primes that are 1 less than a power of 2, such as 3 = 2 2 - 1. (a) Find four more of these primes. (b) If p = 2k - 1 is prime, show that k is an odd integer, except when k = 2. [Hint: 3 I 4n - 1 for all n ::=:: l.] 12. Find the prime factorization of the integers 1234, 10140, and 36000. 13. If n > 1 is an integer not of the form 6k + 3, prove that n2 + 2n is composite. [Hint: Show that either 2 or 3 divides n2 + 2n .] 44 ELEMENTARY NUMBER THEORY 14. It has been conjectured that every even integer can be written as the difference of two consecutive primes in infinitely many ways. For example, 6 = 29 - 23 = 137 - 131 = 599 - 593 = 1019 - 1013 = ... Express the integer 10 as the difference of two consecutive primes in 15 ways. 15. Prove that a positive integer a > 1 is a square if and only if in the canonical form of a all the exponents of the primes are even integers. 16. An integer is said to be square-free if it is not divisible by the square of any integer greater than 1. Prove the following: (a) An integer n > 1 is square-free if and only if n can be factored into a product of distinct primes. (b) Every integer n > 1 is the product of a square-free integer and a perfect square. [Hint: If n = p�1 p�2 • • • p:' is the canonical factorization of n, then write k; = 2q; + r; where r; = 0 or 1 according ask; is even or odd.] 17. Verify that any integer n can be expressed as n = 2k m, where k :'.:'.:: 0 and m is an odd integer. 18. Numerical evidence makes it plausible that there are infinitely many primes p such that p + 50 is also prime. List 15 of these primes. 19. A positive integer n is called square-full, or poweiful, if p2 I n for every prime factor p of n (there are 992 square-full numbers less than 250,000). If n is square-full, show that it can be written in the form n = a2 b3, with a and b positive integers. 3.2 THE SIEVE OF ERATOSTHENES Given a particular integer, how can we determine whether it is prime or composite and, in the latter case, how can we actually find a nontrivial divisor? The most obvious approach consists of successively dividing the integer in question by each of the numbers preceding it; if none of them (except 1) serves as a divisor, then the integer must be prime. Although this method is very simple to describe, it cannot be regarded as useful in practice. For even if one is undaunted by large calculations, the amount of time and work involved may be prohibitive. There is a property of composite numbers that allows us to reduce materially the necessary computations-but still the process remains cumbersome. If an in­ teger a > 1 is composite, then it may be written as a = be, where 1 < b < a and 1 < e < a. Assuming that b < e, we get b2 < be= a, and so b _:s JG,. Because b > 1, Theorem 3 .2 ensures that b has at least one prime factor p. Then p < b ,:s JG,; furthermore, because p I band b I a, it follows that p I a. The point is simply this: a composite number a will always possess a prime divisor p satisfying p < fa. In testing the primality of a specific integer a > 1, it therefore suffices to divide a by those primes not exceeding fa (presuming, of course, the availability of a list of primes up to fa). This may be clarified by considering the integer a = 509. Inasmuch as 22 < .J509 < 23, we need only try out the primes that are not larger than 22 as possible divisors, namely, the primes 2, 3, 5, 7, 11, 13, 17, 19. Dividing 509 by each of these, in tum, we find that none serves as a divisor of 509. The conclusion is that 509 must be a prime number. PRIMES AND THEIR DISTRIBUTION 45 Example 3.1. The foregoing technique provides a practical means for determining the canonical form of an integer, say a = 2093. Because 45 < J2093 < 46, it is enough to examine the primes 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43. By trial, the first of these to divide 2093 is 7, and 2093 = 7 · 299. As regards the integer 299, the seven primes that are less than 18 (note that 17 < .J299 < 18) are 2, 3, 5, 7, 11, 13, 17. The first prime divisor of 299 is 13 and, carrying out the required division, we obtain 299 = 13 · 23. But 23 is itself a prime, whence 2093 has exactly three prime factors, 7, 13, and 23: 2093 = 7 . 13 . 23 Another Greek mathematician whose work in number theory remains significant is Eratosthenes of Cyrene (276-194 B.c.). Although posterity remembers him mainly as the director of the world-famous library at Alexandria, Eratosthenes was gifted in all branches of learning, if not of first rank in any; in his own day, he was nicknamed \"Beta\" because, it was said, he stood at least second in every field. Perhaps the most impressive feat of Eratosthenes was the accurate measurement of the earth's circumference by a simple application of Euclidean geometry. We have seen that if an integer a > 1 is not divisible by any prime p < fa, then a is of necessity a prime. Eratosthenes used this fact as the basis of a clever technique, called the Sieve of Eratosthenes, for finding all primes below a given integer n. The scheme calls for writing down the integers from 2 to n in their natural order and then systematically eliminating all the composite numbers by striking out all multiples 2p, 3 p, 4p, 5 p, ... of the primes p :S ,Jn. The in­ tegers that are left on the list-those that do not fall through the \"sieve\"-are pnmes. To see an example of how this works, suppose that we wish to find all primes not exceeding 100. Consider the sequence of consecutive integers 2, 3, 4, ... , 100. Recognizing that 2 is a prime, we begin by crossing out all even integers from our listing, except 2 itself. The first of the remaining integers is 3, which must be a prime. We keep 3, but strike out all higher multiples of 3, so that 9, 15, 21, ... are now removed (the even multiples of 3 having been removed in the previous step). The smallest integer after 3 that has not yet been deleted is 5. It is not divisible by either 2 or 3-otherwise it would have been crossed out-hence, it is also a prime. All proper multiples of 5 being composite numbers, we next remove 10, 15, 20, ... (some of these are, of course, already missing), while retaining 5 itself. The first surviving integer 7 is a prime, for it is not divisible by 2, 3, or 5, the only primes that precede it. After eliminating the proper multiples of 7, the largest prime less than ,JlOO = 10, all composite integers in the sequence 2, 3, 4, ... , 100 have fallen through the sieve. The positive integers that remain, to wit, 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, are all of the primes less than 100. The following table represents the result of the completed sieve. The multiples of 2 are crossed out by\\; the multiples of 3 are crossed out by/; the multiples of 5 are crossed out by -; the multiples of 7 are crossed out by \"\"\". 46 ELEMENTARY NUMBER THEORY 2 3 � 5 :8: 7 '8. JJ * 11 M 13 # -t5- ):\"{) 17 pg 19 -w -lf 2Q 23 24 .ZS- � YI � 29 � 31 N J1 :N 'S'.5' � 37 38 � -zffi- 41 * 43 <l:4 .i5 % 47 � -49' -5't Bi 5Q 53 � -55- '* YI S'S 59 -00 61 w � 64 -65- � 67 68 � � 71 'M 73 74 75 7f) \"'l't' Jg 79 � � � 83 * -85- 8(i WI � 89 * ,-9-} � 93 � -95- % 97 * 99 i-W By this point, an obvious question must have occurred to the reader. Is there a largest prime number, or do the primes go on forever? The answer is to be found in a remarkably simple proof given by Euclid in Book IX of his Elements. Euclid's argument is universally regarded as a model of mathematical elegance. Loosely speaking, it goes like this: Given any finite list of prime numbers, one can always find a prime not on the list; hence, the number of primes is infinite. The actual details appear below. Theorem 3.4 Euclid. There is an infinite number of primes. Proof. Euclid's proof is by contradiction. Let Pi = 2, p2 = 3, p3 = 5, p4 = 7, ... be the primes in ascending order, and suppose that there is a last prime, called Pn· Now consider the positive integer P = P1P2 · · · Pn + 1 Because P > 1, we may put Theorem 3.2 to work once again and conclude that P is divisible by some prime p. But p1, p2, ... , Pn are the only prime numbers, so that p must be equal to one of p1, p2, ... , Pn· Combining the divisibility relation p I Pl p2 · · · Pn with p I P, we arrive at p I P - Pl p2 · · · Pn or, equivalently, p 11. The only positive divisor of the integer 1 is 1 itself and, because p > 1, a contradiction arises. Thus, no finite list of primes is complete, whence the number of primes is infinite. For a prime p, define p# to be the product of all primes that are less than or equal top. Numbers of the form p# + 1 might be termed Euclidean numbers, because they appear in Euclid's scheme for proving the infinitude of primes. It is interesting to note that in forming these integers, the first five, namely, 2 # + 1=2 + 1=3 3# + 1 = 2 . 3 + 1 = 7 5# + 1 = 2 . 3 . 5 + 1 = 31 7# + 1 = 2 . 3 . 5 . 7 + 1 = 211 11 # + 1 = 2 . 3 . 5 . 7 . 11 + 1 = 2311 PRIMES AND THEIR DISTRIBUTION 49 and as a direct consequence, Pn+ 1 < 2 Pn for n > 2. In particular, 11 = p5 < 2 . p4 = 14 To see that Pn < 2n, we argue by induction on n. Clearly, p2 = 3 < 22, so that the inequality is true here. Now assume that the inequality holds for an integer n, whence Pn < 2n. Invoking Bertrand's conjecture, there exists a prime number p satisfying 2n < p < 2n+ 1; that is, Pn < p. This immediately leads to the conclusion that Pn+l < p < 2n+1, which completes the induction and the proof. Primes of special form have been of perennial interest. Among these, the repunit primes are outstanding in their simplicity. A repunit is an integer written (in decimal notation) as a string of 1 's, such as 11, 111, or 1111. Each such integer must have the form (lOn - 1)/9. We use the sy mbol Rn to denote the repunit consisting of n consecutive l's. A peculiar feature of these numbers is the apparent scarcity of primes among them. So far, only R2, R19, R23, R311, R1031, R49os1, Rs6453, R109297, and R270343 have been identified as primes (the last one in 2007). It is known that the only possible repunit primes Rn for all n :::=: 49000 are the nine numbers just indicated. No conjecture has been made as to the existence of any others. For a repunit Rn to be prime, the subscript n must be a prime; that this is not a sufficient condition is shown by Rs= 11111=41·271 R1 = 1111111=239·4649 PROBLEMS 3.2 1. Determine whether the integer 701 is prime by testing all primes p :::; J70l as possible divisors. Do the same for the integer 1009. 2. Employing the Sieve of Eratosthenes, obtain all the primes between 100 and 200. 3. Given that p )' n for all primes p :::; ffe,, show that n > 1 is either a prime or the product of two primes. [Hint: Assume to the contrary that n contains at least three prime factors.] 4. Establish the following facts: (a) ,JP is irrational for any prime p. (b) If a is a positive integer and :.:/{i, is rational, then :.:/{i, must be an integer. ( c) For n � 2, � is irrational. [Hint: Use the fact that 2n > n.] 5. Show that any composite three-digit number must have a prime factor less than or equal to 31. 6. Fill in any missing details in this sketch of a proof of the infinitude of primes: Assume that there are only finitely many primes, say P1, P2, ... , Pn. Let A be the product of any r of these primes and put B = Pl P2 · · · Pn /A. Then each Pk divides either A or B, but not both. Because A + B > 1, A + B has a prime divisor different from any of the Pb which is a contradiction. 7. Modify Euclid's proof that there are infinitely many primes by assuming the existence of a largest prime p and using the integer N = p ! + 1 to arrive at a contradiction. 8. Give another proof of the infinitude of primes by assuming that there are only finitely many primes, say p1, p2, ... , Pn, and using the following integer to arrive at a contradiction: N = P2P3 · · · Pn + P1P3 · · · Pn + · · · + P1P2 · · · Pn-1 50 ELEMENTARY NUMBER THEORY 9. (a) Prove that if n > 2, then there exists a prime p satisfying n < p < n ! . [Hint: If n ! - 1 is not prime, then it has a prime divisor p; and p :::; n implies p In!, leading to a contradiction.] (b) For n > 1, show that every prime divisor of n ! + 1 is an odd integer that is greater than n. 10. Let qn be the smallest prime that is strictly greater than Pn = PI P2 · · · Pn + 1. It has been conjectured that the difference qn - (PI p2 · · · Pn) is always a prime. Confirm this for the first five values of n. 11. If Pn denotes the nth prime number, put dn = Pn+I - Pn· An open question is whether the equation dn = dn+I has infinitely many solutions. Give five solutions . 12. Assuming that Pn is the nth prime number, establish each of the following statements: (a) Pn > 2n - 1 for n 2: 5. (b) None of the integers Pn = PIP2 · · · Pn + 1 is a perfect square. [Hint: Each Pn is of the form 4k + 3 for n > l .] (c) The sum is never an integer. 1 1 1 -+-+···+­ PI P2 Pn 13. For the repunits Rn, verify the assertions below: (a) If n Im, then Rn I Rm. [Hint: If m = kn, consider the identity xm _ 1 = (xn _ l)(x(k-I)n + x(k-2)n + ... + xn + l). ] (b) If d I Rn and d I Rm, then d I Rn+m· [Hint: Show that Rm+n = Rnl0'11 +Rm.] (c) If gcd(n, m) = 1, then gcd(Rn, Rm)= 1. 14. Use the previous problem to obtain the prime factors of the repunit R10• 3.3 THE GOLDBACH CONJECTURE Although there is an infinitude of primes, their distribution within the positive inte­ gers is most mystifying. Repeatedly in their distribution we find hints or, as it were, shadows of a pattern; yet an actual pattern amenable to precise description remains elusive. The difference between consecutive primes can be small, as with the pairs 11 and 13, 17 and 19, or for that matter 1000000000061 and 1000000000063. At the same time there exist arbitrarily long intervals in the sequence of integers that are totally devoid of any primes. It is an unanswered question whether there are infinitely many pairs of twin primes; that is, pairs of successive odd integers p and p + 2 that are both primes. Numerical evidence leads us to suspect an affirmative conclusion. Electronic com­ puters have discovered 152891 pairs of twin primes less than 30000000 and 20 pairs between 1012 and 1012+ 10000, which hints at their growing scarcity as the positive integers increase in magnitude. Many examples of immense twins are known. The largest twins to date, each 100355 digits long, 65516468355 . 2333333 ± 1 were discovered in 2009. PRIMES AND THEIR DISTRIBUTION 51 Consecutive primes not only can be close together, but also can be far apart; that is, arbitrarily large gaps can occur between consecutive primes. Stated precisely: Given any positive integer n, there exist n consecutive integers, all of which are composite. To prove this, we simply need to consider the integers (n + 1)! + 2, (n + 1)! + 3, ... , (n + l)! + (n + 1) where (n + l)! = (n + 1) · n · · · 3 · 2 · 1. Clearly there are n integers listed, and they are consecutive. What is important is that each integer is composite. Indeed, (n + 1)! + 2 is divisible by 2, (n + l)! + 3 is divisible by 3, and so on. For instance, if a sequence of four consecutive composite integers is desired, then the previous argument produces 122, 123, 124, and 125: 5! + 2 = 122 = 2 . 61 5! + 3 = 123 = 3 . 41 5! + 4 = 124 = 4 . 31 5 ! + 5 = 125 = 5 . 25 Of course, we can find other sets of four consecutive composites, such as 24, 25, 26, 27 or 32, 33, 34, 35. As this example suggests, our procedure for constructing gaps between two con­ secutive primes gives a gross overestimate of where they occur among the integers. The first occurrences of prime gaps of specific lengths, where all the intervening inte­ gers are composite, have been the subject of computer searches. For instance, there is a gap of length 778 (that is, Pn+ 1 - Pn = 778) following the prime 42842283925351. No gap of this size exists between two smaller primes. The largest effectively cal­ culated gap between consecutive prime numbers has length 1442, with a string of 1441 composites immediately after the prime 804212830686677669 Interestingly, computer researchers have not identified gaps of every possible width up to 1442. The smallest missing gap size is 796. The conjecture is that there is a prime gap (a string of 2k - 1 consecutive composites between two primes) for every even integer 2k. This brings us to another unsolved problem concerning the primes, the Gold­ bach conjecture. In a letter to Leonhard Euler in the year 1742, Christian Goldbach hazarded the guess that every even integer is the sum of two numbers that are either primes or 1. A somewhat more general formulation is that every even integer greater than 4 can be written as a sum of two odd prime numbers. This is easy to confirm 52 ELEMENTARY NUMBER THEORY for the first few even integers: 2=1+1 4=2+2=1+3 6=3+3=1+5 8=3+5=1+7 10 = 3 + 7 = 5 + 5 12 = 5 + 7 = 1 + 11 14 = 3 + 11 = 7 + 7 = 1 + 13 16 = 3 + 13 = 5 + 11 18 = 5 + 13 = 7 + 11 = 1 + 17 20 = 3 + 17 = 7 + 13 = 1 + 19 22 = 3 + 19 = 5 + 17 = 11 + 11 24 = 5 + 19 = 7 + 17 = 11 + 13 = 1 + 23 26 = 3 + 23 = 7 + 19 = 13 + 13 28 = 5 + 23 = 11 + 17 30 = 7 + 23 = 11 + 19 = 13 + 17 = 1 + 29 Although it seems that Euler never tried to prove the result, upon writing to Goldbach at a later date, Euler countered with a conjecture of his own: Any even integer (> 6) of the form 4n + 2 is a sum of two numbers each being either a prime of the form 4n + 1or1. The numerical data suggesting the truth of Goldbach's conjecture are over­ whelming. It has been verified by computers for all even integers less than 4 · 1014. As the integers become larger, the number of different ways in which 2n can be expressed as the sum of two primes increases. For example, there are 291400 such representations for the even integer 100000000. Although this supports the feeling that Goldbach was correct in his conjecture, it is far from a mathematical proof, and all attempts to obtain a proof have been completely unsuccessful. One of the most famous number theorists of the last century, G. H. Hardy, in his address to the Mathematical Society of Copenhagen in 1921, stated that the Goldbach conjecture appeared \"probably as difficult as any of the unsolved problems in mathematics.\" It is currently known that every even integer is the sum of six or fewer primes. We remark that if the conjecture of Goldbach is true, then each odd number larger than 7 must be the sum of three odd primes. To see this, take n to be an odd integer greater than 7, so that n - 3 is even and greater than 4; if n - 3 could be expressed as the sum of two odd primes, then n would be the sum of three. The first real progress on the conjecture in nearly 200 years was made by Hardy and Littlewood in 1922. On the basis of a certain unproved hypothesis, the so­ called generalized Riemann hypothesis, they showed that every sufficiently large odd number is the sum of three odd primes. In 1937, the Russian mathematician I. M. Vinogradov was able to remove the dependence on the generalized Riemann hypothesis, thereby giving an unconditional proof of this result; that is to say, he PRIMES AND THEIR DISTRIBUTION 53 established that all odd integers greater than some effectively computable n0 can be written as the sum of three odd primes. n = P1 + P2 + p3 (n odd, n sufficiently large) Vinogradov was unable to decide how large no should be, but Borozdkin (1956) proved that no < 33 15 . In 2002, the bound on no was reduced to 101346. It follows immediately that every even integer from some point on is the sum of either two or four primes. Thus, it is enough to answer the question for every odd integer n in the range 9 < n < n0, which, for a given integer, becomes a matter of tedious computation (unfortunately, n0 is so large that this exceeds the capabilities of the most modern electronic computers). Because of the strong evidence in favor of the famous Goldbach conjecture, we readily become convinced that it is true. Nevertheless, it might be false. Vinogradov showed that if A(x) is the number of even integers n < x that are not the sum of two primes, then lim A(x)/x = 0 X�OO This allows us to say that \"almost all\" even integers satisfy the conjecture. As Edmund Landau so aptly put it, \"The Goldbach conjecture is false for at most 0% of all even integers; this at most 0% does not exclude, of course, the possibility that there are infinitely many exceptions.\" Having digressed somewhat, let us observe that according to the Division Al­ gorithm, every positive integer can be written uniquely in one of the forms 4n 4n + 1 4n +2 4n + 3 for some suitable n > 0. Clearly, the integers 4n and 4n + 2 = 2(2n + 1) are both even. Thus, all odd integers fall into two progressions: one containing integers of the form 4n + 1, and the other containing integers of the form 4n + 3. The question arises as to how these two types of primes are distributed within the set of positive integers. Let us display the first few odd prime numbers in consecutive order, putting the 4n + 3 primes in the top row and the 4n + 1 primes under them: 3 7 11 19 23 31 43 47 59 67 71 79 83 5 13 17 29 37 41 53 61 73 89 At this point, one might have the general impression that primes of the form 4n + 3 are more abundant than are those of the form 4n + 1. To obtain more precise information, we require the help of the function na,b(x ), which counts the number of primes of the form p = an + b not exceeding x. Our small table, for instance, indicates that 7r4,1(89) = 10 and 7r4,3(89) = 13. In a famous letter written in 1853, Tchebycheff remarked that rr4,1 (x) < rr4,3(x) for small values of x. He also implied that he had a proof that the inequality always held. In 1914, J. E. Littlewood showed that the inequality fails infinitely often, but his method gave no indication of the value of x for which this first happens. It turned out to be quite difficult to find. Not until 1957 did a computer search reveal that x = 26861 is the smallest prime for which n4,1(x) > n4,3(x); here, n4,1(x) = 1473 54 ELEMENTARY NUMBER THEORY and n4,3(x ) = 1472. This is an isolated situation, because the next prime at which a reversal occurs is x = 616,841. Remarkably, n4,1 (x ) > n4,3(x ) for the 410 million successive integers x lying between 18540000000 and 18950000000. The behavior of primes of the form 3n ± 1 provided more of a computa­ tional challenge: the inequality n3, 1 (x ) < n3,2 (x ) holds for all x until one reaches x = 608981813029. This furnishes a pleasant opportunity for a repeat performance of Euclid's method for proving the existence of an infinitude of primes. A slight modifica­ tion of his argument reveals that there is an infinite number of primes of the form 4n + 3. We approach the proof through a simple lemma. Lemma. The product of two or more integers of the form 4n + 1 is of the same form. Proof. lt is sufficient to consider the product ofjust two integers.Let us take k = 4n + 1 and k' = 4m + 1. Multiplying these together, we obtain kk' = (4n + 1)(4m + 1) = 16nm + 4n + 4m + 1 = 4( 4nm + n + m) + 1 which is of the desired form. This paves the way for Theorem 3.6. Theorem 3.6. There are an infinite number of primes of the form 4n + 3. Proof. In anticipation of a contradiction, let us assume that there exist only finitely many primes of the form 4n + 3; call them q 1, q2, ... , q s . Consider the positive integer N = 4q1q2 · · ·qs - 1=4(q1q2 · · ·qs - 1) + 3 and let N = rir2 · · · r1 be its prime factorization. Because N is an odd integer, we have rk =f 2 for all k, so that each rk is either of the form 4n + 1 or 4n + 3. By the lemma, the product of any number of primes of the form 4n + 1 is again an integer of this type. For N to take the form 4n + 3, as it clearly does, N must contain at least one prime factor ri of the form 4n + 3. But ri cannot be found among the listing q1, q1, ... , qs, for this would lead to the contradiction that ri 11. The only possible conclusion is that there are infinitely many primes of the form 4n + 3. Having just seen that there are infinitely many primes of the form 4n + 3, we might reasonably ask: Is the number of primes of the form 4n + 1 also infinite? This answer is likewise in the affirmative, but a demonstration must await the development of the necessary mathematical machinery. Both these results are special cases of a remarkable theorem by P. G. L. Dirichlet on primes in arithmetic progressions, established in 1837. The proof is much too difficult for inclusion here, so that we must content ourselves with the mere statement. Theorem 3.7 Dirichlet. If a and b are relatively prime positive integers, then the arithmetic progression a, a+ b, a+ 2b, a+ 3b, ... contains infinitely many primes. PRIMES AND THEIR DISTRIBUTION 55 Dirichlet's theorem tells us, for instance, that there are infinitely many prime numbers ending in 999, such as 1999, 100999, 1000999, ... for these appear in the arithmetic progression determined by lOOOn + 999, where gcd( lOOO, 999) = 1. There is no arithmetic progression a, a+ b, a+ 2b, ... that consists solely of prime numbers. To see this, suppose that a+ nb = p, where p is a prime. If we put nk = n + kp fork= 1, 2, 3, ... then the nk th term in the progression is a + nkb = a + (n + kp )b = (a + nb) + kpb = p + kpb Because each term on the right-hand side is divisible by p, so is a + nkb. In other words, the progression must contain infinitely many composite numbers. It was proved in 2008 that there are finite but arbitrarily long arithmetic progres­ sions consisting only of prime numbers (not necessarily consecutive primes). The longest progression found to date is composed of the 23 primes: 56211383760397+44546738095860n 0 < n :S 22 The prime factorization of the common difference between the terms is 22 . 3 . 5 . 7 . 11 . 13 . 17 . 19 . 23 . 99839 which is divisible by 9699690, the product of the primes less than 23. This takes place according to Theorem 3.8. Theorem 3.8. If all the n > 2 terms of the arithmetic progression p, p + d, p + 2d, ... , p + (n - l)d are prime numbers, then the common differenced is divisible by every prime q < n. Proof. Consider a prime number q < n and assume to the contrary that q J d. We claim that the first q terms of the progression p, p + d, p + 2d, ... ' p + (q - l)d (1) will leave different remainders when divided by q. Otherwise there exist integers j and k, with 0::::: j < k::::: q - 1, such that the numbers p + jd and p + kd yield the same remainder upon division by q. Then q divides their difference (k - j)d. But gcd (q , d) = 1, and so Euclid's lemma leads to q I k - j, which is nonsense in light of the inequality k - j ::::: q - 1. Because the q different remainders produced from Eq. ( 1) are drawn from the q integers 0, 1, ... , q - 1, one of these remainders must be zero. This means that q I p + td for some t satisfying 0 ::::: t ::::: q - 1. Because of the inequality q < n ::::: p ::::: p + td, we are forced to conclude that p + td is composite. (If p were less than n, one of the terms of the progression would be p +pd= p(l + d).) With this contradiction, the proof that q I d is complete. It has been conjectured that there exist arithmetic progressions of finite (but otherwise arbitrary) length, composed of consecutive prime numbers. Examples of such progressions consisting of three and four primes, respectively, are 47, 53, 59, and 251, 257, 263, 269. Most recently a sequence of 10 consecutive primes was discovered in which each term exceeds its predecessor by just 210; the smallest of these primes has 93 digits. 56 ELEMENTARY NUMBER THEORY Finding an arithmetic progression consisting of 11 consecutive primes is likely to be out of reach for some time. Absent the restriction that the primes involved be consecutive, strings of 11-term arithmetic progressions are easily located. One such IS 110437 + 13860n 0 < n < 10 In the interest of completeness, we might mention another famous problem that, so far, has resisted the most determined attack. For centuries, mathematicians have sought a simple formula that would yield every prime number or, failing this, a formula that would produce nothing but primes. At first glance, the request seems modest enough: find a function f (n) whose domain is, say, the nonnegative integers and whose range is some infinite subset of the set of all primes. It was widely believed years ago that the quadratic polynomial f(n) = n2 + n + 41 assumed only prime values. This was shown to be false by Euler, in 1772. As evidenced by the following table, the claim is a correct one for n = 0, 1, 2, ... , 39. n f (n) n f (n) n f (n) 0 41 14 251 28 853 1 43 15 281 29 911 2 47 16 313 30 971 3 53 17 347 31 1033 4 61 18 383 32 1097 5 71 19 421 33 1163 6 83 20 461 34 1231 7 97 21 503 35 1301 8 113 22 547 36 1373 9 131 23 593 37 1447 10 151 24 641 38 1523 11 173 25 691 39 1601 12 197 26 743 13 223 27 797 However, this provocative conjecture is shattered in the cases n = 40 and n = 41, where there is a factor of 41: f ( 40) = 40 . 41 + 41 = 412 and f(41) = 41 . 42 + 41 = 41 . 43 The next value f(42) = 1847 turns out to be prime once again. In fact, for the first 100 integer values of n, the so-called Euler polynomial represents 86 primes. Although it starts off very well in the production of primes, there are other quadratics such as g(n) = n2 + n + 27941 PRIMES AND THEIR DISTRIBUTION 57 that begin to best f (n) as the values of n become larger. For example, g(n) is prime for 286129 values of 0:::; n < 106, whereas its famous rival yields 261081 primes in this range. It has been shown that no polynomial of the form n2 + n + q, with q a prime, can do better than the Euler polynomial in giving primes for successive values of n. Indeed, until fairly recently no other quadratic polynomial of any kind was known to produce more than 40 successive prime values. The polynomial h(n) = 103n2 - 3945n + 34381 found in 1988, produces 43 distinct prime values for n = 0, 1, 2, ... , 42. The current record holder in this regard k(n) = 36n2 - 810n + 2753 does slightly better by giving a string of 45 prime values. The failure of the previous functions to be prime-producing is no accident, for it is easy to prove that there is no nonconstant polynomial f (n) with integral coefficients that takes on just prime values for integral n > 0. We assume that such a polynomial f(n) actually does exist and argue until a contradiction is reached. Let f (n) = aknk + ak-1nk-l + · · · + a2n2 + ain + ao where all the coefficients a0, a1, ... , ak are integers, and ak =j:. 0. For a fixed value of (n0), p = f (no) is a prime number. Now, for any integer t, we consider the following expression: f(no + tp) = ak(no + tpl + · · · + ai(no + tp) + ao = (akn� + · · · + aino + ao) + pQ(t) = f(no) + pQ(t) = p + pQ(t) = p(l + Q(t)) where Q(t) is a polynomial in t having integral coefficients. Our reasoning shows that p I f(no + tp); hence, from our own assumption that f(n) takes on only prime values, f(no + tp) = p for any integer t. Because a polynomial of degree k can­ not assume the same value more than k times, we have obtained the required contradiction. Recent years have seen a measure of success in the search for prime-producing functions. W. H. Mills proved (1947) that there exists a positive real number r such that the expression f(n) = [r3\"] is prime for n = 1, 2, 3, ... (the brackets indicate the greatest integer function). Needless to say, this is strictly an existence theorem and nothing is known about the actual value of r. Mills's function does not produce all the primes. There are several celebrated, still unresolved, conjectures about primes. One posed by G. H. Hardy and J.E. Littlewood in 1922 asks whether there are infinitely many primes that can be represented in the form n2 + 1. The closest thing to an answer, so far, came in 1978 when it was proved that there are infinitely many values of n for which n 2 + 1 is either a prime or the product of just two primes. One can 58 ELEMENTARY NUMBER THEORY start to see this for the smallest values 22 + 1 = 5 32 + 1=2. 5 42+1=17 PROBLEMS 3.3 52 + 1=2.13 62 + 1 = 37 82 + 1 = 5. 31 92 + 1=2.41 102 + 1 = 101 1. Verify that the integers 1949 and 1951 are twin primes. 2. (a) If 1 is added to a product of twin primes, prove that a perfect square is always obtained. (b) Show that the sum of twin primes p and p + 2 is divisible by 12, provided that p > 3. 3. Find all pairs of primes p and q satisfying p - q = 3. 4. Sylvester (1896) rephrased the Goldbach conjecture: Every even integer 2n greater than 4 is the sum of two primes, one larger than n /2 and the other less than 3n /2. Verify this version of the conjecture for all even integers between 6 and 76. 5. In 1752, Goldbach submitted the following conjecture to Euler: Every odd integer can be written in the form p + 2a2 , where p is either a prime or 1 and a ::'.::: 0. Show that the integer 5777 refutes this conjecture. 6. Prove that the Goldbach conjecture that every even integer greater than 2 is the sum of two primes is equivalent to the statement that every integer greater than 5 is the sum of three primes. [Hint: If 2n - 2 =Pl+ p2, then 2n =Pl+ P2 + 2 and 2n + 1 =Pl+ P2 + 3.] 7. A conjecture of Lagrange (1775) asserts that every odd integer greater than 5 can be written as a sum Pl + 2 p2, where p1, p2 are both primes. Confirm this for all odd integers through 75. 8. Given a positive integer n, it can be shown that there exists an even integer a that is representable as the sum of two odd primes in n different ways. Confirm that the integers 60, 78, and 84 can be written as the sum of two primes in six, seven, and eight ways, respectively. 9. (a) For n > 3, show that the integers n, n + 2, n + 4 cannot all be prime. (b) Three integers p, p + 2, p + 6, which are all prime, are called a prime-triplet. Find five sets of prime-triplets. 10. Establish that the sequence (n + l)! - 2, (n + 1)! - 3, ... , (n + 1)! - (n + 1) produces n consecutive composite integers for n > 2. 11. Find the smallest positive integer n for which the function f(n) = n2 + n + 17 is com­ posite. Do the same for the functions g(n) = n2 + 2ln + 1 and h(n) = 3n 2 + 3n + 23. 12. Let Pn denote the nth prime number. For n ::'.::: 3, prove that P�+3 < PnPn+l Pn+2· [Hint: Note that P�+3 < 4p�+2 < 8Pn+lPn+2. ] 13. Apply the same method of proof as in Theorem 3.6 to show that there are infinitely many primes of the form 6n + 5. 14. Find a prime divisor of the integer N = 4(3 · 7 · 11) - 1 of the form 4n + 3. Do the same for N = 4(3 · 7 · 11 · 15) - 1. 15. Another unanswered question is whether there exists an infinite number of sets of five consecutive odd integers of which four are primes. Find five such sets of integers. 16. Let the sequence of primes, with 1 adjoined, be denoted by Po = 1, Pl = 2, P2 = 3, p3 = 5, .... For each n ::::: 1, it is known that there exists a suitable choice of coefficients PRIMES AND THEIR DISTRIBUTION 59 Ek = ± 1 such that 2n-2 P2n = P2n-l + L EkPk k=O 2n-l P2n+l = 2p2n + L EkPk k=O To illustrate: 13=1+2-3-5+7+11 and 17 = 1+2 -3 -5 + 7 -11+2 . 13 Determine similar representations for the primes 23, 29, 31, and 37. 17. In 1848, de Polignac claimed that every odd integer is the sum of a prime and a power of 2. For example, 55 = 47 + 23 = 23 + 25. Show that the integers 509 and 877 discredit this claim. 18. (a) If pis a prime and p l b, prove that in the arithmetic progression a, a + b, a + 2b, a + 3b, ... every pth term is divisible by p. [Hint: Because gcd(p, b) = 1, there exist integers r ands satisfying pr+ bs = 1. Put nk = kp -as fork= 1, 2, ... and show that p I (a+ nkb).] (b) From part (a), conclude that if b is an odd integer, then every other term in the indicated progression is even. 19. In 1950, it was proved that any integer n > 9 can be written as a sum of distinct odd primes. Express the integers 25, 69, 81, and 125 in this fashion. 20. If p and p2 + 8 are both prime numbers, prove that p3 + 4 is also prime. 21. (a) For any integer k > 0, establish that the arithmetic progression a + b, a + 2b, a + 3b, ... where gcd(a, b) = 1, contains k consecutive terms that are composite. [Hint: Put n =(a+ b)(a + 2b) ···(a+ kb) and consider the k terms a+ (n + l)b, a+ (n + 2)b, ... , a+ (n + k)b.] (b) Find five consecutive composite terms in the arithmetic progression 6, 11, 16,21,26,31,36, ... 22. Show that 13 is the largest prime that can divide two successive integers of the form n 2 + 3. 23. (a) The arithmetic mean of the twin primes 5 and 7 is the triangular number 6. Are there any other twin primes with a triangular mean? (b) The arithmetic mean of the twin primes 3 and 5 is the perfect square 4. Are there any other twin primes with a square mean? 24. Determine all twin primes p and q = p + 2 for which pq -2 is also prime. 25. Let Pn denote the nth prime. For n > 3, show that Pn < Pl + P2 + · · · + Pn-l [Hint: Use induction and the Bertrand conjecture.] 26. Verify the following: (a) There exist infinitely many primes ending in 33, such as 233, 433, 733, 1033, .... [Hint: Apply Dirichlet's theorem.] 60 ELEMENTARY NUMBER THEORY (b) There exist infinitely many primes that do not belong to any pair of twin primes. [Hint: Consider the arithmetic progression 2lk + 5 fork= 1, 2, .... ] (c) There exists a prime ending in as many consecutive l's as desired. [Hint: To obtain a prime ending in n consecutive l's, consider the arithmetic pro­ gression lOnk +Rn fork= 1, 2, .... ] ( d) There exist infinitely many primes that contain but do not end in the block of digits 123456789. [Hint: Consider the arithmetic progression 1011 k + 1234567891 fork= 1, 2, .... ] 27. Prove that for every n � 2 there exists a prime p with p S n < 2 p. [Hint: In the case where n = 2k + 1, then by the Bertrand conjecture there exists a prime p such that k < p < 2k.] 28. (a) If n > 1, show that n ! is never a perfect square. (b) Find the values of n � 1 for which n! + (n + l)! + (n + 2)! is a perfect square. [Hint: Note that n! + (n + l)! + (n + 2)! = n!(n + 2)2.] CHAPTER 4 THE THEORY OF CONGRUENCES Gauss once said \"Mathematics is the queen of the sciences and number-theory the queen of mathematics.\" If this be true we may add that the Disquisitiones is the Magna Charta of number-theory. M. CANTOR 4.1 CARL FRIEDRICH GAUSS Another approach to divisibility questions is through the arithmetic of remainders, or the theory of congruences as it is now commonly known. The concept, and the notation that makes it such a powerful tool, was first introduced by the German mathematician Carl Friedrich Gauss (1777-1855) in his Disquisitiones Arithmeticae; this monumental work, which appeared in 1801 when Gauss was 24 years old, laid the foundations of modem number theory. Legend has it that a large part of the Disquisitiones Arithmeticae had been submitted as a memoir to the French Academy the previous year and had been rejected in a manner that, even if the work had been as worthless as the referees believed, would have been inexcusable. (In an attempt to lay this defamatory tale to rest, the officers of the academy made an exhaustive search of their permanent records in 1935 and concluded that the Disquisitiones was never submitted, much less rejected.) \"It is really astonishing,\" said Kronecker, \"to think that a single man of such young years was able to bring to light such a wealth of results, and above all to present such a profound and well-organized treatment of an entirely new discipline.\" 61 62 ELEMENTARY NUMBER THEORY Carl Friedrich Gauss (1777-1855) (Dover Publications, Inc.) Gauss was one of those remarkable infant prodigies whose natural aptitude for mathematics soon became apparent. As a child of age three, according to a well­ authenticated story, he corrected an error in his father's payroll calculations. His arithmetical powers so overwhelmed his schoolmasters that, by the time Gauss was 7 years old, they admitted that there was nothing more they could teach the boy. It is said that in his first arithmetic class Gauss astonished his teacher by instantly solving what was intended to be a \"busy work\" problem: Find the sum of all the numbers from 1to 100. The young Gauss later confessed to having recognized the pattern 1+100 = 101, 2 + 99 = 101, 3 + 98 = 101, ... ' 50 + 51 = 101 Because there are 50 pairs of numbers, each of which adds up to 101, the sum of all the numbers must be 50 · 101 = 5050. This technique provides another way of deriving the formula n(n + 1) 1+2+3+ .. ·+n= --- 2 for the sum of the first n positive integers. One need only display the consecutive integers 1 through n in two rows as follows: 1 2 3 n n-l n-2 n - 1 n 2 1 Addition of the vertical columns produces n terms, each of which is equal to n + 1; when these terms are added, we get the value n(n + 1). Because the same sum is obtained on adding the two rows horizontally, what occurs is the formula n(n + 1) = 2(1+2 + 3 + .. · + n). Gauss went on to a succession of triumphs, each new discovery following on the heels of a previous one. The problem of constructing regular polygons with only \"Euclidean tools,\" that is to say, with ruler and compass alone, had long been laid aside in the belief that the ancients had exhausted all the possible constructions. In 1796, Gauss showed that the 17-sided regular polygon is so constructible, the first THE THEORY OF CONGRUENCES 63 advance in this area since Euclid's time. Gauss's doctoral thesis of 1799 provided a rigorous proof of the Fundamental Theorem of Algebra, which had been stated first by Girard in 1629 and then proved imperfectly by d' Alembert (1746), and later by Euler (1749). The theorem (it asserts that a polynomial equation of degree n has exactly n complex roots) was always a favorite of Gauss's, and he gave, in all, four distinct demonstrations of it. The publication of Disquisitiones Arithmeticae in 1801 at once placed Gauss in the front rank of mathematicians. The most extraordinary achievement of Gauss was more in the realm of theo­ retical astronomy than of mathematics. On the opening night of the 19th century, January 1, 1801, the Italian astronomer Piazzi discovered the first of the so-called minor planets (planetoids or asteroids), later called Ceres. But after the course of this newly found body-visible only by telescope-passed the sun, neither Piazzi nor any other astronomer could locate it again. Piazzi's observations extended over a period of 41 days, during which the orbit swept out an angle of only nine degrees. From the scanty data available, Gauss was able to calculate the orbit of Ceres with amazing accuracy, and the elusive planet was rediscovered at the end of the year in almost exactly the position he had forecasted. This success brought Gauss worldwide fame, and led to his appointment as director of Gottingen Observatory. By the middle of the 19th century, mathematics had grown into an enormous and unwieldy structure, divided into a large number of fields in which only the specialist knew his way. Gauss was the last complete mathematician, and it is no exaggeration to say that he was in some degree connected with nearly every aspect of the subject. His contemporaries regarded him as Princeps Mathematicorum (Prince of Mathematicians), on a par with Archimedes and Isaac Newton. This is revealed in a small incident: On being asked who was the greatest mathematician in Germany, Laplace answered, \"Why, Pfaff.\" When the questioner indicated that he would have thought Gauss was, Laplace replied, \"Pfaff is by far the greatest in Germany, but Gauss is the greatest in all Europe.\" Although Gauss adorned every branch of mathematics, he always held number theory in high esteem and affection. He insisted that, \"Mathematics is the Queen of the Sciences, and the theory of numbers is the Queen of Mathematics.\" 4.2 BASIC PROPERTIES OF CONGRUENCE In the first chapter of Disquisitiones Arithmeticae, Gauss introduces the concept of congruence and the notation that makes it such a powerful technique (he explains that he was induced to adopt the symbol _ because of the close analogy with algebraic equality). According to Gauss, \"If a number n measures the difference between two numbers a and b, then a and b are said to be congruent with respect ton; if not, incongruent.\" Putting this into the form of a definition, we have Definition 4.1. Definition 4.1. Let n be a fixed positive integer. Two integers a and b are said to be congruent modulo n, symbolized by a= b (mod n) if n divides the difference a - b; that is, provided that a - b = kn for some integer k. 64 ELEMENTARY NUMBER THEORY To fix the idea, consider n = 7. It is routine to check that 3 = 24 (mod 7) - 31 = 11 (mod 7) - 15 = -64 (mod 7) because 3 - 24 = (- 3)7 , -31- 11 = ( - 6)7, and -15 -(-64) = 7 · 7. When n A' (a - b), we say that a is incongruent to b modulo n, and in this case we write a ¢ b (mod n). For a simple example: 25 ¢ 12 (mod 7), because 7 fails to divide 25 - 12 = 13. It is to be noted that any two integers are congruent modulo 1, whereas two integers are congruent modulo 2 when they are both even or both odd. Inasmuch as congruence modulo 1 is not particularly interesting, the usual practice is to assume that n > 1. Given an integer a, let q and r be its quotient and remainder upon division by n, so that a= qn + r O<r<n Then, by definition of congruence, a = r (mod n ). Because there are n choices for r, we see that every integer is congruent modulo n to exactly one of the values 0, 1, 2, ... , n - 1; in particular, a = 0 (mod n) if and only if n I a. The set of n integers 0, 1, 2, ... , n - 1 is called the set of least nonnegative residues modulo n. In general, a collection of n integers ai, a2, ... , an is said to form a complete set of residues (or a complete system of residues) modulo n if every integer is congruent modulo n to one and only one of the ak. To put it another way, a1, a2, ... , an are congruent modulo n to 0, 1, 2, ... , n - 1, taken in some order. For instance, -12, -4, 11, 13, 22, 82, 91 constitute a complete set of residues modulo 7; here, we have all modulo 7. An observation of some importance is that any n integers form a complete set of residues modulo n if and only if no two of the integers are congruent modulo n. We shall need this fact later. Our first theorem provides a useful characterization of congruence modulo n in terms of remainders upon division by n. Theorem 4.1. For arbitrary integers a and b, a = b (mod n) if and only if a and b leave the same nonnegative remainder when divided by n. Proof. First take a = b (mod n), so that a = b +kn for some integer k. Upon division by n, b leaves a certain remainder r; that is, b = qn + r, where 0 ::'.::: r < n. Therefore, a= b +kn= (qn + r) +kn= (q + k)n + r which indicates that a has the same remainder as b. On the other hand, suppose we can write a = q1n + r and b = q2n + r, with the same remainder r (0 ::'.::: r < n). Then a - b = (q1n + r) - (q2n + r) = (qi - q2)n whence n I a - b. In the language of congruences, we have a= b (mod n). THE THEORY OF CONGRUENCES 65 Example 4.1. Because the integers -56 and -11 can be expressed in the form -56 = (-7)9 + 7 -11=(-2)9+7 with the same remainder 7, Theorem 4.1 tells us that -56 = -11 (mod 9). Going in the other direction, the congruence -31 = 11 (mod 7) implies that -31 and 11 have the same remainder when divided by 7; this is clear from the relations -31=(-5)7+4 11=1·7+4 Congruence may be viewed as a generalized form of equality, in the sense that its behavior with respect to addition and multiplication is reminiscent of ordinary equality. Some of the elementary properties of equality that carry over to congruences appear in the next theorem. Theorem 4.2. Let n > 1 be fixed and a, b, c, d be arbitrary integers. Then the following properties hold: (a) a =a (mod n). (b) If a= b (mod n), then b =a (mod n). (c) If a - b (mod n) and b - c (mod n), then a= c (mod n). (d) If a= b (mod n) and c = d (mod n), then a+ c = b + d (mod n) and ac = bd (mod n). (e) If a= b (mod n), then a+ c = b + c (mod n) and ac =be (mod n). (f) If a = b (mod n), then ak =bk (mod n) for any positive integer k. Proof. For any integer a, we have a - a= 0 · n, so that a= a (mod n). Now if a= b (mod n), then a - b =kn for some integer k. Hence, b - a= -(kn)= (-k)n and because -k is an integer, this yields property (b). Property (c) is slightly less obvious: Suppose that a = b (mod n) and also b = c (mod n). Then there exist integers hand k satisfying a - b = hn and b - c =kn. It follows that a - c = (a - b) + (b - c) = hn +kn = (h + k)n which is a = c (mod n) in congruence notation. In the same vein, if a = b (mod n) and c = d (mod n ), then we are assured that a - b =kin and c - d = k1n for some choice of ki and kz. Adding these equations, we obtain (a+ c) - (b + d) = (a - b) + (c - d) =kin+ k1n = (ki + k1)n or, as a congruence statement, a + c = b + d (mod n ). As regards the second assertion of property (d), note that ac = (b + kin)(d + k1n) = bd + (bk2 + dki + kik2n)n Because bk2 + dki + k1k2n is an integer, this says that ac - bd is divisible by n, whence ac = bd (mod n). The proof of property ( e) is covered by ( d) and the fact that c = c (mod n ). Finally, we obtain property (f) by making an induction argument. The statement certainly holds for k = 1, and we will assume it is true for some fixed k. From ( d), we know 66 ELEMENTARY NUMBER THEORY that a = b (mod n) and ak =bk (mod n) together imply that aak = bbk (mod n), or equivalently ak+ 1 = bk+ 1 (mod n ). This is the form the statement should take fork + 1, and so the induction step is complete. Before going further, we should illustrate that congruences can be a great help in carrying out certain types of computations. Example 4.2. Let us endeavor to show that 41 divides 220 - 1. We begin by noting that 25 = -9 (mod 41), whence (25 )4 = (-9)4 (mod 41) by Theorem 4.2(f); in other words, 220 = 81 · 81 (mod 41). But 81 = -1 (mod 41), and so 81 · 81 = 1 (mod 41). Using parts (b) and (e) of Theorem 4.2, we finally arrive at 220 - 1 = 81 · 81 - 1 = 1 - 1 = 0 (mod 41) Thus, 41 I 220 - 1, as desired. Example 4.3. For another example in the same spirit, suppose that we are asked to find the remainder obtained upon dividing the sum 1! + 2! + 3! + 4! + ... + 99! + 100! by 12. Without the aid of congruences this would be an awesome calculation. The observation that starts us off is that 4! = 24 = 0 (mod 12); thus, fork :'.'.'.: 4, kl = 4! · 5 · 6 · · · k = 0 · 5 · 6 · · · k = 0 (mod 12) In this way, we find that 1! + 2! + 3! + 4! + ... + 100! = 1! + 2! + 3! + 0 + · · · + 0 = 9 (mod 12) Accordingly, the sum in question leaves a remainder of 9 when divided by 12. In Theorem 4.1 we saw that if a= b (mod n), then ca= ch (mod n) for any integer c. The converse, however, fails to hold. As an example, perhaps as simple as any, note that 2 · 4 _ 2 · 1(mod6), whereas 4 ¢ 1(mod6). In brief: One cannot unrestrictedly cancel a common factor in the arithmetic of congruences. With suitable precautions, cancellation can be allowed; one step in this direction, and an important one, is provided by the following theorem. Theorem 4.3. If ca= cb (mod n), then a= b (mod n/d), where d = gcd(c, n). Proof. By hypothesis, we can write c(a - b) = ca - cb = kn for some integer k . Knowing that gcd(c, n) = d, there exist relatively prime integers r ands satisfying c = dr, n = ds. When these values are substituted in the displayed equation and the common factor d canceled, the net result is r(a - b) =ks Hence, s I r(a - b) and gcd(r, s) = 1. Euclid's lemma yields s I a - b, which may be recast as a = b (mods); in other words, a = b (mod n/d). THE THEORY OF CONGRUENCES 67 Theorem 4.3 gets its maximum force when the requirement that gcd( c, n) = 1 is added, for then the cancellation may be accomplished without a change in modulus. Corollary 1. If ca = cb (mod n) and gcd(c, n) = 1, then a = b (mod n). We take a moment to record a special case of Corollary 1 that we shall have frequent occasion to use, namely, Corollary 2. Corollary 2. If ca = cb (mod p) and p l c, where p is a prime number, then a= b (mod p). Proof. The conditions p )' c and pa prime imply that gcd(c, p) = 1. Example 4.4. Consider the congruence 33 = 15 (mod 9) or, if one prefers, 3 · 11 = 3 · 5 (mod 9). Because gcd(3, 9) = 3, Theorem 4.3 leads to the conclusion that 11 = 5 (mod 3). A further illustration is given by the congruence -35 = 45 (mod 8), which is the same as 5 · ( -7) = 5 · 9 (mod 8). The integers 5 and 8 being relatively prime, we may cancel the factor 5 to obtain a correct congruence - 7 = 9 (mod 8). Let us call attention to the fact that, in Theorem 4.3, it is unnecessary to stipulate that c ¢ 0 (mod n). Indeed, if c _ 0 (mod n), then gcd(c, n) = n and the conclusion of the theorem would state that a _ b (mod 1); but, as we remarked earlier, this holds trivially for all integers a and b. There is another curious situation that can arise with congruences: The product of two integers, neither of which is congruent to zero, may turn out to be congruent to zero. For instance,4 · 3 _ O(mod 12), but4 ¢ O(mod 12) and3 ¢ O(mod 12). It is a simple matter to show that if ab= 0 (mod n) and gcd(a, n) = 1, thenb = 0 (mod n): Corollary 1 permits us legitimately to cancel the factor a from both sides of the congruence ab= a· 0 (mod n). A variation on this is that when ab= 0 (mod p), with p a prime, then either a _ 0 (mod p) or b _ 0 (mod p ). PROBLEMS 4.2 1. Prove each of the following assertions: (a) If a= b (mod n) and m In, then a= b (mod m). (b) If a= b (mod n) and c > 0, then ca= cb (mod en). (c) If a = b (mod n) and the integers a, b, n are all divisible by d > 0, then a/d = b/d (mod n/d). 2. Give an example to show that a2 = b2 (mod n) need not imply that a = b (modn). 3. If a = b (mod n), prove that gcd(a, n) = gcd(b, n). 4. (a) Find the remainders when 250 and 4165 are divided by 7. (b) What is the remainder when the following sum is divided by 4? 15 + 25 + 35 + ... + 995 + 1005 5. Prove that the integer 53103 + 10353 is divisible by 39, and that 111333 + 333111 is divis­ ible by 7. 68 ELEMENTARY NUMBER THEORY 6. For n 2: 1, use congruence theory to establish each of the following divisibility statements: (a) 7 I 52n + 3 . 2sn-2 . (b) 13 I 3n+2 + 42n+l. (c) 27 I 25n+l + 5n+2 . (d) 43 I 6n+2 + 72n+l. 7. For n 2: 1, show that (-l3t +1 = (-13t + (-l3t-1 (mod 181) [Hint: Notice that (-13) 2 = -13 + 1 (mod 181); use induction on n.] 8. Prove the assertions below: (a) If a is an odd integer, then a2 = 1 (mod 8). (b) For any integer a, a3 = 0, 1, or 6 (mod 7). (c) For any integer a, a4 = 0 or 1 (mod5). ( d) If the integer a is not divisible by 2 or 3, then a2 = 1 (mod 24 ). 9. If pis a prime satisfying n < p < 2n, show that ( 2:) = 0 (mod p) 10. If a1, a2, ... , an is a complete set of residues modulo n and gcd(a, n) = 1, prove that aa1, aa2, ... , aan is also a complete set of residues modulo n. [Hint: It suffices to show that the numbers in question are incongruent modulo n.] 11. Verify that 0, 1, 2, 22, 23, ... , 29 form a complete set of residues modulo 11, but that 0, 12, 2 2, 3 2, ... , 102 do not. 12. Prove the following statements: (a) If gcd(a, n) = 1, then the integers c, c +a, c + 2a, c + 3a, ... , c + (n - l)a form a complete set of residues modulo n for any c. (b) Any n consecutive integers form a complete set of residues modulo n. [Hint: Use part (a).] (c) The product of any set of n consecutive integers is divisible by n. 13. Verify that if a = b (mod n1) and a = b (mod n2), then a = b (mod n), where the integer n = lcm(n1, n2). Hence, whenever ni and n2 are relatively prime, a= b (mod n1n2). 14. Give an example to show that ak =bk (mod n) and k = j (mod n) need not imply that aj = bj (mod n). 15. Establish that if a is an odd integer, then for any n 2: 1 a2n = 1 (mod 2n+2 ) [Hint: Proceed by induction on n.] 16. Use the theory of congruences to verify that 891244 - 1 and 971248 - 1 17. Prove that whenever ab= cd (mod n) and b = d (mod n), with gcd(b, n) = 1, then a= c (mod n). 18. If a = b (mod n1) and a = c (mod n2), prove that b = c (mod n), where the integer n = gcd(n1, n2). 70 ELEMENTARY NUMBER THEORY This tells us that b I dk. Now the inequalities 0 < ak < band 0 < Ck < b lead us to -b < ak - Ck < b, or I dk I < b. The only way of reconciling the conditions b I dk and I dk I < b is to have dk = 0, which is impossible. From this contradiction, we conclude that the representation of N is unique. The essential feature in all of this is that the integer N is completely determined by the ordered array am, am_ 1, ... , a1, a0 of coefficients, with the plus signs and the powers of b being superfluous. Thus, the number N = ambm + am-1b m-l + · · · + a2b2 +alb+ ao may be replaced by the simpler symbol (the right-hand side is not to be interpreted as a product, but only as an abbreviation for N). We call this the base b place-value notation for N. Small values of b give rise to lengthy representation of numbers, but have the advantage of requiring fewer choices for coefficients. The simplest case occurs when the base b = 2, and the resulting system of enumeration is called the binary number system (from the Latin binarius, two). The fact that when a number is written in the binary system only the integers 0 and 1 can appear as coefficients means that every positive integer is expressible in exactly one way as a sum of distinct powers of 2. For example, the integer 105 can be written as 105 = 1. 26 + 1. 25 + 0. 24 + 1. 23 + 0. 22 + 0. 2 + 1 = 26 + 25 + 23 + 1 or, in abbreviated form, 105 = (1101001)2 In the other direction, ( 1001111 h translates into 1 . 2 6 + 0 . 25 + 0 . 24 + 1 . 23 + 1 . 22 + 1 . 2 + 1 = 79 The binary system is most convenient for use in modern electronic computing ma­ chines, because binary numbers are represented by strings of zeros and ones; 0 and 1 can be expressed in the machine by a switch (or a similar electronic device) being either on or off. We shall frequently wish to calculate the value of ak (mod n) when k is large. Is there a more efficient way of obtaining the least positive residue than multiplying a by itself k times before reducing modulo n? One such procedure, called the binary exponential algorithm, relies on successive squarings, with a reduction modulo n after each squaring. More specifically, the exponent k is written in binary form, as k = (amam-1 ... a2a1aoh, and the values a2i (mod n) are calculated for the powers of 2, which correspond to the 1 's in the binary representation. These partial results are then multiplied together to give the final answer. An illustration should make this process clear. THE THEORY OF CONGRUENCES 71 Example 4.5. To calculate 5110 (mod 131), first note that the exponent 110 can be expressed in binary form as 110 = 64 + 32 + 8 + 4 + 2 = (1101 llO)z Thus, we obtain the powers 52j (mod 131) for 0 :S j :S 6 by repeatedly squaring while at each stage reducing each result modulo 131: 52 = 25 (mod 131) 54 = 101 (mod 131) 58 = 114 (mod 131) 516 = 27 (mod 131) 532 = 74 (mod 131) 564 = 105 (mod 131) When the appropriate partial results-those corresponding to the 1 's in the binary expansion of 110-are multiplied, we see that 5110 = 564+32+8+4+2 = 564 . 532 . 58 . 54 . 52 = 105 · 74 · 114 · 101 · 25 = 60 (mod 131) As a minor variation of the procedure, one might calculate, modulo 131, the powers 5 52 53 56 512 524 548 596 to arrive at ' ' ' ' ' ' ' 5110 = 596. 512. 52 = 41·117 · 25 = 60 (mod 131) which would require two fewer multiplications. We ordinarily record numbers in the decimal system of notation, where b = 10, omitting the 10-subscript that specifies the base. For instance, the symbol 1492 stands for the more awkward expression 1 . 103 + 4 . 102 + 9 . 10 + 2 The integers 1, 4, 9, and 2 are called the digits of the given number, 1 being the thousands digit, 4 the hundreds digit, 9 the tens digit, and 2 the units digit. In technical language we refer to the representation of the positive integers as sums of powers of 10, with coefficients at most 9, as their decimal representation (from the Latin decem, ten). We are about ready to derive criteria for determining whether an integer is divisible by 9 or 11, without performing the actual division. For this, we need a result having to do with congruences involving polynomials with integral coefficients. Theorem 4.4. Let P(x) = L:;=O ckxk be a polynomial function of x with integral coefficients ck. If a = b (mod n), then P(a) = P(b) (mod n). Proof. Because a = b (mod n ), part (f) of Theorem 4.2 can be applied to give ak =bk (mod n) fork= 0, 1, ... , m. Therefore, ckak = ckbk (mod n) for all such k. Adding these m + 1 congruences, we conclude that m m L ckak - L ckbk (mod n) k=O k=O or, in different notation, P(a) = P(b) (mod n). 72 ELEMENTARY NUMBER THEORY If P(x) is a polynomial with integral coefficients, we say that a is a solution of the congruence P(x) _ 0 (mod n) if P(a) _ 0 (mod n). Corollary. If a is a solution of P(x) = 0 (mod n) and a = b (mod n), then b also is a solution. Proof. From the last theorem, it is known that P(a) = P(b) (mod n). Hence, if a is a solution of P(x) = 0 (mod n), then P(b) = P(a) = 0 (mod n), making b a solution. One divisibility test that we have in mind is this. A positive integer is divisible by 9 if and only if the sum of the digits in its decimal representation is divisible by 9. Theorem 4.5. Let N =am 10m + am-110m-I + · · · + ai 10 + ao be the decimal ex­ pansion of the positive integer N, 0 � ak < 10, and let S = a0 + a1 +···+am. Then 9 I N if and only if 9 I S. Proof. Consider P (x) = L,:;=0 akxk, a polynomial with integral coefficients. The key observation is that 10 = 1 (mod 9), whence by Theorem 4. 4, P(lO) = P(l) (mod 9). But P(lO) = N and P(l) = ao + a1 +···+am = S, so that N = S (mod 9). It fol­ lows that N = 0 (mod 9) if and only if S = 0 (mod 9), which is what we wanted to prove. Theorem 4.4 also serves as the basis for a well-known test for divisibility by 11: an integer is divisible by 11 if and only if the alternating sum of its digits is divisible by 11. We state this more precisely by Theorem 4.6. Theorem 4.6. Let N =am 10m + am-110m-l + · · · + ailO + ao be the decimal expansion of the positive integer N, 0 � ak < 10, and let T = ao - a1 + a1 - · · · + ( -1 ram. Then 11 I N if and only if 11 I T. Proof. As in the proof of Theorem 4.5, put P(x) = L,:;=0 akxk . Because 10 = -1 (mod 11), we get P(lO) = P(-1) (mod 11). But P(lO) = N, whereas P(-1) = a0 - a1 + a2 - · · · + (-lram = T, so that N = T (mod 11). The implication is that either both N and T are divisible by 11 or neither is divisible by 11. Example 4.6. To see an illustration of the last two results, consider the integer N = 1,571, 724. Because the sum 1 + 5 + 7 + 1 + 7 + 2 + 4 = 27 is divisible by 9, Theorem 4.5 guarantees that 9 divides N. It also can be divided by 11; for, the alternating sum 4- 2+7-1 +7-5 +1=11 is divisible by 11. Congruence theory is frequently used to append an extra check digit to iden­ tification numbers, in order to recognize transmission errors or forgeries. Personal THE THEORY OF CONGRUENCES 73 identification numbers of some kind appear on passports, credit cards, bank accounts, and a variety of other settings. Some banks use an eight-digit identification number a1a2 ... a8 together with a final check digit a9• The check digit is usually obtained by multiplying the digits ai(l < i :S 8) by certain \"weights\" and calculating the sum of the weighted products modulo 10. For instance, the check digit might be chosen to satisfy a9 = 7a1 + 3a2 + 9a3 + 7a4 + 3as + 9a6 + 7a1 + 3as (mod 10) The identification number 81504216 would then have check digit a9 - 7 · 8 + 3 · 1 + 9 · 5 + 7 · 0 + 3 · 4 + 9 · 2 + 7 · 1 + 3 · 6 - 9 (mod 10) so that 815042169 would be printed on the check. This weighting scheme for assigning check digits detects any single-digit error in the identification number. For suppose that the digit ai is replaced by a different a;. By the manner in which the check digit is calculated, the difference between the correct a9 and the new a� is (mod 10) where k is 7, 3, or 9 depending on the position of a;. Because k(ai - a;) \"¢ 0 (mod 10), it follows that a9 -=!- a� and the error is apparent. Thus, if the valid number 81504216 were incorrectly entered as 81504316 into a computer programmed to calculate check digits, an 8 would come up rather than the expected 9. The modulo 10 approach is not entirely effective, for it does not always detect the common error of transposing distinct adjacent entries a and b within the string of digits. To illustrate: the identification numbers 81504216 and 81504261 have the same check digit 9 when our example weights are used. (The problem occurs when l a - bl = 5.) More sophisticated methods are available, with larger moduli and different weights, that would prevent this possible error. PROBLEMS 4.3 1. Use the binary exponentiation algorithm to compute both 1953 (mod 503) and 14147 (mod 1537). 2. Prove the following statements: (a) For any integer a, the units digit of a2 is 0, 1, 4, 5, 6, or 9. (b) Any one of the integers 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 can occur as the units digit of a 3. (c) For any integer a, the units digit of a4 is 0, 1, 5, or 6. (d) The units digit of a triangular number is 0, 1, 3, 5, 6, or 8. 3. Find the last two digits of the number 999. [Hint: 99 = 9 (mod 10); hence, 999 = 99+IOk; notice that 9 9 = 89 (modlOO).] 4. Without performing the divisions, determine whether the integers 176521221 and 149235678 are divisible by 9 or 11. 5. (a) Obtain the following generalization of Theorem 4.6: If the integer N is represented in the base b by then b - 1 IN if and only if b - 1 I (am + · · · + a2 + ai + ao) . 7 4 ELEMENTARY NUMBER THEORY (b) Give criteria for the divisibility of N by 3 and 8 that depend on the digits of N when written in the base 9. (c) Is the integer (447836)9 divisible by 3 and 8? 6. Working modulo 9 or 11, find the missing digits in the calculations below: (a) 51840 · 273581 = 1418243x040. (b) 2x99561 = [3(523 + x) ]2. (c) 2784x = x · 5569. (d) 512 · lx53125 = 1000000000. 7. Establish the following divisibility criteria: (a) An integer is divisible by 2 if and only if its units digit is 0, 2, 4, 6, or 8. (b) An integer is divisible by 3 if and only if the sum of its digits is divisible by 3. ( c) An integer is divisible by 4 if and only if the number formed by its tens and units digits is divisible by 4. [Hint: lOk = 0 (mod 4) fork ::: 2.] (d) An integer is divisible by 5 if and only if its units digit is 0 or 5. 8. For any integer a, show that a2 - a + 7 ends in one of the digits 3, 7, or 9. 9. Find the remainder when 44444444 is divided by 9. [Hint: Observe that 23 = -1 (mod 9).] 10. Prove that no integer whose digits add up to 15 can be a square or a cube. [Hint: For any a, a3 = 0, 1, or 8 (mod 9).] 11. Assuming that 495 divides 273x49y5, obtain the digits x and y. 12. Determine the last three digits of the number 7999. [Hint: 74n = (1 + 400)ll = 1 + 400n (mod 1000).] 13. If t n denotes the nth triangular number, show that tn+2k = t n (mod k ); hence, t n and t n+20 must have the same last digit. 14. For any n ::: 1, prove that there exists a prime with at least n of its digits equal to 0. [Hint: Consider the arithmetic progression 10n+lk + 1 fork= 1, 2, .... ] 15. Find the values of n ::: 1 for which 1 ! + 2 ! + 3 ! + · · · + n ! is a perfect square. [Hint: Problem 2(a).] 16. Show that 2n divides an integer N if and only if 2n divides the number made up of the last n digits of N. [Hint: lok = 2k5k = 0 (mod 2n) fork ::: n.] 17. Let N =am 10m + · · · + a1102+ai10 + ao, where 0:::; a k :::; 9, be the decimal expan­ sion of a positive integer N. (a) Prove that 7, 11, and 13 all divide N if and only if 7, 11, and 13 divide the integer M = (lOOa 2 + l0a1 + ao) - (lOOas + l0a4 + a3) + (lOOas + l0a7 + a6) - · · · [Hint: If n is even, then 103n = 1, 103n+l = 10, 103n+2 = 100 (mod 1001); if n is odd, then 103n = -1, 103n+l = -10, 103n+2 = -100 (mod 1001).] (b) Prove that 6 divides N if and only if 6 divides the integer 18. Without performing the divisions, determine whether the integer 1010908899 is divisible by 7, 11, and 13. 19. (a) Given an integer N, let M be the integer formed by reversing the order of the digits of N (for example, if N = 6923, then M = 3296). Verify that N - M is divisible by 9. THE THEORY OF CONGRUENCES 75 (b) A palindrome is a number that reads the same backward as forward (for instance, 373 and 521125 are palindromes). Prove that any palindrome with an even number of digits is divisible by 11. 20. Given a repunit Rn, show that (a) 91 Rn if and only if 91 n. (b) 11 I Rn if and only if n is even. 21. Factor the repunit R6 = 111111 into a product of primes. [Hint: Problem 17(a).] 22. Explain why the following curious calculations hold: [Hint: Show that 1-9+ 2=11 12 . 9 + 3 = 111 123 . 9 + 4 = 1111 1234 . 9 + 5 = 11111 12345 . 9 + 6 = 111111 123456 . 9 + 7 = 1111111 1234567 . 9 + 8 = 11111111 12345678 . 9 + 9 = 111111111 123456789 . 9 + 10 = 1111111111 (Ion-I + 2 · 10n-2 + 3 · 1on-3 + · · · + n)(lO - 1) 10n+l - 1 +(n + 1) = 9 .] 23. An old and somewhat illegible invoice shows that 72 canned hams were purchased for $x 67.9y. Find the missing digits. 24. If 792 divides the integer 13xy 45z, find the digits x, y, and z. [Hint: By Problem 17, 8 I 45z.] 25. For any prime p > 3, prove that 13 divides 102P - lQP + 1. 26. Consider the eight-digit bank identification number a1a2 ••• a8, which is followed by a ninth check digit a9 chosen to satisfy the congruence a9 = 7a1 + 3a2 + 9a3 + 7a4 + 3as + 9a6 + 7a7 + 3as (mod 10) (a) Obtain the check digits that should be appended to the two numbers 55382006 and 81372439. (b) The bank identification number 237a418538 has an illegible fourth digit. Determine the value of the obscured digit. 27. The International Standard Book Number (ISBN) used in many libraries consists of nine digits a1a2 ... a9 followed by a tenth check digit a10, which satisfies 9 aw= L kak (mod 11) k=l Determine whether each of the ISBNs below is correct: (a) 0-07-232569-0 (United States). (b) 91-7643-497-5 (Sweden). (c) 1-56947-303-10 (England). 28. When printing the ISBN a1a2 ... a9, two unequal digits were transposed. Show that the check digits detected this error. 7 6 ELEMENTARY NUMBER THEORY 4.4 LINEAR CONGRUENCES AND THE CHINESE REMAINDER THEOREM This is a convenient place in our development of number theory at which to inves­ tigate the theory of linear congruences: an equation of the form ax = b (mod n) is called a linear congruence, and by a solution of such an equation we mean an integer x0 for which ax0 - b (mod n ). By definition, ax0 - b (mod n) if and only if n I axo - b or, what amounts to the same thing, if and only if axo - b = nyo for some integer YO· Thus, the problem of finding all integers that will satisfy the lin­ ear congruence ax _ b (mod n) is identical with that of obtaining all solutions of the linear Diophantine equation ax - ny = b. This allows us to bring the results of Chapter 2 into play. It is convenient to treat two solutions of ax = b (mod n) that are congruent modulo n as being \"equal\" even though they are not equal in the usual sense. For instance, x = 3 and x = -9 both satisfy the congruence 3x _ 9 (mod 12); because 3 = -9 (mod 12), they are not counted as different solutions. In short: When we refer to the number of solutions of ax = b (mod n ), we mean the number of incongruent integers satisfying this congruence. With these remarks in mind, the principal result is easy to state. Theorem 4.7. The linear congruence ax = b (mod n) has a solution if and only if d I b, where d = gcd(a, n). If d I b, then it has d mutually incongruent solutions modulo n. Proof. We already have observed that the given congruence is equivalent to the linear Diophantine equation ax - ny = b. From Theorem 2.9, it is known that the latter equation can be solved if and only if d I b; moreover, if it is solvable and xo, Yo is one specific solution, then any other solution has the form for some choice of t. n X =XO+ -t d a y = Yo+ -t d Among the various integers satisfying the first of these formulas, consider those that occur when t takes on the successive values t = 0, 1, 2, ... , d - 1: n 2n (d - l)n XO, XO + d, XO + d, · · · , XO + d We claim that these integers are incongruent modulo n, and all other such integers x are congruent to some one of them. If it happened that n n xo + dti = xo + dt2 (mod n) where 0 � t1 < t2 � d - 1, then we would have n n -ti = -t2 (mod n) d d Now gcd(n/d, n) = n/d, and therefore by Theorem 4.3 the factor n/d could be can­ celed to arrive at the congruence ti = t2 (mod d) THE THEORY OF CONGRUENCES 77 which is to say that d I t2 - t1. But this is impossible in view of the inequality 0 < t1 - ti < d. It remains to argue that any other solution xo + (n / d)t is congruent modulo n to one of the d integers listed above. The Division Algorithm permits us to write t as t = qd + r, where 0:::; r :::; d - 1. Hence n n xo + -;/ = xo + d(qd + r) n = xo + nq + dr n = x0 + dr (mod n) with xo + (n / d)r being one of our d selected solutions. This ends the proof. The argument that we gave in Theorem 4.7 brings out a point worth stating ex­ plicitly: If xo is any solution of ax = b (mod n), then the d = gcd(a, n) incongruent solutions are given by xo, xo + �, xo + 2 (�) , ... , xo + (d - 1) (�) For the reader's convenience, let us also record the form Theorem 4.7 takes in the special case in which a and n are assumed to be relatively prime. Corollary. If gcd(a, n) = 1, then the linear congruence ax = b (mod n) has a unique solution modulo n. Given relatively prime integers a and n, the congruence ax = 1 (mod n) has a unique solution. This solution is sometimes called the (multiplicative) inverse of a modulo n. We now pause to look at two concrete examples. Example 4.7. First consider the linear congruence 18x = 30 (mod 42). Because gcd(l8, 42) = 6 and 6 surely divides 30, Theorem 4.7 guarantees the existence of exactly six solutions, which are incongruent modulo 42. By inspection, one solution is found to be x = 4. Our analysis tells us that the six solutions are as follows: x = 4 + (42/6)t = 4 + ?t (mod 42) t = 0, 1, ... ' 5 or, plainly enumerated, x = 4, 11, 18, 25, 32, 39 (mod 42) Example 4.8. Let us solve the linear congruence 9x = 21 (mod 30). At the out­ set, because gcd(9, 30) = 3 and 3121, we know that there must be three incongruent solutions. One way to find these solutions is to divide the given congruence through by 3, thereby replacing it by the equivalent congruence 3x = 7 (mod 10). The relative primeness of 3 and 10 implies that the latter congruence admits a unique solution modulo 10. Although it is not the most efficient method, we could test the integers 78 ELEMENTARY NUMBER THEORY 0, 1, 2, ... , 9 in tum until the solution is obtained. A better way is this: Multiply both sides of the congruence 3x = 7 (mod 10) by 7 to get 21x = 49 (mod 10) which reduces to x = 9 (mod 10). (This simplification is no accident, for the multiples 0 · 3, 1 · 3, 2 · 3, ... , 9 · 3 form a complete set of residues modulo 10; hence, one of them is necessarily congruent to 1 modulo 10.) But the original congruence was given modulo 30, so that its incongruent solutions are sought among the integers 0, 1, 2, ... , 29. Taking t = 0, 1, 2, in the formula x = 9 + lOt we obtain 9, 19, 29, whence x = 9 (mod 30) x = 19 (mod 30) x = 29 (mod 30) are the required three solutions of 9x = 21 (mod 30). A different approach to the problem is to use the method that is suggested in the proof of Theorem 4.7. Because the congruence 9x = 21(mod 30) is equivalent to the linear Diophantine equation 9x - 30y = 21 we begin by expressing 3 = gcd(9, 30) as a linear combination of 9 and 30. It is found, either by inspection or by using the Euclidean Algorithm, that 3 = 9(-3) + 30 · 1, so that 21=7 .3 = 9(-21) - 30(- 7) Thus, x = -21, y = - 7 satisfy the Diophantine equation and, in consequence, all solutions of the congruence in question are to be found from the formula x = -21 + (30/3)t = -21 + lOt The integers x = -21 + lOt, where t = 0, 1, 2, are incongruent modulo 30 (but all are congruent modulo 10); thus, we end up with the incongruent solutions x = -21 (mod 30) x = -11 (mod 30) x = -1 (mod 30) or, if one prefers positive numbers, x = 9, 19, 29 (mod 30). Having considered a single linear congruence, it is natural to turn to the problem of solving a system of simultaneous linear congruences: aix = b1 (mod m1), azx = b2 (mod m2), ... , a,x = b, (mod m,) We shall assume that the moduli mk are relatively prime in pairs. Evidently, the system will admit no solution unless each individual congruence is solvable; that is, unless dk I bk for each k, where dk = gcd(ab mk). When these conditions are satisfied, the factor dk can be canceled in the kth congruence to produce a new system having the same set of solutions as the original one: a�x =Vi (mod n1), a;x = b� (mod n2), ... , a�x = b� (mod n,) THE THEORY OF CONGRUENCES 79 where nk = mkf dk and gcd(ni , n j) = 1 for i =/:- j; in addition, gcd(a�, ni) = 1. The solutions of the individual congruences assume the form x = c1 (mod n1), x = c2 (mod n2), ... , x =Cr (mod nr) Thus, the problem is reduced to one of finding a simultaneous solution of a system of congruences of this simpler type. The kind of problem that can be solved by simultaneous congruences has a long history, appearing in the Chinese literature as early as the 1st century A.D. Sun-Tsu asked: Find a number that leaves the remainders 2, 3, 2 when divided by 3, 5, 7, respectively. (Such mathematical puzzles are by no means confined to a single cultural sphere; indeed, the same problem occurs in the Introductio Arithmeticae of the Greek mathematician Nicomachus, circa 100 A.D.) In honor of their early contributions, the rule for obtaining a solution usually goes by the name of the Chinese Remainder Theorem. Theorem 4.8 Chinese Remainder Theorem. Let n 1, n2, ... , nr be positive integers such that gcd(n;, n j) = 1 for i #- j. Then the system of linear congruences x = ai (mod n1) x = a1 (mod n2) x =a, (mod n,) has a simultaneous solution, which is unique modulo the integer n1n2 · · · n,. Proof. We start by forming the product n = n1n2 · · · n,. For each k = 1, 2, ... , r, let n Nk = - = n1 · · · nk-lnk+l · · · n, nk In words, Nk is the product of all the integers n; with the factor nk omitted. By hy­ pothesis, the n; are relatively prime in pairs, so that gcd(Nb nk) = 1. According to the theory of a single linear congruence, it is therefore possible to solve the congruence Nkx = 1 (mod nk); call the unique solution xk. Our aim is to prove that the integer x = a1N1x1 + a1N2x2 + · · · + a,N,x, is a simultaneous solution of the given system. First, observe that N; = 0 (mod nk) for i #- k, because nk I Ni in this case. The result is x = a1N1x1 + · · · + a,N,x, = akNkxk (mod nk) But the integer xk was chosen to satisfy the congruence Nkx = 1 (mod nk), which forces x = ak · 1 = ak (mod nk) This shows that a solution to the given system of congruences exists. As for the uniqueness assertion, suppose that x' is any other integer that satisfies these congruences. Then x = ak = x' (mod nk) k = 1, 2, ... , r 80 ELEMENTARY NUMBER THEORY and so nk I x -x' for each value of k. Because gcd(ni, n j) = 1, Corollary 2 to Theorem 2.4 supplies us with the crucial point that n1n2 · · · nr Ix -x'; hence x = x' (mod n). With this, the Chinese Remainder Theorem is proven. Example 4.9. The problem posed by Sun-Tsu corresponds to the system of three congruences x = 2 (mod 3) x = 3 (mod 5) x = 2 (mod 7) In the notation of Theorem 4.8, we have n = 3 · 5 · 7 = 105 and n Ni= 3\" = 35 n N1 = - = 21 5 n N3 = - = 15 7 Now the linear congruences 35x = 1 (mod 3) 21x = 1 (mod 5) 15x = 1 (mod 7) are satisfied by x1 = 2, x2 = 1, x3 = 1, respectively. Thus, a solution of the system is given by x = 2 . 35 . 2 + 3 . 21 . 1 + 2 . 15 . 1 = 233 Modulo 105, we get the unique solution x = 233 = 23 (mod 105). Example 4.10. For a second illustration, let us solve the linear congruence 17x = 9 (mod 276) Because 276 = 3 · 4 · 23, this is equivalent to finding a solution for the system of congruences 17x = 9 (mod 3) 17x - 9 (mod4) 17x = 9 (mod 23) or x = 0 (mod 3) x - 1 (mod4) 17x = 9 (mod 23) Note that if x = 0 (mod 3), thenx = 3k for any integer k. We substitute into the second congruence of the system and obtain 3k = 1 (mod4) Multiplication of both sides of this congruence by 3 gives us k = 9k = 3 (mod 4) so that k = 3 + 4 j, where j is an integer. Then x = 3(3 + 4j) = 9 + 12j For x to satisfy the last congruence, we must have 17(9 + 12j) = 9 (mod 23) or 204 j = -144 (mod 23), which reduces to 3 j = 6 (mod 23); in consequence, j = 2 (mod 23). This yields j = 2 + 23t, with t an integer, whence x = 9 + 12(2 + 23t) = 33 + 276t THE THEORY OF CONGRUENCES 81 All in all, x = 33 (mod 276) provides a solution to the system of congruences and, in tum, a solution to 17 x = 9 (mod 276). We should say a few words about linear congruences in two variables; that is, congruences of the form ax+ by= c (modn) In analogy with Theorem 4.7, such a congruence has a solution if and only if gcd(a, b, n) divides c. The condition for solvability holds if either gcd(a, n) = 1 or gcd(b, n) = 1. Say gcd(a, n) = 1. When the congruence is expressed as ax= c -by (modn) the corollary to Theorem 4.7 guarantees a unique solution x for each of the n incongruent values of y. Take as a simple illustration 7x + 4y = 5 (mod 12), that would be treated as 7x _ 5 - 4y (mod 12). Substitution of y _ 5 (mod 12) gives 7x = -15 (mod 12); but this is equivalent to -5x = -15 (mod 12) so that x = 3 (mod 12). It follows that x = 3 (mod 12), y = 5 (mod 12) is one of the 12 incongruent solutions of 7x + 4y _ 5 (mod 12). Another solution having the same value of x is x = 3 (mod 12),y = 8 (mod 12). The focus of our concern here is how to solve a system of two linear congruences in two variables with the same modulus. The proof of the coming theorem adopts the familiar procedure of eliminating one of the unknowns. Theorem 4.9. The system of linear congruences ax + by = r (mod n) ex + dy = s (modn) has a unique solution modulo n whenever gcd(ad - be, n) = 1. Proof. Let us multiply the first congruence of the system by d, the second congruence by b, and subtract the lower result from the upper. These calculations yield (ad - be)x = dr - bs (mod n) (1) The assumption gcd( ad - be, n) = 1 ensures that the congruence (ad - be)z = 1 (mod n) posseses a unique solution; denote the solution by t. When congruence (1) is multiplied by t, we obtain x = t(dr - bs) (mod n) A value for y is found by a similar elimination process. That is, multiply the first congruence of the system by e, the second one by a, and subtract to end up with (ad - be)y =as - er (mod n) Multiplication of this congruence by t leads to y = t(as - er) (mod n) A solution of the system is now established. We close this section with an example illustrating Theorem 4.9. (2) 82 ELEMENTARY NUMBER THEORY Example 4.11. Consider the system 7x + 3y = 10 (mod 16) 2x + Sy = 9 (mod 16) Because gcd(7 · S - 2 · 3, 16) = gcd(29, 16) = 1, a solution exists. It is obtained by the method developed in the proof of Theorem 4.9. Multiplying the first congruence by S, the second one by 3, and subtracting, we arrive at 29x = S · 10 - 3 · 9 = 23 (mod 16) or, what is the same thing, 13x = 7 (mod 16). Multiplication of this congruence by S (noting that S · 13 = 1 (mod 16)) produces x = 3S = 3 (mod 16). When the variable x is eliminated from the system of congruences in a like manner, it is found that 29y = 7 · 9 - 2 · 10 = 43 (mod 16) But then 13y = 11 (mod 16), which upon multiplication by S, results in y =SS = 7 (mod 16). The unique solution of our system turns out to be x = 3 (mod 16) PROBLEMS 4.4 1. Solve the following linear congruences: (a) 2Sx = lS (mod 29). (b) Sx = 2 (mod 26). (c) 6x = lS (mod 21). (d) 36x = 8 (mod 102). (e) 34x = 60 (mod 98). (f) 140x = 133 (mod 301). [Hint: gcd(l40, 301) = 7.] y = 7 (mod 16) 2. Using congruences, solve the Diophantine equations below: (a) 4x +Sly = 9. [Hint: 4x = 9 (mod Sl) gives x = lS + Slt, whereas Sly = 9 (mod 4) gives y = 3 + 4s. Find the relation between s and t .] (b) 12x + 2Sy = 331. (c) Sx - S3y = 17. 3. Find all solutions of the linear congruence 3x - 7y = 11 (mod 13). 4. Solve each of the following sets of simultaneous congruences: (a) x = 1 (mod 3), x = 2 (mod S), x = 3 (mod 7). (b) x = S (mod 11), x = 14 (mod 29), x = lS (mod 31). (c) x = S (mod 6), x = 4 (mod 11), x = 3 (mod 17). (d) 2x = 1 (mod S), 3x = 9 (mod 6), 4x = 1 (mod 7), Sx = 9 (mod 11). 5. Solve the linear congruence 17 x = 3 (mod 2 · 3 · S · 7) by solving the system 17x = 3 (mod 2) 17x = 3 (mod S) 6. Find the smallest integer a > 2 such that 17x = 3 (mod 3) 17x = 3 (mod 7) 21 a, 31a+1, 41a+2, SI a+ 3, 61a+4 THE THEORY OF CONGRUENCES 83 7. (a) Obtain three consecutive integers, each having a square factor. [Hint: Find an integer a such that 221a,3 21 a+ 1, 521a+2.] (b) Obtain three consecutive integers, the first of which is divisible by a square, the second by a cube, and the third by a fourth power. 8. (Brahmagupta, 7th century A.D.) When eggs in a basket are removed 2, 3, 4, 5, 6 at a time there remain, respectively, 1, 2, 3, 4, 5 eggs. When they are taken out 7 at a time, none are left over. Find the smallest number of eggs that could have been contained in the basket. 9. The basket-of-eggs problem is often phrased in the following form: One egg remains when the eggs are removed from the basket 2, 3, 4, 5, or 6 at a time; but, no eggs remain if they are removed 7 at a time. Find the smallest number of eggs that could have been in the basket. 10. (Ancient Chinese Problem.) A band of 17 pirates stole a sack of gold coins. When they tried to divide the fortune into equal portions, 3 coins remained. In the ensuing brawl over who should get the extra coins, one pirate was killed. The wealth was redistributed, but this time an equal division left 10 coins. Again an argument developed in which another pirate was killed. But now the total fortune was evenly distributed among the survivors. What was the least number of coins that could have been stolen? 11. Prove that the congruences x =a (mod n) and x = b (modm) admit a simultaneous solution if and only if gcd(n, m) I a - b; if a solution exists, confirm that it is unique modulo lcm(n, m). 12. Use Problem 11 to show that the following system does not possess a solution: x = 5 (mod 6) and x = 7 (mod 15) 13. If x =a (mod n), prove that either x =a (mod 2n) or x =a+ n (mod 2n). 14. A certain integer between 1 and 1200 leaves the remainders 1, 2, 6 when divided by 9, 11, 13, respectively. What is the integer? 15. (a) Find an integer having the remainders 1, 2, 5, 5 when divided by 2, 3, 6, 12, respec­ tively. (Yih-hing, died 717). (b) Find an integer having the remainders 2, 3, 4, 5 when divided by 3, 4, 5, 6, respectively. (Bhaskara, born 1114). (c) Find an integer having the remainders 3, 11, 15 when divided by 10, 13, 17, respec­ tively. (Regiomontanus, 1436-1476). 16. Let tn denote the nth triangular number. For which values of n does tn divide 2 2 2 ti + t2 + ... + tn [Hint: Because tf + tJ + · · · + t; = tn (3n3 + 12n2 + 13n + 2)/30, it suffices to deter­ mine those n satisfying 3n3 + 12n2 + 13n + 2 = 0 (mod 2 · 3 · 5).] 17. Find the solutions of the system of congruences: 3x +4y = 5 (mod 13) 2x + 5y = 7 (mod 13) 18. Obtain the two incongruent solutions modulo 210 of the system 2x = 3 (mod 5) 4x = 2 (mod 6) 3x = 2 (mod 7) 84 ELEMENTARY NUMBER THEORY 19. Obtain the eight incongruent solutions of the linear congruence 3x + 4y = 5 (mod 8). 20. Find the solutions of each of the following systems of congruences: (a) 5x + 3y = 1 (mod 7) 3x + 2y = 4 (mod 7). (b) 7x + 3y = 6 (mod 11) 4x + 2y = 9 (mod 11). (c) llx + 5y = 7 (mod 20) 6x + 3y = 8 (mod 20). CHAPTER 5 FERMAT'S THEOREM And perhaps posterity will thank me for having shown it that the ancients did not know everything. P. DE FERMAT 5.1 PIERRE DE FERMAT What the ancient world had known was largely forgotten during the intellectual torpor of the Dark Ages, and it was only after the 12th century that Western Europe again became conscious of mathematics. The revival of classical scholarship was stimulated by Latin translations from the Greek and, more especially, from the Arabic. The Latinization of Arabic versions of Euclid's great treatise, the Elements, first appeared in 1120. The translation was not a faithful rendering of the Elements, having suffered successive, inaccurate translations from the Greek-first into Arabic, then into Castilian, and finally into Latin-done by copyists not versed in the content of the work. Nevertheless, this much-used copy, with its accumulation of errors, served as the foundation of all editions known in Europe until 1505, when the Greek text was recovered. With the fall of Constantinople to the Turks in 1453, the Byzantine schol­ ars who had served as the major custodians of mathematics brought the ancient masterpieces of Greek learning to the West. It is reported that a copy of what sur­ vived of Diophantus'sArithmetica was found in the Vatican library around 1462 by Johannes Muller (better known as Regiomontanus from the Latin name of his native town, Konigsberg). Presumably, it had been brought to Rome by the refugees from Byzantium. Regiomontanus observed, \"In these books the very flower of the whole 85 86 ELEMENTARY NUMBER THEORY Pierre de Fermat (1601-1665) (David Eugene Smith Collection, Rare Book and Manuscript Library, Columbia University) of arithmetic lies hid,\" and tried to interest others in translating it. Notwithstanding the attention that was called to the work, it remained practically a closed book until 1572 when the first translation and printed edition was brought out by the German professor Wilhelm Holzmann, who wrote under the Grecian form of his name, Xylander. The Arithmetica became fully accessible to European mathematicians when Claude Bachet-borrowing liberally from Xylander-published (1621) the original Greek text, along with a Latin translation containing notes and comments. The Bachet edition probably has the distinction of being the work that first directed the attention of Fermat to the problems of number theory. Few if any periods were so fruitful for mathematics as was the 17th century; Northern Europe alone produced as many men of outstanding ability as had ap­ peared during the preceding millennium. At a time when such names as Desargues, Descartes, Pascal, Wallis, Bernoulli, Leibniz, and Newton were becoming famous, a certain French civil servant, Pierre de Fermat ( 1601-1665), stood as an equal among these brilliant scholars. Fermat, the \"Prince of Amateurs,\" was the last great mathe­ matician to pursue the subject as a sideline to a nonscientific career. By profession a lawyer and magistrate attached to the provincial parliament at Toulouse, he sought refuge from controversy in the abstraction of mathematics. Fermat evidently had no particular mathematical training and he evidenced no interest in its study until he was past 30; to him, it was merely a hobby to be cultivated in leisure time. Yet no practitioner of his day made greater discoveries or contributed more to the advance­ ment of the discipline: one of the inventors of analytic geometry (the actual term was coined in the early 19th century), he laid the technical foundations of differential and integral calculus and, with Pascal, established the conceptual guidelines of the theory of probability. Fermat's real love in mathematics was undoubtedly number theory, which he rescued from the realm of superstition and occultism where it had long been imprisoned. His contributions here overshadow all else; it may well be said that the revival of interest in the abstract side of number theory began with Fermat. FERMAT'S THEOREM 87 Fermat preferred the pleasure he derived from mathematical research itself to any reputation that it might bring him; indeed, he published only one major manuscript during his lifetime and that just 5 years before his death, using the concealing initials M.P.E.A.S. Adamantly refusing to put his work in finished form, he thwarted several efforts by others to make the results available in print under his name. In partial compensation for his lack of interest in publication, Fermat carried on a voluminous correspondence with contemporary mathematicians. Most of what little we know about his investigations is found in the letters to friends with whom he exchanged problems and to whom he reported his successes. They did their best to publicize Fermat's talents by passing these letters from hand to hand or by making copies, which were dispatched over the Continent. As his parliamentary duties demanded an ever greater portion of his time, Fermat was given to inserting notes in the margin of whatever book he happened to be using. Fermat's personal copy of the Bachet edition ofDiophantus held in its margin many of his famous theorems in number theory. These were discovered by his son Samuel 5 years after Fermat's death. His son brought out a new edition of the Arithmetica incorporating Fermat's celebrated marginalia. Because there was little space available, Fermat's habit had been to jot down some result and omit all steps leading to the conclusion. Posterity has wished many times that the margins of the Arithmetica had been wider or that Fermat had been a little less secretive about his methods. 5.2 FERMAT'S LITTLE THEOREM AND PSEUDOPRIMES The most significant of Fermat's correspondents in number theory was Bernhard Frenicle de Bessy (1605-1675), an official at the French mint who was renowned for his gift of manipulating large numbers. (Frenicle's facility in numerical calculation is revealed by the following incident: On hearing that Fermat had proposed the problem of finding cubes that when increased by their proper divisors become squares, as is the case with 73 + (1 + 7 + 72) = 202, he immediately gave four different solutions, and supplied six more the next day.) Though in no way Fermat's equal as a mathematician, Frenicle alone among his contemporaries could challenge Fermat in number theory and Frenicle's challenges had the distinction of coaxing out of Fermat some of his carefully guarded secrets. One of the most striking is the theorem that states: If p is a prime and a is any integer not divisible by p, then p divides aP-l - 1. Fermat communicated the result in a letter to Frenicle dated October 18, 1640, along with the comment, \"I would send you the demonstration, if I did not fear its being too long.\" This theorem has since become known as \"Fermat's Little Theorem,\" or just \"Fermat's Theorem,\" to distinguish it from Fermat's \"Great\" or \"Last Theorem,\" which is the subject of Chapter 12. Almost 100 years were to elapse before Euler published the first proof of the little theorem in 1736. Leibniz, however, seems not to have received his share of recognition, for he left an identical argument in an unpublished manuscript sometime before 1683. We now proceed to a proof of Fermat's theorem. FERMAT'S THEOREM 89 by virtue of which p I k ! or p I ( f ). But p I k ! implies that p I j for some j satisfying 1 � j < k � p - 1, an absurdity. Therefore, p I ( f ) or, converting to a congruence statement, (n =O(modp) The point we wish to make is that (a+ l)P = aP + 1 =a+ 1 (mod p) where the rightmost congruence uses our inductive assumption. Thus, the desired conclusion holds for a+ 1 and, in consequence, for all a > 0. If a happens to be a negative integer, there is no problem: because a _ r (mod p) for some r, where 0 � r < p - 1, we get aP = rP = r =a (mod p). Fermat's theorem has many applications and is central to much of what is done in number theory. In the least, it can be a labor-saving device in certain calculations. If asked to verify that 538 _ 4 (mod 11 ), for instance, we take the congruence 510 _ 1 (mod 11) as our starting point. Knowing this, 538 = 510·3+8 = (510)3(52)4 = 13 . 34 = 81=4(mod 11) as desired. Another use of Fermat's theorem is as a tool in testing the primality of a given integer n. If it could be shown that the congruence an_ a (mod n) fails to hold for some choice of a, then n is necessarily composite. As an example of this approach, let us look at n = 117. The computation is kept under control by selecting a small integer for a, say, a = 2. Because 2117 may be written as 2111 = 21.16+5 = (21)1625 and 27 = 128 = 11 (mod 117), we have 2117 = 1116 . 25 = (121)825 = 48 . 25 = 221 (mod 117) But 221 = (27)3, which leads to 221 _ 113 _ 121. 11_4.11_44 (mod 117) Combining these congruences, we finally obtain 2117 = 44 ¥ 2 (mod 117) so that 117 must be composite; actually, 117 = 13 · 9. It might be worthwhile to give an example illustrating the failure of the converse of Fermat's theorem to hold, in other words, to show that if an-l = 1 (mod n) for some integer a, then n need not be prime. As a prelude we require a technical lemma. Lemma. If p and q are distinct primes with aP =a (mod q) and aq =a (mod p), then aPq = a (mod pq ). 90 ELEMENTARY NUMBER THEORY Proof. The last corollary tells us that (aq )P = aq (mod p), whereas aq =a (mod p) holds by hypothesis. Combining these congruences, we obtain aPq = a (mod p) or, in different terms, p I aPq - a. In an entirely similar manner, q I aPq - a. Corollary 2 to Theorem 2.4 now yields pq I aPq - a, which can be recast as apq = a (mod pq ). Our contention is that 2340 _ 1 (mod 341), where 341 = 11 · 31. In working toward this end, notice that 210 = 1024 = 31 · 33 + 1. Thus, 211 = 2 . 210 = 2 · 1 = 2 (mod 31) and 231 = 2(210)3 _ 2 · 13 _ 2 (mod 11) Exploiting the lemma, 211·31 = 2 (mod 11 · 31) or 2341 _ 2 (mod 341). After canceling a factor of 2, we pass to 2340 = 1 (mod 341) so that the converse to Fermat's theorem is false. The historical interest in numbers of the form 2n - 2 resides in the claim made by Chinese mathematicians over 25 centuries ago that n is prime if and only if n I 2n - 2 (in point of fact, this criterion is reliable for all integers n � 340). Our example, where 341 I 2341 - 2, although 341 = 11 · 31, lays the conjecture to rest; this was discovered in the year 1819. The situation in which n 12n - 2 occurs often enough to merit a name, though: a composite integer n is called pseudoprime whenever n 12n - 2. It can be shown that there are infinitely many pseudoprimes, the smallest four being 341, 561, 645, and 1105. Theorem 5.2 allows us to construct an increasing sequence of pseudoprimes. Theorem 5.2. If n is an odd pseudoprime, then Mn = 2n - 1 is a larger one. Proof. Because n is a composite number, we can write n = rs, with 1 < r :S s < n. Then, according to Problem 21, Section 2.3, 2r - 1I2n - 1, or equivalently 2r - 11 Mn, making Mn composite. By our hypotheses, 2n - 2 (mod n); hence 2n - 2 = kn for some integer k. It follows that This yields 2Mn-1 = 22n-2 = 2kn 2M.-l - 1 = 2kn - 1 = (2n _ 1)(2n(k-1) + 2n(k-2) + ... + 2n + 1) = Mn(2n(k-1) + 2n(k-2) + ... + 2n + 1) = 0 (mod Mn) We see immediately that 2M\" - 2 = O(modMn),in light ofwhichMn is a pseudoprime. FERMAT'S THEOREM 91 More generally, a composite integer n for which an = a (mod n) is called a pseudoprime to the base a. (When a = 2, n is simply said to be a pseudoprime.) For instance, 91 is the smallest pseudoprime to base 3, whereas 217 is the smallest such to base 5. It has been proved (1903) that there are infinitely many pseudoprimes to any given base. These \"prime imposters\" are much rarer than are actual primes. Indeed, there are only 247 pseudoprimes smaller than one million, in comparison with 78498 primes. The first example of an even pseudoprime, namely, the number 161038 = 2 . 73 . 1103 was found in 1950. There exist composite numbers n that are pseudoprimes to every base a; that is, an-l = 1 (mod n) for all integers a with gcd(a, n) = 1. The least such is 561. These exceptional numbers are called absolute pseudoprimes or Carmichael numbers, for R. D. Carmichael, who was the first to notice their existence. In his first paper on the subject, published in 1910, Carmichael indicated four ab­ solute pseudoprimes including the well-known 561 = 3 · 11 · 17. The others are 1105 = 5 · 13 · 17, 2821=7·13 · 31, and 15841=7·31·73. Two years later he presented 11 more having three prime factors and discovered one absolute pseudo­ prime with four factors, specifically, 16046641 = 13 · 37 · 73 · 457. To see that 561 = 3 · 11 · 17 must be an absolute pseudoprime, notice that gcd(a, 561) = 1 gives gcd(a, 3) = gcd(a, 11) = gcd(a, 17) = 1 An application of Fermat's theorem leads to the congruences a2 _ 1 (mod 3) a10 _ 1 (mod 11) a16 _ 1 (mod 17) and, in turn, to a560 = (a2)2so = 1 (mod 3) a560 _ (a10)56 _ 1 (mod 11) a560 _ (a 16)35 _ 1 (mod 17) These give rise to the single congruence a560 = 1 (mod 561), where gcd(a, 561) = 1. But then a561 =a (mod 561) for all a, showing 561 to be an absolute pseudoprime. Any absolute pseudoprime is square-free. This is easy to prove. Suppose that an = a (mod n) for every integer a, but k2 I n for some k > 1. If we let a = k, then kn = k (mod n). Because k2 In, this last congruence holds modulo k2; that is, k = kn - 0 (mod k2), whence k2 I k, which is impossible. Thus, n must be square-free. Next we present a theorem that furnishes a means for producing absolute pseudoprimes. Theorem 5.3. Let n be a composite square-free integer, say, n = P1P2 · · · p,, where the Pi are distinct primes. If Pi - 1 I n - 1 for i = 1, 2, ... , r, then n is an absolute pseudo prime. 92 ELEMENTARY NUMBER THEORY Proof. Suppose that a is an integer satisfying gcd(a, n) = 1, so that gcd(a, pJ = 1 for each i. Then Fermat's theorem yields Pi I aPi-l - 1. From the divisibility hy­ pothesis Pi - 11 n - 1, we have Pi I an-l - 1, and therefore Pi I an - a for all a and i = 1, 2, ... , r. As a result of Corollary 2 to Theorem 2.4, we end up with n I an - a, which makes n an absolute pseudoprime. Examples of integers that satisfy the conditions of Theorem 5.3 are 1729 = 7. 13 . 19 6601 = 7 . 23 . 41 10585 = 5. 29. 73 It was proven in 1994 that infinitely many absolute pseudoprimes exist, but that they are fairly rare. There are just 43 of them less than one million, and 105 212 less than 1015. PROBLEMS 5.2 1. Use Fermat's theorem to verify that 17 divides 111 04 + 1. 2. (a) If gcd(a, 35) = 1, show that a12 = 1 (mod 35). [Hint: From Fermat's theorem a6 = 1 (mod 7) and a4 = 1 (mod 5).] (b) If gcd(a, 42) = 1, show that 168 = 3 · 7 · 8 divides a6 - 1. (c) If gcd(a, 133) = gcd(b, 133) = 1, show that 1331 a18 - b18. 3. From Fermat's theorem deduce that, for any integer n 2: 0, 13 I 1112n+6 + 1. 4. Derive each of the following congruences: (a) a21 = a (mod 15) for all a. [Hint: By Fermat's theorem, as = a (mod 5).] (b) a1=a (mod 42) for all a. (c) a13 =a (mod 3 · 7 · 13) for all a. (d) a9 =a (mod 30) for all a. 5. If gcd(a, 30) = 1, show that 60 divides a4 + 59. 6. (a) Find the units digit of 31 00 by the use of Fermat's theorem. (b) For any integer a, verify that as and a have the same units digit. 7. lf 7Ja,prove that either a3+1 or a3- 1 is divisible by 7. 8. The three most recent appearances of Halley's comet were in the years 1835, 1910, and 1986; the next occurrence will be in 2061. Prove that 18351910 + 19862 061 = 0 (mod 7) 9. (a) Let p be a prime and gcd(a, p) = 1. Use Fermat's theorem to verify that x = aP-2b (mod p) is a solution of the linear congruence ax = b (mod p ). (b) By applying part (a), solve the congruences 2x = 1 (mod 31), 6x = 5 (mod 11), and 3x = 17 (mod 29). 10. Assuming that a and b are integers not divisible by the prime p, establish the following: (a) If aP = bP (mod p), then a = b (mod p). (b) If aP = bP (mod p), then aP = bP (mod p2). [Hint: By (a), a = b + pk for some k, so that aP - bP = (b + pk )P - bP; now show that p2 divides the latter expression.] 11. Employ Fermat's theorem to prove that, if pis an odd prime, then (a) IP-1 + 2p-l + 3p-l + ... + (p - l)P-l = -1 (mod p). (b) IP+ 2P + 3P + ... + (p - l)P = O (mod p). [Hint: Recall the identity 1 + 2 + 3 + · · · + (p - 1) = p(p - 1)/2.] FERMAT'S THEOREM 93 12. Prove that if p is an odd prime and k is an integer satisfying I _:::: k _:::: p - I, then the binomial coefficient ( p ; I) = (-Ii (mod p) 13. Assume that p and q are distinct odd primes such that p - I I q - I. If gcd(a, pq) = I, show that aq-l = I (mod pq). 14. If p and q are distinct primes, prove that pq-l + qp-I = I (mod pq) 15. Establish the statements below: (a) If the number MP = 2P - I is composite, where p is a prime, then MP is a pseudo­ pnme. (b) Every composite number Fn = 22\" + I is a pseudoprime (n = 0, I, 2, ... ). [Hint: By Problem 2I, Section 2.3, 2n+1122\" implies that 22n+i - II 2Fn-l - I; but Fn I 22n+l - l.] 16. Confirm that the following integers are absolute pseudoprimes: (a) 1105 = 5 · 13 · I7. (b) 282I = 7 . 13 . 31. ( c) 2465 = 5 . I 7 . 29. 17. Show that the smallest pseudoprime 34I is not an absolute pseudoprime by showing that 11341¢11 (mod 34I). [Hint: 3I J 11341 - IL] 18. (a) When n = 2p, where p is an odd prime, prove that an-I =a (mod n) for any integer a. (b) For n = I95 = 3 · 5 · I3, verify that an-2 =a (mod n) for any integer a. 19. Prove that any integer of the form n = (6k + I)(I2k + I)(I8k + I) is an absolute pseudoprime if all three factors are prime; hence, I 729 = 7 · I3 · I9 is an absolute pseudoprime. 20. Show that 56I 12561 - 2 and 56I 13561 - 3. It is an unanswered question whether there exist infinitely many composite numbers n with the property that n I 2n - 2 and n I 3n - 3. 21. Establish the congruence 22225555 + 55552222 = 0 (mod 7) [Hint: First evaluate I I I I modulo 7.] 5.3 WILSON'S THEOREM We now tum to another milestone in the development of number theory. In his Meditationes Algebraicae of 1770, the English mathematician Edward Waring (1734-1798) announced several new theorems. Foremost among these is an in­ teresting property of primes reported to him by one of his former students, a certain John Wilson. The property is the following: If pis a prime number, then p divides (p - l)! + 1. Wilson appears to have guessed this on the basis of numerical com­ putations; at any rate, neither he nor Waring knew how to prove it. Confessing his inability to supply a demonstration, Waring added, \"Theorems of this kind will be 94 ELEMENTARY NUMBER THEORY very hard to prove, because of the absence of a notation to express prime numbers.\" (Reading the passage, Gauss uttered his telling comment on \"notationes versus no­ tiones,\" implying that in questions of this nature it was the notion that really mattered, not the notation.) Despite Waring's pessimistic forecast, soon afterward Lagrange (1771) gave a proof of what in literature is called \"Wilson's theorem\" and observed that the converse also holds. Perhaps it would be more just to name the theorem after Leibniz, for there is evidence that he was aware of the result almost a century earlier, but published nothing on the subject. Now we give a proof of Wilson's theorem. Theorem 5.4 Wilson. If p is a prime, then (p - 1) ! = -1 (mod p ). Proof. Dismissing the cases p = 2 and p = 3 as being evident, let us take p > 3. Suppose that a is any one of the p - 1 positive integers 1, 2, 3, ... ' p - 1 and consider the linear congruence ax = 1 (mod p ). Then gcd(a, p) = 1. By Theorem 4. 7, this congruence admits a unique solution modulo p; hence, there is a unique integer a', with 1 ::; a' ::; p - 1, satisfying aa' = 1 (mod p). Because p is prime, a = a' if and only if a = 1 or a = p - 1. Indeed, the con­ gruence a2 = 1 (mod p) is equivalent to (a - 1) ·(a+ 1) = 0 (mod p). Therefore, either a - 1 = 0 (mod p ), in which case a = 1, or a + 1 = 0 (mod p ), in which case a=p- 1. If we omit the numbers 1 and p - 1, the effect is to group the remaining integers 2, 3, ... , p - 2 into pairs a, a', where a f. a', such that their product aa' = 1 (mod p). When these (p - 3)/2 congruences are multiplied together and the factors rearranged, we get 2 · 3 · · · (p - 2) = 1 (mod p) or rather (p - 2) ! = 1 (mod p) Now multiply by p - 1 to obtain the congruence (p - l)! = p - 1 = -1 (mod p) as was to be proved. Example 5.1. A concrete example should help to clarify the proof of Wilson's theorem. Specifically, let us take p = 13. It is possible to divide the integers 2, 3, ... , 11 into (p - 3)/2 = 5 pairs, each product of which is congruent to 1 modulo 13. To write these congruences out explicitly: 2 · 7 = 1 (mod 13) 3 · 9 = 1 (mod 13) 4 · 10 = 1 (mod 13) 5 · 8 = 1 (mod 13) 6 · 11 = 1 (mod 13) Multiplying these congruences gives the result FERMAT'S THEOREM 95 11! = (2 · 7)( 3 · 9)(4 · 10)(5 · 8)(6 · 11) = 1(mod13) and so 12! = 12 = -1(mod13) Thus, (p - 1)! = -1 (mod p), with p = 13. The converse of Wilson's theorem is also true. If (n - 1)! = -1 (mod n), then n must be prime. For, if n is not a prime, then n has a divisor d with 1 < d < n. Furthermore, because d .:S n - 1, d occurs as one of the factors in (n - l)!, whence d I (n - 1)!. Now we are assuming that n I (n - 1)! + 1, and so d I (n - 1)! + 1, too. The conclusion is that d 11, which is nonsense. Taken together, Wilson's theorem and its converse provide a necessary and sufficient condition for determining primality; namely, an integer n > 1 is prime if and only if (n - l)! = -1 (modn). Unfortunately, this test is ofmore theoretical than practical interest because as n increases, (n - l)! rapidly becomes unmanageable in size. We would like to close this chapter with an application of Wilson's theorem to the study of quadratic congruences. [It is understood that quadratic congruence means a congruence of the form ax2 + bx + c = 0 (mod n ), with a ¢. 0 (mod n ). ] This is the content of Theorem 5.5. Theorem 5.5. The quadratic congruence x2 + 1 = 0 (mod p ), where p is an odd prime, has a solution if and only if p = 1 (mod 4). Proof. Let a be any solution of x2 + 1 = 0 (mod p ), so that a2 = -1 (mod p ). Because p J a, the outcome of applying Fermat's theorem is 1 = ap-1 = (a2)(p-l)/2 = (-l)(p-1)/2 (mod p) The possibility that p = 4k + 3 for some k does not arise. If it did, we would have (-lip-1)/2 = (-1)2k+l = -l hence, 1 = -1 (mod p ). The net result of this is that p 12, which is patently false. Therefore, p must be of the form 4k + 1. Now for the opposite direction. In the product p- 1 p+l (p - l)! = 1 . 2 ... - 2- . - 2- ... (p - 2)(p - 1) we have the congruences p - 1 = -1 (mod p) p - 2 = -2 (mod p) p+l p- 1 -- = - -- (mod p) 2 2 96 ELEMENTARY NUMBER THEORY Rearranging the factors produces p- 1 ( p- 1) (p - 1)! = 1· (-1)·2-(-2)-· · - 2-· - - 2- (mod p) p- 1 ( ) 2 =(-l)(p-l)/2 1·2··· - 2- (mod p) because there are (p - 1)/2 minus signs involved. It is at this point that Wilson's theorem can be brought to bear; for, (p - 1)! = -1 (mod p), whence -1 = (-J}'p-l)/2 [ ( p � 1) iJ' (mod p) If we assume that pis of the form 4k + 1, then (-l)Cp-l)/2 = 1, leaving us with the congruence -I= [( p � 1}] ' (mod p) The conclusion is that the integer [ (p - 1) /2] ! satisfies the quadratic congruence x 2 + 1 = 0 (mod p). Let us take a look at an actual example, say, the case p = 13, which is a prime of the form 4k + 1. Here, we have (p - 1)/2 = 6, and it is easy to see that 6! = 720 = 5 (mod 13) and 52 + 1 = 26 _ 0 (mod 13) Thus, the assertion that [((p - 1)/2)!]2 + 1 = 0 (mod p) is correct for p = 13. Wilson's theorem implies that there exists an infinitude of composite numbers of the form n ! + 1. On the other hand, it is an open question whether n ! + 1 is prime for infinitely many values of n. The only values of n in the range 1 < n .::::: 100 for which n! + 1 is known to be a prime number are n = 1, 2, 3, 11, 27, 37, 41, 73, and 77. Currently, the largest prime of the form n! + 1 is 6380! + 1, discovered in 2000. PROBLEMS 5.3 1. (a) Find the remainder when 15! is divided by 17. (b) Find the remainder when 2(26!) is divided by 29. 2. Determine whether 17 is a prime by deciding whether 16! = -1 (mod 17). 3. Arrange the integers 2, 3, 4, ... , 21 in pairs a and b that satisfy ab= 1 (mod 23) . 4. Show that 18! = -1 (mod 437). 5. (a) Prove that an integer n > 1 is prime if and only if (n - 2)! = 1 (mod n) . (b) If n is a composite integer, show that (n - 1)! = 0 (mod n) , except when n = 4. 6. Given a prime number p, establish the congruence (p - l)! = p - 1 (mod 1 + 2 + 3 + · · · + (p - 1)) 7. If p is a prime, prove that for any integer a, FERMAT'S THEOREM 97 p I a P + (p - 1) !a and p I (p - l)!aP +a [Hint: By Wilson's theorem, aP + (p - l)!a = aP - a (mod p).] 8. Find two odd primes p ::; 13 for which the congruence (p - 1)! = -1 (mod p2) holds. 9. Using Wilson's theorem, prove that for any odd prime p, 1 2 · 32 · 52 · · · (p - 2)2 = (-l)(p+l)/2 (mod p) [Hint: Because k = -(p - k) (mod p), it follows that 2 · 4 · 6 · · · (p - 1) = (-l)(p-l)/21·3 · 5 · · · (p - 2) (mod p).] 10. (a) For a prime p of the form 4k + 3, prove that either ( p � 1) ! = 1 (mod p) or ( p � 1) ! = -1 (mod p) hence, [(p - 1)/2] ! satisfies the quadratic congruence x2 = 1 (mod p). (b) Use part (a) to show that if p = 4k + 3 is prime, then the product of all the even integers less than p is congruent modulo p to either 1 or -1. [Hint: Fermat's theorem implies that 2Cp-l)/2 = ±1 (mod p).] 11. Apply Theorem 5 .5 to obtain two solutions to each of the quadratic congruences x2 = -1 (mod 29) and x2 = -1 (mod 37). 12. Show that if p = 4k + 3 is prime and a2 + b2 = 0 (mod p ), then a = b = 0 (mod p ). [Hint: If a ¢. 0 (mod p ), then there exists an integer c such that ac = 1 (mod p )� use this fact to contradict Theorem 5.5.] 13. Supply any missing details in the following proof of the irrationality of -J2: Suppose ,J2 = a/b, with gcd(a, b) = 1. Then a2 = 2b2, so that a2 + b2 = 3b2. But 31 (a2 + b2) implies that 3 I a and 3 I b, a contradiction. 14. Prove that the odd prime divisors of the integer n2 + 1 are of the form 4k + 1. [Hint: Theorem 5.5.] 15. Verify that 4(29 !) + 5 ! is divisible by 31. 16. For a prime p and 0 ::; k ::; p - 1, show that k!(p - k - 1)! = (-l)k+1 (mod p ). 17. If p and q are distinct primes, prove that for any integer a, pq I aPq - aP - aq + a 18. Prove that if p and p + 2 are a pair of twin primes, then 4((p - 1)! + 1) + p = 0 (mod p(p + 2)) 5.4 THE FERMAT-KRAITCHIK FAC T ORIZATION METH OD In a fragment of a letter, written in all probability to Father Marin Mersenne in 1643, Fermat described a technique of his for factoring large numbers. This represented the first real improvement over the classical method of attempting to find a factor of n by dividing by all primes not exceeding ,Jn. Fermat's factorization scheme has at its heart the observation that the search for factors of an odd integer n (because powers of 2 are easily recognizable and may be removed at the outset, there is no loss in assuming that n is odd) is equivalent to obtaining integral solutions x and y of the equation n = x 2 - y 2 98 ELEMENTARY NUMBER THEORY If n is the difference of two squares, then it is apparent that n can be factored as n = x2 - y2 = (x + y )(x - y) Conversely, when n has the factorization n = ab, with a > b � 1, then we may write Moreover, because n is taken to be an odd integer, a and b are themselves odd; hence (a+ b)/2 and (a - b)/2 will be nonnegative integers. One begins the search for possible x and y satisfying the equation n = x2 - y2, or what is the same thing, the equation x2 - n = y2 by first determining the smallest integer k for which k2 � n. Now look successively at the numbers k2 - n, (k + 1)2 - n, (k + 2)2 - n, (k + 3 )2 - n, ... until a value of m > ,Jn is found making m2 - n a square. The process cannot go on indefinitely, because we eventually arrive at the representation of n corresponding to the trivial factorization n = n · 1. If this point is reached without a square difference having been discovered earlier, then n has no factors other than n and 1, in which case it is a prime. Fermat used the procedure just described to factor 2027651281 = 44021 . 46061 in only 11 steps, as compared with making 4580 divisions by the odd primes up to 44021. This was probably a favorable case devised on purpose to show the chief virtue of his method: It does not require one to know all the primes less than ,Jn to find factors of n. Example 5.2. To illustrate the application of Fermat's method, let us factor the inte­ ger n = 119143. From a table of squares, we find that 3452 < 119143 < 3462; thus it suffices to consider values of k2 - 119143 for those k that satisfy the inequality 346.::::: k < (119143 + 1)/2 = 59572. The calculations begin as follows: 3462 - 119143 = 119716 - 119143 = 573 347 2 - 119143 = 120409 - 119143 = 1266 348 2 - 119143 = 121104 - 119143 = 1961 349 2 - 119143 = 121801 - 119143 = 2658 3502 - 119143 = 122500 - 119143 = 3357 351 2 - 119143 = 123201 - 119143 = 4058 352 2 - 119143 = 123904 - 119143 = 4761 = 692 This last line exhibits the factorization FERMAT'S THEOREM 99 119143 = 352 2 - 69 2 = (352 + 69)(352 - 69) = 421 . 283 the two factors themselves being prime. In only seven trials, we have obtained the prime factorization of the number 119143. Of course, one does not always fare so luckily; it may take many steps before a difference turns out to be a square. Fermat's method is most effective when the two factors of n are of nearly the same magnitude, for in this case a suitable square will appear quickly. To illustrate, let us suppose that n = 23449 is to be factored. The smallest square exceeding n is 1542, so that the sequence k2 - n starts with 1542 - 23449 = 23716 - 23449 = 267 1552 - 23449 = 24025 - 23449 = 576 = 242 Hence, factors of 23449 are 23449 = (155 + 24)(155 - 24) = 179 . 131 When examining the differences k2 - n as possible squares, many values can be immediately excluded by inspection of the final digits. We know, for instance, that a square must end in one of the six digits 0, 1, 4, 5, 6, 9 (Problem 2(a), Section 4.3). This allows us to exclude all values in Example 5.2, save for 1266, 1961, and 4761. By calculating the squares of the integers from 0 to 99 modulo 100, we see further that, for a square, the last two digits are limited to the following 22 possibilities: 00 01 04 09 16 21 24 25 29 36 41 44 49 56 61 64 69 76 81 84 89 96 The integer 1266 can be eliminated from consideration in this way. Because 61 is among the last two digits allowable in a square, it is only necessary to look at the numbers 1961 and 4761; the former is not a square, but 4761 = 692. There is a generalization of Fermat's factorization method that has been used with some success. Here, we look for distinct integers x and y such that x2 - y2 is a multiple of n rather than n itself; that is, x 2 = y2 (mod n) Having obtained such integers, d = gcd(x - y, n) (or d = gcd(x + y, n)) can be calculated by means of the Euclidean Algorithm. Clearly, dis a divisor of n, but is it a nontrivial divisor? In other words, do we have 1 < d < n? In practice, n is usually the product of two primes p and q, with p < q, so that d is equal to 1, p, q, or pq. Now the congruence x2 - y2 (mod n) translates into pq I (x - y )(x + y ). Euclid's lemma tells us that p and q must divide one of the factors. If it happened that p I x - y and q I x - y, then pq I x - y, or expressed as 100 ELEMENTARY NUMBER THEORY a congruence x = y (mod n). Also, p Ix+ y and q Ix+ y yield x = -y (mod n). By seeking integers x and y satisfying x2 _ y2 (mod n), where x ¥= ±y (mod n), these two situations are ruled out. The result of all this is that d is either p or q, giving us a nontrivial divisor of n. Example 5.3. Suppose we wish to factor the positive integer n = 2189 and happen to notice that 5792 - 182 (mod 2189). Then we compute gcd(579 - 18, 2189) = gcd(561, 2189) = 11 using the Euclidean Algorithm: 2189 = 3. 561 + 506 561 = 1 . 506 + 55 506 = 9 . 55 + 11 55 = 5. 11 This leads to the prime divisor 11 of 2189. The other factor, namely 199, can be obtained by observing that gcd(579 + 18, 2189) = gcd(597, 2189) = 199 The reader might wonder how we ever arrived at a number, such as 579, whose square modulo 2189 also turns out to be a perfect square. In looking for squares close to multiples of 2189, it was observed that 812 - 3 · 2189 = -6 and 155 2 - 11·2189 = -54 which translates into 81 2 _ -2 · 3 (mod 2189) and 1552 _ -2 · 33 (mod 2189) When these congruences are multiplied, they produce (81 · 155) 2 _ (2 · 32) 2 (mod 2189) Because the product 81 · 155 = 12555 _ -579 (mod 2189), we ended up with the congruence 5792 _ 182 (mod 2189). The basis of our approach is to find several xi having the property that each xf is, modulo n, the product of small prime powers, and such that their product's square is congruent to a perfect square. When n has more than two prime factors, our factorization algorithm may still be applied; however, there is no guarantee that a particular solution of the congruence x2 = y 2 (mod n), with x ¥= ±y (mod n), will result in a nontrivial divisor of n. Of course the more solutions of this congruence that are available, the better the chance of finding the desired factors of n. Our next example provides a considerably more efficient variant of this last factorization method. It was introduced by Maurice Kraitchik in the 1920s and became the basis of such modem methods as the quadratic sieve algorithm. Example 5.4. Let n = 12 499 be the integer to be factored. The first square just larger than n is 1122 = 12 54 4. So we begin by considering the sequence of numbers x2 - n FERMAT'S THEOREM 101 for x = 112, 113, .... As before, our interest is in obtaining a set of values x1, x2 , ... , Xk for which the product (xi - n) · · · (xk - n) is a square, say y2. Then (x1 · · · xk)2 = y2 (mod n) , which might lead to a nontrivial factor of n. A short search reveals that 1122 - 12499 = 45 117 2 - 12499 = 1190 1212 - 12499 = 2142 or, written as congruences, 1122 - 32 · 5 (mod 12499) 1172 = 2 · 5 · 7 · 17 (mod 12499) 1212 = 2 · 32 · 7 · 17 (mod 12499) Multiplying these together results in the congruence (112 · 117 · 121) 2 = (2 · 32 · 5 · 7 · 17) 2 (mod 12499) that is, 1585584 2 = 107102 (mod 12499) But we are unlucky with this square combination. Because 1585584 = 10710 (mod 12499) only a trivial divisor of 12499 will be found. To be specific, gcd(1585584 + 10710, 12499) = 1 gcd(1585584 - 10710, 12499) = 12499 After further calculation, we notice that 1132 = 2 · 5 · 33 (mod 12499) 127 2 = 2. 3. 5. 112 (mod 12499) which gives rise to the congruence (113 . 127)2 = (2 · 32 · 5 · 11) 2 (mod 12499) This reduces modulo 12499 to 1852 2 = 9902 (mod 12499) and fortunately 1852 ¢ ± 990 (mod 12499). Calculating gcd(1852 - 990, 12499) = gcd(862, 12499) = 431 produces the factorization 12499 = 29 · 431. 102 ELEMENTARY NUMBER THEORY PROBLEMS 5.4 1. Use Fermat's method to factor each of the following numbers: (a) 2279. (b) 10541. (c) 340663 [Hint: The smallest square just exceeding 340663 is 5842 .] 2. Prove that a perfect square must end in one of the following pairs of digits: 00, 01, 04, 09, 16, 21, 24, 25, 29, 36, 41, 44, 49, 56, 61, 64, 69, 76, 81, 84, 89, 96. [Hint: Because x2 = (50 + x)2 (mod 100) and x2 = (50 - x)2 (mod 100), it suffices to examine the final digits of x2 for the 26 values x = 0, 1, 2, ... , 25.] 3. Factor the number 211 - 1 by Fermat's factorization method. 4. In 1647, Mersenne noted that when a number can be written as a sum of two relatively prime squares in two distinct ways, it is composite and can be factored as follows: If n = a2 + b2 = c2 + d2, then (ac + bd)(ac - bd) n= (a+ d)(a - d) Use this result to factor the numbers 493 = 182 + 132 = 222 + 32 and 38025 = 1682 + 992 = 1562 + 1172 5. Employ the generalized Fermat method to factor each of the following numbers: (a) 2911 [Hint: 1382 = 672 (mod 2911).] (b) 4573 [Hint: 1772 = 922 (mod 4573).] (c) 6923 [Hint: 2082 = 932 (mod 6923).] 6. Factor 13561 with the help of the congruences 2332 = 32 · 5 (mod 13561) and 12812 = 24 · 5 (mod 13561) 7. (a) Factor the number 4537 by searching for x such that x2 - k · 4537 is the product of small prime powers. (b) Use the procedure indicated in part (a) to factor 14429. [Hint: 1202 - 14429 = -29 and 30032 - 625 · 14429 = -116.] 8. Use Kraitchik's method to factor the number 20437. CHAPTER 6 NUMBER-THEORETIC FUNCTIONS Mathematicians are like Frenchmen: whatever you say to them they translate into their own language and forthwith it is something entirely different. GOETHE 6.1 THE SUM AND NUMBER OF DIVISORS Certain functions are found to be of special importance in connection with the study of the divisors of an integer. Any function whose domain of definition is the set of positive integers is said to be a number-theoretic (or arithmetic) function. Although the value of a number-theoretic function is not required to be a positive integer or, for that matter, even an integer, most of the number-theoretic functions that we shall encounter are integer-valued. Among the easiest to handle, and the most natural, are the functions r and a. Definition 6.1. Given a positive integer n, let r(n) denote the number of positive divisors of n and cr(n) denote the sum of these divisors. For an example of these notions, consider n = 12. Because 12 has the positive divisors 1, 2, 3, 4, 6, 12, we find that r(12) = 6 and a(12) = 1 + 2 + 3 + 4 + 6 + 12 = 28 For the first few integers, r(l) = 1 r(2) = 2 r(3) = 2 r(4) = 3 r(S) = 2 r(6) = 4, ... 103 104 ELEMENTARY NUMBER THEORY and a(l) = 1, a(2) = 3, a(3) = 4, a(4) = 7, a(5) = 6, a(6) = 12, ... It is not difficult to see that r(n) = 2 if and only if n is a prime number; also, a(n) = n + 1 if and only if n is a prime. Before studying the functions r and a in more detail, we wish to introduce notation that will clarify a number of situations later. It is customary to interpret the symbol L:1cd) din to mean, \"Sum the values f(d) as d runs over all the positive divisors of the positive integer n .\" For instance, we have L f(d) = f(l) + f(2) + f(4) + f(5) + f(lO) + f(20) dl20 With this understanding, r and a may be expressed in the form r(n) = L 1 din The notation Ld 1 n l, in particular, says that we are to add together as many 1 's as there are positive divisors of n. To illustrate: the integer 10 has the four positive divisors 1, 2, 5, 10, whence and r(lO) = L 1 = 1 + 1 + 1 + 1 = 4 d 110 a(lO) = L d = 1 + 2 + 5 + 10 = 18 d 110 Our first theorem makes it easy to obtain the positive divisors of a positive integer n once its prime factorization is known. Theorem 6.1. If n = p� 1 p�2 • • • p�' is the prime factorization of n > 1, then the pos­ itive divisors of n are precisely those integers d of the form d a1 a2 a, = P1 P2 ··· Pr where 0 S ai Ski (i = 1, 2, ... , r). Proof. Note that the divisor d = 1 is obtained when a1 = a2 = · · · = ar = 0, and n itself occurs when ai = ki, a1 = k1, ... , ar = kr. Suppose that d divides n nontriv­ ially; say, n = dd', where d > 1, d' > 1. Express both d and d' as products of (not necessarily distinct) primes: with qi, t j prime. Then 106 ELEMENTARY NUMBER THEORY Corresponding to the L notation for sums, the notation for products may be defined using TI, the Greek capital letter pi. The restriction delimiting the numbers over which the product is to be made is usually put under the TI sign. Examples are n f(d) = f(l)f(2)f(3)f(4)f (5) n f(d) = f (l)f(3)f(9) dl9 n f(p) = f(2)f(3)f(5) p 130 p prime With this convention, the conclusion to Theorem 6.2 takes the compact form: if n = p�1 p�2 ••• p�' is the prime factorization of n > 1, then and r(n) = n (k; + 1) l::::i::::r n pk;+l -1 a(n)= _i -- p. -1 l::::i:::r l Example 6.1. The number 180 = 22 . 32 . 5 has r(l80) = (2 + 1)(2 + 1)(1 + 1) = 18 positive divisors. These are integers of the form where a1 = 0, 1, 2; a2 = 0, 1, 2; and a3 = 0, 1. Specifically, we obtain 1,2,3,4,5,6,9, 10, 12, 15, 18,20,30,36,45,60,90, 180 The sum of these integers is 23 -1 33 -1 52 -1 7 26 24 a(l80) = = - - - = 7 · 13 · 6 = 546 2-1 3-1 5-1 1 2 4 One of the more interesting properties of the divisor function r is that the product of the positive divisors of an integer n > 1 is equal to n r(n)/2. It is not difficult to get at this fact: Let d denote an arbitrary positive divisor of n, so that n = dd' for some d'. As d ranges over all r(n) positive divisors of n, r(n) such equations occur. Multiplying these together, we get nr(n)= nd· nd' d In d' In NUMBER-THEORETIC FUNCTIONS 107 But as d runs through the divisors of n, so does d'; hence, fld In d = fld' In d'. The situation is now this: or equivalently n•(n) = (n d) 2 din n•(n)/2 = n d din The reader might (or, at any rate, should) have one lingering doubt concerning this equation. For it is by no means obvious that the left-hand side is always an integer. If r(n) is even, there is certainly no problem. When r(n) is odd, n turns out to be a perfect square (Problem 7, Section 6.1), say, n = m2; thus n•(n)/2 = m«n>, settling all suspicions. For a numerical example, the product of the five divisors of 16 (namely, 1, 2, 4, 8, 16) is n d = 16'(16)/2 = 16512 = 45 = 1024 d 116 Multiplicative functions arise naturally in the study of the prime factorization of an integer. Before presenting the definition, we observe that r(2 · 10) = r(20) = 6 #- 2 · 4 = r(2) · r(lO) At the same time, a (2 · 10) = a (20) = 42 #- 3 · 18 = a (2) · a (lO) These calculations bring out the nasty fact that, in general, it need not be true that r(mn) = r(m)r(n) and a (mn) = a (m)a (n) On the positive side of the ledger, equality always holds provided we stick to rela­ tively prime m and n. This circumstance is what prompts Definition 6.2. Definition 6.2. A number-theoretic function f is said to be multiplicative if f(mn) = f(m)f(n) whenever gcd(m , n) = 1. For simple illustrations of multiplicative functions, we need only consider the functions given by f (n) = 1 and g (n) = n for all n :=:: 1. It follows by induction that if f is multiplicative and n1, n2, .•• , nr are positive integers that are pairwise relatively prime, then Multiplicative functions have one big advantage for us: they are completely determined once their values at prime powers are known. Indeed, if n > 1 is a given positive integer, then we can write n = p�1 p�2 • • • p�' in canonical form; because the 108 ELEMENTARY NUMBER THEORY p�; are relatively prime in pairs, the multiplicative property ensures that f(n) = f(p�1)f(p;2) • • • f(p;') If f is a multiplicative function that does not vanish identically, then there exists an integer n such that f (n) \"I- 0. But f(n) = f (n · 1) = f (n)f( l) Being nonzero, f (n) may be canceled from both sides of this equation to give f (1) = 1. The point to which we wish to call attention is that f ( 1) = 1 for any multiplicative function not identically zero. We now establish that r and a have the multiplicative property. Theorem 6.3. The functions r and <J are both multiplicative functions. Proof. Let rn and n be relatively prime integers. Because the result is trivially true if either rn or n is equal to 1, we may assume that rn > 1 and n > 1. If and n _ qjiqjz qjs - 1 2 ... s are the prime factorizations of rn and n, then because gcd(rn, n) = 1, no Pi can occur among the qj. It follows that the prime factorization of the product rnn is given by ki kr h js rnn = P1 · · ·Pr ql · · · qs Appealing to Theorem 6.2, we obtain r(mn) = [(k1 + 1) · · · (kr + l)][(ji + 1) ···Us + l)] = r(rn)r(n) In a similar fashion, Theorem 6.2 gives <J(rnn) = · · · · · · ---[ p�1+l _ 1 p�r+l _ 1] [q{1+l _ 1 qfs+l _ 1] PI - 1 Pr - 1 qi - 1 qs - 1 = <J(rn )<J (n) Thus, r and <J are multiplicative functions. We continue our program by proving a general result on multiplicative functions. This requires a preparatory lemma. Lemma. If gcd(rn, n) = 1, then the set of positive divisors of rnn consists of all products did2, where di I rn, dz In and gcd(d1, dz)= 1; furthermore, these products are all distinct. Proof. It is harmless to assume that rn > 1 and n > 1; let rn = p�1 p�2 ••• p�r and n = q{1 q�2 • • • qf be their respective prime factorizations. Inasmuch as the primes PI, ... , Pr, qi, ... , qs are all distinct, the prime factorization of rnn is ki k j1 j rnn = P1 · · · p/q1 · · ·q/ Hence, any positive divisor d of rnn will be uniquely representable in the form NUMBER-THEORETIC FUNCTIONS 109 This allows us to write d as d = d1d2, where d1 = p�1 • • • p�r divides m and d2 = qf1 • • • q%' divides n. Because no Pi is equal to any qj, we surely must have gcd(d1 , d1) = 1. A keystone in much of our subsequent work is Theorem 6.4. Theorem 6.4. If f is a multiplicative function and F is defined by F(n) = L f(d) din then F is also multiplicative. Proof. Let m and n be relatively prime positive integers. Then F(mn) = L f(d) dlmn = I: J(d1d2) di Im d1 In because every divisor d of mn can be uniquely written as a product of a divisor d1 of m and a divisor d2 of n, where gcd(d1 , d2) = 1. By the definition of a multiplicative function, It follows that F(mn) = L f(d1)f(d2) di Im d1 In = F(m)F(n) It might be helpful to take time out and run through the proof of Theorem 6.4 in a concrete case. Letting m = 8 and n = 3, we have F(8 . 3) = L f (d) dl24 = f(l) + f(2) + f(3) + f(4) + f(6 ) + f(8) + f(l2) + f (24) = f(I . 1) + f (2. 1) + f(l . 3) + f(4. 1) + f(2. 3) + f (8. 1) + f (4. 3) + f (8. 3) = f (l)f (1) + f (2)f (1) + f (I)f (3) + f (4)f (1) + f (2)f (3) + f(8)f(l) + f(4)f(3) + f (8)f (3) = [f(l) + f (2) + f(4) + f(8)][f(l) + f(3)] = L f (d). L f (d) = F(8)F(3) dl8 dl3 110 ELEMENTARY NUMBER THEORY Theorem 6.4 provides a deceptively short way of drawing the conclusion that r and a are multiplicative. Corollary. The functions r and CJ are multiplicative functions. Proof. We have mentioned that the constant function f(n) = 1 is multiplicative, as is the identity function f(n) = n. Because r and CJ may be represented in the form r(n) = L 1 and CJ(n) = L d din din the stated result follows immediately from Theorem 6.4. PROBLEMS 6.1 1. Let m and n be positive integers and p1, p2, ... , Pr be the distinct primes that divide at least one of morn. Then m and n may be written in the form Prove that ki kz k, m = Pi P2 ··· Pr n = p{I p�2 ... p/' with ki =:::: 0 for i = 1, 2, ... , r with ji =:::: 0 for i = 1, 2, ... , r gcd(m, n) = p�1 p;2 • • • p�' lcm(m, n) = P? p�2 • • • p�' where ui =min {ki, j;}, the smaller of ki and ji; and Vi= max {ki, ji}, the larger of ki and ji. 2. Use the result of Problem 1 to calculate gcd(12378, 3054) and lcm(12378, 3054). 3. Deduce from Problem 1 that gcd(m, n) lcm(m, n) = mn for positive integers m and n. 4. In the notation of Problem 1, show that gcd(m, n) = 1 if and only if ki ji = 0 for i = 1, 2, ... , r. 5. (a) Verify that r(n) = r(n + 1) = r(n + 2) = r(n + 3) holds for n = 3655 and 4503. (b) When n = 14, 206, and 957, show that CJ(n) = CJ(n + 1). 6. For any integer n =:::: 1, establish the inequality r(n) :S 2,Jll. [Hint: If d In, then one of d or n/d is less than or equal to Jn.] 7. Prove the following. (a) r(n) is an odd integer if and only if n is a perfect square. (b) CJ(n) is an odd integer if and only if n is a perfect square or twice a perfect square. [Hint: If p is an odd prime, then 1 + p + p2 + · · · + pk is odd only when k is even.] 8. Show that Ld 1 n 1 / d = CJ (n) / n for every positive integer n. 9. If n is a square-free integer, prove that r(n) = 2r, where r is the number of prime divisors of n. 10. Establish the assertions below: (a) If n = p�1 p�2 • • • p�' is the prime factorization of n > 1, then 1 > _n > (1 - __!__) (1 - __!__) · · · (1 - __!__) CJ(n) Pl P2 Pr (b) For any positive integer n, [Hint: See Problem 8.] CJ(n!) 1 1 1 -- >1+-+-+ ··· +- n! - 2 3 n (c) If n > 1 is a composite number, then CJ(n) > n +Jn. [Hint: Let d In, where 1 < d < n, so 1 < n/d < n. If d :S Jn, then n/d =:::: Jn.] NUMBER-THEORETIC FUNCTIONS 111 11. Given a positive integer k > 1, show that there are infinitely many integers n for which r(n) = k, but at most finitely many n with a(n) = k. [Hint: Use Problem lO(a). ] 12. (a) Find the form of all positive integers n satisfying r(n) = 10. What is the smallest positive integer for which this is true? (b) Show that there are no positive integers n satisfying a(n) = 1 0. [Hint: Note that for n > 1, a(n) > n.] 13. Prove that there are infinitely many pairs of integers m and n with a(m2) = a(n2). [Hint: Choose k such that gcd(k, 1 0) = 1 and consider the integers m = 5k, n = 4k. ] 14. For k 2: 2, show each of the following: (a) n = 2k-I satisfies the equation a(n) = 2n - 1. (b) If 2k - 1 is prime, then n = 2k-I (2k - 1) satisfies the equation a (n) = 2n. (c) If 2k - 3 is prime, then n = 2k-1(2k - 3) satisfies a(n) = 2n + 2. It is not known if there are any positive integers n for which a (n) = 2n + 1. 15. If n and n + 2 are a pair of twin primes, establish that a(n + 2) = a(n) + 2; this also holds for n = 434 and 8575. 16. (a) For any integer n > 1, prove that there exist integers n1 and n 2 for which r(n1) + r(n2) = n. (b) Prove that the Goldbach conjecture implies that for each even integer 2n there exist integers ni and n1 with a(n1) + a(n2) = 2n. 17. For a fixed integer k, show that the function f defined by f(n) = nk is multiplicative. 18. Let f and g be multiplicative functions that are not identically zero and have the property that f(pk) = g(pk) for each prime p and k 2: 1. Prove that f = g. 19. Prove that if f and g are multiplicative functions, then so is their product f g and quotient f / g (whenever the latter function is defined). 20. Let w(n) denote the number of distinct prime divisors of n > 1, with w(l) = 0. For instance, w(360) = w(23 · 32 · 5) = 3. (a) Show that 2w(n) is a multiplicative function. (b) For a positive integer n, establish the formula r(n2) = L 2w(d) din 21. For any positive integer n, prove that Ld 1 n r(d)3 = (Ld 1 n r(d))2. [Hint: Both sides of the equation in question are multiplicative functions of n, so that it suffices to consider the case n = pk, where pis a prime. ] 22. Given n 2: 1, let as(n) denote the sum of the sth powers of the positive divisors of n; that is, Verify the following: (a) ao =rand a1 = a. as(n) = Lds din (b) as is a multiplicative function. [Hint: The function f, defined by f(n) = ns, is multiplicative. ] ( c) If n = p�1 p�2 • • • p�r is the prime factorization of n, then a n = (P�(k1+l) _ l) (P�(k2+1) _ l) ... (p:<kr+l) _ l) s( ) s 1 s 1 s 1 P1 - P2 - Pr - 112 ELEMENTARY NUMBER THEORY 23. For any positive integer n, show the following: (a) Ldln a(d) = Ldln(n/d)r(d). (b) Ldln(n/d)a(d) = Ldln dr(d). [Hint: Because the functions F(n) = L a(d) and din G(n) = L !!_r(d) din d are both multiplicative, it suffices to prove that F(pk) = G(pk) for any prime p.] 6.2 THE MOBIUS INVERSION FORMULA We introduce another naturally defined function on the positive integers, the Mobius µ.,-function. Definition 6.3. For a positive integer n, defineµ by the rules µ(n) = { � (- 1)' if n = 1 if p2 I n for some prime p if n = P1P2 · · · Pn where Pi are distinct primes Put somewhat differently, Definition 6.3 states that µ.,(n) = 0 if n is not a square­ free integer, whereas µ.,(n) = ( -1)' if n is square-free with r prime factors. For example: µ.,(30) = µ.,(2 · 3 · 5) = ( -1 )3 = -1. The first few values ofµ., are µ.,(1) = 1 µ.,(2) = -1 µ.,(3) = -1 µ.,(4) = 0 µ.,(5) = -1 µ.,(6) = 1, ... If p is a prime number, it is clear that µ.,(p) = -1; in addition, µ,(pk) = 0 fork > 2. As the reader may have guessed already, the Mobius µ.,-function is multiplicative. This is the content of Theorem 6.5. Theorem 6.5. The function µ is a multiplicative function. Proof. We want to show that µ(mn) = µ(m )µ(n ), whenever m and n are rela­ tively prime. If either p2 Im or p2 In, p a prime, then p2 I mn; hence, µ(mn) = 0 = µ(m)µ(n), and the formula holds trivially. We therefore may assume that both m and n are square-free integers. Say, m = P1P2 · · · p7, n = qiq2 · · · qs, with all the primes Pi and q j being distinct. Then µ(mn) = µ(p1 · · · Prql · · · qs) = (-ly+s = ( - 1)' ( - lY = µ(m)µ(n) which completes the proof. Let us see what happens if µ.,(d) is evaluated for all the positive divisors d of an integer n and the results are added. In the case where n = 1, the answer is easy; here, z= µ.,(d) = µ.,(l) = 1 d 11 NUMBER-THEORETIC FUNCTIONS 113 Suppose that n > 1 and put F(n) = L µ,(d) din To prepare the ground, we first calculate F (n) for the power of a prime, say, n = pk. The positive divisors of pk are just the k + 1 integers 1, p, p2, ... , pk, so that F(pk) = L µ,(d) = µ,(1) + µ,(p) + µ,(p2) + ... +µ,(pk) d I pk = µ,(1) + µ,(p) = 1+(-1)=0 Because µ, is known to be a multiplicative function, an appeal to Theorem 6.4 is legitimate; this result guarantees that F also is multiplicative. Thus, if the canonical factorization of n is n = p�1 p;2 • • • p�', then F (n) is the product of the values assigned to F for the prime powers in this representation: We record this result as Theorem 6.6. Theorem 6.6. For each positive integer n :'.:'.: 1, I: µ,(d) = { � din ifn = 1 if n > 1 where d runs through the positive divisors of n. For an illustration of this last theorem, consider n = 10. The positive divisors of 10 are 1, 2, 5, 10 and the desired sum is I: µ,(d) = µ,(1) + µ,(2) + µ,(5) +µ,(lo) d 110 = 1 + (-1) + (-1) + 1 = 0 The full significance of the Mobius µ,-function should become apparent with the next theorem. Theorem 6.7 Mobius inversion formula. Let F and f be two number-theoretic functions related by the formula Then F(n) = L f(d) din f(n) = Lµ,(d)F (�)=LIL(�) F(d) din d din d Proof. The two sums mentioned in the conclusion of the theorem are seen to be the same upon replacing the dummy index d by d' = n / d; as d ranges over all positive divisors of n, so does d'. 114 ELEMENTARY NUMBER THEORY Carrying out the required computation, we get Lµ(d)F (�) = L (µ(d) L f(c)) din din cl(n/d) = I: ( I: µ(d)J(c)) din cl(n/d) (1) It is easily verified that d I n and c I (n / d) if and only if c I n and d I (n / c ). Because of this, the last expression in Eq. (1) becomes L ( L µ(d)f(c)) = L ( L f(c)µ(d)) din cl(n/d) cln dl(n/c) = I: (ice) I: µ(d)) c In d I (n/c) (2) In compliance with Theorem 6.6, the sum Ld 1 (n/c) µ(d) must vanish except when n/c = 1 (that is, when n = c), in which case it is equal to 1; the upshot is that the right-hand side of Eq. (2) simplifies to L (f(c) L µ(d)) = L f(c). 1 cln dl(n/c) c=n = f(n) giving us the stated result. Let us use n = 10 again to illustrate how the double sum in Eq. (2) is turned around. In this instance, we find that I: ( I: µ,(d)t (c)) = µ,(l)[J(l) + tc2) + t(5) + t c10)1 dllO cl(lO/d) + µ,(2)[f (1) + f (5)] + µ,(5)[f (1) + f (2)] + µ,(lO)f (1) = f (l)[µ,(l) + µ,(2) + µ,(5) + µ,(10)] + f (2)[µ,(l) + µ,(5)] + f (5)[µ,(1) + µ,(2)] + f (10)µ,(l) = I: ( I: t (c)µ,(d)) cllO dl(lO/c) To see how the Mobius inversion formula works in a particular case, we remind the reader that the functions r and a may both be described as \"sum functions\": r(n) = L 1 and din 116 ELEMENTARY NUMBER THEORY 1963 verified the conjecture for all n up to 10 billion. But in 1984, Andrew Odlyzko and Herman te Riele showed that the Mertens conjecture is false. Their proof, which involved the use of a computer, was indirect and produced no specific value of n for which IM(n)I > ,Jii; all it demonstrated was that such a number n must exist somewhere. Subsequently, it has been shown that there is a counterexample to the Mertens conjecture for at least one n < (3.21)10 64• PROBLEMS 6.2 1. (a) For each positive integer n, show that µ(n)µ(n + l)µ(n + 2)µ(n + 3) = 0 (b) For any integer n :::: 3, show that L�=l µ(k! ) = 1. 2. The Mangoldt function A is defined by A(n) = { � og p if n = pk , where p is a prime and k :::: 1 otherwise Prove that A(n) = Ldln µ(n/d)logd = - Ldln µ(d) log d. [Hint: First show that Ld 1 n A(d) = log n and then apply the Mobius inversion formula.] 3. Let n = p�1 p�2 • • • p;r be the prime factorization of the integer n > 1. If f is a multiplica­ tive function that is not identically zero, prove that L µ(d)f(d) = (1 - f(p1))(l - f(pz)) · · · (1 - f(Pr)) din [Hint: By Theorem 6.4, the function F defined by F(n) = Ld In µ(d)f(d) is multiplica­ tive; hence, F(n) is the product of the values F(p�i).] 4. If the integer n > 1 has the prime factorization n = p�1 p�2 • • • p;r, use Problem 3 to establish the following: (a) Ldlnµ(d)r(d) = (-lY. (b) Ldln µ(d)a(d) = (-l Y PIP2 ···Pr· (c) Ldln µ(d)/d = (1- l/p1)(l - l/p2)- · · (1 - l/pr). (d) Ldln dµ(d) = (1 - P1)(1 - P2) · · · (1 - Pr). 5. Let S(n) denote the number of square-free divisors of n. Establish that S(n) = L lµ(d)I = zw( n) din where w(n) is the number of distinct prime divisors of n. [Hint: S is a multiplicative function.] 6. Find formulas for Ldln µ2(d)/r(d) and Ldln µ2(d)/a(d) in terms of the prime factor­ ization of n. 7. The Liouville A-function is defined by A(l) = 1 and A(n) = ( - l )k 1 +kz+··+k r, if the prime factorization of n > 1 is n = p�1 p�2 • • • p;r. For instance, ).(360) = ).(23 · 32 · 5) = (-1)3+2+l = (-1)6 = 1 (a) Prove that A is a multiplicative function. (b) Given a positive integer n, verify that NUMBER-THEORETIC FUNCTIONS 117 L:)..(d) = { i din O if n = m 2 for some integer m otherwise 8. For an integer n ::'.'.: 1, verify the formulas below: (a) Ld In µ,(d))..(d) = 2w(n). (b) Ld In )..(n / d)2w(d) = 1. 6.3 THE GREATEST INTEGER FUNCTION The greatest integer or \"bracket\" function [ ] is especially suitable for treating di­ visibility problems. Although not strictly a number-theoretic function, its study has a natural place in this chapter. Definition 6.4. For an arbitrary real number x, we denote by [x] the largest integer less than or equal to x; that is, [ x] is the unique integer satisfying x - 1 < [ x] :S x. By way of illustration, [ ] assumes the particular values [-3/2]=-2 hl2]=1 [1 /3]=0 [n]=3 [-n]=-4 The important observation to be made here is that the equality [x] = x holds if and only if x is an integer. Definition 6.4 also makes plain that any real number x can be written as x=[x]+e for a suitable choice of e' with 0 < e < 1. We now plan to investigate the question of how many times a particular prime p appears in n ! . For instance, if p = 3 and n = 9, then 9! = 1 . 2. 3 . 4. 5 . 6 . 7 . 8 . 9 = 27. 34. 5. 7 so that the exact power of 3 that divides 9 ! is 4. It is desirable to have a formula that will give this count, without the necessity of always writing n ! in canonical form. This is accomplished by Theorem 6.9. Theorem 6.9. If n is a positive integer and p a prime, then the exponent of the highest power of p that divides n ! is f [!!___] k=l pk where the series is finite, because [n/ pk] = 0 for p k > n. Proof. Among the first n positive integers, those divisible by p are p, 2p, ... , tp, where t is the largest integer such that tp :S n; in other words, t is the largest integer 118 ELEMENTARY NUMBER THEORY less than or equal ton/ p (which is to say t = [n/ p ]). Thus, there are exactly [n/ p] multiples of p occurring in the product that defines n!, namely, p,2p, ... ,[;] p (1) The exponent of p in the prime factorization of n ! is obtained by adding to the number of integers in Eq. (1), the number of integers among 1, 2, ... , n divisible by p2, and then the number divisible by p3, and so on. Reasoning as in the first paragraph, the integers between 1 and n that are divisible by p2 are p2, 2p2, ... ' [; 2] p2 (2) which are [n/ p2] in number. Of these, [n/ p3] are again divisible by p: 3 3 [ n ] 3 p '2p ' ... ' p3 p (3) After a finite number of repetitions of this process, we are led to conclude that the total number of times p divides n ! is This result can be cast as the following equation, which usually appears under the name of the Legendre formula: n! =TI pL�1[n/pk] pS:_n Example 6.2. We would like to find the number of zeros with which the decimal representation of 50 ! terminates. In determining the number of times 10 enters into the product 50!, it is enough to find the exponents of 2 and 5 in the prime factorization of 50!, and then to select the smaller figure. By direct calculation we see that [50/2] + [50/22] + [50/23] + [50/24] + [50/25] = 25 + 12 + 6 + 3 + 1 = 47 Theorem 6.9 tells us that 247 divides 50!, but 248 does not. Similarly, [50/5] + [50/52] = 10 + 2 = 12 and so the highest power of 5 dividing 50! is 12. This means that 50! ends with 12 zeros. We cannot resist using Theorem 6.9 to prove the following fact. From Corollary 1, NUMBER-THEORETIC FUNCTIONS 121 t rnJ = [6) + [3] + [2] + [3/2) + [6/5] + [1) =6+3 + 2+1+1+1 = 14 as it should. In the present case, we also have 6 L a(n) = 33 n=l and a simple calculation leads to t n rn] = 1[6] + 2[3) + 3[2) + 4[3/2) + 5[6/5) + 6[1] = 1 · 6 + 2 · 3 + 3 · 2 + 4 · 1 + 5 · 1 + 6 · 1 = 33 PROBLEMS 6.3 1. Given integers a and b > 0, show that there exists a unique integer r with 0 :::; r < b satisfying a = [a/b]b + r. 2. Let x and y be real numbers. Prove that the greatest integer function satisfies the following properties: (a) [x + n] = [x] + n for any integer n. (b) [ x] + [ -x] = 0 or -1, according as x is an integer or not. [Hint: Write x = [x] +(), with 0:::; () < 1, so that -x = -[x] -1 + (1 - 8).] (c) [x] + [y] :::; [x + y] and, when x and y are positive, [x][y] :::; [xy]. (d) [x/n] = [[x]/n] for any positive integer n. [Hint: Let x/n = [x/n] + 8, where 0:::; () < 1; then [x] = n[x/n] + [n()].] (e) [nm/ k] � n[m/ k] for positive integers, n, m, k. (f) [x] + [y] + [x + y]:::; [2x] + [2y]. [Hint: Let x = [ x] + (), 0 :::; 8 < 1, and y = [y] + ()', 0 :::; ()' < 1. Consider cases in which neither, one, or both of() and()' are greater than or equal to ! ·1 3. Find the highest power of 5 dividing 1000 ! and the highest power of 7 dividing 2000 ! . 4. For an integer n � 0, show that [n/2] - [ -n/2] = n. 5. (a) Verify that 1000! terminates in 249 zeros. (b) For what values of n does n ! terminate in 37 zeros? 6. If n � 1 and p is a prime, prove that (a) (2n)l/(n!)2 is an even integer. [Hint: Use Theorem 6.10.] (b) The exponent of the highest power of p that divides (2n) ! / (n !)2 is (c) In the prime factorization of (2n)!/(n!)2 the exponent of any prime p such that n < p < 2n is equal to 1. 122 ELEMENTARY NUMBER THEORY 7. Let the positive integer n be written in terms of powers of the prime p so that we have n = akpk + · · · + a1p2 + aip + ao, where 0 :S ai < p. Show that the exponent of the highest power of p appearing in the prime factorization of n ! is n - (ak + · · · + a1 + a1 + ao) p-1 8. (a) Using Problem 7, show that the exponent of highest power of p dividing (pk - l)! is [pk - (p - l)k -1]/(p -1). [Hint: Recall the identity pk -1 = (p - l)(pk-l + ... + p2 + p + l).] (b) Determine the highest power of 3 dividing 80 ! and the highest power of 7 dividing 2400!. [Hint: 2400 = 74 -1.] 9. Find an integer n '.:::: 1 such that the highest power of 5 contained inn! is 100. [Hint: Because the sum of coefficients of the powers of 5 needed to express n in the base 5 is at least 1, begin by considering the equation (n -1)/4 = 100.] 10. Given a positive integer N, show the following: (a) :L:=l µ,(n)[N /n] = 1. (b) 1:L:=1µ,(n)/nl :S 1. 11. Illustrate Problem 10 in the case where N = 6. 12. Verify that the formula holds for any positive integer N. [Hint: Apply Theorem 6.11 to the multiplicative function F(n) = Ld 1 n ).(d), noting that there are [,Jn] perfect squares not exceeding n.] 13. If N is a positive integer, establish the following: \"\\'2N \"\\' N (a) N = L.m= l r(n) -Lm=1[2N /n]. (b) r(N) = :L:=1([N/n]-[(N -1)/n]). 6.4 AN APPLICATION TO THE CALENDAR Our familiar calendar, the Gregorian calendar, goes back as far as the second half of the 16th century. The earlier Julian calendar, introduced by Julius Caesar, was based on a year of 365 � days, with a leap year every fourth year. This was not a precise enough measure, because the length of a solar year-the time required for the earth to complete an orbit about the sun-is apparently 365.2422 days. The small error meant that the Julian calendar receded a day from its astronomical norm every 128 years. By the 16th century, the accumulating inaccuracy caused the vernal equinox (the first day of Spring) to fall on March 11 instead of its proper day, March 21. The calendar's inaccuracy naturally persisted throughout the year, but at this season it meant that the Easter festival was celebrated at the wrong astronomical time. Pope Gregory XIII rectified the discrepancy in a new calendar, imposed on the predominantly Catholic countries of Europe. He decreed that 10 days were to be omitted from the year 1582, by having October 15 of that year immediately follow NUMBER-THEORETIC FUNCTIONS 123 October 4. At the same time, the Jesuit mathematician Christopher Clavius amended the scheme for leap years: these would be years divisible by 4, except for those marking centuries. Century years would be leap years only if they were divisible by 400. (For example, the century years 1600 and 2000 are leap years, but 1700, 1800, 1900, and 2100 are not.) Because the edict came from Rome, Protestant England and her possessions­ including the American colonies-resisted. They did not officially adopt the Gre­ gorian calendar until 1752. By then it was necessary to drop 11 days in September from the Old Style, or Julian, calendar. So it happened that George Washington, who was born on February 11, 1732, celebrated his birthday as an adult on February 22. Other nations gradually adopted the reformed calendar: Russia in 1918, and China as late as 1949. Our goal in the present section is to determine the day of the week for a given date after the year 1600 in the Gregorian calendar. Because the leap year day is added at the end of February, let us adopt the convenient fiction that each year ends at the end of February. According to this plan, in the Gregorian year Y March and April are counted as the first and second months. January and February of the Gregorian year Y + 1 are, for convenience, counted as the eleventh and twelfth months of the year Y. Another convenience is to designate the days of the week, Sunday through Saturday, by the numbers 0, 1, ... , 6: Sun Mon Tue Wed Thu Fri Sat 0 1 2 3 4 5 6 The number of days in a common year is 365 = 1 (mod 7), whereas in leap years there are 366 _ 2 (mod 7) days. Because February 28 is the 365th day of the year, and 365 _ 1 (mod 7), February 28 always falls on the same weekday as the previous March 1. Thus if a particular March 1 immediately follows February 28, its weekday number will be one more, modulo 7, than the weekday number of the previous March 1. But if it follows a leap year day, February 29, its weekday number will be increased by two. For instance, if D1600 is the weekday number for March 1, 1600, then March 1 in the years 1601, 1602, and 1603 has numbers congruent modulo 7 to D1600 + 1, D160o + 2, and D160o + 3, respectively; but the number corresponding to March 1, 1604 is Di6oo + 5 (mod 7). We can summarize this: the weekday number Dy for March 1 of any year Y > 1600 will satisfy the congruence Dy = D1600 + (Y - 1600) + L (mod 7) (1) where L is the number of leap year days between March 1, 1600, and March 1 of the year Y. Let us first find L, the number of leap year days between 1600 and the year Y. To do this, we count the number of these years that are divisible by 4, deduct the number of century years, and then add back the number of century years divisible by 400. According to Problem 2(a) of Section 6.3, [x - a] = [x] - a whenever a is an NUMBER-THEORETIC FUNCTIONS 125 (Notice that [y / 100] = 0 and y / 400 < ±.) Then the congruence for Dy appears as Dy = 3 + (lOOc + y - 1600) + 24c + [�] + [�] - 388 (mod 7) which reduces to Dy= 3 - 2c + y + [�] + [�] (mod 7) (3) Example 6.4 We can use the latest congruence to calculate the day of the week on which March 1, 1990, fell. For this year, c = 19 and y = 90 so that (3) gives D1990 = 3 - 38 + 90 + [19/4] + [90/4] = 55 + 4 + 22 = 4 (mod 7) March 1 was on a Thursday in 1990. We move on to determining the day of the week on which the first of each month of the year would fall. Because 30 = 2 (mod 7), a 30-day month advances by two the weekday on which the next month begins. A 31-day month increases it by 3. So, for example, the number of June 1 will always be 3 + 2 + 3 = 1 (mod 7) greater than that of the preceding March 1 because March, April, and May are months of 31, 30, and 31 days, respectively. The table below gives the value that must be added to the day-number of March 1 to arrive at the number of the first day of each month in any year Y. March 0 April 3 May 5 June 1 July 3 August 6 For m = 1, 2, ... , 12, the expression September 2 October 4 November December January February 0 2 5 1 [(2.6)m - 0.2] - 2 (mod 7) produces the same monthly increases as indicated by the table. Thus the number of the first day of the m th month of the year Y is given by Dy + [(2.6)m - 0.2] - 2 (mod 7) Taking December 1, 1990, as an example, we have Di990 + [(2.6)10 - 0.2] - 2 - 4 + 25 - 2 _ 6 (mod 7) that is, the first of December in 1990 fell on a Saturday. Finally, the number w of day d, month m, year Y = lOOc + y is determined from congruence w - (d - 1) +Dy + [(2.6)m - 0.2] - 2 (mod 7) 126 ELEMENTARY NUMBER THEORY We can use Eq. (3) to recast this: w = d + [(2.6)m - 0.2] - 2c + y + [�] + [�] (mod 7) (4) We summarize the results of this section in the following theorem. Theorem 6.12. The date with month m, day d, year Y = IOOc + y where c 2: 16 and 0 :::: y < 100, has weekday number w = d + [(2.6)m - 0.2] - 2c + y + [�] + [�] (mod 7) provided that March is taken as the first month of the year and January and February are assumed to be the eleventh and twelfth months of the previous year. Let us give an example using the calendar formula. Example 6.5. On what day of the week will January 14, 2020, occur? In our convention, January of 2020 is treated as the eleventh month of the year 2019. The weekday number corresponding to its fourteenth day is computed as w = 14 + [(2.6)11 - 0.2] - 40 + 19 + [20/4] + [19/4] = 14 + 28 - 40 + 19 + 5 + 4 = 2 (mod 7) We conclude that January 14, 2020, will take place on a Tuesday. An interesting question to ask about the calendar is whether every year contains a Friday the thirteenth. Phrased differently, does the congruence 5 = 13 + [(2.6)m - 0.2] - 2c + y + [�] + [�] (mod 7) hold for each year Y = IOOc + y? Notice that the expression [(2.6)m - 0.2] assumes, modulo 7, each of the values 0, 1, ... , 6 as m varies from 3 to 9-values corresponding to the months May through November. Hence there will always be a month for which the indicated congruence is satisfied: in fact, there will always be a Friday the thirteenth during these seven months of any year. For the year 2022, as an example, the Friday the thirteenth congruence reduces to 0 = [(2.6)m - 0.2] (mod 7) which holds when m = 3. In 2022, there is a Friday the thirteenth in May. PROBLEMS 6.4 1. Find the number n of leap years such that 1600 < n < Y, when (a) Y = 1825. (b) y = 1950. (c) Y = 2075. 2. Determine the day of the week on which you were born. 3. Find the day of the week for the important dates below: (a) November 19, 1863 (Lincoln's Gettysburg Address). (b) April 18, 1906 (San Francisco earthquake). (c) November 11, 1918 (Great War ends). (d) October 24, 1929 (Black Day on the New York stock market). (e) June 6, 1944 (Allies land in Normandy). (f) February 15, 1898 (Battleship Maine blown up). NUMBER-THEORETIC FUNCTIONS 127 4. Show that days with the identical calendar date in the years 1999 and 1915 fell on the same day of the week. [Hint: If W1 and W2 are the weekday numbers for the same date in 1999 and 1915, respectively, verify that W1 - W2 = 0 (mod 7).] 5. For the year 2010, determine the following: (a) the calendar dates on which Mondays will occur in March. (b) the months in which the thirteenth will fall on a Friday. 6. Find the years in the decade 2000 to 2009 when November 29 is on a Sunday. This page intentionally left blank CHAPTER 7 EULER'S GENERALIZATION OF FERMAT'S THEOREM Euler calculated without apparent effort, just as men breathe, as eagles sustain themselves in the air. ARAGO 7.1 LEONHARD EULER The importance of Fermat's work resides not so much in any contribution to the mathematics of his own day, but rather in its animating effect on later generations of mathematicians. Perhaps the greatest disappointment of Fermat's career was his inability to interest others in his new number theory. A century was to pass before a first-class mathematician, Leonhard Euler (1707-1783), either understood or appre­ ciated its significance. Many of the theorems announced without proof by Fermat yielded to Euler's skill, and it is likely that the arguments devised by Euler were not substantially different from those that Fermat said he possessed. The key figure in 18th century mathematics, Euler was the son of a Lutheran pastor who lived in the vicinity of Basel, Switzerland. Euler's father earnestly wished him to enter the ministry and sent his son, at the age of 13, to the University of Basel to study theology. There the young Euler met Johann Bernoulli-then one of Europe's leading mathematicians-and befriended Bernoulli's two sons, Nicolaus and Daniel. Within a short time, Euler broke off the theological studies that had been selected for him to address himself exclusively to mathematics. He received his master's degree in 1723, and in 1727 at the age of 19, he won a prize from the Paris Academy of Sciences for a treatise on the most efficient arrangement of ship masts. 129 130 ELEMENTARY NUMBER THEORY Leonhard Euler (1707-1783) (Dover Publications, Inc.) Where the 17th century had been an age of great amateur mathematicians, the 18th century was almost exclusively an era of professionals-university professors and members of scientific academies. Many of the reigning monarchs delighted in regarding themselves as patrons of learning, and the academies served as the in­ tellectual crown jewels of the royal courts. Although the motives of these rulers may not have been entirely philanthropic, the fact remains that the learned societies constituted important agencies for the promotion of science. They provided salaries for distinguished scholars, published journals of research papers on a regular ba­ sis, and offered monetary prizes for scientific discoveries. Euler was at different times associated with two of the newly formed academies, the Imperial Academy at St. Petersburg (1727-1741; 1766-1783) and the Royal Academy in Berlin (1741- 1766). In 1725, Peter the Great founded the Academy of St. Petersburg and at­ tracted a number ofleading mathematicians to Russia, including Nicolaus and Daniel Bernoulli. On their recommendation, an appointment was secured for Euler. Because of his youth, he had recently been denied a professorship in physics at the Univer­ sity of Basel and was only too ready to accept the invitation of the Academy. In St. Petersburg, he soon came into contact with the versatile scholar Christian Goldbach (of the famous conjecture), a man who subsequently rose from professor of mathematics to Russian Minister of Foreign Affairs. Given his interests, it seems likely that Goldbach was the one who first drew Euler's attention to the work of Fermat on the theory of numbers. Euler eventually tired of the political repression in Russia and accepted the call of Frederick the Great to become a member of the Berlin Academy. The story is told that, during a reception at Court, he was kindly received by the Queen Mother who inquired why so distinguished a scholar should be so timid and reticent; he replied, \"Madame, it is because I have just come from a country where, when one speaks, one is hanged.\" However, flattered by the warmth of the Russian feeling toward him and unendurably offended by the contrasting coolness of Frederick and his court, EULER'S GENERALIZATION OF FERMAT'S THEOREM 131 Euler returned to St. Petersburg in 1766 to spend his remaining days. Within two or three years of his return, Euler became totally blind. However, Euler did not permit blindness to retard his scientific work; aided by a phenomenal memory, his writings grew to such enormous proportions as to be virtually unmanageable. Without a doubt, Euler was the most prolific writer in the entire history of mathematics. He wrote or dictated over 700 books and papers in his lifetime and left so much unpublished material that the St. Petersburg Academy did not finish printing all his manuscripts until 4 7 years after his death. The publication of Euler's collected works was begun by the Swiss Society of Natural Sciences in 19 11: it is estimated that more than 75 large volumes will ultimately be required for the completion of this monumental project. The best testament to the quality of these papers may be the fact that on 12 occasions they won the coveted biennial prize of the French Academy in Paris. During his stay in Berlin, Euler acquired the habit of writing memoir after memoir, placing each when finished at the top of a pile of manuscripts. Whenever material was needed to fill the Academy's journal, the printers helped themselves to a few papers from the top of the stack. As the height of the pile increased more rapidly than the demands made upon it, memoirs at the bottom tended to remain in place a long time. This explains how it happened that various papers of Euler were published, when extensions and improvements of the material contained in them had previously appeared in print under his name. We might also add that the manner in which Euler made his work public contrasts sharply with the secrecy customary in Fermat's time. 7.2 EULER'S PHI-FUNCTION This chapter deals with that part of the theory arising out of the result known as Euler's Generalization of Fermat's Theorem. In a nutshell, Euler extended Fermat's theorem, which concerns congruences with prime moduli, to arbitrary moduli. While doing so, he introduced an important number-theoretic function, described in Definition 7 .1. Definition 7 . 1 . For n :=:: 1, let </>(n) denote the number of positive integers not exceeding n that are relatively prime to n. As an illustration of the definition, we find that ¢(30) = 8; for, among the positive integers that do not exceed 30, there are eight that are relatively prime to 30; specifically, 1, 7, 11, 13, 17, 19, 23, 29 Similarly, for the first few positive integers, the reader may check that ¢( 1) = 1, ¢(2) = 1, ¢(3) = 2, ¢(4) = 2, ¢(5) = 4, ¢(6) = 2, ¢(7) = 6, ... Notice that ¢( 1) = 1, because gcd(l, 1) = 1. In the event n > 1, then gcd(n, n) = n -=/=- 1, so that ¢(n) can be characterized as the number of integers less than n and relatively prime to it. The function ¢ is usually called the Euler EULER'S GENERALIZATION OF FERMAT'S THEOREM 133 that p I be; in consequence, p I b or p I c. If p I b, then (by virtue of the fact that p I a) we have gcd(a, b) :::: p, a contradiction. In the same way, the condition p I c leads to the equally false conclusion that gcd(a, c):::: p. Thus, di = 1 and the lemma is proven. Theorem 7 .2 . The function </> is a multiplicative function. Proof. It is required to show that </>(mn) = </>(m )</>(n ), wherever m and n have no common factor. Because </>(1) = 1, the result obviously holds if either m or n equals 1. Thus, we may assume that m > 1 and n > 1. Arrange the integers from 1 to mn in m columns of n integers each, as follows: 1 m+ 1 2m + 1 (n - l)m + 1 2 m+2 2m +2 (n - l)m + 2 r m +r 2m +r (n - l)m + r m 2m 3m nm We know that </>(mn) is equal to the number of entries in this array that are relatively prime to mn; by virtue of the lemma, this is the same as the number of integers that are relatively prime to both m and n. Before embarking on the details, it is worth commenting on the tactics to be adopted: because gcd(qm + r, m) = gcd(r, m), the numbers in the rth column are relatively prime to m if and only if r itself is relatively prime to m. Therefore, only </>(m) columns contain integers relatively prime to m, and every entry in the column will be relatively prime to m. The problem is one of showing that in each of these </>(m) columns there are exactly </>(n) integers that are relatively prime to n; for then altogether there would be </>(m)</>(n) numbers in the table that are relatively prime to both m and n. Now the entries in the rth column (where it is assumed that gcd(r, m) = 1) are r, m + r, 2m + r, ... , (n - l)m + r There are n integers in this sequence and no two are congruent modulo n. Indeed, if km+ r = jm + r (mod n) with 0 :S k < j < n, it would follow that km = jm (mod n). Because gcd(m, n) = 1, we could cancel m from both sides of this congruence to arrive at the contradiction that k = j (mod n ). Thus, the numbers in the rth column are congruent modulo n to 0, 1, 2, ... , n - 1, in some order. But if s - t (mod n), then gcd(s, n) = 1 if and only if gcd(t, n) = 1. The implication is that the rth column contains as many integers that are relatively prime to n as does the set {O, 1, 2, ... , n - l}, namely, </>(n) integers. Therefore, the total number of entries in the array that are relatively prime to both m and n is </>(m )</>(n ). This completes the proof of the theorem. With these preliminaries in hand, we now can prove Theorem 7.3. EULER'S GENERALIZATION OF FERMAT'S THEOREM 135 a prime divisor q. Because Pl, p2, ... , Pr are the only primes, q must be one of these Pi, whence q I n; in other words, gcd(a, n) ::::: q. The implication of all this is that ¢(n) = 1, which clearly is impossible by Theorem 7.4. PROBLEMS 7.2 1. Calculate <f>(lOOl), </>(5040), and </>(36,000). 2. Verify that the equality <f>(n) = <f>(n + 1) = <f>(n + 2) holds when n = 5186. 3. Show that the integers m = 3k · 568 and n = 3k · 638, where k � 0, satisfy simultaneously r(m) = r(n), cr(m) = a(n), and 4. Establish each of the assertions below: (a) If n is an odd integer, then <f>(2n) = <f>(n). (b) If n is an even integer, then <f>(2n) = 2<f>(n ). (c) <f>(3n) = 3<f>(n) if and only if 31 n. (d) <f>(3n) = 2<f>(n) if and only if 3 )' n. (e) <f>(n) = n/2 if and only if n = 2k for some k � 1. <f>(m) = <f>(n) [Hint: Write n = 2k N, where N is odd, and use the condition <f>(n) = n /2 to show that N = l.] 5. Prove that the equation <f>(n) = <f>(n + 2) is satisfied by n = 2(2p - 1) whenever p and 2p - 1 are both odd primes. 6. Show that there are infinitely many integers n for which <f>(n) is a perfect square. [Hint: Consider the integers n = 22k+1 fork= 1, 2, .... ] 7. Verify the following: (a) For any positive integer n, �,Jn:::; <f>(n) :::; n. [Hint:Writen = 2k0p�1 • • • p�r,so <f>(n) = 2k0-1p�i-l. · · p�r-1(pi - 1) · ·· (Pr -1). Now use the inequalities p - 1 > .JP and k - � � k/2 to obtain <f>(n) � 2k0-1 kJ/2 kr /2 ] Pi ··· Pr · (b) If the integer n > 1 has r distinct prime factors, then <f>(n) � n /2r . ( c) If n > 1 is a composite number, then <f>(n) :::; n - ,Jn. [Hint: Let p be the smallest prime divisor of n, so that p :::; ,Jn. Then <f>(n) :::; n(l -1/ p).] 8. Prove that if the integer n has r distinct odd prime factors, then 2r I <f>(n ). 9. Prove the following: (a) If n and n + 2 are a pair of twin primes, then <f>(n + 2) = <f>(n) + 2; this also holds for n = 12, 14, and 20. (b) If p and 2p + 1 are both odd primes, then n = 4p satisfies <f>(n + 2) = <f>(n) + 2. 10. If every prime that divides n also divides m, establish that <f>(nm) = n<f>(m ); in particular, <f>(n2) = n<f>(n) for every positive integer n. 11. (a) If <f>(n) In -1, prove that n is a square-free integer. [Hint: Assume that n has the prime factorization n = p�1 p�2 • • • p�r, where k1 � 2. Then pi I <f>(n), whence Pi In -1, which leads to a contradiction.] (b) Show that if n = 2k or 2k 3j, with k and j positive integers, then <f>(n) In. 12. If n = p�1 p�2 • • • p�r, derive the following inequalities: (a) cr(n)<f>(n) � n2(1 -1/ Pi)(l -1/ Pi) ··· (1 -1/ p;). (b) r(n)<f>(n) � n. [Hint: Show that r(n)<f>(n) � 2r · n(l/2Y.J 136 ELEMENTARY NUMBER THEORY 13. Assuming that d I n, prove that ¢(d) I ¢(n ). [Hint: Work with the prime factorizations of d and n.] 14. Obtain the following two generalizations of Theorem 7.2: (a) For positive integers m and n, where d = gcd(m, n), </J(d) </J(m)</>(n) = </J(mn)d (b) For positive integers m and n, <f>(m)<f>(n) = ¢(gcd(m, n))<f>(lcm(m, n)) 15. Prove the following: (a) There are infinitely many integers n for which ¢(n) = n/3. [Hint: Consider n = 2k3j , where k and j are positive integers.] (b) There are no integers n for which ¢(n) = n/4. 16. Show that the Goldbach conjecture implies that for each even integer 2n there exist integers ni and n2 with ¢(n1) + ¢(n2) = 2n. 17. Given a positive integer k, show the following: (a) There are at most a finite number of integers n for which ¢(n) = k. (b) If the equation ¢(n) = k has a unique solution, say n = n0, then 41 n0. [Hint: See Problems 4(a) and 4(b).] A famous conjecture of R. D. Carmichael (1906) is that there is no k for which the equation ¢(n) = k has precisely one solution; it has been proved that any counterex­ ample n must exceed 1010000000 • 18. Find all solutions of <f>(n) = 16 and ¢(n) = 24. [Hint: If n = p�1 p�2 • • • p�r satisfies ¢(n) = k, then n = [k/IT (p ; - l)]ITp;. Thus the integers d; = p; - 1 can be determined by the conditions (1) di I k, (2) di + 1 is prime, and (3) k/ ITdi contains no prime factor not in ITp; .] 19. (a) Prove that the equation ¢(n) = 2p, where pis a prime number and 2p + 1 is com­ posite, is not solvable. (b) Prove that there is no solution to the equation </J(n) = 14, and that 14 is the smallest (positive) even integer with this property. 20. If p is a prime and k 2:: 2, show that ¢(¢(pk)) = pk-2</J((p - 1)2). 21. Verify that </J(n)a(n) is a perfect square when n = 63457 = 23 · 31 · 89. 7.3 EULER'S THEOREM As remarked earlier, the first published proof of Fermat's theorem (namely that aP-l = 1 (mod p) if p J a) was given by Euler in 1736. Somewhat later, in 1760, he succeeded in generalizing Fermat's theorem from the case of a prime p to an arbitrary positive integer n. This landmark result states: if gcd(a, n) = 1, then a<f>(n) _ 1 (mod n). For example, putting n = 30 and a = 11, we have 11 <1><3o) = 118 = (112)4 = (121)4 = 14 = 1 (mod 30) As a prelude to launching our proof of Euler's generalization of Fermat's theo­ rem, we require a preliminary lemma. EULER'S GENERALIZATION OF FERMAT'S THEOREM 137 Lemma. Letn > land gcd(a,n) = l.lfa1,a2, ... ,a</J(n) are the positive integers less than n and relatively prime ton, then are congruent modulo n to a1, a2, ... , a</J(n) in some order. Proof. Observe that no two of the integers aa1, aa2, ... , aa</J(n) are congruent modulo n. For if aai = aaj (mod n), with 1 :S: i < j :::: </>(n), then the cancellation law yields ai = aj (modn) and thus ai = aj,a contradiction.Furthermore,because gcd(a;, n) = 1 for all i and gcd(a, n) = 1, the lemma preceding Theorem 7.2 guarantees that each of the aa; is relatively prime ton. Fixing on a particular aa;, there exists a unique integer b, where 0 :::: b < n, for which aa; = b (mod n). Because gcd(b, n) = gcd(aai, n) = 1 b must be one of the integers a1, a2, ... , a</J(n)· All told, this proves that the numbers aa1, aa2, ... , aa</J(n) and the numbers a1, a2, ... , a</J(n) are identical (modulo n) in a certain order. Theorem 7.5 Euler. If n :=:::: 1 and gcd(a, n) = 1, then a<P<n) = 1 (mod n). Proof. There is no harm in taking n > 1. Let a1, a2, ... , a</J(n) be the positive integers less than n that are relatively prime to n. Because gcd(a, n) = 1, it follows from the lemma that aa 1, aa2, ... , aa</J(n) are congruent, not necessarily in order of appearance, to a1, a2, ... , a</J(n)· Then aa1 = ai (mod n) aa2 =a; (mod n) aa</J(n) = a¢(n) (mod n) where ai, a;, ... , a¢(n) are the integers a1, a2, ... , a</J(n) in some order. On taking the product of these </>(n) congruences, we get and so (aa1)(aa2) · · · (aa</J(n)) = ai a; · · · a¢(n) (mod n) = a1a2 · · · a</J(n) (mod n) a<P(n) (a1a2 · · · a</J(n)) = a1a2 · · · a</J(n) (mod n) Because gcd(a;, n) = 1 for each i, the lemma preceding Theorem 7 .2 implies that gcd(a1a2 · · · a</J(n)• n) = 1. Therefore, we may divide both sides of the foregoing congruence by the common factor a1a2 · · · a</J(n)• leaving us with a<P(n) = 1 (mod n) This proof can best be illustrated by carrying it out with some specific numbers. Let n = 9, for instance. The positive integers less than and relatively prime to 9 are 1,2,4,5, 7,8 138 ELEMENTARY NUMBER THEORY These play the role of the integers ai, a2, ... , aq;(n) in the proof of Theorem 7.5. If a = -4, then the integers aai are -4,-8,-16,-20,-28,-32 where, modulo 9, -4 - 5 -8 - 1 -16 - 2 -20 - 7 -28 - 8 -32 - 4 When the above congruences are all multiplied together, we obtain (-4)(-8)(-16)(-20)(-28)(-32) _ 5 · 1 · 2 · 7 · 8 · 4 (mod 9) which becomes (1 · 2 · 4 · 5 · 7 · 8)(-4)6 = (1 · 2 · 4 · 5 · 7 · 8) (mod 9) Being relatively prime to 9, the six integers 1, 2, 4, 5, 7, 8 may be canceled succes­ sively to give (-4)6 = 1(mod 9) The validity of this last congruence is confirmed by the calculation (-4)6 _ 46 _ (64) 2 _ 1 2 _ 1(mod 9) Note that Theorem 7.5 does indeed generalize the one credited to Fermat, which we proved earlier. For if pis a prime, then </>(p) = p - 1; hence, when gcd(a, p) = 1, we get ap-l = a<f>(p) = 1 (mod p) and so we have the following corollary. Corollary Fermat. If pis a prime and p J a, then aP-l = 1 (mod p). Example 7.2. Euler's theorem is helpful in reducing large powers modulo n. To cite a typical example, let us find the last two digits in the decimal representation of 3256. This is equivalent to obtaining the smallest nonnegative integer to which 3256 is congruent modulo 100. Because gcd(3, 100) = 1 and </>(100) = </>(2 2 . 5 2 ) = 100 ( 1 - �) ( 1 - l) = 40 Euler's theorem yields 340 = 1 (mod 100) By the Division Algorithm, 256 = 6 · 40 + 16; whence 3256 = 36-40+16 = (340)6316 = 316 (mod lOO) and our problem reduces to one of evaluating 316, modulo 100. The method of succes­ sive squaring yields the congruences 32 = 9 (mod 100) 34 = 81 (mod 100) 38 = 61 (mod 100) 316 = 21 (mod 100) EULER'S GENERALIZATION OF FERMAT'S THEOREM 139 There is another path to Euler's theorem, one which requires the use of Fermat's theorem. Second Proof of Euler's Theorem. To start, we argue by induction that if p J a (p a prime), then k>O (1) When k = 1, this assertion reduces to the statement of Fermat's theorem. Assuming the truth of Eq. (1) for a fixed value of k, we wish to show that it is true with k replaced by k + 1. Because Eq. (1) is assumed to hold, we may write atf>(pk) = 1 + qpk for some integer q. Also notice that </>(pk+l) = pk+l _pk= p(pk _pk-I)= p</>(pk) Using these facts, along with the binomial theorem, we obtain atf>(pk+') = aPtf>(pk) = (atf>(pk))P = (1 + qpk)P = 1 + ( �) (qpk) + ( �) (qpk)2 + ... + ( p ) (qpk)p-1 + (qpk)p p - 1 = 1 + ( �) (qpk) (mod pk+1) But p I ( � ),and so pk+1 I ( � )(qpk). Thus, the last-written congruence becomes alf>(pk+') = 1 (modpk+1) completing the induction step. Let gcd(a, n) = 1 and n have the prime-power factorization n = p�' p�2 • • • p�'. In view of what already has been proven, each of the congruences k· k atf>(p;') = 1 (mod p/) i = 1, 2, ... , r (2) holds. Noting that </>(n) is divisible by </>(p7;), we may raise both sides of Eq. (2) to the power </>(n)/</>(p�;) and arrive at alf>(n) = 1 (mod p�;) i = 1, 2, ... , r Inasmuch as the moduli are relatively prime, this leads us to the relation atf>(n) = 1 (mod p�1 p�2 ••• p;') or atf>(n) = 1 (mod n ). The usefulness of Euler's theorem in number theory would be hard to exaggerate. It leads, for instance, to a different proof of the Chinese Remainder Theorem. In other 140 ELEMENTARY NUMBER THEORY words, we seek to establish that if gcd(n;, n j) = 1 for i =j:. j, then the system of linear congruences i = 1,2, ... ,r admits a simultaneous solution. Let n = nin2 · · · nr, and put N; = n/n; for n = 1, 2, ... , r. Then the integer x = aiNfCni) + a2NfCnz) + · · · + arN!(n,) fulfills our requirements. To see this, first note that N j = 0 (mod n;) whenever i =j:. j; whence, x _ a;Nt(n;) (mod n;) But because gcd(N;, n;) = 1, we have Ni</J(n;) = 1 (mod n;) and so x = a; (mod n;) for each i. As a second application of Euler's theorem, let us show that if n is an odd integer that is not a multiple of 5, then n divides an integer all of whose digits are equal to 1 (for example, 71 111111). Because gcd(n, 10) = 1 and gcd(9, 10) = 1, we have gcd(9n, 10) = 1. Quoting Theorem 7.5, again, l o<PC9n) = 1 (mod 9n) This says that 1o<PC9n) - 1 = 9nk for some integer k or, what amounts to the same thing, 1Q¢(9n) - 1 kn= ---- 9 The right-hand side of this expression is an integer whose digits are all equal to 1, each digit of the numerator being clearly equal to 9. PROBLEMS 7.3 1. Use Euler's theorem to establish the following: (a) For any integer a, a37 = a (mod 1729). [Hint: 1729 = 7 · 13 · 19.] (b) For any integer a, a13 =a (mod 2730). [Hint: 2730 = 2 · 3 · 5 · 7 · 13.] (c) For any odd integer a, a33 =a (mod 4080). [Hint: 4080 = 15 · 16 · 17.] 2. Use Euler's theorem to confirm that, for any integer n ::=: 0, 51 I 1032n+9 - 7 3. Prove that 215 - 23 divides a15 - a3 for any integer a. [Hint: 215 - 23 = 5 · 7 · 8 · 9 · 13.] 4. Show that if gcd(a, n) = gcd(a - 1, n) = 1, then 1 +a+ a2 + · · · + a</J(n)-l = 0 (mod n) [Hint: Recall that a</l(n) - 1 = (a - l)(a¢(n)-l + · · · + a2 +a + 1).] EULER'S GENERALIZATION OF FERMAT'S THEOREM 141 5. If m and n are relatively prime positive integers, prove that m<f>(n) + n<f>(m) = 1 (mod m n) 6. Fill in any missing details in the following proof of Euler's theorem: Let p be a prime divisor of n and gcd(a, p) = 1. By Fermat's theorem, ap-l = 1 (mod p), so that ap-l = 1 + tp for some t. Therefore ap(p-l) = (1 + tp)P = 1 + ( f )(tp) + · · · + (tp)P = 1 (mod p2) and, by induction, aP k-t(p-l) = 1 (mod pk), where k = 1, 2, .... Raise both sides of this congruence to the ¢(n)/ p k-1(p - 1) power to get a<f>(n) = 1 (mod pk). Thus, a<f>(n) = 1 (mod n ). 7. Find the units digit of 3100 by means of Euler's theorem. 8. (a) If gcd(a, n) = 1, show that the linear congruence ax = b (mod n) has the solution x = ba<f>(n)-l (mod n). (b) Use part (a) to solve the linear congruences 3x = 5 (mod 26), 13x = 2 (mod 40), and lOx = 21 (mod 49). 9. Use Euler's theorem to evaluate 2100000 (mod 77). 10. For any integer a, show that a and a4n+l have the same last digit. 11. For any prime p, establish each of the assertions below: (a) r(p!) = 2r((p - 1)!). (b) a(p!) = (p + l)a((p - 1)!). (c) ¢(p !) = (p - 1)¢((p - 1)!). 12. Given n � 1, a set of ¢(n) integers that are relatively prime to n and that are incongruent modulo n is called a reduced set of residues modulo n (that is, a reduced set of residues are those members of a complete set of residues modulo n that are relatively prime to n). Verify the following: (a) The integers -31, -16, -8, 13, 25, 80 form a reduced set of residues modulo 9. (b) The integers 3, 32, 33, 34, 35, 36 form a reduced set of residues modulo 14. ( c) The integers 2, 2 2, 23, ... , 218 form a reduced set of residues modulo 27. 13. If p is an odd prime, show that the integers p- 1 p- 1 - - 2 -, ... ' -2, -1, 1, 2, ... ' - 2 - form a reduced set of residues modulo p. 7.4 SOME PROPERTIES OF THE PHI-FUNCTION The next theorem points out a curious feature of the phi-function; namely, that the sum of the values of </J(d), as d ranges over the positive divisors of n, is equal ton itself. This was first noticed by Gauss. Theorem 7.6 Gauss. For each positive integer n � 1, n = :L cfJ<d) din the sum being extended over all positive divisors of n. Proof. The integers between 1 and n can be separated into classes as follows: If dis a positive divisor of n, we put the integer m in the class sd provided that gcd(m' n) = d. Stated in symbols, sd = {m I gcd(m, n) = d; 1 :::; m :::; n} 142 ELEMENTARY NUMBER THEORY Now gcd(m, n) = d if and only if gcd(m / d, n / d) = 1. Thus, the number of integers in the class Sd is equal to the number of positive integers not exceeding n / d that are relatively prime ton/ d; in other words, equal to </J(n / d). Because each of then integers in the set {1, 2, ... , n} lies in exactly one class Sd, we obtain the formula But as d runs through all positive divisors of n, so does n/d; hence, which proves the theorem. Example 7.3. A simple numerical example of what we have just said is provided by n = 10 . Here, the classes Sd are S1 = {1, 3, 7, 9} S2 = {2, 4, 6, 8} Ss = {5} S10 = {10 } These contain ¢(10 ) = 4, ¢(5) = 4, ¢(2) = 1, and </J(l) = 1 integers, respectively. Therefore, z= </J(d) = t/>(10 ) + ¢(5) + ¢(2) + ¢(1) d 110 = 4+4+1+1 = 10 It is instructive to give a second proof of Theorem 7 .6, this one depending on the fact that</> is multiplicative. The details are as follows. If n = 1, then clearly :L <t>(d) = :L <t>(d) = <1>c1) = 1 = n d In d 11 Assuming that n > 1, let us consider the number-theoretic function F(n) = L </>(d) din Because </> is known to be a multiplicative function, Theorem 6.4 asserts that F is also multiplicative. Hence, if n = p�1 p�2 • • • p;' is the prime factorization of n, then EULER'S GENERALIZATION OF FERMAT'S THEOREM 143 For each value of i, F(p�i) = L </>(d) d IP�; = ¢(1) +</>(pi)+ </>(pf) +</>(pf)+ ... + </>(p�i) = 1 +(Pi -1)+ (pl-Pi)+ (pf-pf)+···+ (p�; -p�;-l) k =pi' because the terms in the foregoing expression cancel each other, save for the term p�;. Knowing this, we end up with F( ) ki kz k n = P1 P2 · · · Pr' = n and so n = L:<t>(d) din as desired. We should mention in passing that there is another interesting identity that in­ volves the phi-function. Theorem 7.7. For n > 1, the sum of the positive integers less than n and relatively prime ton is �n¢(n) . Proof. Let a1, a2, ... , a</>(n) be the positive integers less than n and relatively prime to n. Now because gcd(a, n) = 1 if and only if gcd(n - a, n) = 1, the numbers n - a1, n - a2, ... , n - a</>(n) are equal in some order to a1, a2, ... , a</>(n)· Thus, ai + a1 + · · · + a</>(n) = (n - ai) + (n - a1) + · · · + (n - a<Pcn» = ¢(n)n - (a1 + a1 + · · · + a</J(n>} Hence, 2( a1 + a2 + · · · + a</>(n>} = ¢(n )n leading to the stated conclusion. Example 7.4. Consider the case where n = 30 . The ¢( 30 ) = 8 integers that are less than 30 and relatively prime to it are 1, 7, 11, 13, 17, 19,23,29 In this setting, we find that the desired sum is 1 1+7 + 11 + 13 + 17 + 19 + 23 + 29 = 120 = 2 . 30 . 8 Also note the pairings 1+29 = 30 7 + 23 = 30 11+19 = 30 13 + 17 = 30 144 ELEMENTARY NUMBER THEORY This is a good point at which to give an application of the Mobius inversion formula. Theorem 7.8. For any positive integer n, Proof. The proof is deceptively simple. If we apply the inversion formula to the result is F(n) = n = L </>(d) din </>(n) = L µ,(d)F (�) din d = Lµ,(d)� din Let us again illustrate the situation where n = 10. As easily can be seen, 10 I: µ,(d) = 10 [µ,c1) + µ,(2) + µ,(5) + µ,(10) J dllO d 2 5 10 =10 1+ -+ -+ --[ ( -1) ( -1) ( -1)2 ] 2 5 10 [ 1 1 l] 2 = 10 1 - - - -+ - = 10 . - = 4 = </>(10) 2 5 10 5 Starting with Theorem 7 .8, it is an easy matter to determine the value of the phi­ function for any positive integer n. Suppose that the prime-power decomposition of n is n = p�1 p�2 • • • p�', and consider the product Multiplying this out, we obtain a sum of terms of the form µ(l)µ(p�l )µ(p�2) ... µ,(p�') a1 a2 a, P 1 P2 ··· Pr or, because µ, is known to be multiplicative, 0 <a· < k· - I - I µ,(d) d EULER'S GENERALIZATION OF FERMAT'S THEOREM 145 where the summation is over the set of divisors d = p�1 p�2 • • • p�' of n. Hence, P = Ld In µ(d)/d. It follows from Theorem 7.8 that Q>(n) = n L µ� d) = n n (µo) + µ(�i) + ... + µ(�r )) din p;ln Pz Pi But µ(pf;)= 0 whenever ai > 2. As a result, the last-written equation reduces to n ( µ(p i)) n ( 1 ) Q>(n) = n µ(1) + . = n 1 - -. Pi In Pi P; In Pz which agrees with the formula established earlier by different reasoning. What is significant about this argument is that no assumption is made concerning the multi­ plicative character of the phi-function, only ofµ. PROBLEMS 7.4 1. For a positive integer n, prove that if n is even if n is odd [Hint: If n = 2k N, where N is odd, then I:C-1t1d <t><d)= z= <t><d)- L: <1> < 2kd).] d I n d 12k-1 N d I N 2. Confirm that L,d136</>(d) = 36 and L,d136(-1)36/d</>(d) = 0. 3. For a positive integer n, prove that Ld In µ2(d)/4>(d) = n/</>(n). [Hint: Both sides of the equation are multiplicative functions.] 4. Use Problem 4(c), Section 6.2, to proven Ld In µ(d)/d = </>(n). 5. If the integer n > 1 has the prime factorization n = p�1 p�2 • • • p:', establish each of the following: (a) L µ(d)</>(d) = (2 - P1)(2 - P2) · · · (2 - Pr). din (p2k,+l + 1) (p2k2+l + 1) (p2k,+l + 1) (b) L:d<t>(d)= 1 2 ... r . d In Pl + 1 P2 + 1 Pr + 1 (c) L </>(d) = ( l + k 1 (P 1 - 1)) ( l + k1(P2 - 1)) ... ( i + kr(Pr - 1)) . d In d Pl P2 Pr [Hint: For part (a), use Problem 3, Section 6.2.] 6. Verify the formula L,�=l </>(d)[n/d] = n(n + 1)/2 for any positive integer n. [Hint: This is a direct application of Theorems 6.11 and 7 .6.] 7. If n is a square-free integer, prove that Ld 1 n a(dk-l )</>(d) = nk for all integers k :=:: 2. 8. For a square-free integer n > 1, show that r(n2) = n if and only if n = 3. 9. Prove that 31a(3n+2) and 41a(4n+3) for any positive integer n. 146 ELEMENTARY NUMBER THEORY 10. (a) Given k > 0, establish that there exists a sequence of k consecutive integers n + 1, n + 2, ... , n + k satisfying µ,(n + 1) = µ,(n + 2) = · · · = µ,(n + k) = 0 [Hint: Consider the following system of linear congruences, where Pk is the kth pnme: x = -1(mod4), x = -2 (mod 9), ... , x = -k (mod Pl).] (b) Find four consecutive integers for which µ,(n) = 0. 11. Modify the proof of Gauss' theorem to establish that n L gcd(k, n) = L d</> (�) k=l d In = n L </>(d) for n 2'.: 1 din d 12. For n > 2, establish the inequality </>(n2) + </>((n + 1)2) ::=::: 2n2 • 13. Given an integer n, prove that there exists at least one k for which n I </>(k). 14. Show that if n is a product of twin primes, say n = p(p + 2), then </>(n)a(n) = (n + l)(n - 3) 15. Prove that Ld In a(d)</>(n/d) = nr(n) and Ld In r(d)</>(n/d) = a(n). 16. If a1, a2, ... , a<f>(n) is a reduced set of residues modulo n, show that ai + az + · · · + a<f>(n) = 0 (mod n) for n > 2 CHAP TER 8 PRIMITIVE ROOTS AND INDICES ... mathematical proofs, like diamonds, are hard as well as clear, and will be touched with nothing but strict reasoning. 8.1 THE ORDER OF AN INTEGER MODULO n JOHN LOCKE In view ofEuler's theorem, weknow that a<PCn) = 1 (modn), whenever gcd(a, n) = 1. Yet there are often powers of a smaller than a<P(n) that are congruent to 1 modulo n. This prompts the following definition. Definition 8.1. Let n > 1 and gcd(a, n) = 1. The order of a modulo n (in older ter­ minology: the exponent to which a belongs modulo n) is the smallest positive integer k such that ak = 1 (mod n). Consider the successive powers of 2 modulo 7. For this modulus, we obtain the congruences 21 - 2, 2 2 - 4, 23 - 1, 24 - 2, 25 - 4, 26 - 1, ... from which it follows that the integer 2 has order 3 modulo 7. Observe that if two integers are congruent modulo n, then they have the same order modulo n. For if a = b (mod n) and ak = 1 (mod n ), Theorem 4.2 implies that ak - bk (mod n ), whence bk - 1 (mod n ). It should be emphasized that our definition of order modulo n concerns only integers a for which gcd(a, n) = 1. Indeed, if gcd(a, n) > 1, then we know from 147 148 ELEMENTARY NUMBER THEORY Theorem 4.7 that the linear congruence ax = 1 (mod n) has no solution; hence, the relation ak = 1 (mod n) k > 1 cannot hold, for this would imply that x = ak-l is a solution of ax _ 1 (mod n). Thus, whenever there is reference to the order of a modulo n, it is to be assumed that gcd(a, n) = 1, even if it is not explicitly stated. In the example given previously, we have 2 k = 1 (mod 7) whenever k is a multiple of 3, where 3 is the order of 2 modulo 7. Our first theorem shows that this is typical of the general situation. Theorem 8.1. Let the integer a have order k modulo n. Then ah = 1 (mod n) if and only if k I h; in particular, k I </J(n). Proof. Suppose that we begin with k I h, so that h = j k for some integer j. Because ak = 1 (mod n), Theorem 4.2 yields (ak)j = lj (mod n) or ah = 1 (mod n). Conversely, let h be any positive integer satisfying ah = 1 (mod n ). By the Division Algorithm, there exist q and r such that h = qk + r, where 0 ::::: r < k. Consequently, ah = aqk+r = (ak)q ar By hypothesis, both ah = 1 (mod n) and ak = 1 (mod n), the implication of which is that ar = 1 (mod n). Because 0::::: r < k, we end up with r = O; otherwise, the choice of k as the smallest positive integer such that ak = 1 (mod n) is contradicted. Hence, h = q k, and k I h. Theorem 8.1 expedites the computation when we attempt to find the order of an integer a modulo n; instead of considering all powers of a, the exponents can be restricted to the divisors of </>(n). Let us obtain, by way of illustration, the order of 2 modulo 13. Because ¢(13) = 12, the order of 2 must be one of the integers 1, 2, 3, 4, 6, 12. From 26 - 12 212 _ 1 (mod 13) it is seen that 2 has order 12 modulo 13. For an arbitrarily selected divisor d of </>(n ), it is not always true that there exists an integer a having order d modulo n. An example is n = 12. Here </>(12) = 4, yet there is no integer that is of order 4 modulo 12; indeed, we find that 11 = 52 = 7 2 = 112 = 1 (mod 12) and therefore the only choice for orders is 1 or 2. Here is another basic fact regarding the order of an integer. Theorem 8.2. If the integer a has order k modulo n, then ai = aj (mod n) if and only if i = j (mod k). Proof. First, suppose that ai = aj (mod n), where i 2: j. Because a is relatively prime to n, we may cancel a power of a to obtain ai-j = 1 (mod n). According to PRIMITIVE ROOTS AND INDICES 149 Theorem 8.1, this last congruence holds only if k I i - j, which is just another way of saying that i = j (mod k). Conversely, let i = j (mod k). Then we have i = j + qk for some integer q. By the definition of k, ak = 1 (mod n ), so that ai = ai+qk = ai (ak)q = ai (mod n) which is the desired conclusion. Corollary. If a has order k modulo n, then the integers a, a2, ... , ak are incongruent modulo n. Proof. If a; = ai (mod n) for 1 :::; i :::; j :::; k, then the theorem ensures that i = j (mod k). But this is impossible unless i = j. A fairly natural question presents itself: Is it possible to express the order of any integral power of a in terms of the order of a? The answer is contained in Theorem 8.3. Theorem 8.3. If the integer a has order k modulo n and h > 0, then ah has order k/gcd(h, k) modulo n. Proof. Let d = gcd(h, k). Then we may write h =hid and k =kid, with gcd (hi,k1) = 1. Clearly, (ah)k1 = (ah1d)k/d = (ak)h1 = 1 (mod n) If ah is assumed to have order r modulo n, then Theorem 8.1 asserts that r I k1. On the other hand, because a has order k modulo n, the congruence ahr = (ahr = 1 (mod n) indicates that k I hr; in other words, kid I hidr or ki I hir. But gcd(k1, hi)= 1, and therefore ki I r. This divisibility relation, when combined with the one obtained earlier, gives proving the theorem. k k r =k1 = - = --- d gcd(h, k) The preceding theorem has a corollary for which the reader may supply a proof. Corollary. Let a have order k modulo n. Then ah also has order k if and only if gcd(h, k) = 1. Let us see how all this works in a specific instance. Example 8.1. The following table exhibits the orders modulo 13 of the positive integers less than 13: Integer 1 2 3 4 5 6 7 8 9 10 11 12 Order 1 12 3 6 4 12 12 4 3 6 12 2 150 ELEMENTARY NUMBER THEORY We observe that the order of 2 modulo 13 is 12, whereas the orders of 22 and 23 are 6 and 4, respectively; it is easy to verify that 12 12 6= ---­ gcd(2, 12) and 4= ---­ gcd(3, 12) in accordance with Theorem 8.3. The integers that also have order 12 modulo 13 are powers 2 k for which gcd(k, 12) = 1; namely, 21 = 2 25 = 6 27 = 11 211 = 7 (mod 13) If an integer a has the largest order possible, then we call it a primitive root of n. Definition 8.2. If gcd(a, n) = 1 and a is of order <f>(n) modulo n, then a is a primitive root of the integer n. To put it another way, n has a as a primitive root if ac/>(n) = 1 (mod n ), but ak ¢ 1 (mod n) for all positive integers k < </>(n). It is easy to see that 3 is a primitive root of 7, for 31 _ 3 32 _ 2 33 _ 6 34 _ 4 35 _ 5 36 - 1 (mod 7) More generally, we can prove that primitive roots exist for any prime modulus, which is a result of fundamental importance. Although it is possible for a primitive root of n to exist when n is not a prime (for instance, 2 is a primitive root of 9), there is no reason to expect that every integer n possesses a primitive root; indeed, the existence of primitive roots is more often the exception than the rule. Example 8.2. Let us show that if Fn = 22n + 1, n > 1, is a prime, then 2 is not a primitive root of Fn· (Clearly, 2 is a primitive root of 5 = F1.) From the factorization 2n+I 2n 2n 2 - 1 = (2 + 1) (2 - 1), we have 2n+I 2 = 1 (mod Fn) which implies that the order of 2 modulo Fn does not exceed 2n+ 1 . But if Fn is assumed to be prime, then and a straightforward induction argument confirms that 22n > 2n+ 1 , whenever n > 1. Thus, the order of 2 modulo Fn is smaller than <f>(Fn); referring to Definition 8.2, we see that 2 cannot be a primitive root of Fn. One of the chief virtues of primitive roots lies in our next theorem. Theorem 8.4. Let gcd( a, n) = 1 and let a 1 , a1, ... , a</>(n) be the positive integers less than n and relatively prime to n. If a is a primitive root of n, then 2 <f>(n) a, a , ... , a are congruent modulo n to al, a1, ... , a</>(n). in some order. PRIMITIVE ROOTS AND INDICES 151 Proof. Because a is relatively prime to n, the same holds for all the powers of a; hence, each ak is congruent modulo n to some one of the ai. The </>(n) numbers in the set {a, a2, ..• , a<P<n)} are incongruent by the corollary to Theorem 8. 2; thus, these powers must represent (not necessarily in order of appearance) the integers ai, az, ... , a</J( n)· One consequence of what has just been proved is that, in those cases in which a primitive root exists, we can now state exactly how many there are. Corollary. If n has a primitive root, then it has exactly </>(</>(n)) of them. Proof. Suppose that a is a primitive root of n. By the theorem, any other primitive root of n is found among the members of the set {a, a2, ... , a<P<n)}. But the number of powers ak, 1 :::; k :::; </>(n ), that have order </>(n) is equal to the number of integers k for which gcd(k, </>(n)) = l; there are </>(</>(n)) such integers, hence, </>(</>(n)) primitive roots of n. Theorem 8.4 can be illustrated by taking a = 2 and n = 9. Because ¢(9) = 6, the first six powers of 2 must be congruent modulo 9, in some order, to the positive integers less than 9 and relatively prime to it. Now the integers less than and relatively prime to 9 are 1, 2, 4, 5, 7, 8, and we see that 21 _ 2 22 _ 4 23 _ 8 24 _ 7 25 _ 5 26 _ 1 (mod 9) By virtue of the corollary, there are exactly ¢(¢(9)) = ¢(6) = 2 primitive roots of 9, these being the integers 2 and 5. PROBLEMS 8.1 1. Find the order of the integers 2, 3, and 5: (a) modulo 17. (b) modulo 19. (c) modulo 23. 2. Establish each of the statements below: (a) If a has order hk modulo n, then ah has order k modulo n. (b) If a has order 2k modulo the odd prime p, then ak = -1 (mod p ). (c) If a has order n - 1 modulo n, then n is a prime. 3. Prove that </>(2n - 1) is a multiple of n for any n > 1. [Hint: The integer 2 has order n modulo 2n - 1.] 4. Assume that the order of a modulo n is h and the order of b modulo n is k. Show that the order of ab modulo n divides hk; in particular, if gcd(h, k) = 1, then ab has order hk. 5. Given that a has order 3 modulo p, where p is an odd prime, show that a + 1 must have order 6 modulo p. [Hint: From a2 +a+ 1 = 0 (mod p), it follows that (a+ 1)2 =a (mod p) and (a+ 1)3 = -1 (mod p).] 6. Verify the following assertions: (a) The odd prime divisors of the integer n2 + 1 are of the form 4k + 1. [Hint: n2 = -1 (mod p), where p is an odd prime, implies that 41 </>(p) by Theorem 8.1.] (b) The odd prime divisors of the integer n4 + 1 are of the form 8k + 1. ( c) The odd prime divisors of the integer n 2 + n + 1 that are different from 3 are of the form6k + 1. 152 ELEMENTARY NUMBER THEORY 7. Establish that there are infinitely many primes of each of the forms 4k + 1, 6k + 1, and 8k + 1. [Hint: Assume that there are only finitely many primes of the form 4k + 1; call them pi, p2, ... , Pr· Consider the integer (2P1P2 · · · Pr)2 + 1 and apply the previous prob­ lem.] 8. (a) Prove that if p and q are odd primes and q I aP - 1, then either q I a - 1 or else q = 2kp + 1 for some integer k. [Hint: Because aP = 1 (mod q), the order of a modulo q is either 1 or p; in the latter case, p I <f>(q).] (b) Use part (a) to show that if pis an odd prime, then the prime divisors of 2P - 1 are of the form 2kp + 1. ( c) Find the smallest prime divisors of the integers 217 - 1 and 229 - 1. 9. (a) Verify that 2 is a primitive root of 19, but not of 17. (b) Show that 15 has no primitive root by calculating the orders of 2, 4, 7, 8, 11, 13, and 14 modulo 15. 10. Let r be a primitive root of the integer n. Prove that rk is a primitive root of n if and only if gcd(k, Q>(n)) = 1. 11. (a) Find two primitive roots of 10. (b) Use the information that 3 is a primitive root of 17 to obtain the eight primitive roots of 17. 12. (a) Prove that if p and q > 3 are both odd primes and q I R P, then q = 2k p + 1 for some integer k. (b) Find the smallest prime divisors of the repunits R5 = 11111 and R7 = 1111111. 13. (a) Let p > 5 be prime. If Rn is the smallest repunit for which p I Rn, establish that n I p - 1. For example, Rs is the smallest repunit divisible by 73, and 8 172. [Hint: The order of 10 modulo pis n.] (b) Find the smallest Rn divisible by 13. 8.2 PRIMITIVE ROOTS FOR PRIMES Because primitive roots play a crucial role in many theoretical investigations, a prob­ lem exerting a natural appeal is that of describing all integers that possess primitive roots. We shall, over the course of the next few pages, prove the existence of primitive roots for all primes. Before doing this, let us turn aside briefly to establish Lagrange's theorem, which deals with the number of solutions of a polynomial congruence. Theorem 8.5 Lagrange. If p is a prime and an¢:. 0 (mod p) is a polynomial of degree n � 1 with integral coefficients, then the congruence f(x) = 0 (mod p) has at most n incongruent solutions modulo p. Proof. We proceed by induction on n, the degree of f(x). If n = 1, then our polynomial is of the form f(x) = aix + ao PRIMITIVE ROOTS AND INDICES 153 Because gcd(a1, p) = 1, Theorem 4.7 asserts that the congruence a1x = -a0 (mod p) has a unique solution modulo p. Thus, the theorem holds for n = 1. Now assume inductively that the theorem is true for polynomials of degree k - 1, and consider the case in which f(x) has degree k. Either the congruence f(x) = 0 (mod p) has no solutions (and we are finished), or it has at least one solution, call it a. If f(x) is divided by x - a, the result is f(x) = (x - a)q(x) + r in which q(x) is a polynomial of degree k - 1 with integral coefficients and r is an integer. Substituting x =a, we obtain 0 = f(a) =(a - a)q(a) + r = r (mod p) and therefore f(x) = (x - a)q(x) (mod p). If b is another one of the incongruent solutions of f (x) = 0 (mod p ), then 0 = f(b) = (b - a)q(b) (mod p) Because b - a =fa 0 (mod p), we may cancel to conclude that q(b) = 0 (mod p); in other words, any solution of f(x) = 0 (mod p) that is different from a must satisfy q(x) = 0 (mod p). By our induction assumption, the latter congruence can possess at most k - 1 incongruent solutions, and therefore f (x) = 0 (mod p) has no more than k incongruent solutions. This completes the induction step and the proof. From this theorem, we can pass easily to the corollary. Corollary. If p is a prime number and d I p -1, then the congruence xd -1 = O(mod p) has exactly d solutions. Proof. Because d Ip -1, we have p -1 = dk for some k. Then xp-l -1 = (xd - l)f(x) where the polynomial f(x) = xd(k-l) + xd(k-2) + · · · + xd + 1 has integral coefficients and is of degree d(k - 1) = p -1 - d. By Lagrange's theorem, the congruence f(x) = 0 (mod p) has at most p -1 - d solutions. We also know from Fermat's theorem that xp-l - 1 - 0 (mod p) has precisely p - 1 incongruent solutions; namely, the integers 1, 2, ... , p -1. Now any solution x - a (mod p) of xP-l -1 - 0 (mod p) that is not a solution of f(x) = 0 (mod p) must satisfy xd -1 = 0 (mod p). For 0 = ap-l -1 =(ad - l)f(a) (mod p) with p ,,r f(a), implies that p I ad -1. It follows that xd - 1 = 0 (mod p) must have at least p -1 - (p -1 - d) = d solutions. This last congruence can possess no more than d solutions (Lagrange's theorem enters again) and, hence, has exactly d solutions. 154 ELEMENTARY NUMBER THEORY We take immediate advantage of this corollary to prove Wilson's theorem in a different way: given a prime p, define the polynomial f (x) by f(x) = (x - l)(x - 2) · · · (x - (p - 1)) - (xP-l - 1) = ap -2xP-2 + ap_3xP-3 + · · · + alx + ao which is of degree p - 2. Fermat's theorem implies that the p - 1 integers 1, 2, ... , p - 1 are incongruent solutions of the congruence f(x) = 0 (mod p) But this contradicts Lagrange's theorem, unless ap-2 - ap-3 - · · · - al - ao - 0 (mod p) It follows that, for any choice of the integer x, (x - l)(x - 2) · · · (x - (p - 1)) - (xp-l - 1) = 0 (mod p) Now substitute x = 0 to obtain (-1)(-2) · · · (-(p - 1)) + 1 = 0 (mod p) or (-l)P-1(p - l)! + 1 = 0 (mod p ). Either p - 1 is even or p = 2, in which case -1 = 1 (mod p ); at any rate, we get (p - l)! = -1 (mod p) Lagrange's theorem has provided us with the entering wedge. We are now in a position to prove that, for any prime p, there exist integers with order corresponding to each divisor of p - 1. We state this more precisely in Theorem 8.6. Theorem 8.6. If p is a prime number and d Ip - 1, then there are exactly </>(d) incongruent integers having order d modulo p. Proof. Let d Ip - 1 and l/f (d) denote the number of integers k, 1 :=:: k :=:: p - 1, that have order d modulo p. Because each integer between 1 and p - 1 has order d for some d Ip - 1, p - 1 = :L t(d) dip-I At the same time, Gauss's theorem tells us that p - 1 = :L <t>(d) dip-I and therefore, putting these together, :L l/J(d) = :L <t>(d) dip-I dip-I (1) Our aim is to show that l/f(d) ::::: </>(d) for each divisor d of p - 1, because this, in conjunction with Eq. (1), would produce the equality l/f(d) = </>(d) =!= 0 (otherwise, the first sum would be strictly smaller than the second). Given an arbitrary divisor d of p - 1, there are two possibilities: we either have l/f(d) = 0 or 1/f(d) > 0. If l/f(d) = 0, then certainly l/f(d) :=:: </>(d). Suppose that PRIMITIVE ROOTS AND INDICES 155 1/f (d) > 0, so that there exists an integer a of order d. Then the d integers a, a2, ... , ad are incongruent modulo p and each of them satisfies the polynomial congruence xd - 1 = 0 (mod p) (2) for, (ak)d = (ad )k = 1 (mod p ). By the corollary to Lagrange's theorem, there can be no other solutions of Eq. (2). It follows that any integer having order d modulo p must be congruent to one of a, a2, ••• , ad . But only </>(d) of the just-mentioned powers have order d, namely those ak for which the exponent k has the property gcd(k, d) = 1. Hence, in the present situation, 1/f(d) = cp(d), and the number of integers having order d modulo p is equal to cp(d). This establishes the result we set out to prove. Taking d = p - 1 in Theorem 8.6, we arrive at the following corollary. Corollary. If pis a prime, then there are exactly cp(p - 1) incongruent primitive roots of p. An illustration is afforded by the prime p = 13. For this modulus, 1 has order 1; 12 has order 2; 3 and 9 have order 3; 5 and 8 have order 4; 4 and 10 have order 6; and four integers, namely 2, 6, 7, 11, have order 12. Thus, I: 1/l(d) = 1/f(l) + 1/1(2) + 1/1(3) + 1/1(4) + 1/1(6) + 1/1(12) d 112 = 1 + 1 + 2 + 2 + 2 + 4 = 12 as it should. Also notice that 1/1(1) = 1 = ¢(1) 1/1(2) = 1 = ¢(2) 1/1(3) = 2 = ¢(3) 1/1(4) = 2 = ¢(4) 1/1(6) = 2 = ¢(6) 1/f (12) = 4 = ¢(12) Incidentally, there is a shorter and more elegant way of proving that 1/f (d) = </J(d) for each d Ip - 1. We simply subject the formula d =Leid 1/f(c) to Mobius inversion to deduce that d 1/J(d) = I: µ,(c)- e Id c In light of Theorem 7. 8, the right-hand side of the foregoing equation is equal to¢( d). Of course, the validity of this argument rests upon using the corollary to Theorem 8.5 to show that d = Le 1 d 1/f (c ). We can use this last theorem to give another proof of the fact that if p is a prime of the form 4k + 1, then the quadratic congruence x2 _ -1 (mod p) admits a solution. Because 41 p - 1, Theorem 8.6 tells us that there is an integer a having order 4 modulo p; in other words, a4 = 1 (mod p) or equivalently, (a2 - l)(a2 + 1) = 0 (mod p) 156 ELEMENTARY NUMBER THEORY Because p is a prime, it follows that either a2 - 1 = 0 (mod p) or a2 + 1 = 0 (mod p) If the first congruence held, then a would have order less than or equal to 2, a contradiction. Hence, a2 + 1 = 0 (mod p ), making the integer a a solution to the congruence x2 _ -1 (mod p ). Theorem 8.6, as proved, has an obvious drawback; although it does indeed imply the existence of primitive roots for a given prime p, the proof is nonconstructive. To find a primitive root, we usually must either proceed by brute force or fall back on the extensive tables that have been constructed. The accompanying table lists the smallest positive primitive root for each prime below 200. Least positive Least positive Prime primitive root Prime primitive root 2 1 89 3 3 2 97 5 5 2 101 2 7 3 103 5 11 2 107 2 13 2 109 6 17 3 113 3 19 2 127 3 23 5 131 2 29 2 137 3 31 3 139 2 37 2 149 2 41 6 151 6 43 3 157 5 47 5 163 2 53 2 167 5 59 2 173 2 61 2 179 2 67 2 181 2 71 7 191 19 73 5 193 5 79 3 197 2 83 2 199 3 If x (p) designates the smallest positive primitive root of the prime p, then the table presented shows that x(p) < 19 for all p < 200. In fact, x(p) becomes arbitrarily large as p increases without bound. The table suggests, although the answer is not yet known, that there exist an infinite number of primes p for which x(p) = 2. In most cases x(p) is quite small. Among the 78498 odd primes up to 106, x(p) < 6 holds for about 80% of these primes; x(p) = 2 takes place for 29841 primes or approximately 37 % of the time, whereas x (p) = 3 happens for 17814 primes, or 22% of the time. PRIMITIVE ROOTS AND INDICES 157 In his Disquisitiones Arithmeticae, Gauss conjectured that there are infinitely many primes having 10 as a primitive root. In 1927, Emil Artin generalized this unresolved question as follows: for a not equal to 1, -1, or a perfect square, do there exist infinitely many primes having a as a primitive root? Although there is little doubt that this latter conjecture is true, it has yet to be proved. Recent work has shown that there are infinitely many a's for which Artin's conjecture is true, and at most two primes for which it fails. The restrictions in Artin's conjecture are justified as follows. Let a be a perfect square, say a= x2, and let p be an odd prime with gcd(a, p) = 1. If p l x, then Fermat's theorem yields xP-l _ 1 (mod p), whence aCp-1)/2 - (x2)(p-l)/2 - 1 (mod p) Thus, a cannot serve as a primitive root of p [if p Ix, then p I a and surely aP-l ¢ 1 (mod p )]. Furthermore, because (-1)2 = 1, -1 is not a primitive root of p when­ ever p - 1 > 2. Example 8.3. Let us employ the various techniques of this section to find the </>( 6) = 2 integers having order 6 modulo 31. To start, we know that there are </J(</>(31)) = </>(30) = 8 primitive roots of 31. Obtaining one of them is a matter of trial and error. Because 25 = 1 (mod 31), the integer 2 is clearly ruled out. We need not search too far, because 3 turns out to be a primitive root of 31. Observe that in computing the integral powers of 3 it is not necessary to go beyond 315; for the order of 3 must divide </>(31) = 30 and the calculation 315 = (27)5 = (-4)5 = (-64)(16) = -2(16) = -1 ¢= 1 (mod 31) shows that its order is greater than 15. Because 3 is a primitive root of 31, any integer that is relatively prime to 31 is congruent modulo 31 to an integer of the form 3k, where 1 :S k :S 30. Theorem 8.3 asserts that the order of 3k is 30/gcd(k, 30); this will equal 6if and only if gcd(k, 30) = 5. The values of k for which the last equality holds are k = 5 and k = 25. Thus our problem is now reduced to evaluating 35 and 325 modulo 31. A simple calculation gives 35 = (27)9 = (-4)9 = -36 = 26 (mod 31) 325 = (35)5 = (26)5 = (-5)5 = (-125)(25) = -1(25) = 6 (mod 31) so that 6 and 26 are the only integers having order 6 modulo 31. PROBLEMS 8.2 1. If p is an odd prime, prove the following: (a) The only incongruent solutions of x2 = 1 (mod p) are 1 and p - 1. (b) The congruence xP-2 + · · · + x2 + x + 1 = 0 (mod p) has exactly p - 2 incongru­ ent solutions, and they are the integers 2, 3, ... , p - 1. 2. Verify that each of the congruences x2 = 1 (mod 15), x2 = -1 (mod 65), and x2 = -2 (mod 33) has four incongruent solutions; hence, Lagrange's theorem need not hold if the modulus is a composite number. 158 ELEMENTARY NUMBER THEORY 3. Determine all the primitive roots of the primes p = 11, 19, and 23, expressing each as a power of some one of the roots. 4. Given that 3 is a primitive root of 43, find the following: (a) All positive integers less than 43 having order 6 modulo 43. (b) All positive integers less than 43 having order 21 modulo43. 5. Find all positive integers less than 61 having order 4 modulo 61. 6. Assuming that r is a primitive root of the odd prime p, establish the following facts: (a) The congruence r(p-l)/2 = -1 (mod p) holds. (b) If r' is any other primitive root of p, then rr' is not a primitive root of p. [Hint: By part (a), (rr')(p-l)/2 = 1 (mod p ).] (c) If the integer r' is such that rr' = 1 (mod p), then r' is a primitive root of p. 7. For a prime p > 3, prove that the primitive roots of p occur in incongruent pairs r, r' where rr' = 1 (mod p ). [Hint: If r is a primitive root of p, consider the integer r' = rP-2 .] 8. Let r be a primitive root of the odd prime p. Prove the following: (a) If p = 1 (mod 4), then -r is also a primitive root of p. (b) If p = 3 (mod 4), then -r has order (p - 1)/2 modulo p. 9. Give a different proof of Theorem 5.5 by showing that if r is a primitive root of the prime p = 1 (mod 4), then r<p-l)/4 satisfies the quadratic congruence x2 + 1 = 0 (mod p). 10. Use the fact that each prime p has a primitive root to give a different proof of Wilson's theorem. [Hint: If p has a primitive root r, then Theorem 8.4 implies that (p - l)! = r1+2+··+(p-l) (mod p).] 11. If pis a prime, show that the product of the </J(p - 1) primitive roots of pis congruent modulo p to ( -1 )</J(p-l). [Hint: If r is a primitive root of p, then the integer rk is a primitive root of p provided that gcd(k, p - 1) = 1; now use Theorem 7.7.] 12. For an odd prime p, verify that the sum 1n + 2n + 3n + ... + (p _It = { 0 (mod p) -l (mod p) if (p - 1) l n if (p - 1) In [Hint: If (p - 1) l n, and r is a primitive root of p, then the indicated sum is congruent modulo p to r(p-l)n - 1 1 + rn + r2n + ... + r(p-2)n = .] rn - 1 8.3 COMPOSITE NUMBERS HAVING PRIMITIVE ROOTS We saw earlier that 2 is a primitive root of 9, so that composite numbers can also possess primitive roots. The next step in our program is to determine all composite numbers for which there exist primitive roots. Some information is available in the following two negative results. Theorem 8.7. For k 2: 3, the integer 2k has no primitive roots. Proof. For reasons that will become clear later, we start by showing that if a is an odd integer, then for k 2: 3 PRIMITIVE ROOTS AND INDICES 159 If k = 3, this congruence becomes a2 = 1 (mod 8), which is certainly true (indeed, 12 = 32 = 52 = 72 = 1 (mod 8)). Fork> 3, we proceed by induction on k. Assume that the asserted congruence holds for the integer k; that is, a2k-z = 1 (mod 2k). This is equivalent to the equation a2k-2 = 1 + b2k where b is an integer. Squaring both sides, we obtain a2k-1 = (a2k-2)2 = 1 + 2(b2k) + (b2k)2 = 1+2k+1(b + b22k-l) = 1 (mod 2k+1) so that the asserted congruence holds for k + 1 and, hence, for all k ;::: 3. Now the integers that are relatively prime to 2k are precisely the odd integers, so that ¢(2k) = 2k-I _By what was just proved, if a is an odd integer and k ;::: 3, a!/JC2k>12 = 1 (mod 2k) and, consequently, there are no primitive roots of 2k. Another theorem in this same spirit is Theorem 8.8. Theorem 8.8. If gcd(m, n) = 1, where m > 2 and n > 2, then the integer mn has no primitive roots. Proof. Consider any integer a for which gcd(a, mn) = 1; then gcd(a, m) = 1 and gcd(a, n) = 1. Put h = lcm(</J(m), </J(n)) and d = gcd(¢(m), </J(n)). Because </J(m) and ¢(n) are both even (Theorem 7.4), surely d ;::: 2. In conse­ quence, h = </J(m)</J(n) < </J(mn) d - 2 Now Euler's theorem asserts that a!/J(m) = 1 (mod m). Raising this congruence to the </J(n)/d power, we get ah = (a!/J(m))!/J(n)/d = 11/J(n)/d = 1 (mod m) Similar reasoning leads to ah = 1 (mod n). Together with the hypothesis gcd(m, n) = 1, these congruences force the conclusion that ah = 1 (mod mn) The point we wish to make is that the order of any integer relatively prime to mn does not exceed </J(mn)/2, whence there can be no primitive roots for mn. Some special cases of Theorem 8.8 are of particular interest, and we list these below. Corollary. The integer n fails to have a primitive root if either (a) n is divisible by two odd primes, or (b) n is of the form n = 2m pk, where p is an odd prime and m ;::: 2. 160 ELEMENTARY NUMBER THEORY The significant feature of this last series of results is that it restricts our search for primitive roots to the integers 2, 4, pk, and 2 pk, where p is an odd prime. In this section, we prove that each of the numbers just mentioned has a primitive root, the major task being the establishment of the existence of primitive roots for powers of an odd prime. The argument is somewhat long-winded, but otherwise routine; for the sake of clarity, it is broken down into several steps. Lemma 1. If p is an odd prime, then there exists a primitive root r of p such that rp-l ¥= 1 (mod p2). Proof. From Theorem 8.6, it is known that p has primitive roots. Choose one, and call it r. If rP-l ¥= 1 (mod p2), then we are finished. In the contrary case, replace r by r' = r + p, which is also a primitive root of p. Then employing the binomial theorem, (r')P-l = (r + p)p-l = rp-l + (p - l)prP-2 (mod p 2) But we have assumed that rp-l = 1 (mod p2); hence, (r')P-l = 1 - prP-2 (mod p2) Because r is a primitive root of p, gcd(r, p) = 1, and therefore p l rP-2. The outcome of all this is that (r')P-1 ¥= 1 (mod p2), which proves the lemma. Corollary. If p is an odd prime, then p2 has a primitive root; in fact, for a primitive root r of p, either r or r + p (or both) is a primitive root of p2. Proof. The assertion is almost obvious: if r is a primitive root of p, then the order of r modulo p2 is either p - 1 or p(p - 1) = ¢(p2). The foregoing proof shows that if r has order p - 1 modulo p2, then r + p is a primitive root of p2• As an illustration of this corollary, we observe that 3 is a primitive root of 7, and that both 3 and 10 are primitive roots of 72. Also, 14 is a primitive root of 29 but not of 292. To reach our goal, another somewhat technical lemma is needed. Lemma 2. Let p be an odd prime and let r be a primitive root of p with the property that rp-l ¥= 1 (mod p2). Then for each positive integer k � 2, rPk-2(p-l) ¥= 1 (mod pk) Proof. The proof proceeds by induction on k. By hypothesis, the assertion holds for k = 2. Let us assume that it is true for some k � 2 and show that it is true for k + 1. Because gcd(r, pk-l) = gcd(r, pk)= 1, Euler's theorem indicates that rPk-2(p-l) = r<l><Pk-1) = 1 (mod pk-1) Hence, there exists an integer a satisfying rPk-2(p-l) = 1 + apk-1 PRIMITIVE ROOTS AND INDICES 161 where p l a by our induction hypothesis. Raise both sides of this last equation to the pth power and expand to obtain rPk-l(p-1) = (1 + apk-I)p = 1 + apk (mod pk+I) Because the integer a is not divisible by p, we have rPk-'(p-I) ¢. 1 (mod pk+ I) This completes the induction step, thereby proving the lemma. The hard work, for the moment, is over. We now stitch the pieces together to prove that the powers of any odd prime have a primitive root. Theorem 8.9. If p is an odd prime number and k 2: l, then there exists a primitive root for pk. Proof. The two lemmas allow us to choose aprimitive rootr of p for whichrPk- 2Cp-l) ¢. 1 (mod pk); in fact, any integer r satisfying the condition rp-I ¢. 1 (mod p2) will do. We argue that such an r serves as a primitive root for all powers of p. Let n be the order of r modulo pk. In compliance with Theorem 8.1, n must divide </J(pk) = pk-I(p - 1). Because rn = 1 (mod pk) yields rn = 1 (mod p), we also have p - 11 n. (Theorem 8.1 serves again.) Consequently, n assumes the form n = pm(p - 1), where 0:::; m :::; k - 1. If it happened that n =j:. pk-I(p - 1), then pk-2(p - 1) would be divisible by n and we would arrive at rPk-2(p-I) = 1 (mod pk) contradicting the way in which r was initially chosen. Therefore, n = pk-I (p - 1) and r is a primitive root for pk. This leaves only the case 2 pk for our consideration. Corollary. There are primitive roots for 2pk, where p is an odd prime and k 2: 1. Proof. Let r be a primitive root for pk. There is no harm in assuming that r is an odd integer; for, if it is even, then r + pk is odd and is still a primitive root for pk. Then gcd(r, 2pk) = 1. The order n of r modulo 2pk must divide ¢(2pk) = ¢(2)</J(pk) = </J(pk) But rn = 1 (mod 2pk) implies that rn = 1 (mod pk), and therefore </J(pk) In. Together these divisibility conditions force n = </J(2pk), making r a primitive root of 2pk. The prime 5 has ¢(4) = 2 primitive roots, namely, the integers 2 and 3. Because 25-1 _ 16 ¢ 1 (mod 25) and 35-1 _ 6 ¢ 1 (mod 25) these also serve as primitive roots for 52 and, hence, for all higher powers of 5. The proof of the last corollary guarantees that 3 is a primitive root for all numbers of the form 2 . 5k. In Theorem 8.10 we summarize what has been accomplished. 162 ELEMENTARY NUMBER THEORY Theorem 8.10. An integer n > 1 has a primitive root if and only if n = 2,4, pk,or 2 pk where p is an odd prime. Proof. By virtue of Theorems 8. 7 and 8.8, the only positive integers with primitive roots are those mentioned in the statement of our theorem. It may be checked that 1 is a primitive root for 2, and 3 is a primitive root of 4. We have just finished proving that primitive roots exist for any power of an odd prime and for twice such a power. This seems the opportune moment to mention that Euler gave an essentially correct (although incomplete) proof in 1773 of the existence of primitive roots for any prime p and listed all the primitive roots for p < 37. Legendre, using Lagrange's theorem, managed to repair the deficiency and showed (1785) that there are </>(d) integers of order d for each d I (p - 1). The greatest advances in this direction were made by Gauss when, in 1801, he published a proof that there exist primitive roots of n if and only if n = 2, 4, pk, and 2pk , where p is an odd prime. PROBLEMS 8.3 1. (a) Find the four primitive roots of 26 and the eight primitive roots of 25. (b) Determine all the primitive roots of 32, 33, and 34. 2. For an odd prime p, establish the following facts: (a) There are as many primitive roots of 2pn as of pn. (b) Any primitive root r of pn is also a primitive root of p. [Hint: Let r have order k modulo p. Show that rPk = 1 (mod p2), ... , rP\"-1k = 1 (mod pn) and, hence, </J(pn) I pn-lk. ] ( c) A primitive root of p2 is also a primitive root of pn for n ::=::: 2. 3. If r is a primitive root of p2, p being an odd prime, show that the solutions of the congruence xP-l = 1 (mod p2) are precisely the integers rP, r2P, ... , r<p-I)p. 4. (a) Prove that 3 is a primitive root of all integers of the form 7k and 2 · 7k. (b) Find a primitive root for any integer of the form 17k. 5. Obtain all the primitive roots of 41 and 82. 6. (a) Prove that a primitive root r of pk, where p is an odd prime, is a primitive root of 2 pk if and only if r is an odd integer. (b) Confirm that 3, 33, 35, and 39 are primitive roots of 578 = 2 · 172, but that 34 and 317 are not. 7. Assume that r is a primitive root of the odd prime p and (r + tp)P-l ¢. 1 (mod p2). Show that r + t p is a primitive root of pk for each k ::=::: 1. 8. If n = 2ko p�1 p�2 ••• p;r is the prime factorization of n > 1, define the universal exponent .A( n) of n by .A( n) = lcm(.A(2ko), </J(p�1 ), ... '</J(p�r)) where .A(2) = 1, .A(22) = 2, and .A(2k) = 2k-2 fork ::::: 3. Prove the following statements concerning the universal exponent: (a) For n = 2, 4, pk, 2 p k, where pis an odd prime, .A( n) = <f>(n). (b) If gcd(a, 2k) = 1, then aJ..<2k) = 1 (mod 2k). [Hint: Fork ::=::: 3, use induction on k and the fact that .A(2k+1) = 2.A(2k). ] (c) If gcd(a, n) = 1, then aJ..(n) = 1 (mod n). [Hint: For each prime power pk occurring inn, aJ..(n) = 1 (mod pk). ] PRIMITIVE ROOTS AND INDICES 163 9. Verify that, for 5040 = 2 4 • 32 • 5 · 7, A.(5040) = 12 and ¢(5040) = 1152. 10. Use Problem 8 to show that if n =j:. 2, 4, pk, 2pk, where pis an odd prime, then n has no primitive root. [Hint: Except for the cases 2, 4, pk, 2pk, we have A.(n) I � ¢(n); hence, gcd(a, n) = 1 implies that a<P(n)/2 = 1 (mod n).] 11. (a) Prove that if gcd(a, n) = 1, then the linear congruence ax = b (mod n) has the solution x = baA.(n)-l (mod n). (b) Use part (a) to solve the congruences 13x = 2 (mod 40) and 3x = 13 (mod 77). 8.4 THE THEORY OF INDICES The remainder of the chapter is concerned with a new idea, the concept of index. This was introduced by Gauss in his Disquisitiones Arithmeticae. Let n be any integer that admits a primitive root r. As we know, the first </>(n) powers of r, 2 ¢(n) r, r , ... , r are congruent modulo n, in some order, to those integers less than n and relatively prime to it. Hence, if a is an arbitrary integer relatively prime to n, then a can be expressed in the form a= r k (mod n) for a suitable choice of k, where 1 < k ::: </>(n ). This allows us to frame the following definition. Definition 8.3. Let r be a primitive root of n. If gcd(a, n) = 1, then the smallest positive integer k such that a = r k (mod n) is called the index of a relative to r. Customarily, we denote the index of a relative to r by indr a or, if no confusion is likely to occur, by ind a. Clearly, 1 ::;: indr a < </>(n) and rind, a =a (mod n) The notation indr a is meaningless unless gcd(a, n) = 1; in the future, this will be tacitly assumed. For example, the integer 2 is a primitive root of 5 and 24 = 1(mod5) It follows that ind2 1 = 4 ind2 2 = 1 ind2 3 = 3 ind2 4 = 2 Observe that indices of integers that are congruent modulo n are equal. Thus, when setting up tables of values for ind a, it suffices to consider only those integers a less than and relatively prime to the modulus n. To see this, let a = b (mod n ), where a and bare taken to be relatively prime to n. Because rinda =a (mod n) and rindb = b (mod n), we have rinda _ rindb (mod n) PRIMITIVE ROOTS AND INDICES 165 congruence x2 = a (mod p) has a solution if and only if 2 I ind a; when this con­ dition is fulfilled, there are exactly two solutions. If r is a primitive root of p, then rk ( 1 < k � p - 1) runs modulo p through the integers 1, 2, ... , p - 1, in some order. The even powers of r produce the values of a for which the congruence x2 =a (mod p) is solvable; there are precisely (p - 1)/2 such choices for a. Example 8.4. For an illustration of these ideas, let us solve the congruence 4x9 = 7 (mod 13) A table of indices can be constructed once a primitive root of 13 is fixed. Using the primitive root 2, we simply calculate the powers 2, 2 2, ... , 212 modulo 13. Here, 21 = 2 25 = 6 29 =5 2 2 = 4 26 = 12 210 = 10 23 = 8 27 = 11 211 = 7 24 = 3 28 = 9 212 = 1 all congruences being modulo 13; hence, our table is a 1 2 3 4 5 6 7 8 9 10 11 12 12 1 4 2 9 5 11 3 8 10 7 6 Taking indices, the congruence 4x9 = 7 (mod 13) has a solution if and only if ind2 4 + 9 ind2 x = ind2 7 (mod 12) The table gives the values ind2 4 = 2 and ind2 7 = 11, so that the last congruence becomes 9 ind2 x = 11 - 2 = 9 (mod 12), which, in turn, is equivalent to having ind2 x = 1 (mod 4). It follows that ind2 x = 1, 5, or 9 Consulting the table of indices once again, we find that the original congruence 4x9 = 7 (mod 13) possesses the three solutions x = 2, 5, and 6 (mod 13) If a different primitive root is chosen, we obviously obtain a different value for the index of a; but, for purposes of solving the given congruence, it does not really matter which index table is available. The ¢(¢(13)) = 4 primitive roots of 13 are obtained from the powers 2k(l :::; k :::; 12), where gcd(k, ¢(13)) = gcd(k, 12) = 1 These are 21 = 2 25 = 6 27 = 11 211 = 7 (mod 13) The index table for, say, the primitive root 6 is displayed below: a 1 2 3 4 5 6 7 8 9 10 11 12 in�a 12 5 8 10 9 1 7 3 4 2 11 6 166 ELEMENTARY NUMBER THEORY Employing this table, the congruence 4x9 = 7 (mod 13) is replaced by ind6 4 + 9 in� x = ind6 7 (mod 12) or, rather, 9 ind6 x = 7 - 10 = -3 = 9 (mod 12) Thus, ind6 x = 1, 5, or 9, leading to the solutions x = 2, 5, and 6 (mod 13) as before. The following criterion for solvability is often useful. Theorem 8.12. Let n be an integer possessing a primitive root and let gcd(a, n) = 1. Then the congruence xk =a (mod n) has a solution if and only if a</l(n)/d = 1 (mod n) where d = gcd(k, </>(n)); if it has a solution, there are exactly d solutions modulo n. Proof. Taking indices, the congruence a</l(n)/d = 1 (mod n) is equivalent to </>(n) . d md a= 0 (mod </>(n)) which, in tum, holds if and only if d I ind a. But we have just seen that the latter is a necessary and sufficient condition for the congruence xk =a (mod n) to be solvable. Corollary. Let p be a prime and gcd(a, p) = 1. Then the congruence xk = a (mod p) has a solution if and only if a<p-l)/d = 1 (mod p), where d = gcd(k, p - 1). Example 8.5. Let us consider the congruence x3 = 4 (mod 13) In this setting, d = gcd(3, ¢(13)) = gcd(3, 12) = 3, and therefore ¢(13)/d = 4. Be­ cause 44 = 9 =f=. 1 (mod 13), Theorem 8.12 asserts that the given congruence is not solvable. On the other hand, the same theorem guarantees that x3 = 5 (mod 13) possesses a solution (in fact, there are three incongruent solutions modulo 13); for, in this case, 54 = 625 = 1 (mod 13). These solutions can be found by means of the index calculus as follows: the congruence x3 = 5 (mod 13) is equivalent to 3 ind2 x = 9 (mod 12) which becomes ind2 x = 3 (mod 4) This last congruence admits three incongruent solutions modulo 12, namely, ind2 x = 3, 7, or 11 PRIMITIVE ROOTS AND INDICES 167 The integers corresponding to these indices are, respectively, 8, 11, and 7, so that the solutions of the congruence x3 = 5 (mod 13) are x = 7, 8, and 11 (mod 13) PROBLEMS 8.4 1. Find the index of 5 relative to each of the primitive roots of 13. 2. Using a table of indices for a primitive root of 11, solve the following congruences: (a) 7x3 = 3 (mod 11). (b) 3x4 = 5 (mod 11). (c) x8 = 10 (mod 11). 3. The following is a table of indices for the prime 17 relative to the primitive root 3: a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 ind3 a 16 14 1 12 5 15 11 10 2 3 7 13 4 9 6 8 With the aid of this table, solve the following congruences: (a) x12 = 13 (mod 17). (b) 8x 5 = 10 (mod 17). (c) 9x8 = 8 (mod 17). (d) 7x = 7 (mod 17). 4. Find the remainder when 324 • 513 is divided by 17. [Hint: Use the theory of indices.] 5. If r and r' are both primitive roots of the odd prime p, show that for gcd(a, p) = 1 indr' a = (indr a)(indr' r) (mod p - 1) This corresponds to the rule for changing the base of logarithms. 6. (a) Construct a table of indices for the prime 17 with respect to the primitive root 5. [Hint: By the previous problem, inds a = 13 ind3 a (mod 16).] (b) Solve the congruences in Problem 3, using the table in part (a). 7. If r is a primitive root of the odd prime p, verify that 1 indr (-1) = indr (p -1) = 2,(p - 1) 8. (a) Determine the integers a(l � a � 12) such that the congruence ax4 = b (mod 13) has a solution for b = 2, 5, and 6. (b) Determine the integers a(l �a � p - 1) such that the congruence x4 =a (mod p) has a solution for p = 7, 11, and 13. 9. Employ the corollary to Theorem 8.12 to establish that if p is an odd prime, then (a) x2 = -1 (mod p) is solvable if and only if p = 1 (mod 4). (b) x4 = -1 (mod p) is solvable if and only if p = 1 (mod 8). 10. Given the congruence x3 =a (mod p), where p 2: 5 is a prime and gcd(a, p) = 1, prove the following: (a) If p = 1 (mod 6), then the congruence has either no solutions or three incongruent solutions modulo p. (b) If p = 5 (mod 6), then the congruence has a unique solution modulo p. 11. Show that the congruence x3 = 3 (mod 19) has no solutions, whereas x3 = 11 (mod 19) has three incongruent solutions. 168 ELEMENTARY NUMBER THEORY 12. Determine whether the two congruences x5 = 13 (mod 23) and x 7 = 15 (mod 29) are solvable. 13. If pis a prime and gcd(k, p - 1) = 1, prove that the integers 1 k' 2k' 3k' ... ' (p - 1/ form a reduced set of residues modulo p. 14. Letr be a primitive root of the odd prime p, and letd = gcd(k, p - 1). Prove that the val­ ues of a for which the congruence xk = a (mod p) is solvable are rd , r2d, ... , r[(p-l)/dJd. 15. If r is a primitive root of the odd prime p, show that . . (p - 1) mdr (p - a)= mdr a+ 2 (mod p - 1) and, consequently, that only half of an index table need be calculated to complete the table. 16. (a) Let r be a primitive root of the odd prime p. Establish that the exponential congruence ax =b(mod p) has a solution if and only if d I indr b, where the integer d = gcd(indr a, p - 1); in this case, there are d incongruent solutions modulo p - 1. (b) Solve the exponential congruences 4x = 13 (mod 17) and 5x = 4 (mod 19). 17. For which values of bis the exponential congruence gx = b (mod 13) solvable? CHA PTER 9 THE QUADRATIC RECIPROCITY LAW The moving power of mathematical invention is not reasoning but imagination. A. DEMORGAN 9.1 EULER'S CRITERION As the heading suggests, the present chapter has as its goal another major contribu­ tion of Gauss: the Quadratic Reciprocity Law. For those who consider the theory of numbers \"the Queen of Mathematics,\" this is one of the jewels in her crown. The intrinsic beauty of the Quadratic Reciprocity Law has long exerted a strange fasci­ nation for mathematicians. Since Gauss's time, over a hundred proofs of it, all more or less different, have been published (in fact, Gauss himself eventually devised seven). Among the eminent mathematicians of the 19th century who contributed their proofs appear the names of Cauchy, Jacobi, Dirichlet, Eisenstein, Kronecker, and Dedekind. Roughly speaking, the Quadratic Reciprocity Law deals with the solvability of quadratic congruences. Therefore, it seems appropriate to begin by considering the congruence ax2 + bx + c - 0 (mod p) (1) where p is an odd prime and a ¥= 0 (mod p ) ; that is, gcd(a, p) = 1. The supposition that p is an odd prime implies that gcd( 4a, p) = 1. Thus, the quadratic congruence in Eq. (1) is equivalent to 4a(ax2 +bx+ c) = 0 (mod p) 169 170 ELEMENTARY NUMBER THEORY By using the identity 4a(ax2 +bx+ c) = (2ax + b) 2 - (b2 - 4ac) the last-written quadratic congruence may be expressed as (2ax + b) 2 = (b2 - 4ac) (mod p) Now put y = 2ax +b and d = b2 - 4ac to get y2 = d (mod p) (2) If x = x0 (mod p) is a solution of the quadratic congruence in Eq. ( 1 ), then the integer y = 2ax0 + b (mod p) satisfies the quadratic congruence in Eq. (2). Conversely, if y = Yo (mod p) is a solution of the quadratic congruence in Eq. (2), then 2ax = Yo - b (mod p) can be solved to obtain a solution to Eq. (1). Thus, the problem of finding a solution to the quadratic congruence in Eq. (1) is equivalent to that of finding a solution to a linear congruence and a quadratic congruence of the form x2 =a (mod p) (3) If p I a, then the quadratic congruence in Eq. (3) has x _ 0 (mod p) as its only solution. To avoid trivialities, let us agree to assume hereafter that p )' a. Granting this, whenever x2 = a (mod p) admits a solution x = x0, there is also a second solution x = p - x0. This second solution is not congruent to the first. For x0 = p - x0 (mod p) implies that 2x0 _ 0 (mod p ), or x0 = 0 (mod p ), which is impossible. By Lagrange's theorem, these two solutions exhaust the incongruent solutions of x2 _ a (mod p ). In short: x2 _ a (mod p) has exactly two solutions or no solutions. A simple numerical example of what we have just said is provided by the quadratic congruence 5x2 - 6x + 2 = 0 (mod 13) To obtain the solution, we replace this congruence by the simpler one y2 - 9 (mod 13) with solutions y = 3, 10 (mod 13). Next, solve the linear congruences lOx = 9 (mod 13) lOx = 16 (mod 13) It is not difficult to see that x = 10, 12 (mod 13) satisfy these equations and, by our previous remarks, also the original quadratic congruence. The major effort in this presentation is directed toward providing a test for the existence of solutions of the quadratic congruence x2 =a (mod p) gcd(a, p) = 1 (4) To put it differently, we wish to identify those integers a that are perfect squares modulo p. 172 ELEMENTARY NUMBER THEORY By Theorem 8.1, the order of r (namely, p - 1) must divide the exponent k(p - 1)/2. The implication is that k is an even integer, say k = 2j. Hence, making the integer rj a solution of the congruence x2 = a (mod p ). This proves that a is a quadratic residue of the prime p. Now if p (as always) is an odd prime and gcd(a, p) = 1, then (a(p-l)/2 - l)(a(p-l)/2 + 1) = ap-l - 1 - 0 (mod p) the last congruence being justified by Fermat's theorem. Hence, either aCp-l)/2 = 1 (mod p) or aCp-l)/2 = -1 (mod p) but not both. For, if both congruences held simultaneously, then we would have 1 = -1 (mod p ), or equivalently, p 12, which conflicts with our hypothesis. Because a quadratic nonresidue of p does not satisfy aCp-l)/2 = 1 (mod p ), it must therefore satisfy aCp-l)/2 = -1 (mod p ). This observation provides an alternate formulation of Euler's criterion: the integer a is a quadratic nonresidue of the prime p if and only if aCp-l)/2 _ -1 (mod p). Putting the various pieces together, we come up with the following corollary. Corollary. Let p be an odd prime and gcd( a, p) = 1. Then a is a quadratic residue or nonresidue of p according to whether a<p-l)/2 = 1 (mod p) or a<p-l)/2 = -1 (mod p) Example 9.2. In the case where p = 13, we find that 2<13-1>12 = 26 = 64 = 12 = -1 (mod 13) Thus, by virtue of the last corollary, the integer 2 is a quadratic nonresidue of 13. Because 3 Cl3-l)/2 = 36 = (27)2 = 12=1 (mod13) the same result indicates that 3 is a quadratic residue of 13 and so the congruence x2 = 3 (mod 13) is solvable; in fact, its two incongruent solutions are x = 4 and 9 (mod 13). There is an alternative proof of Euler's criterion (due to Dirichlet) that is longer, but perhaps more illuminating. The reasoning proceeds as follows. Let a be a quadratic nonresidue of p and let c be any one of the integers 1, 2, ... , p - 1. By the theory of linear congruences, there exists a solution c' of ex = a (mod p ), with c' also in the set {1, 2, ... , p - 1 }. Note that c ' # c; otherwise we would have c2 = a (mod p ), which contradicts what we assumed. Thus, the integers between 1 and p - 1 can be divided into (p - 1)/2 pairs, c, c', where cc '= a (mod p). This 17 4 ELEMENTARY NUMBER THEORY 2. Prove that the quadratic congruence 6x2 + 5x + 1 = 0 (mod p) has a solution for every prime p, even though the equation 6x2 + 5x + 1 = 0 has no solution in the integers. 3. (a) For an odd prime p, prove that the quadratic residues of p are congruent modulo p to the integers 2 2 2 p- 1 ( ) 2 1,2,3, ... , -2 - (b) Verify that the quadratic residues of 17 are 1, 2, 4, 8, 9, 13, 15, 16. 4. Show that 3 is a quadratic residue of 23, but a nonresidue of 31. 5. Given that a is a quadratic residue of the odd prime p, prove the following: (a) a is not a primitive root of p. (b) The integer p - a is a quadratic residue or nonresidue of p according as p = 1 (mod 4) or p = 3 (mod 4). (c) If p = 3 (mod 4), then x = ±a(p+l )/4 (mod p) are the solutions of the congruence x2 =a (mod p). 6. Let p be an odd prime and gcd(a, p) = 1. Establish that the quadratic congruence ax2 + bx + c = 0 (mod p) is solvable if and only if b2 - 4ac is either zero or a quadratic residue of p. 7. If p = 2k + 1 is prime, verify that every quadratic nonresidue of p is a primitive root of p. [Hint: Apply Euler's criterion.] 8. Assume that the integer r is a primitive root of the prime p, where p = 1 (mod 8). (a) Show that the solutions of the quadratic congruence x2 = 2 (mod p) are given by x = ±(r ?(p-l)/S + r(p-1)/S) (mod p) [Hint: First confirm that r3(p-l)/2 = -1 (mod p).] (b) Use part (a) to find all solutions to the two congruences x2 = 2 (mod 17) and x2 = 2 (mod 41). 9. (a) If ab= r (mod p), where r is a quadratic residue of the odd prime p, prove that a and bare both quadratic residues of p or both nonresidues of p. (b) If a and b are both quadratic residues of the odd prime p or both nonresidues of p, show that the congruence ax2 = b (mod p) has a solution. [Hint: Multiply the given congruence by a' where aa' = 1 (mod p).] 10. Let p be an odd prime and gcd( a, p) = gcd( b, p) = 1. Prove that either all three of the quadratic congruences x2 =a (mod p) x2 = b (mod p) x2 =ab (mod p) are solvable or exactly one of them admits a solution. 11. (a) Knowing that 2 is a primitive root of 19, find all the quadratic residues of 19. [Hint: See the proof of Theorem 9.1.] (b) Find the quadratic residues of 29 and 31. 12. If n > 2 and gcd( a, n) = 1, then a is called a quadratic residue of n whenever there exists an integer x such that x2 =a (mod n). Prove that if a is a quadratic residue of n > 2, then a<f>(n)/2 = 1 (mod n). 13. Show that the result of the previous problem does not provide a sufficient condition for the existence of a quadratic residue of n; in other words, find relatively prime integers a and n, with a<f>(n)/2 = 1 (mod n), for which the congruence x2 =a (mod n) is not solvable. THE QUADRATIC RECIPROCITY LAW 17 5 9.2 THE LEGENDRE SYMBOL AND ITS PROPERTIES Euler's studies on quadratic residues were further developed by the French math­ ematician Adrien Marie Legendre (1752-1833). Legendre's memoir \"Recherches d' Analyse Indeterminee\" (1785) contains an account of the Quadratic Reciprocity Law and its many applications, a sketch of a theory of the representation of an integer as the sum of three squares, and the statement of a theorem that was later to become famous: Every arithmetic progression ax+ b, where gcd(a, b) = 1, contains an infinite number of primes. The topics covered in \"Recherches\" were taken up in a more thorough and systematic fashion in his Essai sur la Theorie des Nombres, which appeared in 1798. This represented the first \"modern\" treatise devoted exclusively to number theory, its precursors being translations or commentaries on Diophantus. Legendre's Essai was subsequently expanded into his Theorie des Nombres. The results of his later research papers, inspired to a large extent by Gauss, were included in 1830 in a two-volume third edition of the Theorie des Nombres. This remained, together with the Disquisitiones Arithmeticae of Gauss, a standard work on the subject for many years. Al­ though Legendre made no great innovations in number theory, he raised fruitful questions that provided subjects of investigation for the mathematicians of the 19th century. Before leaving Legendre's mathematical contributions, we should mention that he is also known for his work on elliptic integrals and for his Elements de Geometrie (1794). In this last book, he attempted a pedagogical improvement of Euclid's Elements by rearranging and simplifying many of the proofs without lessening the rigor of the ancient treatment. The result was so favorably received that it became one of the most successful textbooks ever written, dominating instruction in geometry for over a century through its numerous editions and translations. An English translation was made in 1824 by the famous Scottish essayist and historian Thomas Carlyle, who was in early life a teacher of mathematics; Carlyle's translation ran through 33 American editions, the last not appearing until 1890. In fact, Legendre's revision was used at Yale University as late as 1885, when Euclid's Elements was finally abandoned as a text. Our future efforts will be greatly simplified by the use of the symbol (a/ p ); this notation was introduced by Legendre in his Essai and is called, naturally enough, the Legendre symbol. Definition 9.2. Let p be an odd prime and let gcd(a, p) = 1. The Legendre symbol (a/ p) is defined by { 1 if a is a quadratic residue of p (a/p)= -1 if a is a quadratic nonresidue of p For the want of better terminology, we shall refer to a as the numerator and p as the denominator of the symbol (a/ p ). Another standard notation for the Legendre symbol is ( ££ ), or (a I p ). p 17 6 ELEMENTARY NUMBER THEORY Example 9.3. Let us look at the prime p = 13, in particular. Using the Legendre symbol, the results of an earlier example may be expressed as (1/13) = (3/13) = (4/13) = (9/13) = (10/13) = (12/13) = 1 and (2/13) = (5/13) = (6/13) = (7 /13) = (8/13) = (11/13) = -1 Remark. For p I a, we have purposely left the symbol (a/ p) undefined. Some authors find it convenient to extend Legendre's definition to this case by setting (a/ p) = 0. One advantage of this is that the number of solutions of x2 = a (mod p) can then be given by the simple formula 1 +(a/ p). The next theorem establishes certain elementary facts concerning the Legendre symbol. Theorem 9.2. Let p be an odd prime and let a and b be integers that are relatively prime to p. Then the Legendre symbol has the following properties: (a) If a = b (mod p), then (a/ p) = (b/ p). (b) (a2/p) = 1. (c) (a/ p) = aCp-l)/2 (mod p). (d) (ab/ p) = (a/ p)(b/ p). (e) (1/p) = 1 and (-1/p) = (-l)(p-l)/2. Proof. If a = b (mod p ), then the two congruences x2 = a (mod p) and x2 = b (mod p) have exactly the same solutions, if any at all. Thus, x2 = a (mod p) and x2 = b (mod p) are both solvable, or neither one has a solution. This is reflected in the statement (a/ p) = (b/ p). Regarding property (b ), observe that the integer a trivially satisfies the congruence x2 = a2 (mod p); hence, (a2 / p) = 1. Property (c) is just the corollary to Theorem 9.1 rephrased in terms of the Legendre symbol. We use ( c) to establish property ( d): (ab/ p) = (ab)(p-l)/2 = a(p-l)/2b(p-l)/2 =(a/ p)(b/ p)(mod p) Now the Legendre symbol assumes only the values 1 or -1. If (ab/ p) # (a/ p)(b/ p), we would have 1 = -1 (mod p) or 2 = 0 (mod p ); this cannot occur, because p > 2. It follows that (ab/p) = (a/p)(b/p) Finally, we observe that the first equality in property ( e) is a special case of property (b ), whereas the second one is obtained from property ( c) upon setting a = -1. Because the quantities (-1/ p) and (-l)(p-l)/2 are either 1 or -1, the resulting congruence (-1/ p) = (-l)(p-l)/2 (mod p) implies that (-1/ p) = (-l)(p-1)/2. From parts (b) and (d) of Theorem 9.2, we may also abstract the relation (f) (ab2 / p) = (a/ p)(b2 / p) = (a/ p) THE QUADRATIC RECIPROCITY LAW 179 all congruences being modulo 13. Similarly, the nonresidues occur as the odd powers of2: 21 = 2 23 - 8 25 = 6 27 = 11 29 - 5 211 = 7 Most proofs of the Quadratic Reciprocity Law, and ours as well, rest ultimately upon what is known as Gauss's lemma. Although this lemma gives the quadratic character of an integer, it is more useful from a theoretic point of view than as a computational device. We state and prove it below. Theorem 9.5 Gauss's lemma. Let p be an odd prime and let gcd(a, p) = 1. If n denotes the number of integers in the set S = { a, 2a, 3a, ... , ( p � 1 ) a} whose remainders upon division by p exceed p /2, then (a/p) = (- lt Proof. Because gcd(a, p) = 1, none of the (p - 1)/2 integers in Sis congruent to zero and no two are congruent to each other modulo p. Let r1 , ... , rm be those remainders upon division by p such that 0 < ri < p /2, and let s1 , ... , Sn be those remainders such that p > si > p/2. Then m + n = (p - 1)/2, and the integers p- s1 , ... ,p - sn are all positive and less than p /2. To prove that these integers are all distinct, it suffices to show that no p - Si is equal to any r j. Assume to the contrary that for some choice of i and j. Then there exist integers u and v, with 1 :::; u, v :::; (p - 1) /2, satisfying Si = ua (mod p) and rj = va (mod p). Hence, (u + v)a = si + rj = p = 0 (mod p) which says that u + v = 0 (mod p ). But the latter congruence cannot take place, because 1 < u + v :::; p - 1. The point we wish to bring out is that the (p - 1)/2 numbers p - S1' ... ' p - Sn are simply the integers 1, 2, ... , (p - 1)/2, not necessarily in order of appearance. Thus, their product is [(p - 1)/2] !: ( P � l) ! = ri · · · rm(P - s1) · · · (p - Sn) = ri · · · rm(-s1) · · · (-sn) (mod p) = ( - l ) nr1 · · ·rmSl ···S n (mod p) 180 ELEMENTARY NUMBER THEORY But we know that r1, ... , rm, s1, ... , Sn are congruent modulo p to a, 2a, ... , [(p - I)/2]a, in some order, so that (p- I) (p- I) - 2- ! = (-Ita · 2a · · · - 2- a (mod p) = (-l)na(p-1)/2 ( p � I) ! (mod p) Because [(p - I)/2] ! is relatively prime to p, it may be canceled from both sides of this congruence to give I = (-Ita(p-l)/2 (mod p) or, upon multiplying by (-It, a (p-l)/2 =(-It (mod p) Use of Euler's criterion now completes the argument: (a/p) = a (p-l)/2 =(-It (mod p) which implies that (a/p) =(-It By way of illustration, let p = 13 and a = 5. Then (p - 1)/2 = 6, so that s = {5, 10, 15, 20, 25, 30} Modulo 13, the members of Sare the same as the integers 5, 10,2, 7, 12,4 Three of these are greater than 13/2; hence, n = 3, and Theorem 9.5 says that (5/13) = (-1) 3 = -1 Gauss's lemma allows us to proceed to a variety of interesting results. For one thing, it provides a means for determining which primes have 2 as a quadratic residue. Theorem 9.6. If pis an odd prime, then { I if p = I (mod 8) or p = 7 (mod 8) (2 /p) = -I if p = 3 (mod 8) or p = 5 (mod 8) Proof. According to Gauss's lemma, (2 / p) = ( -It, where n is the number of integers in the set s = { I . 2, 2 . 2, 3 . 2, ... ' ( p � I ) . 2} which, upon division by p, have remainders greater than p /2. The members of S are all less than p, so that it suffices to count the number that exceed p /2. For I ::; k ::; (p - I) /2 , we have 2k < p /2 if and only if k < p / 4. If [] denotes the greatest integer function, then there are [p / 4] integers in S less than p /2; hence, n= p� I - [:J is the number of integers that are greater than p /2. THE QUADRATIC RECIPROCITY LAW 181 Now we have four possibilities, for any odd prime has one of the forms 8k + 1, 8k + 3, 8k + 5, or 8k + 7. A simple calculation shows that if p = 8k + 1, then n = 4k - [ 2k + �] = 4k - 2k = 2k if p = 8k + 3, then n = 4k + 1 - [ 2k + �] = 4k + 1 - 2k = 2k + 1 if p = 8k + 5, then n = 4k + 2 - [ 2k + 1 + �] = 4k + 2 -(2k + 1) = 2k + 1 if p = 8k + 7, then n = 4k + 3 - [ 2k + 1 + �] = 4k + 3 -(2k + 1) = 2k + 2 Thus, when p is of the form 8k + 1 or 8k + 7, n is even and (2/ p) = 1; on the other hand, when p assumes the form 8k + 3 or 8k + 5, n is odd and (2/ p) = -1. Notice that if the prime p is of the form 8k ± 1 (equivalently, p = 1 (mod 8) or p _ 7 (mod 8)), then p2 -1 8 (8k ± 1)2 -1 8 64k2 ± 16k 2 8 = 8k ± 2k which is an even integer; in this situation, ( -l)CP2 -l)/S = 1 = (2/ p ). On the other hand, if p is of the form 8k ± 3 (equivalently, p _ 3 (mod 8) or p _ 5 (mod 8)), then p2 -1 8 (8k ± 3)2 -1 8 64k2 ± 48k + 8 = 8k2 ± 6k + 1 8 which is odd; here, we have (-l)CP2-l)/S = -1 = (2/p). These observations are incorporated in the statement of the following corollary to Theorem 9.6. Corollary. If p is an odd prime, then (2/p) = (-l)(p2-1)/8 It is time for another look at primitive roots. As we have remarked, there is no general technique for obtaining a primitive root of an odd prime p; the reader might, however, find the next theorem useful on occasion. Theorem 9.7. If p and 2p + 1 are both odd primes, then the integer (-l)(p-l)/2 2 is a primitive root of 2p + 1. Proof. For ease of discussion, let us put q = 2p + 1. We distinguish two cases: p = 1(mod4) and p = 3 (mod 4). 182 ELEMENTARY NUMBER THEORY If p = 1 (mod 4), then (-l)Cp-l)/22 = 2. Because </J(q) = q - 1 = 2p, the order of 2 modulo q is one of the numbers 1, 2, p, or 2 p. Taking note of property ( c) of Theorem 9 .2, we have (2/q) = 2Cq-l)/2 = 2P (mod q) But, in the present setting, q = 3 (mod 8); whence, the Legendre symbol (2/q) = -1. It follows that 2P = -1 (mod q ), and therefore 2 cannot have order p modulo q. The order of 2 being neither 1, 2, (22 = 1 (mod q) implies that q 13, which is an impossibility) nor p, we are forced to conclude that the order of 2 modulo q is 2p. This makes 2 a primitive root of q. We now deal with the case p = 3 (mod 4 ). This time, (-l)Cp-l)/22 = -2 and (-2)P = (-2/q) = (-l/q)(2/q) (mod q) Because q = 7 (mod 8), the corollary to Theorem 9.2 asserts that (-1/q) = -1, whereas once again we have (2/q) = 1. This leads to the congruence (-2)P - -1 (mod q ). From here on, the argument duplicates that of the last paragraph. Without analyzing further, we announce the decision: -2 is a primitive root of the prime q. Theorem 9. 7 indicates, for example, that the primes 11, 59, 107, and 179 have 2 as a primitive root. Likewise, the integer -2 serves as a primitive root for 7, 23, 47, and 167. Before retiring from the field, we should mention another result of the same character: if both p and 4 p + 1 are primes, then 2 is a primitive root of 4 p + 1. Thus, to the list of prime numbers having 2 for a primitive root, we could add, say, 13, 29, 53, and 173. An odd prime p such that 2 p + 1 is also a prime is called a Germain prime, after the French number theorist Sophie Germain (1776-1831). An unresolved problem is to determine whether there exist infinitely many Germain primes. The largest such known today is p = 4804 7305725 · 2172403 - 1, which has 51910 digits. There is an attractive proof of the infinitude of primes of the form 8k - 1 that can be based on Theorem 9.6. Theorem 9.8. There are infinitely many primes of the form 8k - 1. Proof. As usual, suppose that there are only a finite number of such primes. Let these be pi, p2 , ... , Pn and consider the integer N = (4p1p2 · · · Pn)2 - 2 There exists at least one odd prime divisor p of N, so that (4p1p2 · · · Pn)2 = 2 (mod p) or (2/ p) = 1. In view of Theorem 9 .6, p = ± 1 (mod 8). If all the odd prime divisors of N were of the form 8k + 1, then N would be of the form 8a + 1; this is clearly impossible, because N is of the form l 6a - 2. Thus, N must have a prime divisor q of the form 8k - 1. But q IN, and q I (4p1p2 · · · Pn)2 leads to the contradiction that q 12. The next result, which allows us to effect the passage from Gauss's lemma to the Quadratic Reciprocity Law (Theorem 9.9), has some independent interest. 184 ELEMENTARY NUMBER THEORY For an example of this last result, again consider p = 13 and a = 5. Because (p -1)/2 = 6, it is necessary to calculate [ka/ p] fork = 1, ... , 6: [5/13] = [10/13] = 0 [15/13] = [20/13] = [25/13] = 1 [30/13] = 2 By the lemma just proven, we have (5/13) = (-l)l+l+l+Z = (-1)5 = -1 confirming what was earlier seen. PROBLEMS 9.2 1. Find the value of the following Legendre symbols: (a) (19/23). (b) (-23/59). (c) (20/31). (d) (18/43). (e) (-72/131). 2. Use Gauss's lemma to compute each of the Legendre symbols below (that is, in each case obtain the integer n for which (a/ p) = ( -1 t): (a) (8/11). (b) (7 /13). (c) (5/19). (d) (11/23). (e) (6/31). 3. For an odd prime p, prove that there are (p - 1)/2 - </>(p - 1) quadratic nonresidues of p that are not primitive roots of p. 4. (a) Let p be an odd prime. Show that the Diophantine equation x2 + py +a = 0 gcd(a, p) = 1 has an integral solution if and only if (-a/ p) = 1. (b) Determine whether x2 + 7y - 2 = 0 has a solution in the integers. 5. Prove that 2 is not a primitive root of any prime of the form p = 3 · 2n + 1, except when p = 13. [Hint: Use Theorem 9.6.] 6. (a) If pis an odd prime and gcd(ab, p) = 1, prove that at least one of a, b, or ab is a quadratic residue of p. (b) Given a prime p, show that, for some choice of n > 0, p divides (n 2 - 2)(n2 - 3)(n2 - 6) 7. If p is an odd prime, show that p-2 L:)a(a + l)/p) = -1 a=l [Hint: If a' is defined by aa' = 1 (mod p), then (a(a + l)/p) = ((1 + a')/p). Note that 1 +a' runs through a complete set of residues modulo p, except for the integer l.] 8. Prove the statements below: THE QUADRATIC RECIPROCITY LAW 185 (a) If p and q = 2p + 1 are both odd primes, then -4 is a primitive root of q. (b) If p = 1 (mod4) is a prime, then -4 and (p - 1) /4 are both quadratic residues of p. 9. For a prime p = 7 (mod 8), show that p 12<p-l)/2 - 1. [Hint: Use Theorem 9.6.] 10. Use Problem 9 to confirm that the numbers 2n - 1 are composite for n = 11, 23, 83, 131, 179, 183,239,251. 11. Given that p and q = 4 p + 1 are both primes, prove the following: (a) Any quadratic nonresidue of q is either a primitive root of q or has order 4 modulo q. [Hint: If a is a quadratic nonresidue of q, then -1 = (a/q) = a2P (mod q); hence, a has order 1, 2, 4, p, 2p, or 4p modulo q .] (b) The integer 2 is a primitive root of q; in particular, 2 is a primitive root of the primes 13, 29, 53, and 173. 12. If r is a primitive root of the odd prime p, prove that the product of the quadratic residues of p is congruent modulo p to r<P2-l)/4 and the product of the nonresidues of p is congruent modulo p to r<P-1)2/4. [Hint: Apply the corollary to Theorem 9.4.] 13. Establish that the product of the quadratic residues of the odd prime p is congruent modulo p to 1 or -1 according as p = 3 (mod 4) or p = 1 (mod4). [Hint: Use Problem 12 and the fact that r<p-l)/2 = -1 (mod p). Or, Problem 3(a) of Section 9.1 and the proof of Theorem 5.5.] 14. (a) If the prime p > 3, show that p divides the sum of its quadratic residues. (b) If the prime p > 5, show that p divides the sum of the squares of its quadratic nonresidues. 15. Prove that for any prime p > 5 there exist integers 1 :S a, b :S p - 1 for which (a/p) = (a+ 1/p) = 1 and (b/p) = (b + 1/p) = -1 that is, there are consecutive quadratic residues of p and consecutive nonresidues. 16. (a) Let p be an odd prime and gcd(a, p) = gcd(k , p) = 1. Show that if the equation x2 - ay2 = kp admits a solution, then (a/ p) = 1; for example, (2 /7) = 1, because 6 2 - 2 . 2 2 = 4 . 7. [Hint: If xo, Yo satisfy the given equation, then (x0yg-2) 2 =a (mod p).] (b) By considering the equation x 2 + 5 y2 = 7, demonstrate that the converse of the result in part (a) need not hold. (c) Show that,for anyprime p = ±3 (mod 8),the equation x2 - 2y2 = phas no solution. 17. Prove that the odd prime divisors p of the integers 9n + 1 are of the form p = 1 (mod4). 18. For a prime p = 1 (mod 4), verify that the sum of the quadratic residues of pis equal to p(p - 1)/4. [Hint: If a1, ... , ar are the quadratic residues of p less than p /2, then p - a1, ... , p - ar are those greater than p /2.] 9.3 QUADRATIC RECIPROCITY Let p and q be distinct odd primes, so that both of the Legendre symbols (p / q) and (q / p) are defined. It is natural to enquire whether the value of (p / q) can be determined if that of ( q / p) is known. To put the question more generally, is there any connection at all between the values of these two symbols? The basic relationship was conjectured experimentally by Euler in 1783 and imperfectly proved by Legendre two years thereafter. Using his symbol, Legendre stated this relationship in the 186 ELEMENTARY NUMBER THEORY elegant form that has since become known as the Quadratic Reciprocity Law: E=!. !I.::! (p/q)(q/p) = (-1) 2 2 Legendre went amiss in assuming a result that is as difficult to prove as the law itself, namely, that for any odd prime p = 1 (mod 8), there exists another prime q = 3 (mod 4) for which p is a quadratic residue. Undaunted, he attempted another proof in his Essai sur la Theorie des Nombres (1798); this one also contained a gap, because Legendre took for granted that there are an infinite number of primes in certain arithmetical progressions (a fact eventually proved by Dirichlet in 1837, using in the process very subtle arguments from complex variable theory). At the age of 18, Gauss (in 1795), apparently unaware of the work of either Euler or Legendre, rediscovered this reciprocity law and, after a year's unremit­ ting labor, obtained the first complete proof. \"It tortured me,\" says Gauss, \"for the whole year and eluded my most strenuous efforts before, finally, I got the proof explained in the fourth section of the Disquisitiones Arithmeticae .\" In the Disqui­ sitiones Arithmeticae-which was published in 1801, although finished in 1798- Gauss attributed the Quadratic Reciprocity Law to himself, taking the view that a theorem belongs to the one who gives the first rigorous demonstration. The indig­ nant Legendre was led to complain: \"This excessive impudence is unbelievable in a man who has sufficient personal merit not to have the need of appropriating the discoveries of others.\" All discussion of priority between the two was futile; because each clung to the correctness of his position, neither took heed of the other. Gauss went on to publish five different demonstrations of what he called \"the gem of higher arithmetic,\" and another was found among his papers. The version presented below, a variant of one of Gauss's own arguments, is due to his student, Ferdinand Eisenstein (1823-1852). The proof is challenging (and it would perhaps be unreasonable to expect an easy proof), but the underlying idea is simple enough. Theorem 9.9 Quadratic Reciprocity Law. If p and q are distinct odd primes, then p-1 q-1 (p/q)(q/ p) = ( - l ) -2 -2 Proof. Consider the rectangle in the xy coordinate plane whose vertices are (0, 0), (p /2, 0), (0, q /2), and (p /2, q /2). Let R denote the region within this rectangle, not including any of the bounding lines. The general plan of attack is to count the number of lattice points (that is, the points whose coordinates are integers) inside R in two different ways. Because p and q are both odd, the lattice points in R consist of all points (n, m), where 1 :'.Sn :'.S (p -1)/2 and 1 :'.Sm :'.S (q -1)/2; clearly, the number of such points is p-1 q-1 2 2 Now the diagonal D from (0, 0) to (p /2, q /2) has the equation y = (q / p )x, or equivalently, py = q x. Because gcd(p, q) = 1, none of the lattice points inside R will lie on D. For p must divide the x coordinate of any lattice point on the line p y = q x, and q must divide its y coordinate; there are no such points in R. Suppose that T1 denotes the portion of R that is below the diagonal D, and T2 the portion above. By what we have just seen, it suffices to count the lattice points inside each of these triangles. THE QUADRATIC RECIPROCITY LAW 187 The number of integers in the interval 0 < y < kq / p is equal to [kq / p ]. Thus, for 1 :S k :S (p - 1)/2, there are precisely [kq / p] lattice points in Ti directly above the point (k, 0) and below D; in other words, lying on the vertical line segment from (k, 0) to (k, kq / p ). It follows that the total number of lattice points contained in Ti is (O,f) (0, 0) (Pf2 [ kq] k=i p • • • • • • • • • • • • • • • • • • • • • • • • • • • • • (k, 0) (p/2, 0) A similar calculation, with the roles of p and q interchanged, shows that the number of lattice points within T2 is (qf2 [ jp] j=l q This accounts for all of the lattice points inside R, so that 1 1 (p-i)/2 [ k ] (q-i)/2 [ . ] �-�= L _!j_ + L JP 2 2 k=i p j=i q The time has come for Gauss's lemma to do its duty: \"<q-1);2[. I l \"<p-1);2 (pjq)(qjp) = (-l)L...j=l JP q • (-l)L...k=l [kq/p] \"<q-1)12 [ . I l \"<p-1);2 [k I l = (-l)L...j=l JP q +L..k=I q P p-1 q-1 = (-l)-2 -2 The proof of the Quadratic Reciprocity Law is now complete. An immediate consequence of this is Corollary 1. Corollary 1. If p and q are distinct odd primes, then (p/q)(q/p) = I -� if p = 1(mod4) or q = 1(mod4) if p = q = 3 (mod 4) 190 ELEMENTARY NUMBER THEORY Example 9.7. Let us turn to a quite different application of these ideas. At an earlier stage, it was observed that if Fn = 22n + 1, n > 1, is a prime, then 2 is not a primitive root of Fn. We now possess the means to show that the integer 3 serves as a primitive root of any prime of this type. As a first step in this direction, note that any Fn is of the form 12k + 5. A sim­ ple induction argument confirms that 4m = 4 (mod 12) form = 1, 2, ... ; hence, we must have Fn = 22\" + 1 = 22 m + 1 = 4m + 1 = 5 (mod 12) If Fn happens to be prime, then Theorem 9.10 permits the conclusion (3/ Fn) = -1 or, using Euler's criterion, 3CFn-l)/2 = -1 (mod Fn) Switching to the phi-function, the last congruence says that 3</J(Fn)/2 = -1 (mod Fn) From this, it may be inferred that 3 has order <f>(Fn) modulo Fn, and therefore 3 is a primitive root of Fn. For if the order of 3 were a proper divisor of </>(Fn) = Fn - 1 = 22n then it would also divide <f>(Fn)/2, leading to the contradiction 3</J(Fn)/2 = 1 (mod Fn) PROBLEMS 9.3 1. Evaluate the following Legendre symbols: (a) (71/73). (b) (-219/383). (c) (461/773). (d) (1234/4567). (e) (3658/12703). [Hint: 3658 = 2 · 31 · 59.] 2. Prove that 3 is a quadratic nonresidue of all primes of the form 22n + 1 and also all primes of the form 2P - 1 where p is an odd prime. [Hint: For all n, 4n - 4 (mod 12).] 3. Determine whether the following quadratic congruences are solvable: (a) x2 = 219 (mod 419). (b) 3x2 + 6x + 5 = 0 (mod 89). (c) 2x2 + 5x - 9 = 0 (mod 101). 4. Verify that if p is an odd prime, then { 1 if p = 1 (mod 8) or (-2/p)= -1 if p=5(mod 8) or 5. (a) Prove that if p > 3 is an odd prime, then p = 3 (mod 8) p = 7 (mod 8) { 1 if p = 1 (mod 6) (-3/p) = -1 if p = 5 (mod 6) THE QUADRATIC RECIPROCITY LAW 191 (b) Using part (a), show that there are infinitely many primes of the form 6k + 1. [Hint: Assume that p1, p 2, ... , Pr are all the primes of the form 6k + 1 and consider the integer N = (2p1p2 · · · Pr)2 + 3.] 6. Use Theorem 9.2 and Problems 4 and 5 to determine which primes can divide integers of the forms n2 + 1, n2 + 2, or n2 + 3 for some value of n. 7. Prove that there exist infinitely many primes of the form 8k + 3. [Hint: Assume that there are only finitely many primes of the form 8k + 3, say p1, p2, ... , Pr• and consider the integer N = (P1P2 · · · Pr)2 + 2.] 8. Find a prime number p that is simultaneously expressible in the forms x2 + y2, u2 + 2v2, and r2 + 3s 2. [Hint: ( - 1/p) = ( -2/p) = ( - 3/p) = l.] 9. If p and q are odd primes satisfying p = q + 4a for some a, establish that (a/p) = (a/q) and, in particular, that (6/37) = (6/13). [Hint: Note that (a/ p) = (-q / p) and use the Quadratic Reciprocity Law.] 10. Establish each of the following assertions: (a) (5/ p) = 1 if and only if p = 1, 9, 11, or 19 (mod 20). (b) (6/ p) = 1 if and only if p = 1, 5, 19, or 23 (mod 24). (c) (7 / p) = 1 if and only if p = 1, 3, 9, 19, 25, or 27 (mod 28). 11. Prove that there are infinitely many primes of the form 5k - 1. [Hint: For any n > 1, the integer 5(n!)2 - 1 has a prime divisor p > n that is not of the form 5k + 1; hence, (5/ p) = l.] 12. Verify the following: (a) The prime divisors p =j:. 3 of the integer n2 - n + 1 are of the form 6k + 1. [Hint: If p I n2 - n + 1, then (2n - 1)2 = -3 (mod p).] (b) The prime divisors p =j:. 5 of the integer n 2 + n - 1 are of the form 1 Ok + 1 or lOk + 9. (c) The prime divisors p of the integer 2n(n + 1) + 1 are of the form p = 1(mod 4). [Hint: If p I 2n(n + 1) + 1, then (2n + 1)2 = -1 (mod p ).] (d) The prime divisors p of the integer 3n(n + 1) + 1 are of the form p = 1(mod 6). 13. (a) Show that if pis a prime divisor of 839 = 382 - 5 · 112, then (5/ p) = 1. Use this fact to conclude that 839 is a prime number. [Hint: It suffices to consider those primes p < 29.] (b) Prove that both 397 = 202 - 3 and 733 = 292 - 3 · 62 are primes. 14. Solve the quadratic congruence x2 = 11 (mod 35). [Hint: After solving x2 = 11 (mod 5) and x2 = 11 (mod 7), use the Chinese Remainder Theorem.] 15. Establish that 7 is a primitive root of any prime of the form p = 24n + 1. [Hint: Because p = 3 or 5 (mod 7), (7 / p) = (p /7) = -1.] 16. Let a and b > 1 be relatively prime integers, with b odd. If b = p1p 2 ··· Pr is the de­ composition of b into odd primes (not necessarily distinct) then the Jacobi symbol (a/ b) is defined by (a/b) = (a/p1 )(a/p2) ·· · (a/pr ) where the symbols on the right-hand side of the equality sign are Legendre symbols. Evaluate the Jacobi symbols (21/22 1) (2 15/253) (631/ 1099) 192 ELEMENTARY NUMBER THEORY 17. Under the hypothesis of the previous problem, show that if a is a quadratic residue of b, then (a/b) = 1; but, the converse is false. 18. Prove that the following properties of the Jacobi symbol hold: If b and b' are positive odd integers and gcd(aa', bb') = 1, then (a) a =a' (mod b) implies that (a/b) = (a' /b). (b) (aa' /b) = (a/b)(a' /b). (c) (a/bb') = (a/b)(a/b'). (d) (a2/b) = (a/b2) = 1. (e) (1/b) = 1. (f) (-1/b) = (-l)(b-1)/2. [Hint: Whenever u and v are odd integers, (u - 1)/2 + (v - 1)/2 = (uv - 1)/2 (mod 2).] (g) (2/b) = (-l/b2-1)/8. [Hint: Whenever u and v are odd integers, (u2 - 1)/8 + (v2 - 1)/8 = [(uv)2 - 1]/8 (mod 2).] 19. Derive the Generalized Quadratic Reciprocity Law: If a and b are relatively prime positive odd integers, each greater than 1, then a-I b-1 (a/b)(b/a) = (-l)-2 2 [Hint: See the hint in Problem 18(f).] 20. Using the Generalized Quadratic Reciprocity Law, determine whether the congruence x2 = 231 (mod 1105) is solvable. 9.4 QUADRATIC CONGRUENCES WITH COMPOSITE MODULI So far in the proceedings, quadratic congruences with (odd) prime moduli have been of paramount importance. The remaining theorems broaden the horizon by allowing a composite modulus. To start, let us consider the situation where the modulus is a power of a prime. Theorem 9.11. If pis an odd prime and gcd(a, p) = 1, then the congruence x2 =a (mod pn) n � 1 has a solution if and only if (a/ p) = 1. Proof. As is common with many \"if and only if\" theorems, half of the proof is trivial whereas the other half requires considerable effort: If x2 - a (mod pn) has a solution, then so does x2 = a (mod p )-in fact, the same solution-whence (a/ p) = 1. For the converse, suppose that (a/ p) = 1. We argue that x2 =a (mod pn) is solvable by inducting on n. If n = 1, there is really nothing to prove; indeed, (a/ p) = 1 is just another way of saying that x2 - a (mod p) can be solved. Assume that the result holds for n = k � 1, so that x2 =a (mod pk) admits a solution x0. Then x5 =a+ bpk for an appropriate choice of b. In passing from k to k + 1, we shall use xo and b to write down explicitly a solution to the congruence x2 =a (mod pk+1 ). Toward this end, we first solve the linear congruence 2xoy = -b (mod p) THE QUADRATIC RECIPROCITY LAW 193 obtaining a unique solution y0 modulo p (this is possible because gcd(2x0, p) = 1). Next, consider the integer k x1 = xo + YoP Upon squaring this integer, we get (xo + YoP k ) 2 = xJ + 2xoyop k + yJp 2k = a + (b + 2xoyo)pk + yJp2k But p I (b + 2xoyo), from which it follows that xi = (xo + YoP k) 2 =a (mod p k+1) Thus, the congruence x2 = a (mod pn) has a solution for n = k + 1 and, by induction, for all positive integers n. Let us run through a specific example in detail. The first step in obtaining a solution of, say, the quadratic congruence x2 - 23 (mod 72) is to solve x2 = 23 (mod 7), or what amounts to the same thing, the congruence x2 = 2 (mod 7) Because (2/7) = 1, a solution surely exists; in fact, x0 = 3 is an obvious choice. Now x6 can be represented as 32 = 9 = 23 + ( -2)7 so that b = -2 (in our special case, the integer 23 plays the role of a). Following the proof of Theorem 9 .11, we next determine y so that 6y = 2 (mod 7) that is, 3y = 1 (mod 7). This linear congruence is satisfied by y0 = 5. Hence, xo + 7yo = 3 + 7 · 5 = 38 serves as a solution to the original congruence x2 = 23 (mod 49). It should be noted that -38 = 11 mod (49) is the only other solution. If, instead, the congruence x2 _ 23 (mod 73) were proposed for solution, we would start with x2 _ 23 (mod 72) obtaining a solution x0 = 38. Because 382 = 23 + 29 . 72 the integer b = 29. We would then find the unique solution y0 = 1 of the linear congruence 76y = -29 (mod 7) 194 ELEMENTARY NUMBER THEORY Then x2 = 23 (mod 73) is satisfied by xo + Yo · 7 2 = 38 + 1 · 49 = 87 as well as -87 _ 256 (mod 73). Having dwelt at length on odd primes, let us now take up the case p = 2. The next theorem supplies the pertinent information. Theorem 9.12. Let a be an odd integer. Then we have the following: (a) x2 = a (mod 2) always has a solution. (b) x2 =a (mod 4) has a solution if and only if a = 1(mod4). (c) x2 =a (mod 2n), for n :=::: 3, has a solution if and only if a = 1 (mod 8). Proof. The first assertion is obvious. The second depends on the observation that the square of any odd integer is congruent to 1 modulo 4. Consequently, x2 =a (mod 4) can be solved only when a is of the form 4k + 1; in this event, there are two solutions modulo 4, namely, x = 1 and x = 3. Now consider the case in which n :=::: 3. Because the square of any odd integer is congruent to 1 modulo 8, we see that for the congruence x2 = a (mod 2n) to be solvable a must be of the form 8k + 1. To go the other way, let us suppose that a = 1 (mod 8) and proceed by induction on the exponent n. When n = 3, the congruence x2 = a (mod 2n) is certainly solvable; indeed, each of the integers 1, 3, 5, 7 satisfies x2 = 1 (mod 8). Fix a value of n :=::: 3 and assume, for the induction hy pothesis, that the congruence x2 =a (mod 2n) admits a solution x0. Then there exists an integer b for which x5 =a+ b2n Because a is odd, so is the integer x0. It is therefore possible to find a unique solution Yo of the linear congruence xoy = -b (mod 2) We argue that the integer xi = xo + Yo2n-l satisfies the congruence x2 - a (mod 2n+l ). Squaring yields (xo + Yo2n-I )2 = x5 + XoYo2n + y522n-2 = a + (b + XoYo)2n + y522n-2 By the way Yo was chosen, 2 I (b + xoyo); hence, xt = (xo + Yo2n-I)2 =a (mod 2n+l) (we also use the fact that 2n - 2 = n + 1 + (n - 3) :=::: n + 1). Thus, the congruence x2 = a (mod 2n+ 1) is solvable, completing the induction step and the proof. To illustrate: The quadratic congruence x2 - 5 (mod 4) has a solution, but x2 = 5 (mod 8) does not; on the other hand, both x2 = 17 (mod 16) and x2 = 17 (mod 32) are solvable. THE QUADRATIC RECIPROCITY LAW 195 In theory, we can now completely settle the question of when there exists an integer x such that x2 =a (mod n) gcd(a, n) = 1 n > 1 For suppose that n has the prime-power decomposition where the Pi are distinct odd primes. Since the problem of solving the quadratic congruence x2 _ a (mod n) is equivalent to that of solving the system of congruences x2 =a (mod 2k0) x2 =a (mod p�1) x2 - a (mod p;') our last two results may be combined to give the following general conclusion. Theorem 9.13. Let n = 2ko p�1 • • • p�r be the prime factorization of n > 1 and let gcd(a, n) = 1. Then x 2 =a (mod n) is solvable if and only if (a) (a/ Pi)= 1 for i = 1, 2, ... , r; (b) a = 1 (mod 4) if 41 n, but 8 ,.r n; a = 1 (mod 8) if 81 n. PROBLEMS 9.4 1. (a) Show that 7 and 18 are the only incongruent solutions of x 2 = -1 (mod 52 ). (b) Use part (a) to find the solutions of x 2 = -1 (mod 53). 2. Solve each of the following quadratic congruences: (a) x 2 = 7 (mod 33). (b) x 2 = 14 (mod 53). (c) x 2 = 2 (mod 73). 3. Solve the congruence x 2 = 31 (mod 114). 4. Find the solutions of x 2 + 5x + 6 = 0 (mod 53) and x 2 + x + 3 = 0 (mod 33). 5. Prove that if the congruence x 2 =a (mod 2n), where a is odd and n ;:::: 3, has a solution, then it has exactly four incongruent solutions. [Hint: If xo is any solution, then the four integers xo, -x o, xo + 2n-1, -x o + 2n-l are incongruent modulo 2n and comprise all the solutions.] 6. From 232 = 17 (mod 27), find three other solutions of the quadratic congruence x 2 = 17 (mod 27). 7. First determine the values of a for which the congruences below are solvable and then find the solutions of these congruences: (a) x 2 = a (mod 24). (b) x 2 = a (mod 25). (c) x 2 =a (mod 26). 8. For fixed n > 1, show that all solvable congruences x 2 =a (mod n) with gcd(a, n) = 1 have the same number of solutions. 196 ELEMENTARY NUMBER THEORY 9. (a) Without actually finding them, determine the number of solutions of the congruences x2 = 3 (mod 112 · 232) and x2 = 9 (mod 23 · 3 · 52). (b) Solve the congruence x2 = 9 (mod 23 . 3 . 52). 10. (a) For an odd prime p, prove that the congruence 2x2 + 1 = 0 (mod p) has a solution if and only if p = 1 or 3 (mod 8). (b) Solve the congruence 2x2 + 1 = 0 (mod 112). [Hint: Consider integers of the form x0 + I Ik, where x0 is a solution of 2x2 + 1 = 0 (mod 11).] CHAPTER 10 INTRODUCTION TO CRYPTOGRAPHY I am fairly familiar with all forms of secret writings and am myself the author of a trifling manuscript on the subject. SIR ARTHUR CONAN DOYLE 10.1 FROM CAESAR CIPHER TO PUBLIC KEY CRYPTOGRAPHY Classically, the making and breaking of secret codes has usually been confined to diplomatic and military practices. With the growing quantity of digital data stored and communicated by electronic data-processing systems, organizations in both the public and commercial sectors have felt the need to protect information from un­ wanted intrusion. Indeed, the widespread use of electronic funds transfers has made privacy a pressing concern in most financial transactions. There thus has been a recent surge of interest by mathematicians and computer scientists in cryptogra­ phy (from the Greek kryptos meaning hidden and graphein meaning to write), the science of making communications unintelligible to all except authorized parties. Cryptography is the only known practical means for protecting information transmit­ ted through public communications networks, such as those using telephone lines, microwaves, or satellites. In the language of cryptography, where codes are called ciphers, the information to be concealed is called plaintext. After transformation to a secret form, a message is called ciphertext. The process of converting from plaintext to ciphertext is said to be encrypting (or enciphering), whereas the reverse process of changing from ciphertext back to plaintext is called decrypting (or deciphering). 197 198 ELEMENTARY NUMBER THEORY One of the earliest cryptographic systems was used by the great Roman emperor Julius Caesar around 50 B.C. Caesar wrote to Marcus Cicero using a rudimentary substitution cipher in which each letter of the alphabet is replaced by the letter that occurs three places down the alphabet, with the last three letters cycled back to the first three letters. If we write the ciphertext equivalent underneath the plaintext letter, the substitution alphabet for the Caesar cipher is given by Plaintext: AB C D E F G H I J KL MN 0 P QR S TU V W X Y Z Ciphertext: D E F G HI J KL M N 0 P Q R S T U V W X Y Z A B C For example, the plaintext message CAESAR WAS GREAT is transformed into the ciphertext FDHVDU ZDV JUHDW The Caesar cipher can be described easily using congruence theory. Any plaintext is first expressed numerically by translating the characters of the text into digits by means of some correspondence such as the following: A B c D E F G H I J K L M 00 01 02 03 04 05 06 07 08 09 10 11 12 N 0 p Q R s T u v w x y z 13 14 15 16 17 18 19 20 21 22 23 24 25 If P is the digital equivalent of a plaintext letter and C is the digital equivalent of the corresponding ciphertext letter, then C = P + 3 (mod 26) Thus, for instance, the letters of the message in Eq. (1) are converted to their equiv­ alents: 02 00 04 18 00 17 22 00 18 06 17 04 00 19 Using the congruence C = P + 3 (mod 26), this becomes the ciphertext 05 03 07 21 03 20 25 03 21 09 20 07 03 22 To recover the plaintext, the procedure is simply reversed by means of the congruence P = C - 3 = C + 23 (mod 26) The Caesar cipher is very simple and, hence, extremely insecure. Caesar himself soon abandoned this scheme-not only because of its insecurity, but also because he did not trust Cicero, with whom he necessarily shared the secret of the cipher. An encryption scheme in which each letter of the original message is replaced by the same cipher substitute is known as a monoalphabetic cipher. Such crypto­ graphic systems are extremely vulnerable to statistical methods of attack because they preserve the frequency, or relative commonness, of individual letters. In a polyalphabetic cipher, a plaintext letter has more than one ciphertext equivalent: the letter E, for instance, might be represented by J, Q, or X, depending on where it occurs in the message. INTRODUCTION TO CRYPTOGRAPHY 199 General fascination with cryptography had its initial impetus with the short story The Gold Bug, published in 1843 by the American writer Edgar Allan Poe. It is a fictional tale of the use of a table of letter frequencies to decipher directions for finding Captain Kidd's buried treasure. Poe fancied himself a cryptologist far beyond the ordinary. Writing for Alexander's Weekly, a Philadelphia newspaper, he once issued a claim that he could solve \"forthwith\" any monoalphabetic substitution cipher sent in by readers. The challenge was taken up by one G. W. Kulp, who submitted a 43-word ciphertext in longhand. Poe showed in a subsequent column that the entry was not genuine, but rather a \"jargon of random characters having no meaning whatsoever.\" When Kulp's cipher submission was finally decoded in 1975, the reason for the difficulty became clear; the submission contained a major error on Kulp's part, along with 15 minor errors, which were most likely printer's mistakes in reading Kulp's longhand. The most famous example of a polyalphabetic cipher was published by the French cryptographer Blaise de Vigenere (1523-1596) in his Traicte de Chiffres of 1586. To implement this system, the communicating parties agree on an easily remembered word or phrase. With the standard alphabet numbered from A = 00 to Z = 25, the digital equivalent of the keyword is repeated as many times as nec­ essary beneath that of the plaintext message. The message is then enciphered by adding, modulo 26, each plaintext number to the one immediately beneath it. The process may be illustrated with the keyword READY, whose numerical version is 17 04 00 03 24. Repetitions of this sequence are arranged below the numerical plaintext of the message AT TACK AT ONCE to produce the array 00 19 19 00 02 17 04 00 03 24 10 17 00 19 04 00 14 13 03 24 02 04 17 04 When the columns are added modulo 26, the plaintext message is encrypted as 17 23 19 03 00 01 04 19 17 11 19 08 or, converted to letters, RXTDAB ET RLTI Notice that a given letter of plain text is represented by different letters in ciphertext. The double T in the word AT TACK no longer appears as a double letter when ciphered, while the ciphertext letter R first corresponds to A and then to 0 in the original message. In general, any sequence of n letters with numerical equivalents b1, b2, .•• , bn (00 < bi ::S 25) will serve as the keyword. The plaintext message is expressed as successive blocks P1 P2 · · · Pn of n two-digit integers Pi, and then converted to ciphertext blocks C1 C2 · · · Cn by means of the congruences Ci = Pi + bi (mod 26) 1 < i ::S n Decryption is carried out by using the relations 200 ELEMENTARY NUMBER THEORY A weakness in Vigenere's approach is that once the length of the keyword has been determined, a coded message can be regarded as a number of separate mono­ alphabetic ciphers, each subject to straightforward frequency analysis. A variant to the continued repetition of the keyword is what is called a running key, a random assignment of ciphertext letters to plaintext letters. A favorite procedure for generat­ ing such keys is to use the text of a book, where both sender and recipient know the title of the book and the starting point of the appropriate lines. Because a running key cipher completely obscures the underlying structure of the original message, the system was long thought to be secure. But it does not, as Scientific American once claimed, produce ciphertext that is \"impossible of translation.\" A clever modification that Vigenere contrived for his polyalphabetic cipher is currently called the autokey (\"automatic key\"). This approach makes use of the plaintext message itself in constructing the encryption key. The idea is to start off the keyword with a short seed or primer (generally a single letter) followed by the plaintext, whose ending is truncated by the length of the seed. The autokey cipher enjoyed considerable popularity in the 16th and 17th centuries, since all it required of a legitimate pair of users was to remember the seed, which could easily be changed. Let us give a simple example of the method. Example 10.1. Assume that the message ONE IF BY DAWN is to be encrypted. Talcing the letter K as the seed, the keyword becomes KONEIFBYDAW When both the plaintext and keyword are converted to numerical form, we obtain the array 14 13 04 10 14 13 08 05 04 08 01 24 05 01 03 00 22 13 24 03 00 22 Adding the integers in matching positions modulo 26 yields the ciphertext 24 01 17 12 13 06 25 01 03 22 09 or, changing back to letters: YBR MN GZ BDWJ Decipherment is achieved by returning to the numerical form of both the plain­ text and its ciphertext. Suppose that the plaintext has digital equivalents P1 P2 ... Pn and the ciphertext C 1 C2 ... Cn. If S indicates the seed, then the first plaintext num­ ber is P1 = C1 - S = 24 - 10 - 14 (mod 26) Thus, the deciphering transformation becomes INTRODUCTION TO CRYPTOGRAPHY 201 pk= ck - pk-1 (mod 26), 2:::: k:::: n This recovers, for example, the integers P2 01 - 14 = -13 = 13 (mod 26) P3 17- 13-4 (mod26) where, to maintain the two-digit format, the 4 is written 04. A way to ensure greater security in alphabetic substitution ciphers was devised in 1929 by Lester Hill, an assistant professor of mathematics at Hunter College. Briefly, Hill's approach is to divide the plaintext message into blocks of n letters (possibly filling out the last block by adding \"dummy\" letters such as X's) and then to encrypt block by block using a system of n linear congruences in n variables. In its simplest form, when n = 2, the procedure takes two successive letters and transforms their numerical equivalents P1 P2 into a block C 1 C2 of ciphertext numbers via the pair of congruences C1 - aP1 + bP2 (mod 26) C2 = cP1 + dP2 (mod 26) To permit decipherment, the four coefficients a, b, c, d must be selected so the gcd(ad - be, 26) = 1. Example 10.2. To illustrate Hill's cipher, let us use the congruences Ci = 2Pi + 3P2 (mod 26) C2 = 5Pi + 8P2 (mod 26) to encrypt the message BUY NOW. The first block BU of two letters is numerically equivalent to 01 20. This is replaced by 2(01) + 3(20) = 62 = 10 (mod 26) 5(01) + 8(20) = 165 = 09 (mod 26) Continuing two letters at a time, we find that the completed ciphertext is 10 09 09 16 16 12 which can be expressed alphabetically as KJJ QQM. Decipherment requires solving the original system of congruences for Pi and P2 in terms of Ci and C2. It follows from the proof of Theorem 4.9 that the plaintext block Pi P2 can be recovered from the ciphertext block Ci C2 by means of the congruences Pi = 8Ci - 3C2 (mod 26) P2 = -5Ci + 2C2 (mod 26) For the block 10 09 of ciphertext, we calculate Pi - 8(10) - 3(09) = 53 = 01 (mod 26) P2 - -5(10) + 2(09) = -32 = 20 (mod 26) which is the same as the letter-pair BU. The remaining plaintext can be restored in a similar manner. 202 ELEMENTARY NUMBER THEORY An influential nonalphabetic cipher was devised by Gilbert S. Verman in 1917 while he was employed by the American Telephone and Telegraph Company (AT&T). Verman was interested in safeguarding information sent by the newly de­ veloped teletypewriter. At that time, wire messages were transmitted in the Baudot code, a code named after its French inventor J.M. E. Baudot. Baudot represented each letter of the alphabet by a five-element sequence of two symbols. If we take the two symbols to be 1 and 0, then the complete table is given by A= 11000 J = 11010 s = 10100 B = 10011 K = 11110 T = 00001 c = 01110 L=01001 u = 11100 D = 10010 M = 00111 v = 01111 E = 10000 N = 00110 w = 11001 F = 10110 0 = 00011 x = 10111 G = 01011 p = 01101 y = 10101 H = 00101 Q = 11101 z = 10001 I= 01100 R= 01010 Any plaintext message such as AC T NOW would first be transformed into a sequence of binary digits: 110000111000001001100001111001 Verman's innovation was to take as the encryption key an arbitrary sequence of 1 's and O's with length the same as that of the numerical plaintext. A typical key might appear as 101001011100100010001111001011 where the digits could be chosen by flipping a coin with heads as 1 and tails as 0. Finally, the ciphertext is formed by adding modulo 2 the digits in equivalent places in the two binary strings. The result in this instance becomes 011001100100101011101111110010 A crucial point is that the intended recipient must possess in advance the encryption key, for then the numerical plaintext can be reconstructed by merely adding modulo 2 corresponding digits of the encryption key and ciphertext. In the early applications of Verman's telegraph cipher, the keys were written on numbered sheets of paper and then bound into pads held by both correspondents. A sheet was tom out and destroyed after its key had been used just once. For this reason, the Verman enciphering procedure soon became known as the one-time system or one-time pad. The cryptographic strength of Verman's method of enciphering resided in the possibly extreme length of the encryption key and the absence of any pattern within its entries. This assured security that was attractive to the military or INTRODUCTION TO CRYPTOGRAPHY 203 diplomatic services of many countries. In 1963, for instance, a teleprinter hot line was established between Washington and Moscow using a one-time tape. In the 1970s, cryptographic systems involving modular exponentiation (that is, finding the least positive residue of ak(mod n) where a, k, n are positive integers) became increasingly prominent. By contrast with conventional cryptosystems, such as Caesar's cipher in which a message's sender and receiver share the same secret code, exponential systems require two distinct keys. One key encrypts; the other decrypts. These asymmetric-key systems are not difficult to implement. A user who wishes to conceal information might begin by selecting a (large) prime p to serve as the enciphering modulus, and a positive integer 2 < k < p - 2, the enciphering exponent. Modulus and exponent, both kept secret, must satisfy gcd(k, p - 1) = 1. The encryption process begins with the conversion of the message to numerical form M by means of a \"digital alphabet\" in which each letter of plaintext is replaced by a two-digit integer. One standard procedure is to use the following assignment A=OO H=07 0= 14 V=21 B = 01 I= 08 P= 15 W=22 C=02 1= 09 Q= 16 X=23 D=03 K= 10 R= 17 Y=24 E=04 L= 11 s = 18 Z=25 F=05 M= 12 T= 19 G=06 N= 13 U=20 with 26 being used to indicate an empty space between words. In this scheme, the message THE BROWN FOX IS QUICK would be transformed into the numerical string 19072426011714221326051423260818261620080210 It is assumed that the plaintext number Mis less than the enciphering modulus p; otherwise it would be impossible to distinguish M from a larger integer congruent to it modulo p. When the message is too lengthy to be represented by a single integer M < p, then it should be partitioned into blocks of digits Mi, M2, ... , Ms in which each block has the same number of digits. (A helpful guide is that when 2525 < p < 15500 each block should contain four digits.) It may be necessary to fill out the final block by appending one or more 23 's, indicating X. Next, the sender disguises the plaintext number M as a ciphertext number r by raising M to the k power and reducing the result modulo p; that is, Mk= r (mod p) At the other end, the intended recipient deciphers the transmitted communication by first determining the integer 2 < j ::=: p - 2, the recovery exponent, for which kj = 1 (mod p - 1) 204 ELEMENTARY NUMBER THEORY This can be achieved by using the Euclidean algorithm to express j as a solution x to the equation kx + (p - 1) y = 1 The recipient can now retrieve M from r by calculating the value rj (mod p ) . For, knowing that kj = 1 + (p - l)t for some t, Fermat's theorem will lead to rj = (Mk)j = Ml+(p-l)t = M(MP-l)t = M ·It (mod p) The numbers p and k must be kept secret from all except the recipient of the message, who needs them to arrive at the value j. That is, the pair (p, k) forms the sender's encryption key. Example 10.3. Let us illustrate the cryptographic procedure with a simple example: say, with the message SEND MONEY We select the prime p = 2609 for the enciphering modulus and the positive integer k = 19 for the enciphering exponent. The letters of the message are replaced by their numerical equivalents, producing the plaintext number 18041303261214130424 This string of digits is broken into four-digit blocks: 1804 1303 2612 1413 0424 Successive blocks are enciphered by raising each to the 19th power and then reducing modulo 2609. The method of repeated squaring can be used to make the exponentiation process more manageable. For instance, in the case of the block 1804 and so 18042 = 993 (mod 2609) 18044 = 9932 = 2456 (mod 2609) 18048 = 24562 = 2537 (mod 2609) 180416 = 25372 = 2575 (mod 2609) 180419 = 18041+2+!6 = 1804 · 993 · 2575 = 457 (mod 2609) The entire encrypted message consists of the list of numbers 0457 0983 1538 2041 0863 Since gcd(l9, 2608) = 1, working backward through the equations of the Euclidean algorithm yields I = 4 · 2608 + (-549)19 But -549 = 2059 (mod 2608) so that 1 = 2059 · 19 (mod 2608), making 2059 the recovery exponent. Indeed, 4572059 = 1804 (mod 2609). INTRODUCTION TO CRYPTOGRAPHY 205 The exponential cryptosystemjust described (the so-called Pohlig-Hellman sys­ tem) has drawbacks when employed in a communication network with many users. The major problem is the secure delivery of the encryption key, for the key must be provided in advance of a ciphertext message in order for the decryption key to be calculated. There is also the disadvantage of having to make frequent changes to the encryption key-perhaps, with each message-to avoid having some diligent eavesdropper become aware of it. The concept of public-key cryptography was in­ troduced to circumvent these difficulties. It also uses two distinct keys, but there is no easy computation method for deriving the decryption key from the encryption key. Indeed, the encryption key can safely be made public; the decryption key is secret and is owned solely by the message's recipient. The advantage of a public-key cryptosystem is clear: it is not necessary for sender and recipient to part with a key, or even to meet, before they communicate with one another. Whitfield Diffie and Martin Hellman laid out the theoretical framework of public-key cryptography in their landmark 1976 paper, \"New Directions in Cryptog­ raphy.\" Shortly thereafter, they developed a workable scheme, one whose security was grounded in a celebrated computation problem known as the knapsack problem. The public-key system most widely used today was proposed in 1978 by Ronald Rivest, Adi Shamir, and Leonard Adleman and is called RSA after their initials. Its security rests on the assumption that, in the current state of computer technol­ ogy, the factorization of composite numbers involving large primes is prohibitively time-consuming. To initiate communication, a typical user of the RSA system chooses distinct primes p and q large enough to place the factorization of their product n = pq, the enciphering modulus, beyond current computational capabilities. For instance, p and q might be picked with 200 digits each so that n would have around 400 digits. Having obtained n, the user takes for the enciphering exponent a random integer 1 < k < </J(n) with gcd(k, </J(n)) = 1. The pair (n, k) is placed in a public file, analogous to a telephone directory, to serve as the user's personal encryption key. This allows anyone else in the network to forward a ciphered message to that individual. Notice that while the integer n is openly revealed, the listed public key does not mention the two factors of n. A person wishing to correspond privately with the user proceeds in the manner indicated earlier. The literal message is first converted into a plaintext number, which thereafter is partitioned into suitably sized blocks of digits. The sender looks up the user's encryption key (n, k) in the public directory and disguises a block M < n by calculating Mk= r (mod n) The decryption process is carried out using the Euclidean algorithm to obtain the integer 1 < j < </J(n) satisfying kj = 1 (mod </J(n)); j exists because of the re­ quirement gcd(k, </J(n) = 1. Euler's generalization of Fermat's theorem plays a crit­ ical role in confirming that the congruence rj = M (mod n) holds. Indeed, since kj = 1 + </J(n )t for some integer j, it follows that rj = (Mk)j = M l+</J(n)t _ M(M</J(n))t _ M · It _ M (mod n) 206 ELEMENTARY NUMBER THEORY The recovery exponent j can be determined only by someone who is aware of both the values k and ¢(n) = (p - l)(q - 1) and, consequently, must know the prime factors p and q of n. This makes j secure from some undesired third party, who would know only the public key (n, k). The triple (p, q, j) can be viewed as the user's private key. Example 10.4. For an illustration of the RSA public-key algorithm, let us carry through an example involving primes of an unrealistically small size. Suppose that a message is to be sent to an individual whose listed public-key is (2701, 47). The key was arrived at by selecting the two primes p = 37 and q = 73, which in turn led to the encipering modulus n = 37 · 73 = 2701 and<f>(n) = 36 · 72 = 2592.Because gcd(47, 2592) = 1, the integer k = 47 was taken as the enciphering exponent. The message to be encrypted and forwarded is NOWAY TODAY It is first translated into a digital equivalent using the previously indicated letter sub­ stitutions to become kt = 131426220024261914030024 This plaintext number is thereafter expressed as four-digit blocks 1314 2622 0024 2619 1403 0024 The corresponding ciphertext numbers are obtained by raising each block to the 47 power and reducing the results modulo 2701. In the first block, repeated squaring produces the value 131447 = 1241 (mod 2701) The completed encryption of the message is the list 1241 1848 0873 1614 2081 0873 For the deciphering operation, the recipient employs the Euclidean algo­ rithm to obtain the equation 47 · 1103 + 2592(-20) = 1, which is equivalent to 47 · 1103 = 1 (mod 2592). Hence, j = 1103 is the recovery exponent. It follows that 12411103 = 1314 (mod 2701) and so on. For the RSA cryptosystem to be secure, it must not be computationally feasible to recover the plaintext M from the information assumed to be known to a third party, namely, the listed public-key (n, k). The direct method of attack would be to attempt to factor n, an integer of huge magnitude, for once the factors are deter­ mined, the recovery exponent j can be calculated from ¢(n) = (p - l)(q - 1) and k. Our confidence in the RSA system rests on what is known as the work factor, the expected amount of computer time needed to factor the product of two large primes. Factoring is computationally more difficult than distinguishing between primes and composites. On today's fastest computers, a 200-digit number can routinely be tested INTRODUCTION TO CRYPTOGRAPHY 207 for primality in less than 20 seconds, whereas the running time required to factor a composite number of the same size is prohibitive. It has been estimated that the quickest factoring algorithm known can use approximately (1.2) 1023 computer op­ erations to resolve an integer with 200 digits into its prime factors. Assuming that each operation takes 1 nanosecond 00-9 seconds), the factorization time would be about (3.8)106 years. Given unlimited computing time and some unimaginably efficient factoring algorithm, the RSA cryptosystem could be broken, but for the present it appears to be quite safe. All we need do is choose larger primes p and q for the enciphering moduli, always staying ahead of the current state of the art in factoring integers. A greater threat is posed by the use of widely distributed networks of computers, working simultaneously on pieces of data necessary for a factorization and commu­ nicating their results to a central site. This is seen in the factoring of RSA-129, one of the most famous problems in cryptography. To demonstrate that their cryptosystem could withstand any attack on its security, the three inventors submitted a ciphertext message to Scientific American, with an offer of $100 to anyone who could decode it. The message depended on a 129-digit enciphering modulus that was the product of two primes of approximately the same length. This large number acquired the name RSA-129. Taking into account the most powerful factoring methods and fastest computers available at the time, it was estimated that at least 40 quadrillion years would be required to break down RSA-129 and decipher the message. However, by devoting enough computing power to the task, the factorization was realized in 1994. A worldwide network of some 600 volunteers participated in the project, running more than 1600 computers over an 8-month period. What seemed utterly beyond reach in 1977 was accomplished a mere 17 years later. The plaintext message is the sentence \"The magic words are squeamish ossifrage.\" (An ossifrage, by the way, is a kind of hawk.) Drawn up in 1991, the 42 numbers in the RSA Challenge List serve as something of a test for recent advances in factorization methods. The latest factoring success showed that the 193-digit number (640 binary digits) RSA-640 could be written as the product of two primes having 95 digits each. The Challenge became inactive in 2007. PROBLEMS 10.1 1. Encrypt the message RETURN HOME using the Caesar cipher. 2. If the Caesar cipher produced KDSSB ELUWKGDB, what is the plaintext message? 3. (a) A linear cipher is defined by the congruence C = a P + b (mod 26), where a and b are integers with gcd(a, 26) = 1. Show that the corresponding decrypting congruence is P = a'(C - b) (mod 26), where the integer a' satisfies aa' = 1 (mod26). (b) Using the linear cipher C = 5P + 11 (mod 26), encrypt the message NUMBER THEORY IS EASY. (c) Decrypt the message RXQTGU HOZTKGH FJ KTMMTG, which was produced using the linear cipher C = 3P + 7 (mod 26). INTRODUCTION TO CRYPTOGRAPHY 209 11. Encrypt the message GOOD CHOICE using an exponential cipher with modulus p = 2609 and exponent k = 7. 12. The ciphertext obtained from an exponential cipher with modulus p = 2551 and enci­ phering exponent k = 43 is 1518 2175 1249 0823 2407 Determine the plaintext message. 13. Encrypt the plaintext message GO LD MEDAL using the RSA algorithm with key (2561,3). 14. The ciphertext message produced by theRSAalgorithmwithkey(n, k) = (2573, 1013)is 0464 1472 0636 1262 2111 Determine the original message. [Hint: The Euclidean algorithm yields 1013 · 17 = 1 (mod 2573).] 15. Decrypt the ciphertext 1030 1511 0744 1237 1719 that was encrypted using the RSA algorithm with key (n, k) = (2623, 869). [Hint: The recovery exponent is j = 29.] 10.2 THE KNAPSACK CRYPTOSYSTEM A public-key cryptosystem also can be based on the classic problem in combinatorics known as the knapsack problem, or the subset sum problem. This problem may be stated as follows: Given a knapsack of volume V and n items of various volumes a1, a2, ... , an, can a subset of these items be found that will completely fill the knapsack? There is an alternative formulation: For positive integers ai, a2, ... , an and a sum V, solve the equation V = aix2 + a2x2 + · · · + an Xn where Xi = 0 or 1 for i = 1, 2, ... , n. There might be no solution, or more than one solution, to the problem, depending on the choice of the sequence a 1, a2, ... , an and the integer V. For instance, the knapsack problem 22 = 3x1+7x2 + 9x3 + llx4 + 20xs is not solvable; but 27 = 3x1+7x2 + 9x3 + llx4 + 20xs has two distinct solutions, namely X2 = X3 = X4 = 1 XI= X5 = 0 and X2 = X5 = 1 Finding a solution to a randomly chosen knapsack problem is notoriously dif­ ficult. None of the known methods for attacking the problem are substantially less 210 ELEMENTARY NUMBER THEORY time-consuming than is conducting an exhaustive direct search, that is, by testing all the 2n possibilities for x1, x2, ... , Xn. This is computationally impracticable for n greater than 100, or so. However, if the sequence of integers a 1, a2, ... , an happens to have some special properties, the knapsack problem becomes much easier to solve. We call a sequence a1, a2, ... , an superincreasing when each ai is larger than the sum of all the preceding ones; that is, i = 2, 3, ... , n A simple illustration of a superincreasing sequence is 1, 2, 4, 8, ... , 2n, where 2i > 2i - 1 = 1+2 + 4 + ... + 2i-1. For the corresponding knapsack problem, V < 2 n+l the unknowns x; are j ust the digits in the binary expansion of V. Knapsack problems based on superincreasing sequences are uniquely solvable whenever they are solvable at all, as our next example shows. Example 10.5. Let us solve the superincreasing knapsack problem 28 = 3x1 + 5x2 + llx3 + 20x4 + 41xs We start with the largest coefficient in this equation, namely 41. Because 41 > 28, it cannot be part of our subset sum; hence xs = 0. The next-largest coefficient is 20, with 20 < 28. Now the sum of the preceding coefficients is 3 + 5 + 11 < 28, so that these cannot fill the knapsack; therefore 20 must be included in the sum, and so x4 = 1. Knowing the values of x4 and x5, the original problem may be rewritten as A repetition of our earlier reasoning now determines whether 11 should be in our knapsack sum. In fact, the inequality 11 > 8 forces us to take x3 = 0. To clinch matters, we are reduced to solving the equation 8 = 3x1 + 5x2, which has the obvious solution x1 = x2 = 1. This identifies a subset of 3, 5, 11, 20, 41 having the desired sum: 28 = 3 + 5 + 20 It is not difficult to see how the procedure described in Example 10.5 operates, in general. Suppose that we wish to solve the knapsack problem where ai , az, ... , an is a superincreasing sequence of integers. Assume that V can be obtained by using some subset of the sequence, so that V is not larger than the sum ai + az +···+an. Working from right to left in our sequence, we begin by letting Xn = 1 if V > an and Xn = 0 if V < an. Then obtain Xn-1• Xn-2• ... , X1, in turn, by choosing X; = g if V - (ai+lXi+l + · · · + anXn) � ai if V - (ai+lXi+l + · · · + anXn) < a; INTRODUCTION TO CRYPTOGRAPHY 211 With this algorithm, knapsack problems using superincreasing sequences can be solved quite readily. A public-key cryptosystem based on the knapsack problem was devised by R. Merkle and M. Hellman in 1978. It works as follows . A typical user of the system starts by choosing a superincreasing sequence ai, a2, ... , an . Now select a modulus m > 2an and a multiplier a, with 0 < a < m and gcd(a, m) = 1. This ensures that the congruence ax - 1 (mod m) has a unique solution, say, x - c (mod m ). Finally, form the sequence of integers b1, b2, ... , bn defined by i = 1, 2, ... , n where 0 < bi < m. Carrying out this last transformation generally destroys the superincreasing property enjoyed by the ai. The user keeps secret the original sequence a1, a2, ... , an, and the numbers m and a, but publishes b1, b2, ... , bn in a public directory. Anyone wishing to send a message to the user employs the publicly available sequence as the encryption key. The sender begins by converting the plaintext message into a string M of O's and l's using the binary equivalent of letters: Letter Binary equivalent Letter Binary equivalent A 00000 N B 00001 0 c 00010 p D 00011 Q E 00100 R F 00101 s G 00110 T H 00111 u I 01000 v J 01001 w K 01010 x L 01011 y M 01100 z For example, the message First Place would be converted into the numerical representation 01101 01110 01111 10000 10001 10010 10011 10100 10101 10110 10111 11000 11001 M =00101 01000 10001 10010 10011 01111 01011 00000 00010 00100 The string is then split into blocks of n binary digits, with the last block being filled out with l's at the end, if necessary. The public encrypting sequence b1, b2, ... , bn is next used to transform a given plaintext block, say x1x2 · · · Xn, into the sum S = b1x1 + b2x2 + · · · + bnXn The number S is the hidden information that the sender transmits over a communi­ cation channel, which is presumed to be insecure. 212 ELEMENTARY NUMBER THEORY Notice that because each xi is either 0 or 1, the problem of recreating the plain text block from S is equivalent to solving an apparently difficult knapsack problem (\"difficult\" because the sequence bi, b2, ... , bn is not necessarily superincreasing). On first impression, the intended recipient and any eavesdropper are faced with the same task. However, with the aid of the private decryption key, the recipient can change the difficult knapsack problem into an easy one. No one without the private key can make this change. Knowing c and m, the recipient computes S' = cS (mod m) 0 < S' < m or, expanding this, S' = cb1x1 + cb2x2 + · · · + cbnXn (mod m) = caa1x1 + caa2x2 + · · · + caanXn (mod m) Now ca= 1 (mod m), so that the previous congruence becomes S' = aix1 + a2x2 + · · · + anXn (mod m) Because m was initially chosen to satisfy m > 2an > ai + a2 +···+an, we obtain aix1 + a2x2 + · · · + anXn < m. In light of the condition 0 < S' < m, the equality S' = aix1 + a2x2 + · · · + anXn must hold. The solution to this superincreasing knapsack problem furnishes the solution to the difficult problem, and the plaintext block x1x2 · • · Xn of n digits is thereby recovered from S. To help make the technique clearer, we consider a small-scale example with n = 5. Example 10.6. Suppose that a typical user of this cryptosystem selects as a secret key the superincreasing sequence 3, 5, 11, 20, 41, the modulus m = 85, and the multiplier a = 44. Each member of the superincreasing sequence is multiplied by 44 and reduced modulo 85 to yield 47, 50, 59, 30, 19. This is the encryption key that the user submits to the public directory. Someone who wants to send a plaintext message to the user, such as HELP US first converts it into the following string of O's and l's: }J =00111 00100 01011 01111 10100 10010 The string is then broken up into blocks of digits, in the current case blocks oflength 5. Using the listed public key to encrypt, the sender transforms the successive blocks into 108 = 47. 0 + 50. 0 + 59. 1+30.1+19. 1 59 = 47. 0 + 50. 0 + 59. 1+30. 0 + 19. 0 99 = 47. 0 + 50. 1+59. 0 + 30. 1+19. 1 158 = 47. 0 + 50. 1+59. 1+30.1+19. 1 106 = 47. 1+50. 0 + 59. 1+30.0 + 19. 0 77 = 47. 1+50. 0 + 59. 0 + 30. 1+19. 0 INTRODUCTION TO CRYPTOGRAPHY 213 The transmitted ciphertext consists of the sequence of positive integers 108 59 99 158 106 77 To read the message, the legitimate receiver first solves the congruence 44x = 1 (mod 85), yielding x = 29 (mod 85). Then each ciphertext number is multiplied by 29 and reduced modulo 85, to produce a superincreasing knapsack problem. For instance, 108 is converted to 72, because 108 · 29 = 72 (mod 85); the corresponding knapsack problem is 72 = 3x1 + 5x2 + llx3 + 20x4 + 41xs The procedure for handling superincreasing knapsack problems quickly produces the solutionx1 = x2 = 0, x3 = x4 = xs = 1. In this way, the first block 00111 of the binary equivalent of the plaintext is recovered. The time required to decrypt a knapsack ciphertext message seems to grow expo­ nentially with the number of items in the knapsack. For a high level of security, the knapsack should contain at least 250 items to choose from. As a second illustration of how this cryptosystem works, let us note the effect of expanding to n = 10 the knapsack of Example 10.6. Example 10.7. Suppose that the user employs the superincreasing sequence 3,5, 11,20,41,83, 179,344,690, 1042 Taking m = 2618 and a = 929, each knapsack item is multiplied by a and reduced modulo m to produce the publicly listed enciphering key 169,2027,2365,254, 1437, 1185, 1357, 180,2218, 1976 If the message NOT NOW is to be forwarded, its binary equivalent may be partitioned into blocks of ten digits as 0110101110 1001101101 0111010110 A given block is encrypted by adding the numbers in the enciphering key whose locations correspond to the l's in the block. This will produce the ciphertext 9584 5373 8229 with larger values than those in Example 10.6. The recipient recovers the hidden message by multiplying each ciphertex number by the solution of the congruence 929x = 1 (mod 2618); that is, by 31 (mod 2618). For instance, 9584 · 31 - 1270 (mod 2618) where 1270 can be expressed in terms of the superincreasing sequence as 1270 = 5 + 11 + 41 + 179 + 344 + 690 The location of each right-hand integer in the knapsack then translates into 0110101110, the initial binary block. The Merkle-Hellman cryptosystem aroused a great deal of interest when it was first proposed, because it was based on a provably difficult problem. However, in 1982, A. Shamir invented a reasonably fast algorithm for solving knapsack problems that involved sequences b1, b2, ... , bn , where bi = aai (mod m) and ai, a2, ... , an is superincreasing. The weakness of the system is that the public encryption key 214 ELEMENTARY NUMBER THEORY b1, b2, ... , bn is too special; multiplying by a and reducing modulo m does not completely disguise the sequence ai, a2, ... , an. The system can be made somewhat more secure by iterating the modular multiplication method with different values of a and m, so that the public and private sequences differ by several transformations. But even this construction was successfully broken in 1985. Although most variations of the Merkle-Hellman scheme have been shown to be insecure, there are a few that have, so far, resisted attack. PROBLEMS 10.2 1. Obtain all solutions of the knapsack problem 21=2x1+3x2 + 5x3 + 7x4 + 9xs + llx6 2. Determine which of the sequences below are superincreasing: (a) 3, 13,20,37,81. (b) 5, 13, 25, 42, 90. (c) 7, 27, 47, 97, 197, 397. 3. Find the unique solution of each of the following superincreasing knapsack problems: (a) 118 = 4x1 + 5x2 + l0x3 + 20x4 + 41xs + 99x6. (b) 51 = 3x1 + 5x2 + 9x3 + l8x4 + 37x5. (c) 54 = x1 + 2x2 + 5x3 + 9x4 + l8x5 + 40x6. 4. Consider a sequence of positive integers a1, a2, ... , an, where ai+l > 2ai for i = 1, 2, ... , n - 1. Show that the sequence is superincreasing. 5. A user of the knapsack cryptosystem has the sequence 49, 32, 30, 43 as a listed encryption key. If the user's private key involves the modulus m = 50 and multiplier a = 33, determine the secret superincreasing sequence. 6. The ciphertext message produced by the knapsack cryptosystem employing the super­ increasing sequence 1, 3, 5, 11, 35, modulus m = 73, and multiplier a = 5 is 55, 15, 124, 109, 25, 34. Obtain the plaintext message. [Hint: Note that 5 · 44 = 1 (mod 73).] 7. A user of the knapsack cryptosystem has a private key consisting of the superincreasing sequence 2, 3, 7, 13, 27, modulus m = 60, and multiplier a= 7. (a) Find the user's listed public key. (b) With the aid of the public key, encrypt the message SEND MONEY. 10.3 AN APPLICATION OF PRIMITIVE ROOTS TO CRYPTOGRAPHY Most modern cryptographic schemes rely on the presumed difficulty of solving some particular number theoretic problem within a reasonable length of time. For instance, the security underlying the widely used RSA cryptosystem discussed in Section 10.1 is the sheer effort required to factor large numbers. In 1985, Taher ElGamal introduced a method of encrypting messages based on a version of the so-called discrete logarithm problem: that is, the problem of finding the power 0 < x < </>(n ), if it exists, which satisfies the congruence r x = y (mod n) for given r, y, and n. The exponent x is said to be the discrete logarithm of y to the base r, modulo n. The 218 ELEMENTARY NUMBER THEORY and thereafter solves the congruence 25d = 13 - 5 · 15 (mod 42) for the valued = 16 (mod 42). The digital signature attached to the reply consists of the pair (5, 16). On its arrival, the signature is confirmed by checking the equality of the integers Vi and V2: Vi = 225 · 516 = 39 · 40 = 12 (mod 43) V2 = 313 = 12 (mod 43) PROBLEMS 10.3 1. The message REPLY TODAY is to be encrypted in the ElGamal cryptosystem and forwarded to a user with public key (47, 5, 10) and private key k = 19. (a) If the random integer chosen for encryption is j = 13, determine the ciphertext. (b) Indicate how the ciphertext can be decrypted using the recipient's private key. 2. Suppose that the following ciphertext is received by a person having ElGamal public key (71, 7, 32) and private key k = 30: (56, 45) (56, 05) (56, 38) (56, 27) Obtain the plaintext message. (56, 29) (56, 31) (56, 03) (56, 38) (56, 67) (56, 29) 3. The message NOT NOW (numerically 131419131422) is to be sent to a user of the ElGamal system who has public key (37, 2, 18) and private key k = 17. If the integer j used to construct the ciphertext is changed over successive four-digit blocks from j = 13 to j = 28 to j = 11, what is the encrypted message produced? 4. Assume that a person has ElGamal public key (2633, 3, 1138) and private key k = 965. If the person selects the random interger j = 583 to encrypt the message BEWARE OF THEM, obtain the resulting ciphertext. [Hint: 3583 = 1424 (mod 2633), 1138583 = 97 (mod 2633).] 5. (a) A person with public key (31, 2, 22) and private key k = 17 wishes to sign a message whose first plaintext block is B = 14. If 13 is the integer chosen to construct the signature, obtain the signature produced by the ElGamal algorithm. (b) Confirm the validity of this signature. CHAPTER 11 NUMBERS OF SPECIAL FORM In most sciences one generation tears down what another has built and what one has established another undoes. In Mathematics alone each generation builds a new story to the old structure. HERMANN HANKEL 11.1 MARIN MERSENNE The earliest instance we know of a regular gathering of mathematicians is the group held together by an unlikely figure-the French priest Father Marin Mersenne ( 1588- 1648). The son of a modest farmer, Mersenne received a thorough education at the Jesuit College of La Fleche. In 1611, after two years studying theology at the Sorbonne, he joined the recently founded Franciscan Order of Minims. Mersenne entered the Minim Convent in Paris in 1619 where, except for short trips, he remained for the rest of his life. Mersenne lamented the absence of any sort of formal organization to which scholars might resort. He responded to this need by making his own rooms at the Minim Convent available as a meeting place for those drawn together by common interests, eager to discuss their respective discoveries and hear of similar activity else­ where. The learned circle he fostered-composed mainly of Parisian mathematicians and scientists but augmented by colleagues passing through the city-seems to have met almost continuously from 1635 until Mersenne's death in 1648. At one of these meetings, the precocious 14-year-old Blaise Pascal distributed his handbill Essay pour les coniques containing his famous \"mystic hexagram\" theorem; Descartes could only grumble that he could not \"pretend to be interested in the work of a boy.\" 219 220 ELEMENTARY NUMBER THEORY After Mersenne's death, the august sessions continued to be held at private homes in and around Paris, including Pascal's. It is customary to regard the Academie Royale des Sciences, chartered in 1666, as the more or less direct successor of these informal gatherings. From 1625 onward, Mersenne made it his business to become acquainted with everyone of note in the European intellectual world. He carried out this plan through an elaborate network of correspondence which lasted over 20 years. In essence, he became an individual clearinghouse of mathematical and scientific information, trading news of current advances in return for more news. For instance, in 1645 Mersenne visited the physicist Torricelli in Italy, and made widely known Torricelli's use of a rising column of mercury in a vacuum tube to demonstrate atmospheric pressure. Mersenne's communications, dispersed over the Continent by passing from hand to hand, were the vital link between isolated members of the emerging scientific community at a time when the publication of learned journals still lay in the future. After Mersenne's death, letters from 78 correspondents scattered over Western Europe were found in his Parisian quarters. Among his correspondents were Huygens in Holland, Torricelli and Galileo in Italy, Pell and Hobbes in England, and the Pascals, father and son, in France. He had also served as the main channel of commu­ nication between the French number theorists Fermat, Frenicle, and Descartes; their exchanged letters determined the sorts of problems these three chose to investigate. Mersenne was not himself a serious contributor to the subject, rather a remark­ able interested person prodding others with questions and conjectures. His own queries tended to be rooted in the classical Greek concern with divisibility. For in­ stance, in a letter written in 1643, he sent the number 100895598169 to Fermat with a request for its factors. (Fermat responded almost immediately that it is the product of the two primes 8984 23 and 112303.) On another occasion he asked for a number that has exactly 360 divisors. Mersenne was also interested in whether or not there exists a so-called perfect number with 20 or 21 digits, the underlying question really being to find out whether 237 - 1 is prime. Fermat discovered that the only prime divisors of 237 - 1 are of the form 7 4k + 1 and that 223 is such a factor, thereby supplying a negative answer to Mersenne. Mersenne was the author of various works dealing with the mathematical sci­ ences, including Synopsis Mathematica (1626), Traite de !'Harmonie Universelle (1636-1637), and Universae Geometriae Synopsis (1644). A believer in the new Copernican theory of the earth's motion, he was virtually Galileo's representative in France. He brought out (1634), under the title Les Mecaniques de Galilee, a ver­ sion of Galileo's early lectures on mechanics; and, in 1639, a year after its original publication, he translated Galileo's Discorsi-a treatise analyzing projectile motion and gravitational acceleration-into French. As Italian was little understood abroad, Mersenne was instrumental in popularizing Galileo's investigations. It is notable that he did this as a faithful member of a Catholic religious order at the height of the Church's hostility to Galileo and its condemnation of his writings. Perhaps Mersenne's greatest contribution to the scientific movement lay in his rejection of the traditional interpretation of natural phenomena, which had stressed the action of \"occult\" powers, by insisting instead upon purely rational explanations. Marin Mersenne (1588-1648) NUMBERS OF SPECIAL FORM 221 (David Eugene Smith Collection, Rare Book and Manuscript Library, Columbia University) 11.2 PERFECT NUMBERS The history of the theory of numbers abounds with famous conjectures and open questions. The present chapter focuses on some of the intriguing conjectures asso­ ciated with perfect numbers. A few of these have been satisfactorily answered, but most remain unresolved; all have stimulated the development of the subject as a whole. The Pythagoreans considered it rather remarkable that the number 6 is equal to the sum of its positive divisors, other than itself: 6=1+2+3 The next number after 6 having this feature is 28; for the positive divisors of 28 are found to be 1, 2, 4, 7, 14, and 28, and 28 = 1 + 2 + 4 + 7 + 14 In line with their philosophy of attributing mystical qualities to numbers, the Pythagoreans called such numbers \"perfect.\" We state this precisely in Definition 11.1. Definition 11.1. A positive integer n is said to be peifect if n is equal to the sum of all its positive divisors, excluding n itself. The sum of the positive divisors of an integer n, each of them less than n, is given by a(n) - n. Thus, the condition \"n is perfect\" amounts to asking thata(n) - n = n, or equivalently, that a(n) = 2n For example, we have a ( 6) = 1 + 2 + 3 + 6 = 2 · 6 222 ELEMENTARY NUMBER THEORY and o-(28) = 1 + 2 + 4 + 7 + 14 + 28 = 2 . 28 so that 6 and 28 are both perfect numbers. For many centuries, philosophers were more concerned with the mystical or religious significance of perfect numbers than with their mathematical properties. Saint Augustine explains that although God could have created the world all at once, He preferred to take 6 days because the perfection of the work is symbolized by the (perfect) number 6. Early commentators on the Old Testament argued that the perfection of the universe is represented by 28, the number of days it takes the moon to circle the earth. In the same vein, the 8th century theologian Alcuin of York observed that the whole human race is descended from the 8 souls on Noah's Ark and that this second Creation is less perfect than the first, 8 being an imperfect number. Only four perfect numbers were known to the ancient Greeks. Nicomachus in his Introductio Arithmeticae (circa 100 A.D.) lists P2 = 28 P3 = 496 P4 = 8128 He says that they are formed in an \"orderly\" fashion, one among the units, one among the tens, one among the hundreds, and one among the thousands (that is, less than 10,000). Based on this meager evidence, it was conjectured that 1. The nth perfect number Pn contains exactly n digits; and 2. The even perfect numbers end, alternately, in 6 and 8. Both assertions are wrong. There is no perfect number with 5 digits; the next perfect number (first given correctly in an anonymous 15th century manuscript) is Ps = 33550336 Although the final digit of P5 is 6, the succeeding perfect number, namely, p6 = 8589869056 also ends in 6, not 8 as conjectured. To salvage something in the positive direction, we shall show later that the even perfect numbers do always end in 6 or 8-but not necessarily alternately. If nothing else, the magnitude of P6 should convince the reader of the rarity of perfect numbers. It is not yet known whether there are finitely many or infinitely many of them. The problem of determining the general form of all perfect numbers dates back almost to the beginning of mathematical time. It was partially solved by Euclid when in Book IX of the Elements he proved that if the sum 1 + 2 + 22 + 23 + ... + 2k-l = p is a prime number, then 2k-l p is a perfect number (of necessity even). For instance, 1+2+4 = 7 is a prime; hence, 4 · 7 = 28 is a perfect number. Euclid's argument NUMBERS OF SPECIAL FORM 223 makes use of the formula for the sum of a geometric progression 1 + 2 + 22 + 23 + ... + 2k-1 = 2k - 1 which is found in various Pythagorean texts. In this notation, the result reads as follows: If 2k - 1 is prime (k > 1), then n = 2k-1(2k - 1) is a perfect number. About 2000 years after Euclid, Euler took a decisive step in proving that all even perfect numbers must be of this type. We incorporate both these statements in our first theorem. Theorem 11.1. If 2k - 1 is prime (k > 1), then n = 2k -1(2k - 1) is perfect and every even perfect number is of this form. Proof. Let 2k - 1 = p, a prime, and consider the integer n = 2k-l p. Inasmuch as gcd(2k -l, p) = 1, the multiplicativity of CJ (as well as Theorem 6.2) entails that u(n) = u(2 k- l p) = u(2 k- 1)u(p) = (2k - l)(p + 1) = (2k - 1)2 k = 2n making n a perfect number. For the converse, assume that n is an even perfect number. We may write n as n = 2k-1m, where m is an odd integer and k � 2. ltfollowsfrom gcd(2 k-l, m) = 1 that u(n) = u(2 k -1 m) = u(2k-1)u(m) = (2k - l)u(m) whereas the requirement for a number to be perfect gives u(n) = 2n = 2km Together, these relations yield 2km = (2k - I)u(m) which is simply to say that (2 k - 1) I 2km. But 2k - 1 and 2k are relatively prime, whence (2k - 1) Im; say, m = (2k - l)M. Now the result of substituting this value of m into the last-displayed equation and canceling 2k - 1 is that u (m) = 2k M. Because m and M are both divisors of m (with M < m), we have 2k M = u(m) � m + M = 2k M leading to u(m) = m + M. The implication of this equality is that m has only two positive divisors, to wit, M and m itself. It must be that m is prime and M = 1; in other words, m = (2k - l)M = 2 k - 1 is a prime number, completing the present proof. Because the problem of finding even perfect numbers is reduced to the search for primes of the form 2k - 1, a closer look at these integers might be fruitful. One thing that can be proved is that if zk - 1 is a prime number, then the exponent k must itself be prime. More generally, we have the following lemma. Lemma. If ak - 1 is prime (a > 0, k � 2), then a = 2 and k is also prime. 224 ELEMENTARY NUMBER THEORY Proof. It can be verified without difficulty that ak - 1 = (a - l)(ak-l + ak-2 +···+a+ 1) where, in the present setting, ak-1 + ak-2 + ... +a+ 1 ::: a+ 1 > 1 Because by hypothesis ak - 1 is prime, the other factor must be 1; that is, a - 1 = 1 so that a= 2. If k were composite, then we could write k = rs, with 1 < r and 1 < s. Thus, ak - 1 = (ary - 1 = (ar _ l)(ar(s-1) + ar(s-2) + ... + ar + 1) and each factor on the right is plainly greater than 1. But this violates the primality of ak - 1, so that by contradiction k must be prime. For p = 2, 3, 5, 7, the values 3, 7, 31, 127 of 2P - 1 are primes, so that are all perfect numbers. 2(22 - 1) = 6 22(23 - 1) = 28 24(25 - 1) = 496 26(27 - 1) = 8128 Many early writers erroneously believed that 2P - 1 is prime for every choice of the prime number p. But in 1536, Hudalrichus Regius in a work entitled Utriusque Arithmetices exhibits the correct factorization 211 - 1 = 204 7 = 23 . 89 If this seems a small accomplishment, it should be realized that his calculations were in all likelihood carried out in Roman numerals, with the aid of an abacus (not until the late 16th century did the Arabic numeral system win complete ascendancy over the Roman one). Regius also gave p = 13 as the next value of p for which the expression 2P - 1 is a prime. From this, we obtain the fifth perfect number 212(213 - 1) = 33550336 One of the difficulties in finding further perfect numbers was the unavailability of tables of primes. In 1603, Pietro Cataldi, who is remembered chiefly for his invention of the notation for continued fractions, published a list of all primes less than 5150. By the direct procedure of dividing by all primes not exceeding the square root of a number, Cataldi determined that 217 - 1 was prime and, in consequence, that 216(217 - 1) = 8589869056 is the sixth perfect number. A question that immediately springs to mind is whether there are infinitely many primes of the type 2P - 1, with p a prime. If the answer were in the affirmative, then there would exist an infinitude of (even) perfect numbers. Unfortunately, this is another famous unresolved problem. NUMBERS OF SPECIAL FORM 225 This appears to be as good a place as any at which to prove our theorem on the final digits of even perfect numbers. Theorem 11.2. An even perfect number n ends in the digit 6 or 8; equivalently, either n = 6 (mod 10) or n = 8 (mod 10). Proof. Being an even perfect number, n may be represented as n = 2k-l (2k - 1), where 2k - 1 is a prime. According to the last lemma, the exponent k must also be prime. If k = 2, then n = 6, and the asserted result holds. We may therefore confine our attention to the case k > 2. The proof falls into two parts, according as k takes the form 4m + 1 or 4m + 3. If k is of the form 4m + 1, then n = 24m(24m+1 - 1) = 28m+l _ 24m = 2. 162m _ 16m A straightforward induction argument will make it clear that 161 = 6 (mod 10) for any positive integer t. Utilizing this congruence, we get n = 2 · 6 - 6 = 6 (mod 10) Now, in the case in which k = 4m + 3, n = 24m+2(24m+3 _ l) = 28m+5 _ 24m+2 = 2. 162m+l _ 4. 16m Falling back on the fact that 161 = 6 (mod 10), we see that n = 2 · 6 - 4 · 6 = -12 = 8 (mod 10) Consequently, every even perfect number has a last digit equal to 6 or to 8. A little more argument establishes a sharper result, namely, that any even perfect number n = 2k-1(2k - 1) always ends in the digits 6 or 28. Because an integer is congruent modulo 100 to its last two digits, it suffices to prove that, if k is of the form 4m + 3, then n _ 28 (mod 100). To see this, note that 2k-l = 24m+2 = l6m · 4 = 6 · 4 = 4 (mod 10) Moreover, for k > 2, we have 4 I 2k-l, and therefore the number formed by the last two digits of 2k-l is divisible by 4. The situation is this: The last digit of 2k-l is 4, and 4 divides the last two digits. Modulo 100, the various possibilities are 2k-l = 4, 24, 44, 64, or 84 But this implies that 2k - 1=2 .2k-l - 1 _ 7, 47, 87, 27, or 67 (mod 100) whence n = 2k-1(2k - 1) = 4 · 7, 24 · 47, 44 · 87, 64 · 27, or 84 · 67 (mod 100) It is a modest exercise, which we bequeath to the reader, to verify that each of the products on the right-hand side of the last congruence is congruent to 28 modulo 100. 226 ELEMENTARY NUMBER THEORY PROBLEMS 11.2 1. Prove that the integer n = 210(211 - 1) is not a perfect number by showing that a(n) # 2n. [Hint: 211 - 1 = 23 · 89.] 2. Verify each of the statements below: (a) No power of a prime can be a perfect number. (b) A perfect square cannot be a perfect number. ( c) The product of two odd primes is never a perfect number. [Hint: Expand the inequality (p - l)(q - 1) > 2 to get pq > p + q + 1.] 3. If n is a perfect number, prove that Ld 1 n 1 / d = 2. 4. Prove that every even perfect number is a triangular number. 5. Given that n is an even perfect number, for instance n = 2k-1(2k - 1), show that the integer n = 1 + 2 + 3 + · · · + (2k - 1) and also that <f>(n) = 2k-1(2k-l - 1). 6. For an even perfect number n > 6, show the following: (a) The sum of the digits of n is congruent to 1 modulo 9. [Hint: The congruence 26 = 1 (mod 9) and the fact that any prime p ::=::: 5 is of the form 6k + 1or6k + 5 imply that n = 2P-1(2P - 1) = 1 (mod 9).] (b) The integer n can be expressed as a sum of consecutive odd cubes. [Hint: Use Section 1.1, Problem l(e) to establish the identity below for all k ::=::: 1: 13 + 33 + 53 + ... + (2k - 1)3 = 22k-2(22k-1 - l).] 7. Show that no proper divisor of a perfect number can be perfect. [Hint: Apply the result of Problem 3.] 8. Find the last two digits of the perfect number n = 219936(219937 _ l) 9. If a(n) =kn, where k ::=::: 3, then the positive integer n is called a k-perfect number (sometimes, multiply perfect). Establish the following assertions concerning k-perfect numbers: (a) 523776 = 29 · 3 · 11 · 31 is 3-perfect. 30240 = 25 · 33 · 5 · 7 is 4-perfect. 14182439040 = 27 · 34 · 5 · 7 · 112 · 17 · 19 is 5-perfect. (b) If n is a 3-perfect number and 3 l n, then 3n is 4-perfect. (c) If n is a 5-perfect number and 5 l n, then 5n is 6-perfect. (d) If 3n is a 4k-perfect number and 3 J n, then n is 3k-perfect. For each k, it is conjectured that there are only finitely many k-perfect numbers. The largest one discovered has 558 digits and is 9-perfect. 10. Show that 120 and 672 are the only 3-perfect numbers of the form n = 2k · 3 · p, where p is an odd prime. 11. A positive integer n is multiplicatively perfect if n is equal to the product of all its positive divisors, excluding n itself; in other words, n2 = 0d In d. Find all multiplicatively perfect numbers. [Hint: Notice that n2 = nr(n)/2.] 12. (a) If n > 6 is an even perfect number, prove that n = 4 (mod 6). [Hint: 2p-I = 1 (mod 3) for an odd prime p.] (b) Prove that if n # 28 is an even perfect number, then n = 1 or -1 (mod 7). 13. For any even perfect number n = 2k-1(2k - 1), show that 2k I a(n2) + 1. NUMBERS OF SPECIAL FORM 227 14. Numbers n such that cr(cr(n)) = 2n are called superpeifect numbers. (a) If n = 2k with 2k+1 - 1 a prime, prove that n is superperfect; hence, 16 and 64 are superperf ect. (b) Find all even perfect numbers n = 2k-1(2k - 1) which are also superperfect. [Hint: First establish the equality cr(cr(n)) = 2k(2k+1 - l).] 15. The harmonic mean H (n) of the divisors of a positive integer n is defined by the formula 1 1 1 H(n) - r(n) � d Show that if n is a perfect number, then H (n) must be an integer. [Hint: Observe that H(n) = nr(n)/cr(n).] 16. The twin primes 5 and 7 are such that one half their sum is a perfect number. Are there any other twin primes with this property? [Hint: Given the twin primes p and p + 2, with p > 5, !CP + p + 2) = 6k for some k > 1 . ] 17. Prove that if 2k - 1 is prime, then the sum 2k-l + 2k + 2k+l + ... + 22k-2 will yield a perfect number. For instance, 23 - 1 is prime and 22 + 23 + 24 = 28, which is perfect. 18. Assuming that n is an even perfect number, say n = 2k-l (2k - 1 ), prove that the product of the positive divisors of n is equal to nk; in symbols, 19. If n1, n2, ... , nr are distinct even perfect numbers, establish that cp(n 1n2 · · · nr) = 2r-l¢(n1)¢(n2) · · · cp(nr) [Hint: See Problem 5. ] 20. Given an even perfect number n = 2k-1(2k - 1), show that ¢(n) = n - 22k-2 11.3 MERSENNE PRIMES AND AMICABLE NUMBERS It has become traditional to call numbers of the form n > 1 M ersenne numbers after Father Marin Mersenne who made an incorrect but provoca­ tive assertion concerning their primality. Those Mersenne numbers that happen to be prime are said to be Mersenne primes. By what we proved in Section 11.2, the determination of Mersenne primes Mn-and, in tum, of even perfect numbers-is narrowed down to the case in which n is itself prime. In the preface of his Cogitata Physica-Mathematica (1644), Mersenne stated that Mp is prime for p = 2, 3, 5, 7, 13, 17, 19, 31, 67, 127, 257 and composite for all other primes p < 257. It was obvious to other mathematicians that Mersenne could not have tested for primality all the numbers he had announced; but neither could they. Euler verified (1772) that M31 was prime by examining all primes up to 228 ELEMENTARY NUMBER THEORY 46339 as possible divisors, but M67, M127, and M2s? were beyond his technique; in any event, this yielded the eighth perfect number 230 (231 - 1) = 2305843008139952128 It was not until 1947, after tremendous labor caused by unreliable desk calcu­ lators, that the examination of the prime or composite character of MP for the 55 primes in the range p < 257 was completed. We know now that Mersenne made five mistakes. He erroneously concluded that M67 and M2s? are prime and excluded M61, M89, and M107 from his predicted list of primes. It is rather astonishing that over 300 years were required to set the good friar straight. All the composite numbers Mn with n � 257 have now been completely fac­ tored. The most difficult factorization, that of M251, was obtained in 1984 after a 32-hour search on a supercomputer. An historical curiosity is that, in 1876, Edouard Lucas worked a test whereby he was able to prove that the Mersenne number M67 was composite; but he could not produce the actual factors. Lucas was the first to devise an efficient \"primality test\"; that is, a procedure that guarantees whether a number is prime or composite without revealing its factors, if any. His primality criteria for the Mersenne and Fermat numbers were developed in a series of 13 papers published between January of 1876 and January of 1878. Despite an outpouring of research, Lucas never obtained a major academic position in his native France, instead spending his career in various secondary schools. A freak, unfortunate accident led to Lucas's death from infection at the early age of 49: a piece of a plate dropped at a banquet flew up and gashed his cheek. At the October 1903 meeting of the American Mathematical Society, the Ameri­ can mathematician Frank Nelson Cole had a paper on the program with the somewhat unassuming title \"On the Factorization of Large Numbers.\" When called upon to speak, Cole walked to a board and, saying nothing, proceeded to raise the integer 2 to the 67th power; then he carefully subtracted 1 from the resulting number and let the figure stand. Without a word he moved to a clean part of the board and multiplied, longhand, the product 193, 707, 721 x 761,838,257,287 The two calculations agreed. The story goes that, for the first and only time on record, this venerable body rose to give the presenter of a paper a standing ovation. Cole took his seat without having uttered a word, and no one bothered to ask him a question. (Later, he confided to a friend that it took him 20 years of Sunday afternoons to find the factors of M 67.) In the study of Mersenne numbers, we come upon a strange fact: when each of the first four Mersenne primes (namely, 3, 7, 31, and 127) is substituted for n in the formula 2n - 1, a higher Mersenne prime is obtained. Mathematicians had hoped that this procedure would give rise to an infinite set of Mersenne primes; in other words, the conjecture was that if the number Mn is prime, then MMn is also a prime. Alas, in 1953 a high-speed computer found the next possibility MM = 2M13 - 1 = 28191 - 1 13 (a number with 2466 digits) to be composite. NUMBERS OF SPECIAL FORM 229 There are various methods for determining whether certain special types of Mersenne numbers are prime or composite. One such test is presented next. Theorem 11.3. If p and q = 2p + 1 are primes, then either q I Mp or q I Mp+ 2, but not both. Proof. With reference to Fermat's theorem, we know that 2q-l - 1 = 0 (mod q) and, factoring the left-hand side, that (2(q-l)/2 - 1)(2(q-l)/2 + 1) = (2P - 1)(2P + 1) = 0 (mod q) What amounts to the same thing: Mp(Mp + 2) = 0 (mod q) The stated conclusion now follows directly from Theorem 3.1. We cannot have both q I MP and q I MP + 2, for then q I 2, which is impossible. A single application should suffice to illustrate Theorem 11.3: if p = 23, then q = 2p + 1 = 47 is also a prime, so that we may consider the case of M23. The question reduces to one of whether 471 M23 or, to put it differently, whether 223 = 1(mod47). Now, we have 2 23 = 2\\2 5) 4 = 23 (-15) 4(mod 47) But (-15) 4 = (225) 2 = (-10) 2 = 6 (mod 47) Putting these two congruences together, we see that 223 = 23 . 6 = 48 = 1(mod47) whence M23 is composite. We might point out that Theorem 11.3 is of no help in testing the primality of M29, say; in this instance, 59 l M29, but instead 591 M29 + 2. Of the two possibilities q I MP or q I MP + 2, is it reasonable to ask: What conditions on q will ensure that q I MP? The answer is to be found in Theorem 11.4. Theorem 11.4. If q = 2n + 1 is prime, then we have the following: (a) q I Mn, provided that q = 1 (mod 8) or q = 7 (mod 8). (b) q I Mn+ 2, provided that q = 3 (mod 8) or q = 5 (mod 8). Proof. To say that q I Mn is equivalent to asserting that 2<q-l)/2 = 2 n = 1 (mod q) In terms of the Legendre symbol, the latter condition becomes the requirement that 230 ELEMENTARY NUMBER THEORY (2/q) = 1. But according to Theorem 9.6, (2/q) = 1 when we have q = 1 (mod 8) or q = 7 (mod 8). The proof of (b) proceeds along similar lines. Let us consider an immediate consequence of Theorem 11.4. Corollary. If p andq = 2p + 1 are both odd primes, with p = 3 (mod 4), thenq I Mp. Proof. An odd prime p is either of the form 4k + 1 or 4k + 3. If p = 4k + 3, then q = 8k + 7 and Theorem 11.4 yields q I MP. In the case in which p = 4k + 1, q = 8k + 3 so that q J MP. The following is a partial list of those prime numbers p _ 3 (mod 4) where q = 2p + 1 is also prime: p = 11, 23, 83, 131, 179, 191, 239, 251. In each instance, MP is composite. Exploring the matter a little further, we next tackle two results of Fermat that restrict the divisors of Mp· The first is Theorem 11.5. Theorem 11.5. If p is an odd prime, then any prime divisor of Mp is of the form 2kp + 1. Proof. Let q be any prime divisor of MP, so that 2 P = 1 (mod q ). If 2 has order k modulo q (that is, if k is the smallest positive integer that satisfies 2k = 1 (mod q )), then Theorem 8.1 tells us that k Ip. The case k = 1 cannot arise; for this would imply that q 11, an impossible situation. Therefore, because both k I p and k > 1, the primality of p forces k = p. In compliance with Fermat's theorem, we have 2q-l = 1 (mod q), and therefore, thanks to Theorem 8.1 again, k I q - 1. Knowing that k = p, the net result is p I q - 1. To be definite, let us put q - 1 = pt; then q = pt+ 1. The proof is completed by noting that if t were an odd integer, then q would be even and a contradiction occurs. Hence, we must have q = 2kp + 1 for some choice of k, which gives q the required form. As a further sieve to screen out possible divisors of MP, we cite the following result. Theorem 11.6. If p is an odd prime, then any prime divisor q of MP is of the form q = ±1(mod8). Proof. Suppose that q is a prime divisor of MP, so that 2 P = 1 (mod q ). According to Theorem 11.5, q is of the form q = 2kp + 1 for some integer k. Thus, using Euler's criterion, (2/q) = 2<q-l)/2 = 1 (mod q), whence (2/q) = 1. Theorem 9.6 can now be brought into play again to conclude that q = ±1 (mod 8). For an illustration of how these theorems can be used, one might look at M 17. Those integers of the form 34k + 1 that are less than 362 < ,JM-;; are 35,69, 103, 137, 171,205,239,273,307,341 NUMBERS OF SPECIAL FORM 231 Because the smallest (nontrivial) divisor of M 17 must be prime, we need only consider the primes among the foregoing 10 numbers; namely, 103, 137,239,307 The work can be shortened somewhat by noting that 307 ¥= ± 1 (mod 8), and therefore we may delete 307 from our list. Now either M 17 is prime or one of the three remaining possibilities divides it. With a little calculation, we can check that M 17 is divisible by none of 103, 137, and 239; the result: M17 is prime. After giving the eighth perfect number 230 (231 - 1), Peter Barlow, in his book Theory of Numbers (published in 1811 ), concludes from its size that it \"is the greatest that ever will be discovered; for as they are merely curious, without being useful, it is not likely that any person will ever attempt to find one beyond it.\" The very least that can be said is that Barlow underestimated obstinate human curiosity. Although the subsequent search for larger perfect numbers provides us with one of the fascinating chapters in the history of mathematics, an extended discussion would be out of place here. It is worth remarking, however, that the first 12 Mersenne primes (hence, 12 perfect numbers) have been known since 1914. The 11th in order of discovery, namely, M 89, was the last Mersenne prime disclosed by hand calculation; its primality was verified by both Powers and Cunningham in 1911, working independently and using different techniques. The prime M127 was found by Lucas in 1876 and for the next 75 years was the largest number actually known to be a prime. Calculations whose mere size and tedium repel the mathematician are just grist for the mill of electronic computers. Starting in 1952, 22 additional Mersenne primes (all huge) have come to light. The 25th Mersenne prime, M21701, was discovered in 1978 by two 18-year-old high school students, Laura Nickel and Curt Noll, using 440 hours on a large computer. A few months later, Noll confirmed that M23209 is also prime. With the advent of much faster computers, even this record prime did not stand for long. During the last 10 years, a flurry of computer activity confirmed the primality of eight more Mersenne numbers, each in tum becoming the largest number currently known to be prime. (In the never-ending pursuit of bigger and bigger primes, the record holder has usually been a Mersenne number.) Forty -six Mersenne primes have been identified. The larger of a pair more recently discovered is M43112609. discovered in 2008. It has 12978189 decimal digits, nearly three million more than the previous largest known prime, the 9808358-digit M325826s7. The two-year search for M43112609 used the spare time of several hundred thousand volunteers and their computers, each assigned a different set of candidates to test for primality. The newest champion prime gave rise to the 41 st even perfect number p45 = 243112608(243112609 _ l) an immense number of 25956377 digits. It is not likely that every prime in the vast expanse p < 43112609 has been tested to see if MP is prime. One should be wary, for in 1989 a systematic computer search found the overlooked Mersenne prime Muos03 lurking between M86243 and 232 ELEMENTARY NUMBER THEORY M216091. What is more probable is that enthusiasts with the time and inclination will forge on through higher values to new records. An algorithm frequently used for testing the primality of MP is the Lucas-Lehmer test. It relies on the inductively defined sequence k > 1 Thus, the sequence begins with the values 4, 14, 194, 37634, .... The basic theorem, as perfected by Derrick Lehmer in 1930 from the pioneering results of Lucas, is this: For p > 2, Mp is prime if and only if Sp-l = 0 (mod Mp). An equivalent formulation is that MP is prime if and only if Sp_2 = ±2(p+l)/2 (mod Mp). A simple example is provided by the Mersenne number M7 = 27 - 1 = 127. Working modulo 127, the computation runs as follows: S2 - 14 Ss - -16 This establishes that M7 is prime. The largest of the numbers on Mersenne's \"original\" list, the 78-digit M2s7, was found to be composite in 1930 when Lehmer succeeded in showing that S2s6 ¥= 0 (mod 257); this arithmetic achievement was announced in print in 1930, although no factor of the number was known. In 1952, the National Bureau of Stan­ dards Western Automatic Computer (SWAC) confirmed Lehmer's efforts of 20 years earlier. The electronic computer accomplished in 68 seconds what had taken Lehmer over 700 hours using a calculating machine. The smallest prime factor of M257, namely, 535006138814359 was obtained in 1979 and the remaining two factors exhibited in 1980, 50 years after the composite nature of the number had been revealed. We have listed in the section of Tables the 47 Mersenne primes known so far, with the number of digits in each and its approximate date of discovery. Most mathematicians believe that there are infinitely many Mersenne primes, but a proof of this seems hopelessly beyond reach. Known Mersenne primes MP clearly become more scarce as p increases. It has been conjectured that about two primes MP should be expected for all primes p in an interval x < p < 2x ; the numerical evidence tends to support this. One of the celebrated problems of number theory is whether there exist any odd perfect numbers. Although no odd perfect number has been produced thus far, nonetheless, it is possible to find certain conditions for the existence of odd perfect numbers. The oldest of these we owe to Euler, who proved that if n is an odd perfect number, then n = pa q�/31 q�/32 ... q;f3r where p, q1, ... , q, are distinct odd primes and p =a = 1 (mod 4). In 1937, Steuerwald showed that not all f3i 's can be equal to 1; that is, if n = paqf qi··· q; is an odd number with p =a = 1 (mod 4), then n is not perfect. Four years later, Kanold established that not all f3i 's can be equal to 2, nor is it possible to have one f3i NUMBERS OF SPECIAL FORM 233 equal to 2 and all the others equal to 1. The last few years have seen further progress: Hagis and McDaniel (1972) found that it is impossible to have f3i = 3 for all i. With these comments out of the way, let us prove Euler's result . Theorem 11.7 Euler. If n is an odd perfect number, then k 2· n _ p I p }2 p2j, - 1 2 · · · r where the Pi 's are distinct odd primes and P1 = ki = 1 (mod 4). Proof. Let n = p�' p� 2 • • • p;' be the prime factorization of n. Because n is perfect, we can write 2n = a(n) = a(p�' )a(p� 2 ) • •• a(p;') Being an odd integer, either n = 1 (mod 4) or n = 3 (mod 4 ); in any event, 2n = 2 (mod 4). Thus, a(n) = 2n is divisible by 2, but not by 4. The implication is that one of the a (p;; ), say a (p�' ), must be an even integer (but not divisible by 4 ), and all the remaining a (p;; )'s are odd integers. For a given Pi, there are two cases to be considered: Pi = 1 (mod 4) and Pi = 3 (mod 4). If Pi = 3 = -1 (mod 4), we would have a(p;i) = 1 +Pi +pf+ ... + p;i = 1 + ( -1) + ( -1 )2 + · · · + ( -1 )k; (mod 4) = {O (mod4) - 1 (mod4) if ki is odd if ki is even Because a(p�') = 2 (mod 4), this tells us that Pl ¢. 3 (mod 4) or, to put it affirma­ tively, p1 = 1(mod4). Furthermore, the congruence a(p;;) = 0 (mod 4) signifies that 4 divides a(p�1), which is not possible. The conclusion: if Pi = 3 (mod 4), where i = 2, ... , r, then its exponent ki is an even integer. Should it happen that Pi = 1 (mod 4)-which is certainly true for i = I-then a (p�i) = 1 + Pi + pf + · · · + p;; = 1 + 11 + 12 + · · · + 1 k; (mod 4) = ki + 1 (mod 4) The condition a(p�1) = 2 (mod 4) forces k1 = 1 (mod 4). For the other values of i, we know that a(p�;) = 1or3 (mod 4), and therefore ki = 0 or 2 (mod 4); in any case, ki is an even integer. The crucial point is that, regardless of whether Pi - 1 (mod 4) or Pi = 3 (mod 4 ), ki is always even for i =J. 1. Our proof is now complete. In view of the preceding theorem , any odd perfect number n can be expressed as k 2. 2. n _ p Ip }2 p }r - 1 2 · · · r k . . _ p I (p}2 p}r)2 - 1 2 · · · r = p�Im2 This leads directly to the following corollary. 234 ELEMENTARY NUMBER THEORY Corollary. If n is an odd perfect number, then n is of the form n = pkm2 where pis a prime, p l m, and p = k = 1(mod4); in particular, n = 1(mod4). Proof. The last assertion is the only non-obvious one. Because p = 1 (mod 4), we have pk = 1 (mod 4). Notice that m must be odd; hence, m = 1 or 3 (mod 4), and therefore upon squaring, m2 = 1 (mod 4). It follows that n = pkm2 = 1 · 1 = 1 (mod 4) establishing our corollary. Another line of investigation involves estimating the size of an odd perfect number n. The classical lower bound was obtained by Turcaninov in 1908: n has at least four distinct prime factors and exceeds 2 · 106. With the advent of electronic computers, the lower bound has been improved to n > 10300. Recent investigations have shown that n must be divisible by at least nine distinct primes, the largest of which is greater than 108, and the next largest exceeds 104; if 3 l n, then the number of distinct prime factors of n is at least 12. Although all of this lends support to the belief that there are no odd perfect numbers, only a proof of their nonexistence would be conclusive. We would then be in the curious position of having built up a whole theory for a class of numbers that did not exist. \"It must always,\" wrote the mathematician Joseph Sylvester in 1888, \"stand to the credit of the Greek geometers that they succeeded in discovering a class of perfect numbers which in all probability are the only numbers which are perfect.\" Another numerical concept, with a history extending from the early Greeks, is amicability. Two numbers such as 220 and 284 are called amicable, or friendly, because they have the remarkable property that each number is \"contained\" within the other, in the sense that each number is equal to the sum of all the positive divisors of the other, not counting the number itself. Thus, as regards the divisors of 220, 1 + 2 + 4 + 5 + 10 + 11 + 20 + 22 + 44 + 55 + 110 = 284 and for 284, 1 + 2 + 4 + 71 + 142 = 220 In terms of the a function, amicable numbers m and n (or an amicable pair) are defined by the equations a (m) - m = n or what amounts to the same thing: a (n) - n = m a(m) = m + n = a (n) Down through their quaint history, amicable numbers have been important in magic and astrology, and in casting horoscopes, making talismans, and concocting NUMBERS OF SPECIAL FORM 235 love potions. The Greeks believed that these numbers had a particular influence in establishing friendships between individuals. The philosopher Iamblichus of Chalcis (ca. A.D. 250-A.D. 330) ascribed a know ledge of the pair 220 and 284 to the Pythagore­ ans. He wrote: They [the Pythagoreans] call certain numbers amicable numbers, adopting virtues and social qualities to numbers, as 284 and 220; for the parts of each have the power to generate the other .... Biblical commentators spotted 220, the lesser of the classical pair, in Genesis 32: 14 as numbering Jacob's present to Esau of 200 she-goats and 20 he-goats. According to one commentator, Jacob wisely counted out his gift (a \"hidden secret arrangement \") to secure the friendship of Esau. An Arab of the 11th century, El Madschriti of Madrid, related that he had put to the test the erotic effect of these numbers by giving someone a confection in the shape of the smaller number, 220, to eat, while he himself ate the larger, 284. He failed, however, to describe whatever success the ceremony brought. It is a mark of the slow development of number theory that until the 1630s no one had been able to add to the original pair of amicable numbers discovered by the Greeks. The first explicit rule described for finding certain types of amicable pairs is due to Thabit ibn Qurra, an Arabian mathematician of the 9th century. In a manuscript composed at that time, he indicated: If the three numbers p = 3 · 2n-l - 1, q = 3 · 2n - 1, and r = 9 · 22n-l - 1 are all prime and n :'.:'.: 2, then 2n pq and 2n r are amicable numbers. It was not until its rediscovery centuries later by Fermat and Descartes that Thabit's rule produced the second and third pairs of amicable numbers. In a letter to Mersenne in 1636, Fermat announced that 17,296 and 18,416 were an amicable pair, and Descartes wrote to Mersenne in 1638 that he had found the pair 9363584 and 9437056. Fermat's pair resulted from taking n = 4 in Thabit's rule (p = 23, q = 47, r = 1151 are all prime) and Descartes' from n = 7 (p = 191, q = 383, r = 73727 are all prime). In the 1700s, Euler drew up at one clip a list of 64 amicable pairs; two of these new pairs were later found to be \"unfriendly,\" one in 1909 and one in 1914. Adrien Marie Legendre, in 1830, found another pair, 2172649216 and 2181168896. Extensive computer searches have currently revealed more than 50000 amicable pairs, some of them running to 320 digits; these include all those with values less than 10 11. It has not yet been established whether the number of amicable pairs is finite or infinite, nor has a pair been produced in which the numbers are relatively prime. What has been proved is that each integer in a pair of relatively prime amicable numbers must be greater than 1025, and their product must be divisible by at least 22 distinct primes. Part of the difficulty is that in contrast with the single formula for generating (even) perfect numbers, there is no known rule for finding all amicable pairs of numbers. 236 ELEMENTARY NUMBER THEORY Another inaccessible question, already considered by Euler, is whether there are amicable pairs of opposite parity-that is, with one integer even and the other odd. \"Most\" amicable pairs in which both members of the pair are even have their sums divisible by 9. A simple example is 220 + 284 = 504 _ 0 (mod 9). The small­ est known even amicable pair whose sum fails to enjoy this feature is 666030256 and 696630544. PROBLEMS 11.3 1. Prove that the Mersenne number M13 is a prime; hence, the integer n = 212 (2 13 - 1) is perfect. [Hint: Because ,./Ml3 < 91, Theorem 11.5 implies that the only candidates for prime divisors of Ml3 are 53 and 79.] 2. Prove that the Mersenne number M19 is a prime; hence, the integer n = 218 (219 - 1) is perfect. [Hint: By Theorems 11.5 and 11.6, the only prime divisors to test are 191, 457, and 647.] 3. Prove that the Mersenne number M29 is composite. 4. A positive integer n is said to be a deficient number if O' (n) < 2n and an abundant number if O' (n) > 2n. Prove each of the following: (a) There are infinitely many deficient numbers. [Hint: Consider the integers n = pk, where p is an odd prime and k 2: l.] (b) There are infinitely many even abundant numbers. [Hint: Consider the integers n = 2k · 3, where k > l.] ( c) There are infinitely many odd abundant numbers. [Hint: Consider the integers n = 945 · k, where k is any positive integer not divisible by 2, 3, 5, or 7. Because 945 = 33 · 5 · 7, it follows that gcd(945, k) = 1 and so O'(n) = 0'(945)0'(k).] 5. Assuming that n is an even perfect number and d In, where 1 < d < n, show that dis deficient. 6. Prove that any multiple of a perfect number is abundant. 7. Confirm that the pairs of integers listed below are amicable: (a) 220 = 22 · 5 · 11 and 284 = 22 • 71. (Pythagoras, 500 B.C.) (b) 17296 = 2 4 · 23 · 47 and 18416 = 24 · 1151. (Fermat, 1636) (c) 9363584 = 27 · 191 · 383 and 9437056 = 27 · 73727. (Descartes, 1638) 8. For a pair of amicable numbers m and n, prove that (I: 11d) - 1 + (I: 11d) - 1 = 1 d Im din 9. Establish the following statements concerning amicable numbers: (a) A prime number cannot be one of an amicable pair. (b) The larger integer in any amicable pair is a deficient number. ( c) If m and n are an amicable pair, with m even and n odd, then n is a perfect square. [Hint: If p is an odd prime, then 1 + p + p2 +···+pk is odd only when k is an even integer.] 10. In 1886, a 16-year-old Italian boy announced that 1184 = 25 · 37 and 1210 = 2 · 5 · 112 form an amicable pair of numbers, but gave no indication of the method of discovery. Verify his assertion. NUMBERS OF SPECIAL FORM 237 11. Prove \"Thabit's rule\" for amicable pairs: If p = 3 · 2n-l - 1, q = 3 · 2n - 1, and r = 9 · 22n-l - 1 are all prime numbers, where n ::::: 2, then 2n pq and 2n r are an amicable pair of numbers. This rule produces amicable numbers for n = 2, 4, and 7, but for no other n ::::; 20,000. 12. By an amicable triple of numbers is meant three integers such that the sum of any two is equal to the sum of the divisors of the remaining integer, excluding the number itself. Verify that 25 · 3 · 13 · 293 · 337, 25 · 3 · 5 · 13 · 16561, and 25 · 3 · 13 · 99371 are an amicable triple. 13. A finite sequence of positive integers is said to be a sociable chain if each is the sum of the positive divisors of the preceding integer, excluding the number itself (the last integer is considered as preceding the first integer in the chain). Show that the following integers form a sociable chain: 14288, 15472, 14536, 14264, 12496 Only two sociable chains were known until 1970, when nine chains of four integers each were found. 14. Prove that (a) Any odd perfect number n can be represented in the form n = pa 2, where p is a pnme. (b) If n = pa2 is an odd perfect number, then n = p (mod 8). 15. If n is an odd perfect number, prove that n has at least three distinct prime factors. [Hint: Assume that n = pkq2j, where p = k = 1 (mod 4). Use the inequality 2 = a(n)/ n ::::; [p /( p - l)][q /(q - l)] to reach a contradiction.] 16. If the integer n > 1 is a product of distinct Mersenne primes, show that a(n) = 2 k for some k. 11.4 FERMAT NUMBERS To round out the picture, let us mention another class of numbers that provides a rich source of conjectures, the Fermat numbers. These may be considered as a special case of the integers of the form 2m + 1. We observe that if 2m + 1 is an odd prime, then m = 2n for some n > 0. Assume to the contrary that m had an odd divisor 2k + 1 > 1, say m = (2k + l)r; then 2m + 1 would admit the nontrivial factorization 2m + 1 = 2(2k+l)r + 1 = (2r)2k+l + 1 = (2r + l)(22kr _ 2(2k-l)r + ... + 22r _ 2r + 1) which is impossible. In brief, 2m + 1 can be prime only if m is a power of 2. Definition 11.2. A Fermat number is an integer of the form 2n Fn = 2 + 1 n '.:::: 0 If Fn is prime, it is said to be a Fermat prime. Fermat, whose mathematical intuition was usually reliable, observed that all the integers Fo = 3 F4 = 65537 238 ELEMENTARY NUMBER THEORY are primes and expressed his belief that Fn is prime for each value of n. In writing to Mersenne, he confidently announced: \"I have found that numbers of the form 2 2n + 1 are always prime numbers and have long since signified to analysts the truth of this theorem.\" However, Fermat bemoaned his inability to come up with a proof and, in subsequent letters, his tone of growing exasperation suggests that he was continually trying to do so. The question was resolved negatively by Euler in 1732 when he found F5 = 2 25 + 1 = 4294967297 to be divisible by 641. To us, such a number does not seem very large; but in Fermat's time, the investigation of its primality was difficult, and obviously he did not carry it out. The following elementary proof that 641 I F5 does not explicitly involve division and is due to G. Bennett. Theorem 11.8. The Fermat number F5 is divisible by 641. Proof. We begin by putting a = 27 and b = 5, so that 1 +ab= 1 + 27 • 5 = 641 It is easily seen that 1 +ab - b4 = 1 +(a - b3)b = 1+3b = 24 But this implies that Fs = 225 + 1 = 232 + 1 = 24a4 + 1 = (1 + ab - b4)a4 + 1 = (1 + ab)a4 + (1 - a4b4) = (1 + ab)[a4 + (1 - ab)(l + a2b2)] which gives 641 I Fn. To this day it is not known whether there are infinitely many Fermat primes or, for that matter, whether there is at least one Fermat prime beyond F4. The best \"guess \" is that all Fermat numbers Fn > F4 are composite. Part of the interest in Fermat primes stems from the discovery that they have a remarkable connection with the ancient problem of determining all regular polygons that can be constructed with ruler and compass alone (where the former is used only to draw straight lines and the latter only to draw arcs). In the seventh and last section of the Disquisitiones Arithmeticae, Gauss proved that a regular polygon of n sides is so constructible if and only if either n = 2k or n = 2k P1P2 ···Pr where k > 0 and Pl, pz, ... , Pr are distinct Fermat primes. The construction of regular polygons of 2k, 2k · 3, 2k · 5 and 2k · 15 sides had been known since the time of the Greek geometers. In particular, they could construct regular n-sided polygons NUMBERS OF SPECIAL FORM 239 for n = 3, 4, 5, 6, 8, 10, 12, 15, and 16. What no one suspected before Gauss was that a regular 17-sided polygon can also be constructed by ruler and compass. Gauss was so proud of his discovery that he requested that a regular polygon of 17 sides be engraved on his tombstone; for some reason, this wish was never fulfilled, but such a polygon is inscribed on the side of a monument to Gauss erected in Brunswick, Germany, his birthplace. A useful property of Fermat numbers is that they are relatively prime to each other. Theorem 11.9. For Fermat numbers Fn and Fm, where m > n 2: 0, gcd(Fm, Fn) = 1. Proof. Put d = gcd(Fm, Fn). Because Fermat numbers are odd integers, d must be odd. If we set x = 22n and k = 2m-n, then Fm - 2 (22n)zm-n - 1 Fn 22n + 1 xk - 1 k-1 k-2 -- =x -x +··· -1 x+l whence Fn I (Fm - 2). From d I Fn, it follows that d I (Fm - 2). Now use the fact that d I Fm to obtain d 12. But d is an odd integer, and sod = 1, establishing the result claimed. This leads to a pleasant little proof of the infinitude of primes. We know that each of the Fermat numbers F0, F1, ... , Fn is divisible by a prime that, according to Theorem 11. 9, does not divide any of the other Fk. Thus, there are at least n + 1 distinct primes not exceeding Fn. Because there are infinitely many Fermat numbers, the number of primes is also infinite. In 1877, the Jesuit priest T. Pepin devised the practical test (Pepin's test) for determining the primality of Fn that is embodied in the following theorem. Theorem 11.10 Pepin's test. For n 2: 1, the Fermat number Fn = 22n + 1 is prime if and only if Proof. First let us assume that 3(Fn-l)/2 = -1 (mod Fn) Upon squaring both sides, we get 3Fn-l = 1 (mod Fn) The same congruence holds for any prime p that divides Fn: 3Fn-I = 1 (mod p) Now let k be the order of 3 modulo p. Theorem 8.1 indicates that k I Fn - 1, or in other words, that k I 22\" ; therefore k must be a power of 2. NUMBERS OF SPECIAL FORM 241 66 years, until 1971, before Brillhart and Morrison discovered the prime factorization F1 = 2128 + 1 =59649589127497217·5704689200685129054721 (The possibility of arriving at such a factorization without recourse to fast computers with large memories is remote.) Morehead and Western carried out (in 1909) a similar calculation for the compositeness of F8, each doing half the work; but the actual factors were not found until 1980, when Brent and Pollard showed the smallest prime divisor of F8 to be 1238926361552897 The other factor of F8 is 62 digits long and shortly afterward was shown to be prime. A large Fn to which Pepin's test has been applied is F14, a number of 4933 digits; this Fermat number was determined to be composite by Selfridge and Hurwitz in 1963, although at present no divisor is known. Our final theorem, due to Euler and Lucas, is a valuable aid in determining the divisors of Fermat numbers. As early as 1747, Euler established that every prime factor of Fn must be of the formk · 2 n+l + 1. Over lOOyears later, in 1879, the French number theorist Edouard Lucas improved upon this result by showing that k can be taken to be even. From this, we have the following theorem. Theorem 11.11. Any prime divisor p of the Fermat number Fn = 22\" + 1, where n :'.'.: 2, is of the form p = k · 2n+2 + 1. Proof. For a prime divisor p of Fn, 22\" = -1 (modp) which is to say, upon squaring, that 2n+I 2 =l(mod p) If h is the order of 2 modulo p, this congruence tells us that h 12n+l We cannot have h = 2r where 1 :S r :S n, for this would lead to 22\" = 1 (mod p) and, in tum, to the contradiction that p = 2. This lets us conclude that h = 2n+1. Because the order of 2 modulo p divides ¢(p) = p - 1, we may further conclude that 2n+l Ip - 1. The point is that for n :::=:: 2, p = 1 (mod 8), and therefore, by Theorem 9.6, the Legendre symbol (2/p) = 1. Using Euler's criterion, we immediately pass to i<p-l)/2 = (2/ p) = 1 (mod p) An appeal to Theorem 8.1 finishes the proof. It asserts that h I (p - 1) /2, or equivalently, 2n+l I (p - 1)/2. This forces 2n+21 p - 1, and we obtain p = k · 2n+2 + 1 for some integer k. 242 ELEMENTARY NUMBER THEORY Theorem 11.11 enables us to determine quickly the nature of F4 = 216 + 1 = 65537. The prime divisors of F4 must take the form 26k + 1 = 64k + 1. There is only one prime of this kind that is less than or equal to JF4, namely, the prime 193. Because this trial divisor fails to be a factor of F4, we may conclude that F4 is itself apnme. The increasing power and availability of computing equipment has allowed the search for prime factors of the Fermat numbers to be extended significantly. For example, the first prime factor of F28 was found in 1997. It is now known that Fn is composite for 5 < n < 30 and for some 140 additional values of n. The largest composite Fermat number found to date is F303088, with divisor 3 · 2303093 + 1. The complete prime factorization of Fn has been obtained for 5 < n � 11 and no other n. After the factorization of F8, it was little suspected that Fu, 629 digits long, would be the next Fermat number to be completely factored; but this was carried out by Brent and Morain in 1988. The factorization of the 155-digit F9 by the joint efforts of Lenstra, Manasse, and Pollard in 1990 was noteworthy for having employ ed approximately 700 workstations at various locations around the world. The complete factorization took about 4 months. Not long thereafter (1996), Brent determined the remaining two prime factors of the 310-digit F10. The reason for arriving at the factorization of Fu before that of F9 and F10 was that size of the second-largest prime factor of F11 made the calculations much easier. The second­ largest prime factor of Fu contains 22 digits, whereas those of F9 and F10 have lengths of 49 and 40 digits, respectively. The enormous F31, with a decimal expansion of over 600 million digits, was proved to be composite in 2001. It was computationally fortunate that F31 had a prime factor of only 23 digits. For F33, the challenge remains: it is the smallest Fermat number whose character is in doubt. Considering that F33 has more than two trillion digits, the matter may not be settled for some time. A resume of the current primality status for the Fermat numbers Fn, where 0 � n � 35, is given below. n 0, 1, 2, 3, 4 5, 6, 7, 8, 9, 10, 11 12, 13, 15, 16, 18, 19,25,27,30 17,21,23,26,28,29,31,32 14,20,22,24 33,34 ,35 Character of F n prime completely factored two or more prime factors known only one prime factor known composite, but no factor known character unknown The case for F16 was settled in 1953 and lay s to rest the tantalizing conjecture that all the terms of the sequence 2 1 22 1 222 + 1, + ' + ' are prime numbers. What is interesting is that none of the known prime factors p of a Fermat number Fn gives rise to a square factor p 2; indeed, it is speculated that the NUMBERS OF SPECIAL FORM 243 Fermat numbers are square-free. This is in contrast to the Mersenne numbers where, for example, 9 divides M6n· Numbers of the form k · 2n + 1, which occur in the search for prime factors of Fermat numbers, are of considerable interest in their own right. The smallest n for which k · 2n + 1 is prime may be quite large in some cases; for instance, the first time 47 · 2n + 1 is prime is when n = 583. But there also exist values of k such that k · 2n + 1 is always composite. Indeed, in 1960 it was proved that there exist infinitely many odd integers k with k · 2n + 1 composite for all n � 1. The problem of determining the least such value of k remains unsolved. Up to now, k = 78557 is the smallest known k for which k · 2n + 1 is never prime for any n. PROBLEMS 11.4 1. By takingfourth powers of the congruence5 · 27 = -1 (mod641),deduce that 232+1 = 0 (mod 641); hence, 6411 F5. 2. Gauss (1796) discovered that a regular polygon with p sides, where p is a prime, can be constructed with ruler and compass if and only if p - 1 is a power of 2. Show that this condition is equivalent to requiring that p be a Fermat prime. 3. For n > 0, prove the following: (a) There are infinitely many composite numbers of the form 2 2n + 3. [Hint: Use the fact that 22n = 3k + 1 for some k to establish that 71222\"+1 + 3.] (b) Each of the numbers 22\" + 5 is composite. 4. Composite integers n for which n 12n - 2 are called pseudoprimes. Show that every Fermat number Fn is either a prime or a pseudoprime. [Hint: Raise the congruence 22\" = -1 (mod Fn) to the 22\"-n power.] 5. For n :=::: 2, show that the last digit of the Fermat number Fn = 2 2n + 1 is 7. [Hint: By induction on n, verify that 22n = 6 (mod 10) for n :'.'.:: 2.] 6. Establish that 22n - 1 has at least n distinct prime divisors. [Hint: Use induction on n and the fact that 22\" - 1 = (2 2n-1 + 1)(22n-1 - l).] 7. In 1869 , Landry wrote: \"No one of our numerous factorizations of the numbers 2n ± 1 gave us as much trouble and labor as that of 258 + 1.\" Verify that 258 + 1 can be factored rather easily using the identity 4x4 + 1 = (2x2 - 2x + 1)(2x2 + 2x + 1) 8. From Problem 5, conclude the following: (a) The Fermat number Fn is never a perfect square. (b) For n > 0, Fn is never a triangular number. 9. (a) For any odd integer n, show that 3 12n + 1. (b) Prove that if p and q are both odd primes and q I 2P + 1, then either q = 3 or q = 2kp + 1 for some integer k. [Hint: Because 22P = 1 (mod q ), the order of 2 modulo q is either 2 or 2p; in the latter case, 2p I </>(q).] (c) Find the smallest prime divisor q > 3 of each of the integers 229 + 1 and 241 + I. 244 ELEMENTARY NUMBER THEORY 10. Determine the smallest odd integer n > 1 such that 2n - 1 is divisible by a pair of twin primes p and q, where 3 < p < q. [Hint: Being the first member of a pair of twin primes, p = -1 (mod 6). Because (2/ p) = (2/ q) = 1, Theorem 9 .6 gives p = q = ± 1 (mod 8); hence, p = -1 (mod 24) and q = 1 (mod 24). Now use the fact that the orders of 2 modulo p and q must divide n.] 11. Find all prime numbers p such that p divides 2P + 1; do the same for 2P - 1. 12. Let p = 3 · 2n + 1 be a prime, where n � 1. (Twenty-nine primes of this form are cur­ rently known, the smallest occurring when n = 1 and the largest when n = 3030 93.) Prove each of the following assertions: (a) The order of 2 modulo pis either 3, 2k or 3 · 2k for some 0 :::=: k :::=: n. (b) Except when p = 13, 2 is not a primitive root of p. [Hint: If 2 is a primitive root of p, then (2/ p) = -1.] ( c) The order of 2 modulo p is not divisible by 3 if and only if p divides a Fermat number Fk with 0 :::=: k :::=: n - 1. [Hint: Use the identity 22k - 1 = FoF1F2 ... Fk-I·] (d) There is no Fermat number that is divisible by 7, 13, or 97. 13. For any Fermat number Fn = 22\" + 1 with n > 0, establish that Fn = 5 or 8 (mod 9) according as n is odd or even. [Hint: Use induction to show, first, that 22\" = 22\"-2 (mod 9) for n � 3.] 14. Use the fact that the prime divisors of F5 are of the form 27k + 1 = 128k + 1 to confirm that 6411 Fs. 15. For any prime p > 3, prove the following: (a) t(2P + 1) is not divisible by 3. [Hint: Consider the identity 2P + 1 -1 -2 -- = 2P - 2P + · · · - 2 + 1.] 2+1 (b) t(2P + 1) has a prime divisor greater than p. [Hint: Problem 9(b).] (c) The integers t C219 + 1) and t(223 + 1) are both prime. 16. From the previous problem, deduce that there are infinitely many prime numbers. 17. (a) Prove that 3, 5, and 7 are quadratic nonresidues of any Fermat prime Fn, wheren � 2. [Hint: Pepin's test and Problem 15, Section 9.3.] (b) Show that every quadratic nonresidue of a Fermat prime Fn is a primitive root of Fn. 18. Establish that any Fermat prime Fn can be written as the difference of two squares, but not of two cubes. [Hint: Notice that Fn = 22\" + 1 = (22\"-1 + 1)2 _ (22n-1 )2 .] 19. For n � 1, show that gcd(Fn, n) = 1. [Hint: Theorem 11.11.] 20. Use Theorems 11.9 and 11.11 to deduce that there are infinitely many primes of the form 4k + 1. CHAPTER 12 CERTAIN NONLINEAR DIOPHANTINE EQUATIONS He who seeks for methods without having a definite problem in mind seeks for the most part in vain. D. HILBERT 12.1 THE EQUATION x2 + y2 = z2 Fermat, whom many regard as a father of modern number theory, nevertheless, had a custom peculiarly ill-suited to this role. He published very little personally, preferring to communicate his discoveries in letters to friends (usually with no more than the terse statement that he possessed a proof) or to keep them to himself in notes. A number of such notes were jotted down in the margin of his copy of Bachet's translation of Diophantus's Arithmetica. By far the most famous of these marginal comments is the one-presumably written about 1637-which states: It is impossible to write a cube as a sum of two cubes, a fourth power as a sum of two fourth powers, and, in general, any power beyond the second as a sum of two similar powers. For this, I have discovered a truly wonderful proof, but the margin is too small to contain it. In this tantalizing aside, Fermat was simply asserting that, if n > 2, then the Dio­ phantine equation 245 246 ELEMENTARY NUMBER THEORY has no solution in the integers, other than the trivial solutions in which at least one of the variables is zero. The quotation just cited has come to be known as Fermat's Last Theorem or, more accurately, Fermat's conjecture. By the 1800s, all the assertions appearing in the margin of his Arithmetic a had either been proved or refuted-with the one exception of the Last Theorem (hence the name). The claim has fascinated many generations of mathematicians, professional and amateur alike, because it is so simple to understand yet so difficult to establish. If Fermat really did have a \"truly wonderful proof,\" it has never come to light. Whatever demonstration he thought he possessed very likely contained a flaw. Indeed, Fermat himself may have subsequently discovered the error, for there is no reference to the proof in his correspondence with other mathematicians. Fermat did, however, leave a proof of his Last Theorem for the case n = 4. To carry through the argument, we first undertake the task of identifying all solutions in the positive integers of the equation x2 + y2 = z2 (1) Because the length z of the hypotenuse of a right triangle is related to the lengths x and y of the sides by the famous Pythagorean equation x2 + y2 = z2, the search for all positive integers that satisfy Eq. (1) is equivalent to the problem of finding all right triangles with sides of integral length. The latter problem was raised in the days of the Babylonians and was a favorite with the ancient Greek geometers. Pythagoras himself has been credited with a formula for infinitely many such triangles, namely, x = 2n + 1 y = 2n2 + 2n z = 2n2 + 2n + 1 where n is an arbitrary positive integer. This formula does not account for all right triangles with integral sides, and it was not until Euclid wrote his Elements that a complete solution to the problem appeared. The following definition gives us a concise way of referring to the solutions of Eq. (1). Definition 12.1. A Pythagorean triple is a set of three integers x, y, z such that x2 + y2 = z2; the triple is said to be primitive if gcd(x, y, z) = 1. Perhaps the best-known examples of primitive Pythagorean triples are 3, 4, 5 and 5, 12, 13, whereas a less obvious one is 12, 35, 37. There are several points that need to be noted. Suppose that x, y, z is any Pythagorean triple and d = gcd(x, y, z). If we write x = dx1, y = dy1, z = dz1, then it is easily seen that 2 2 x2 + Y2 z2 2 x 1 + y 1 = d2 = d2 = z 1 with gcd(x1. y1, z1) = 1. In short, x1, y1, z1 form a primitive Pythagorean triple. Thus, it is enough to occupy ourselves with finding all primitive Pythagorean triples; any Pythagorean triple can be obtained from a primitive one upon multiplying by a suitable nonzero integer. The search may be confined to those primitive Pythagorean CERTAIN NONLINEAR DIOPHANTINE EQUATIONS 247 triples x, y, z in which x > 0, y > 0, z > 0, inasmuch as all others arise from the positive ones through a simple change of sign. Our development requires two preparatory lemmas, the first of which sets forth a basic fact regarding primitive Pythagorean triples. Lemma 1. If x, y, z is a primitive Pythagorean triple, then one of the integers x or y is even, while the other is odd. Proof. If x and y are both even, then 21 (x2 + y2) or 21 z2, so that 21 z. The inference is that gcd(x, y, z) :=::: 2, which we know to be false. If, on the other hand, x and y should both be odd, then x 2 = 1 (mod4) and y2 = 1 (mod4), leading to z2 = x2 + y2 = 2 (mod 4) But this is equally impossible, because the square of any integer must be congruent either to 0 or to 1 modulo 4. Given a primitive Pythagorean triple x, y, z, exactly one of these integers is even, the other two being odd (if x, y, z were all odd, then x2 + y2 would be even, whereas z2 is odd). The foregoing lemma indicates that the even integer is either x or y; to be definite, we shall hereafter write our Pythagorean triples so that xis even and y is odd; then, of course, z is odd. It is worth noticing (and we will use this fact) that each pair of the integers x, y, and z must be relatively prime. Were it the case that gcd(x, y) = d > 1, then there would exist a prime p with p I d. Because d I x and d I y, we would have p I x and p I y, whence p I x2 and p I y2. But then p I (x2 + y2), or p I z2 , giving p I z. This would conflict with the assumption that gcd(x, y, z) = 1, and so d = 1. In like manner, one can verify that gcd(y, z) = gcd(x, z) = 1. By virtue of Lemma 1, there exists no primitive Pythagorean triple x, y, z all of whose values are prime numbers. There are primitive Pythagorean triples in which z and one of x or y is a prime; for instance, 3, 4, 5; 11, 60, 61; and 19, 180, 181. It is unknown whether there exist infinitely many such triples. The next hurdle that stands in our way is to establish that if a and b are relatively prime positive integers having a square as their product, then a and b are themselves squares. With an assist from the Fundamental Theorem of Arithmetic, we can prove considerably more, to wit, Lemma 2. Lemma 2. If ab= en, where gcd(a, b) = 1, then a and b are nth powers; that is, there exist positive integers a1, b1 for which a = a}, b = b}. Proof. There is no harm in assuming that a > 1 and b > 1. If are the prime factorizations of a and b, then, bearing in mind that gcd(a, b) = 1, no Pi can occur among the q;. As a result, the prime factorization of ab is given by 248 ELEMENTARY NUMBER THEORY Let us suppose that c can be factored into primes as c = ui 1 u� · · · u�'. Then the condition ab = en becomes k1 k, ji j, nl1 nl, Pi ···Pr ql · · · qs = Ul · · · Ut From this we see that the primes u1, ... , Ut are p1, ... , Pr· qi, ... , qs (in some order) and nl1, ... , nlt are the corresponding exponents ki, ... , kr, ji, ... , js. The conclu- sion: each of the integers k; and ji must be divisible by n. If we now put kifn k2/n k,/n ai = P1 P2 ···Pr b ji/n jz/n j,/n 1 = ql q2 · · · qs then a! =a, b! = b, as desired. With the routine work now out of the way, the characterization of all primitive Pythagorean triples is fairly straightforward. Theorem 12.1. All the solutions of the Pythagorean equation x2 + y2 = z2 satisfying the conditions gcd(x, y, z) = 1 21x x > 0, y > 0, z > 0 are given by the formulas x = 2st y = s2 - t2 z = s2 + t2 for integers s > t > 0 such that gcd(s, t) = 1 and s ¢. t (mod 2). Proof. To start, let x, y, z be a (positive) primitive Pythagorean triple. Because we have agreed to take x even, and y and z both odd, z - y and z + y are even integers; say, z - y = 2u and z + y = 2v. Now the equation x2 + y2 = z2 may be rewritten as x2 = z2 - Y2 = (z - y)(z + y) whence Notice that u and v are relatively prime; indeed, if gcd(u, v) = d > 1, then d I (u - v) andd I (u + v), or equivalently,d I y andd I z, which violates thefact that gcd(y, z) = 1. Taking Lemma 2 into consideration, we may conclude that u and v are each perfect squares; to be specific, let u = t2 v = s2 where s and t are positive integers. The result of substituting these values of u and v reads z = v + u = s2 + t2 y = v - u = s2 - t2 x2 = 4vu = 4s2t2 CERTAIN NONLINEAR DIOPHANTINE EQUATIONS 249 or, in the last case x = 2st. Because a common factor of s and t divides both y and z, the condition gcd(y, z) = 1 forces gcd(s, t) = 1. It remains for us to observe that ifs and t were both even, or both odd, then this would make each of y and z even, which is an impossibility. Hence, exactly one of the pair s, t is even, and the other is odd; in symbols, s ¢. t (mod 2). Conversely, let s and t be two integers subject to the conditions described before. That x = 2st, y = s2 - t2, z = s2 + t2 form a Pythagorean triple follows from the easily verified identity x 2 + y2 = (2st)2 + (s2 - t2) 2 = (s2 + t2 )2 = z 2 To see that this triple is primitive, we assume that gcd(x, y, z) = d > 1 and take p to be any prime divisor of d. Observe that p =j:. 2, because p divides the odd integer z (one of s and tis odd, and the other is even, hence, s2 + t2 = z must be odd). From p I y and p I z, we obtain p I (z + y) and p I (z - y ), or put otherwise, p I 2s2 and p I 2t2. But then p Is and p It, which is incompatible with gcd(s, t) = 1. The implication of all this is that d = 1 and so x, y, z constitutes a primitive Pythagorean triple. Theorem 12.1 is thus proven. The table below lists some primitive Pythagorean triples arising from small values of s and t. For each value of s = 2, 3, ... , 7, we have taken those values oft that are relatively prime to s, less than s, and even whenever s is odd. x y z s t (2st) (s2 - t2) (s2 + t2) 2 1 4 3 5 3 2 12 5 13 4 1 8 15 17 4 3 24 7 25 5 2 20 21 29 5 4 40 9 41 6 1 12 35 37 6 5 60 11 61 7 2 28 45 53 7 4 56 33 65 7 6 84 13 85 From this, or from a more extensive table, the reader might be led to suspect that if x, y, z is a primitive Pythagorean triple, then exactly one of the integers x or y is divisible by 3. This is, in fact, the case. For, by Theorem 12.1, we have x = 2st y = s2 - t2 z = s2 + t2 where gcd(s, t) = 1. If either 31s or31 t, then evidently 31 x, and we need go no further. Suppose that 3 )' s and 3 )' t. Fermat's theorem asserts that s2 = 1(mod3) t2 = 1(mod3) 250 ELEMENTARY NUMBER THEORY and so y = s2 - t2 = 0 (mod 3) In other words, y is divisible by 3, which is what we were required to show. Let us define a Pythagorean triangle to be a right triangle whose sides are of integral length. Our findings lead to an interesting geometric fact concerning Pythagorean triangles, recorded as Theorem 12.2. Theorem 12.2. The radius of the inscribed circle of a Pythagorean triangle is always an integer. Proof. Let r denote the radius of the circle inscribed in a right triangle with hypotenuse of length z and sides of lengths x and y. The area of the triangle is equal to the sum of the areas of the three triangles having common vertex at the center of the circle; hence, 1 1 1 1 1 -xy = -rx + -ry + -rz = - r (x + y + z) 2 2 2 2 2 The situation is illustrated below: y Now x2 + y2 = z2• But we know that the positive integral solutions of this equation are given by x = 2kst for an appropriate choice of positive integers k, s, t. Replacing x, y, z in the equation xy = r(x + y + z) by these values and solving for r, it will be found that 2k2st(s2 - t2) r = --------- k(2st + s2 - t2 + s2 + t2) kt(s2 - t2) s+t = kt(s - t) which is an integer. We take the opportunity to mention another result relating to Pythagorean tri­ angles. Notice that it is possible for different Pythagorean triangles to have the same area; for instance, the right triangles associated with the primitive Pythagorean triples 20, 21, 29 and 12, 35, 37 each have an area equal to 210. Fermat proved: For any integer n > 1, there exist n Pythagorean triangles with different hypotenuses and the same area. The details of this are omitted. PROBLEMS 12.1 CERTAIN NONLINEAR DIOPHANTINE EQUATIONS 251 1. (a) Find three different Pythagorean triples, not necessarily primitive, of the form 16, y, z. (b) Obtain all primitive Pythagorean triples x, y, z in which x = 40; do the same for x = 60. 2. If x, y, z is a primitive Pythagorean triple, prove that x + y and x - y are congruent modulo 8 to either 1 or 7. 3. (a) Prove that if n ¢ 2 (mod 4), then there is a primitive Pythagorean triple x, y, z in which x or y equals n. (b) If n � 3 is arbitrary, find a Pythagorean triple (not necessarily primitive) having n as one of its members. [Hint: Assuming n is odd, consider the triple n, iCn2 - 1), iCn2 + l); for n even, consider the triple n, (n2 /4) - 1, (n2 /4) + l.] 4. Prove that in a primitive Pythagorean triple x, y, z, the product xy is divisible by 12, hence 60 I xyz. 5. For a given positive integer n, show that there are at least n Pythagorean triples having the same first member. [Hint: Let Yk = 2k(22n-2k - 1) and Zk = 2k(22n-2k + 1) fork= 0, 1, 2, ... , n - 1. Then 2n+i, Yb Zk are all Pythagorean triples.] 6. Verify that 3, 4, 5 is the only primitive Pythagorean triple involving consecutive positive integers. 7. Show that 3n, 4n, 5n where n = 1, 2, ... are the only Pythagorean triples whose terms are in arithmetic progression. [Hint: Call the triple in question x - d, x, x + d, and solve for x in terms of d.] 8. Find all Pythagorean triangles whose areas are equal to their perimeters. [Hint: The equationsx2 + y2 = z2 andx + y + z = ixy imply that(x - 4 )(y - 4) = 8.] 9. (a) Prove that if x, y, z is a primitive Pythagorean triple in which x and z are consecutive positive integers, then x = 2t(t + 1) y = 2t + 1 z = 2t(t + 1) + 1 for some t > 0. [Hint: The equation 1 = z - x = s2 + t2 - 2st implies thats - t = l.] (b) Prove that if x, y, z is a primitive Pythagorean triple in which the difference z - y = 2, then x = 2t y = t2 - 1 z = t2 + 1 for some t > 1. 10. Show that there exist infinitely many primitive Pythagorean triples x, y, z whose even member x is a perfect square. [Hint: Consider the triple 4n2, n4 - 4, n4 + 4, where n is an arbitrary odd integer.] 11. For an arbitrary positive integer n, show that there exists a Pythagorean triangle the radius of whose inscribed circle is n. [Hint: If r denotes the radius of the circle inscribed in the Pythagorean triangle having sides a and band hypotenuse c, then r = iCa + b - c). Now consider the triple 2n + 1, 2n2 + 2n, 2n2 + 2n + l.] 12. (a) Establish that there exist infinitely many primitive Pythagorean triples x, y, z in which x and y are consecutive positive integers. Exhibit five of these. [Hint: If x, x + 1, z forms a Pythagorean triple, then so does the triple 3x + 2z + 1, 3x + 2z + 2, 4x + 3z + 2.] 252 ELEMENTARY NUMBER THEORY (b) Show that there exist infinitely many Pythagorean triples x, y, z in which x and y are consecutive triangular numbers. Exhibit three of these. [Hint: If x, x + 1, z forms a Pythagorean triple, then so does t1x, t1x+1, (2x + l)z.] 13. Use Problem 12 to prove that there exist infinitely many triangular numbers that are perfect squares. Exhibit five such triangular numbers. [Hint: If x, x + 1, z forms a Pythagorean triple, then upon setting u = z - x - 1, v = x + �(1 - z), one obtains u(u + 1)/2 = v2.] 12.2 FERMAT'S LAST THEOREM With our knowledge of Pythagorean triples, we are now prepared to take up the one case in which Fermat himself had a proof of his conjecture, the case n = 4. The technique used in the proof is a form of induction sometimes called \"Fermat's method of infinite descent.\" In brief, the method may be described as follows: It is assumed that a solution of the problem in question is possible in the positive integers. From this solution, one constructs a new solution in smaller positive integers, which then leads to a still smaller solution, and so on. Because the positive integers cannot be decreased in magnitude indefinitely, it follows that the initial assumption must be false and therefore no solution is possible. Instead of giving a proof of the Fermat conjecture for n = 4, it turns out to be easier to establish a fact that is slightly stronger, namely, the impossibility of solving the equation x4 + y4 = z2 in the positive integers. Theorem 12.3 Fermat. The Diophantine equation x4 + y4 = z2 has no solution in positive integers x, y, z. Proof. With the idea of deriving a contradiction, let us assume that there exists a positive solution xo, yo, zo of x4 + y4 = z2• Nothing is lost in supposing also that gcd(xo, yo)= 1; otherwise, put gcd(xo, yo)= d, xo = dx1, Yo = dy1, zo = d2z1 to get xi + Yi = zi with gcd(x1, yi) = 1. Expressing the supposed equation xci + Yci = z6 in the form (xJ)2 + (yJ)2 = z5 we see that x5, y5, zo meet all the requirements of a primitive Pythagorean triple, and therefore Theorem 12.1 can be brought into play. In such triples, one of the integers xJ or yJ is necessarily even, whereas the other is odd. Taking xJ (and hence x0) to be even, there exist relatively prime integers s > t > 0 satisfying x5 = 2st Y5 = s2 - t1 zo = s2 + t2 where exactly one of s and t is even. If it happens that s is even, then we have 1 = yJ = s2 - t2 = 0 - 1 = 3 (mod 4) which is an impossibility. Therefore, s must be the odd integer and, in consequence, t is the even one. Let us put t = 2r. Then the equation x5 = 2s t becomes x5 = 4s r, which says that CERTAIN NONLINEAR DIOPHANTINE EQUATIONS 253 (�) 2 = sr But Lemma 2 asserts that the product of two relatively prime integers [note that gcd(s, t) = 1 implies that gcd(s, r) = l] is a square only if each of the integers it­ self is a square; hence, s = zi, r = w i for positive integers z 1, w 1 · We wish to apply Theorem 12.1 again, this time to the equation t 2 + Y6 = s 2 Because gcd(s, t) = 1, it follows that gcd(t, y0, s) = 1, making t, y0, s a primitive Pythagorean triple. With t even, we obtain t = 2uv Yo= u2 - v 2 s = u2 + v 2 for relatively prime integers u > v > 0. Now the relation t 2 UV= 2 = r = w1 signifies that u and v are both squares (Lemma 2 serves its purpose once more); say, u = Xf and v = Yf. When these values are substituted into the equation for s, the result is 2 2 2 4 4 Z1 = s = u + v = X1 + Y1 A crucial point is that, z1 and t being positive, we also have the inequality 0 2 2 2 2 < Zl ::S Z1 = S ::S S < S + t = Zo What has happened is this. Starting with one solution x0, y0, zo of x 4 + y 4 = z 2, we have constructed another solution x1, y1, z1 such that 0 < z1 < zo. Repeating the whole argument, our second solution would lead to a third solution x2, y2, z2 with 0 < z2 < z1, which, in tum, gives rise to a fourth. This process can be carried out as many times as desired to produce an infinite decreasing sequence of positive integers Zo > Zl > Z2 > · · · Because there is only a finite supply of positive integers less than z0, a contradiction occurs. We are forced to conclude that x 4 + y 4 = z2 is not solvable in the positive integers. As an immediate result, one gets the following corollary. Corollary. The equation x 4 + y 4 = z4 has no solution in the positive integers. Proof. If xo, yo, zo were a positive solution of x 4 + y 4 = z4, then xo, yo, z5 would satisfy the equation x 4 + y 4 = z 2, in conflict with Theorem 12.3. If n > 2, then n is either a power of 2 or divisible by an odd prime p. In the first case, n = 4k for some k > 1 and the Fermat equation xn + yn = zn can be written as 254 ELEMENTARY NUMBER THEORY We have just seen that this equation is impossible in the positive integers. When n = pk, the Fermat equation is the same as (xk)P + (yk)P = (l)P If it could be shown that the equation uP + vP = wP has no solution, then, in par­ ticular, there would be no solution of the form u = xk, v = yk, w = zk; hence, xn + yn = z n would not be solvable. Therefore, Fermat's conjecture reduces to this: For no odd prime p does the equation xP + yP = zP admit a solution in the positive integers. Although the problem has challenged the foremost mathematicians of the last 300 years, their efforts tended to produce partial results and proofs of individual cases. Euler gave the first proof of the Fermat conjecture for the prime p = 3 in the year 1770; the reasoning was incomplete at one stage, but Legendre later supplied the missing steps. Using the method of infinite descent, Dirichlet and Legendre independently settled the case p = 5 around 1825. Not long thereafter, in 1839, Lame proved the conjecture for seventh powers. With the increasing complexity of the arguments came the realization that a successful resolution of the general case called for different techniques. The best hope seemed to lie in extending the meaning of \"integer\" to include a wider class of numbers and, by attacking the problem within this enlarged system, obtaining more information than was possible by using ordinary integers only. The German mathematician Kummer made the major breakthrough. In 1843, he submitted to Dirichlet a purported proof of Fermat's conjecture based upon an extension of the integers to include the so-called algebraic numbers (that is, complex numbers satisfying polynomials with rational coefficients). Having spent consider­ able time on the problem himself, Dirichlet was immediately able to detect the flaw in the reasoning: Kummer had taken for granted that algebraic numbers admit a unique factorization similar to that of the ordinary integers, which is not always true. But Kummer was undeterred by this perplexing situation and returned to his investigations with redoubled effort. To restore unique factorization to the algebraic numbers, he was led to invent the concept of ideal numbers. By adjoining these new entities to the algebraic numbers, Kummer successfully proved Fermat's conjecture for a large class of primes that he termed regular primes (that this represented an enormous achievement is reflected in the fact that the only irregular primes less than 100 are 37, 59, and 67). Unfortunately, it is still not known whether there are an infinite number of regular primes, whereas in the other direction, Jensen (1915) established that there exist infinitely many irregular ones. Almost all the subsequent progress on the problem was within the framework suggested by Kummer. In 1983, a 29-year-old West German mathematician, Gerd Faltings, proved that for each exponent n > 2, the Fermat equation xn + y n = z n can have at most a finite number (as opposed to an infinite number) of integral solutions. At first glance, this may not seem like much of an advance; but if it could be shown that the finite number of solutions was zero in each case, then the Fermat's conjecture would be laid to rest once and for all. CERTAIN NONLINEAR DIOPHANTINE EQUATIONS 255 Another striking result, established in 1987, was that Fermat's assertion is true for \"almost all\" values of n; that is, as n increases the percentage of cases in which the conjecture could fail approaches zero. With the advent of computers, various numerical tests were devised to verify Fermat's conjecture for specific values of n. In 1977, S.S. Wagstafftook over 2 years, using computing time on four machines on weekends and holidays, to show that the conjecture held for all n :S 125000. Since that time, the range of exponents for which the result was determined to be true has been extended repeatedly. By 1992, Fermat's conjecture was known to be true for exponents up to 4000000. For a moment in the summer of 1993, it appeared that the final breakthrough had been made. At the conclusion of three days of lectures in Cambridge, Eng­ land, Andrew Wiles of Princeton University stunned his colleagues by announcing that he could favorably resolve Fermat's conjecture. His proposed proof, which had taken seven years to prepare, was an artful blend of many sophisticated techniques developed by other mathematicians only within the preceding decade. The key in­ sight was to link equations of the kind posed by Fermat with the much-studied theory of elliptic curves; that is, curves determined by cubic polynomials of the form y2 = x3 +ax+ b, where a and b are integers. The overall structure and strategy of Wiles's argument was so compelling that mathematicians hailed it as almost certainly correct. But when the immensely com­ plicated 200-page manuscript was carefully scrutinized for hidden errors, it revealed a subtle snag. No one claimed that the flaw was fatal, and bridging the gap was felt to be feasible. Over a year later, Wiles provided a corrected, refined, and shorter (125-page) version of his original proof to the enthusiastic reviewers. The revised argument was seen to be sound, and Fermat's seemingly simple claim was finally settled. The failure of Wiles's initial attempt is not really surprising or unusual in math­ ematical research. Normally, proposed proofs are privately circulated and examined for possible flaws months in advance of any formal announcement. In Wiles's case, the notoriety of one of number theory's most elusive conjectures brought premature publicity and temporary disappointment to the mathematical community. To round out our historical digression, we might mention that in 1908 a prize of 100,000 marks was bequeathed to the Academy of Science at Gottingen to be paid for the first complete proof of Fermat's conjecture. The immediate result was a deluge of incorrect demonstrations by amateur mathematicians. Because only printed solutions were eligible, Fermat's conjecture is reputed to be the mathematical problem for which the greatest number of false proofs have been published; indeed, between 1908 and 1912 over one thousand alleged proofs appeared, mostly printed as private pamphlets. Suffice it to say, interest declined as the German inflation of the 1920s wiped out the monetary value of the prize. (With the introduction of the Reichsmark and Deutsche Mark [DM] and after various currency revaluations, the award was worth about DM 75,000 or $40,000 when it was presented to Wiles in 1997.) From x4 + y4 = z2, we move on to a closely related Diophantine equation, namely, x4 - y4 = z2. The proof of its insolubility parallels that of Theorem 12.3, but we give a slight variation in the method of infinite descent. CERTAIN NONLINEAR DIOPHANTINE EQUATIONS 257 The result is a new solution c, d, v of the given equation x4 - y4 = z2 and what is more, a solution in which 0 < c = Fa < a2 + b2 = xo contrary to our assumption regarding x0. The only resolution of these contradictions is that the equation x4 - y4 = z2 cannot be satisfied in the positive integers. In the margin of his copy ofDiophantus'sArithmetica, Fermat states and proves the following: the area of a right triangle with rational sides cannot be the square of a rational number. Clearing of fractions, this reduces to a theorem about Pythagorean triangles, to wit, Theorem 12.5. Theorem 12.5. The area of a Pythagorean triangle can never be equal to a perfect (integral) square. Proof. Consider a Pythagorean triangle whose hypotenuse has length z and other two sides have lengths x and y, so that x2 + y2 = z2. The area of the triangle in question is ! xy, and if this were a square, say u2, it would follow that 2xy = 4u2. By adding and subtracting the last-written equation from x2 + y2 = z2, we are led to (x + y)2 = z2 + 4u2 and (x - y)2 = z2 - 4u2 When these last two equations are multiplied together, the outcome is that two fourth powers have as their difference a square: (x2 - y2)2 = z4 - 16u4 = z4 - (2u)4 Because this amounts to an infringement on Theorem 12.4, there can be no Pythagorean triangle whose area is a square. There are a number of simple problems pertaining to Pythagorean triangles that still await solution. The corollary to Theorem 12.3 may be expressed by saying that there exists no Pythagorean triangle all the sides of which are squares. However, it is not difficult to produce Pythagorean triangles whose sides, if increased by 1, are squares; for instance, the triangles associated with the triples 132 - 1, 10 2 - 1, 142 - 1, and 2872 - 1, 2652 - 1, 3292 - 1. An obvious-and as yet unanswered­ question is whether there are an infinite number of such triangles. We can find Pythagorean triangles each side of which is a triangular number. [By a triangular number, we mean an integer of the form tn = n(n + 1)/2.] An example of such is the triangle corresponding to t132, t143, t164. It is not known if infinitely many Pythagorean triangles of this type exist. As a closing comment, we should observe that all the effort expended on attempt­ ing to prove Fermat's conjecture has been far from wasted. The new mathematics that was developed as a by-product laid the foundations for algebraic number theory and the ideal theory of modem abstract algebra. It seems fair to say that the value of these far exceeds that of the conjecture itself. Another challenge to number theorists, somewhat akin to Fermat's conjecture, concerns the Catalan equation. Consider for the moment the squares and cubes of 258 ELEMENTARY NUMBER THEORY positive integers in increasing order: 1,4,8,9, 16,25,27,36,49,64,81, 100, ... We notice that 8 and 9 are consecutive integers in this sequence. The medieval astronomer Levi ben Gershon ( 1288-1344) proved that there are no other consecutive powers of 2 and 3; to put it another way, he showed that if 3m - 2n = ±1, with m > 1 and n > 1, then m = 2 and n = 3. In 1738, Euler, using Fermat's method of infinite descent, dealt with the equation x3 - y2 = ± 1, proving that x = 2 and y = 3. Catalan himself contributed little more to the consecutive-power problem than the assertion (1844) that the only solution of the equation xm - yn = 1 in integers x, y, m, n, all greater than 1, is m = y = 2, n = x = 3. This statement, now known as Catalan's conjecture, was proved, in 2002. Over the years, the Catalan equation xm - yn = 1 had been shown to be impos­ sible of solution for special values of m and n. For example in 1850, V. A. Lebesgue proved that xm - y2 = 1 admits no solution in the positive integers for m =j:. 3; but, it remained until 1964 to show that the more difficult equation x2 - yn = 1 is not solvable for n =j:. 3. The cases x3 - yn = 1 and xm - y3 = 1, with m =j:. 2, were suc­ cessfully resolved in 1921. The most striking result, obtained by R. Tijdeman in 1976, is that xm - yn = 1 has only a finite number of solutions, all of which are smaller than some computable constant C > O; that is, xm, yn < C. Suppose that Catalan's equation did have a solution other than 32 - 23 = 1. If p and q are primes dividing m and n respectively, then xmfp and ynfq would provide a solution to the equation uP - vq = 1. What needed to be shown was that this equation was not solvable in integers u, v :::: 2 and distinct primes p, q :::: 5. One approach called for obtaining explicit bounds on the possible size of the exponents. A series of investigations continually sharpened the restrictions until by the year 2000 it was known that 3 · 108 < p < (7.15)1011and3.108 < q < (7.75)1016. Thus, the Catalan conjecture could in principle be settled by exhaustive computer calculations; but until the upper bound was lowered, this would take a long time. In 2000, Preda Mihailescu proved that for a Catalan solution to exist, p and q must satisfy the simultaneous congruences These are known as double Wieferich primes, after Arthur Wieferich, who inves­ tigated (1909) the congruence 2p-l = 1 (mod p2). Such pairs of primes are rare, with only six pairs having been identified so far. Furthermore, as each of these 12 primes is less than 3 · 108, none satisfied the known restrictions. Taking advantage of his results on Wieferich primes, Mihailescu continued to work on the problem. He finally settled the famous question early in the following year: the only consecutive powers are 8 and 9. One interesting consequence of these results is that no Fermat number Fn = 22n + 1 can be a power of another integer, the exponent being greater than 1. For if Fn =am, with m :::: 2, then am - (22n-1)2 = 1, which would imply that the equation xm - y2 = 1 has a solution. PROBLEMS 12.2 CERTAIN NONLINEAR DIOPHANTINE EQUATIONS 259 1. Show that the equation x2 + y2 = z3 has infinitely many solutions for x, y, z positive integers. [Hint: For any n =:::: 2, let x = n(n2 - 3) and y = 3n2 - 1.] 2. Prove the theorem: The only solutions in nonnegative integers of the equation x2 + 2 y2 = z 2, with gcd(x, y, z) = 1, are given by x = ±(2s2 - t2) y = 2st z = 2s2 + t2 where s, t are arbitrary nonnegative integers. [Hint: If u, v, w are such that y = 2w, z + x = 2u, z - x = 2v, then the equation becomes 2w2 = uv.] 3. In a Pythagorean triple x, y, z, prove that not more than one of x, y, or z can be a perfect square. 4. Prove each of the following assertions: (a) The system of simultaneous equations x2 + y2 = z2 - 1 and x2 - y2 = w2 - 1 has infinitely many solutions in positive integers x, y, z, w. [Hint: For any integer n =:::: 1, take x = 2n2 and y = 2n.] (b) The system of simultaneous equations x2 + y2 = z2 and x2 _ y2 = w2 admits no solution in positive integers x, y, z, w. ( c) The system of simultaneous equations x2 + y2 = z2 + 1 and x2 - y2 = w2 + 1 has infinitely many solutions in positive integers x, y, z, w. [Hint: For any integer n =:::: 1, take x = 8n4 + 1 and y = 8n3 .] 5. Use Problem 4 to establish that there is no solution in positive integers of the simultaneous equations x2 + y2 = z2 and x2 + 2y2 = w2 [Hint: Any solution of the given system also satisfies z2 + y2 = w2 and z2 - y2 = x2 .] 6. Show that there is no solution in positive integers of the simultaneous equations x2 + y2 = z2 and x2 + z2 = w2 hence, there exists no Pythagorean triangle whose hypotenuse and one of whose sides form the sides of another Pythagorean triangle. [Hint: Any solution of the given system also satisfies x4 + (wy)2 = z4.] 7. Prove that the equation x 4 - y4 = 2z2 has no solutions in positive integers x, y, z. [Hint: Because x, y must be both odd or both even, x2 + y2 = 2a2, x + y = 2b2, x - y = 2c2 for some a, b, c; hence, a2 = b4 + c 4 .] 8. Verify that the only solution in relatively prime positive integers of the equation x4 + y4 = 2z2 is x = y = z = 1. [Hint: Any solution of the given equation also satisfies the equation ( x4 y 4) 2 z4 - (xy)4 = ; .] 260 ELEMENTARY NUMBER THEORY 9. Prove that the Diophantine equation x4 - 4 y4 = z2 has no solution in positive integers X, y, z. [Hint: Rewrite the given equation as (2y2)2 + z2 = (x2)2 and appeal to Theorem 12.1.] 10. Use Problem 9 to prove that there exists no Pythagorean triangle whose area is twice a perfect square. [Hint: Assume to the contrary that x2 + y2 = z2 and �xy = 2w2. Then (x + y)2 = z2 + 8w2, and (x - y)2 = z2 - 8w2. This leads to z4 - 4(2w)4 = (x2 - y2)2.] 11. Prove the theorem: The only solutions in positive integers of the equation are given by 1 1 1 - + - = ­ x2 y2 z2 gcd(x, y, z) = 1 x = 2st(s2 + t2) Y = s4 - t4 z = 2st(s2 - t2) where s, t are relatively prime positive integers, one of which is even, with s > t. 12. Show that the equation 1 / x4 + 1 / y4 = 1 / z2 has no solution in positive integers. CHAP TER 13 REPRESENTATION OF INTEGERS AS SUMS OF SQUARES The object of pure Physic is the unfolding of the laws of the intelligible world; the object of pure Mathematic that of unfolding the laws of human intelligence. J. J. SYLVESTER 13.1 JOSEPH LOUIS LAGRANGE After the deaths of Descartes, Pascal, and Fermat, no French mathematician of comparable stature appeared for over a century. In England, meanwhile, mathematics was being pursued with restless zeal, first by Newton, then by Taylor, Stirling, and Maclaurin, while Leibniz came upon the scene in Germany. Mathematical activity in Switzerland was marked by the work of the Bernoullis and Euler. Toward the end of the 18th century, Paris did again become the center of mathematical studies, as Lagrange, Laplace, and Legendre brought fresh glory to France. An Italian by birth, German by adoption, and Frenchman by choice, Joseph Louis Lagrange ( 1736-1813) was, next to Euler, the foremost mathematician of the 18th century. When he entered the University of Turin, his great interest was in physics, but, after chancing to read a tract by Halley on the merits of Newtonian calculus, he became excited about the new mathematics that was transforming celes­ tial mechanics. He applied himself with such energy to mathematical studies that he was appointed, at the age of 18, professor of geometry at the Royal Artillery School in Turin. The French Academy of Sciences soon became accustomed to including Lagrange among the competitors for its biennial prizes: between 1764 and 1788, he 261 262 ELEMENTARY NUMBER THEORY Joseph Louis Lagrange (1736--1813) (Dover Publications, Inc.) won five of the coveted prizes for his applications of mathematics to problems in astronomy. In 1766, when Euler left Berlin for St. Petersburg, Frederick the Great arranged for Lagrange to fill the vacated post, accompanying his invitation with a modest message that said, \"It is necessary that the greatest geometer of Europe should live near the greatest of Kings.\" (To D' Alembert, who had suggested Lagrange's name, the King wrote, \"To your care and recommendation am I indebted for having replaced a half-blind mathematician with a mathematician with both eyes, which will especially please the anatomical members of my academy.\") For the next 20 years, Lagrange served as director of the mathematics section of the Berlin Academy, producing work of high distinction that culminated in his monumental treatise, the Mecanique Analytique (published in 1788 in four volumes). In this work he unified general mechanics and made of it, as the mathematician Hamilton was later to say, \"a kind of scientific poem.\" Holding that mechanics was really a branch of pure mathematics, Lagrange so completely banished geometric ideas from the M ecanique Analytique that he could boast in the preface that not a single diagram appeared in its pages. Frederick the Great died in 1786, and Lagrange, no longer finding a sympathetic atmosphere at the Prussian court, decided to accept the invitation of Louis XVI to settle in Paris, where he took French citizenship. But the years of constant activity had taken their toll: Lagrange fell into a deep mental depression that destroyed his interest in mathematics. So profound was his loathing for the subject that the first printed copy of the M ecanique Analytique-the work of a quarter century-lay unexamined on his desk for more than two years. Strange to say, it was the turmoil of the French Revolution that helped to awaken him from his lethargy. Following REPRESENTATION OF INTEGERS AS SUMS OF SQUARES 263 the abolition of all the old French universities (the Academy of Sciences was also suppressed) in 1793, the revolutionists created two new schools, with the humble titles of Ecole Normale and Ecole Polytechnique, and Lagrange was invited to lecture on analysis. Although he had not lectured since his early days in Turin, having been under royal patronage in the interim, he seemed to welcome the appointment. Subject to constant surveillance, the instructors were pledged \"neither to read nor repeat from memory\" and transcripts of their lectures as delivered were inspected by the authorities. Despite the petty harassments, Lagrange gained a reputation as an inspiring teacher. His lecture notes on differential calculus formed the basis of another classic in mathematics, the Theorie des Fonctions Analytique (1797). Although Lagrange's research covered an extraordinarily wide spectrum, he possessed, much like Diophantus and Fermat before him, a special talent for the theory of numbers. His work here included: the first proof of Wilson's theorem that if n is a prime, then (n - 1) ! = -1 (mod n ); the investigation of the conditions under which ±2 and ±5 are quadratic residues or nonresidues of an odd prime ( -1 and ±3 having been discussed by Euler); finding all integral solutions of the equation x2 - ay2 = 1; and the solution of a number of problems posed by Fermat to the effect that certain primes can be represented in particular ways (typical of these is the result that asserts that every prime p = 3 (mod 8) is of the form p = a2 + 2b2). This chapter focuses on the discovery for which Lagrange has acquired his greatest renown in number theory, the proof that every positive integer can be expressed as the sum of four squares. 13.2 SUMS OF TWO SQUARES Historically, a problem that has received a good deal of attention has been that of representing numbers as sums of squares. In the present chapter, we develop enough material to settle completely the following question: What is the smallest value n such that every positive integer can be written as the sum of not more than n squares? Upon examining the first few positive integers, we find that 1=12 2=12+12 3=12+12+12 4 = 22 5 = 22 + 12 6 = 22 + 12 + 12 7 = 22 + 12 + 12 + 12 Because four squares are needed in the representation of 7, a partial answer to our question is that n :::=: 4. Needless to say, there remains the possibility that some integers might require more than four squares. A justly famous theorem of Lagrange, proved in 1770, asserts that four squares are sufficient; that is, every positive integer is realizable as the sum of four squared integers, some of which may be 0 = 02. This is our Theorem 13. 7. 264 ELEMENTARY NUMBER THEORY To begin with simpler things, we first find necessary and sufficient conditions that a positive integer be representable as the sum of two squares. The problem may be reduced to the consideration of primes by the following lemma. Lemma. If rn and n are each the sum of two squares, then so is their product rnn. Proof. If rn = a2 + b2 and n = c2 + d2 for integers a, b, c, d, then rnn = (a2 + b2)(c2 + d2) = (ac + bd)2 +(ad - bc)2 It is clear that not every prime can be written as the sum of two squares; for instance, 3 = a2 + b2 has no solution for integral a and b. More generally, one can prove Theorem 13 .1. Theorem 13.1. No prime p of the form 4k + 3 is a sum of two squares. Proof. Modulo 4, we have a = 0, 1, 2, or 3 for any integer a; consequently, a2 = 0 or 1 (mod 4). It follows that, for arbitrary integers a and b, a2 + b2 = 0, 1, or 2 (mod 4) Because p = 3 (mod 4), the equation p = a2 + b2 is impossible. On the other hand, any prime that is congruent to 1 modulo 4 is expressible as the sum of two squared integers. The proof, in the form we shall give it, employ s a theorem on congruences due to the Norwegian mathematician Axel Thue. This, in its tum, relies on Dirichlet's famous pigeonhole principle. Pigeonhole principle. If n objects are placed in rn pigeonholes and if n > rn, then some pigeonhole will contain at least two objects. Phrased in more mathematical terms, this simple principle asserts that if a set with n elements is the union of m of its subsets and if n > m, then some subset has more than one element. Lemma (Thue). Let p be a prime and let gcd(a, p) = 1. Then the congruence ax= y (mod p) admits a solution xo, yo, where 0 < lxol < ,JP and 0 < IYol < ,JP Proof. Let k = [,JP] + 1, and consider the set of integers S = {ax - ylO :S x :S k - 1, 0 :Sy :S k - 1} Because ax - y takes on k2 > p possible values, the pigeonhole principle guarantees that at least two members of S must be congruent modulo p; call them ax1 - y1 and REPRESENTATION OF INTEGERS AS SUMS OF SQUARES 265 ax 2 - y2, where x1 #- x 2 or Y1 #- yz. Then we can write a(x1 - x2) = Yi - Y 2 (mod p) Setting xo = xi - x2 and Yo = Yi - yz, it follows that xo and Yo provide a solution to the congruence ax = y (mod p ). If either x0 or y0 is equal to zero, then the fact that gcd(a, p) = 1 can be used to show that the other must also be zero, contrary to assumption. Hence, 0 < lxol � k - 1 < ./ii and 0 < I Yo I � k - 1 < ..fji. We are now ready to derive the theorem of Fermat that every prime of the form 4k + 1 can be expressed as the sum of squares of two integers. (In terms of priority, Albert Girard recognized this fact several years earlier and the result is sometimes referred to as Girard's theorem.) Fermat communicated his theorem in a letter to Mersenne, dated December 25, 1640, stating that he possessed an irrefutable proof. However, the first published proof was given by Euler in 1754, who in addition succeeded in showing that the representation is unique. Theorem 13.2 Fermat. An odd prime p is expressible as a sum of two squares if and only if p = 1 (mod 4). Proof. Although the \"only if\" part is covered by Theorem 13.1, let us give a differ­ ent proof here. Suppose that p can be written as the sum of two squares, let us say p = a2 + b2. Because p is a prime, we have p ,.r a and p ,.r b. (If p I a, then p I b2, and so p I b, leading to the contradiction that p2 I p.) Thus, by the theory of linear con­ gruences, there exists an integer c for which be = 1 (mod p ). Modulo p, the relation (ac)2 + (bc)2 = pc2 becomes (ac)2 = -1 (modp) making -1 a quadratic residue of p. At this point, the corollary to Theorem 9.2 comes to our aid, for (-1/ p) = 1 only when p = 1 (mod 4). For the converse, assume that p = 1 (mod 4). Because -1 is a quadratic residue of p, we can find an integer a satisfying a2 = -1 (mod p); in fact, by Theorem 5.4, a= [(p - 1)/2]! is one such integer. Now gcd(a, p) = 1, so that the congruence ax= y (modp) admits a solution xo, Yo for which the conclusion of Thue's lemma holds. As a result, -x5 = a2x5 = (axo)2 = y5 (modp) or x5 + Y5 = 0 (mod p ). This says that x5 + Y5 = kp for some integer k � 1. Inasmuch as 0 < lxol < ./ii and 0 < IYol < ..fji, we obtain 0 < xJ + y5 < 2 p, the implication of which is that k = 1. Consequently, x5 + y5 = p, and we are finished. Counting a2 and (-a )2 as the same, we have the following corollary. Corollary. Any prime p of the form 4k + 1 can be represented uniquely (aside from the order of the summands) as a sum of two squares. 266 ELEMENTARY NUMBER THEORY Proof. To establish the uniqueness assertion, suppose that p = a2 + b2 = e2 + d2 where a, b, e, dare all positive integers. Then a2d2 - b2e2 = p(d2 - b2) = 0 (mod p) whence ad= be (mod p) or ad= -be (mod p). Because a, b, e, d are all less than ,JP, these relations imply that ad - be= 0 or ad+ be= p If the second equality holds, then we would have ae = bd; for, p2 = (a2 + b2)(e2 + d2) = (ad+ be)2 + (ae - bd)2 = p2 + (ae - bd)2 and so ae - bd = 0. It follows that either ad= be or ae = bd Suppose, for instance, that ad =be. Then a I be, with gcd(a, b) = 1, which forces a I, e; say, e = ka. The condition ad =be= b(ka) then reduces to d =bk. But p = e2 + d2 = k2(a2 + b2) implies that k = 1. In this case, we get a = e and b = d. By a similar argument, the condition ae = bd leads to a = d and b = e. What is important is that, in either event, our two representations of the prime p turn out to be identical. Let us follow the steps in Theorem 13.2, using the prime p = 13. One choice for the integer a is 6! = 720. A solution of the congruence 720x _ y (mod 13), or rather, 5x _ y (mod 13) is obtained by considering the set s = {Sx - y IO < x, y < 4} The elements of S are just the integers 0 5 10 15 -1 4 9 14 -2 3 8 13 -3 2 7 12 which, modulo 13, become 0 5 10 2 12 4 9 1 11 3 8 0 10 2 7 12 REPRESENTATION OF INTEGERS AS SUMS OF SQUARES 267 Among the various possibilities, we have 5 · 1 - 3 = 2 = 5 · 3 - 0 (mod 13) or 5(1 - 3) = 3 (mod 13) Thus, we may take x0 = - 2 and y0 = 3 to obtain 13 = x6 + Y6 = 22 + 32 Remark. Some authors would claim that any prime p = 1 (mod 4) can be written as a sum of squares in eight ways. For with p = 13, we have 13 = 22 + 33 = 22 + (-3)2 = (-2)2 + 32 = (-2)2 + (-3)2 = 32 + 22 = 32 + (-2)2 = (-3)2 + 22 = (-3)2 + (-2)2 Because all eight representations can be obtained from any one of them by interchang­ ing the signs of 2 and 3 or by interchanging the summands, there is \"essentially\" only one way of doing this. Thus, from our point of view, 13 is uniquely representable as the sum of two squares. We have shown that every prime p such that p = 1 (mod 4) is expressible as the sum of two squares. But other integers also enjoy this property; for instance, 10=12+32 The next step in our program is to characterize explicitly those positive integers that can be realized as the sum of two squares. Theorem 13.3. Let the positive integer n be written as n = N2m, where m is square­ free. Then n can be represented as the sum of two squares if and only if m contains no prime factor of the form 4k + 3. Proof. To start, suppose that m has no prime factor of the form 4k + 3. If m = 1 then n = N2 + 02, and we are through. In the case in which m > 1, let m = P1P2 ···Pr be the factorization of m into a product of distinct primes. Each of these primes p;, being equal to 2 or of the form 4k + 1, can be written as the sum of two squares. Now, the identity (a2 + b2)(c2 + d2) = (ac + bd)2 +(ad - bc)2 shows that the product of two (and, by induction, any finite number) integers, each of which is representable as a sum of two squares, is likewise so representable. Thus, there exist integers x and y satisfying m = x2 + y2. We end up with n = N2m = N2(x2 + y2) = (Nx)2 + (Ny)2 a sum of two squares. Now for the opposite direction. Assume that n can be represented as the sum of two squares 268 ELEMENTARY NUMBER THEORY and let p be any odd prime divisor of m (without loss of generality, it may be assumed that m > 1). If d = gcd(a, b), then a =rd, b = sd, where gcd(r, s) = 1. We get d2(r2 + s2) = N2m and so, m being square-free, d2 I N2. But then r2 + s2 = ( �:) m = tp for some integer t, which leads to r2+s2=0(mod p) Now the condition gcd(r, s) = 1 implies that one of r or s, say r, is relatively prime to p. Let r' satisfy the congruence rr' = 1 (mod p) When the equation r2 + s2 = 0 (mod p) is multiplied by (r')2, we obtain (sr')2 + 1 = 0 (mod p) or, to put it differently, ( -1 / p) = 1. Because -1 is a quadratic residue of p, Theorem 9.2 ensures that p = 1 (mod 4). The implication of our reasoning is that there is no prime of the form 4k + 3 that divides m. The following is a corollary to the preceding analysis. Corollary. A positive integer n is representable as the sum of two squares if and only if each of its prime factors of the form 4k + 3 occurs to an even power. Example 13.1. The integer 459 cannot be written as the sum of two squares, because 459 = 33 · 17, with the prime 3 occurring to an odd exponent. On the other hand, 153 = 32 · 17 admits the representation 153 = 32(42 + 12) = 12 2 + 32 Somewhat more complicated is the example n = 5 · 72 · 13 · 17. In this case, we have n = 72 · 5 · 13 . 17 = 72(22 + 12)(32 + 22)(42 + 12) Two applications of the identity appearing in Theorem 13.3 give (32 + 22)(42 + 12) = (12 + 2)2 + (3 - 8)2 = 142 + 52 and (2 2 + 12)(142 + 52 ) = (28 + 5)2 + (10 - 14)2 = 332 + 42 When these are combined, we end up with n = 72(332 + 42) = 2312 + 282 There exist certain positive integers (obviously, not primes of the form 4k + 1) that can be represented in more than one way as the sum of two squares. The smallest is 25 = 42 + 32 = 52 + 02 REPRESENTATION OF INTEGERS AS SUMS OF SQUARES 269 If a = b (mod 2), then the relation allows us to manufacture a variety of such examples. Taken = 153 as an illustration; here, and (17+9)2 (17-9)2 153 = 17. 9 = 2 - 2 = 132 -42 so that 132 -42 = 272 -242 This yields the two distinct representations 272 + 42 = 242 + 132 = 745 At this stage, a natural question should suggest itself: What positive integers admit a representation as the difference of two squares? We answer this below. Theorem 13.4. A positive integer n can be represented as the difference of two squares if and only if n is not of the form 4k + 2. Proof. Because a2 = 0 or 1 (mod 4) for all integers a, it follows that a2 - b2 = 0, 1, or 3 (mod 4) Thus, if n = 2 (mod 4), we cannot haven= a2 - b2 for any choice of a and b. Turning affairs around, suppose that the integer n is not of the form 4k + 2; that is to say, n = 0, 1, or 3 (mod 4). If n = 1or3 (mod 4), then n + 1 and n - 1 are both even integers; hence, n can be written as a difference of squares. If n = 0 (mod 4 ), then we have Corollary. An odd prime is the difference of two successive squares. Examples of this last corollary are afforded by 11 = 62 -52 17 = 92 -82 29 = 152 -142 270 ELEMENTARY NUMBER THEORY Another point worth mentioning is that the representation of a given prime p as the difference of two squares is unique. To see this, suppose that p = a 2 -b 2 = (a -b)(a + b) where a > b > 0. Because 1 and p are the only factors of p, necessarily we have a-b=l and a +b= p from which it may be inferred that p +l and b = _ p _-_ 1 2 a= 2 Thus, any odd prime p can be written as the difference of the squares of two integers in precisely one way; namely, as A different situation occurs when we pass from primes to arbitrary integers. Suppose that n is a positive integer that is neither prime nor of the form 4k + 2. Starting with a divisor d of n, put d' = n / d (it is harmless to assume that d > d'). Now, if d and d' are both even, or both odd, then (d + d')/2 and (d - d')2 are integers. Furthermore, we may write ' (d+ d') 2 (d- d') 2 n = dd = - 2 2 By way of illustration, consider the integer n = 24. Here, and ( 12 + 2) 2 ( 12 -2)2 2 52 24 = 12 . 2 = - = 7 - 2 2 (6+4)2 (6-4)2 24 = 6. 4 = - 2- - - 2 - = 52 -1 2 giving us two representations for 24 as the difference of squares. PROBLEMS 13.2 1. Represent each of the primes 113, 229, and 373 as a sum of two squares. 2. (a) It has been conjectured that there exist infinitely many prime numbers p such that p = n2 + (n + 1)2 for some positive integer n; for example, 5 = 12 + 22 and 13 = 22 + 32. Find five more of these primes. (b) Another conjecture is that there are infinitely many prime numbers p of the form p = 22 + PT, where Pl is a prime. Find five such primes. 3. Establish each of the following assertions: (a) Each of the integers 2n, where n = 1, 2, 3, ... , is a sum of two squares. (b) If n = 3 or 6 (mod 9), then n cannot be represented as a sum of two squares. ( c) If n is the sum of two triangular numbers, then 4n + 1 is the sum of two squares. REPRESENTATION OF INTEGERS AS SUMS OF SQUARES 271 ( d) Every Fermat number Fn = 22\" + 1, where n � 1, can be expressed as the sum of two squares. (e) Every odd perfect number (if one exists) is the sum of two squares. [Hint: See the Corollary to Theorem 11.7.] 4. Prove that a prime p can be written as a sum of two squares if and only if the congruence x2 + 1 = 0 (mod p) admits a solution. 5. (a) Show that a positive integer n is a sum of two squares if and only if n = 2ma2b, where m � 0, a is an odd integer, and every prime divisor of b is of the form 4k + 1. (b) Write each of the integers 3185 = 5 · 72 • 13; 39690 = 2 · 34 · 5 · 72; and 62920 = 2 3 . 5 . 112 . 13 as a sum of two squares. 6. Find a positive integer having at least three different representations as the sum of two squares, disregarding signs and the order of the summands. [Hint: Choose an integer that has three distinct prime factors, each of the form 4k + l .] 7. If the positive integer n is not the sum of squares of two integers, show that n cannot be represented as the sum of two squares of rational numbers. [Hint: By Theorem 13.3, there is a prime p = 3 (mod 4) and an odd integer k such that pk In, whereas pk+l )' n. If n = (a/b)2 + (c/d)2, then p will occur to an odd power on the left-hand side of the equation n(bd)2 = (ad)2 + (be )2, but not on the right-hand side.] 8. Prove that the positive integer n has as many representations as the sum of two squares as does the integer 2n. [Hint: Starting with a representation of n as a sum of two squares obtain a similar representation for 2n, and conversely.] 9. (a) If n is a triangular number, show that each of the three successive integers 8n2, 8n2 + 1, 8n2 + 2 can be written as a sum of two squares. (b) Prove that of any four consecutive integers, at least one is not representable as a sum of two squares. 10. Prove the following: (a) If a prime number is the sum of two or four squares of different primes, then one of these primes must be equal to 2. (b) If a prime number is the sum of three squares of different primes, then one of these primes must be equal to 3. 11. (a) Let p be an odd prime. If p I a2 + b2, where gcd(a, b) = 1, prove that the prime p = 1 (mod4). [Hint: Raise the congruence a2 = -b2 (mod p) to the power (p - 1)/2 and apply Fermat's theorem to conclude that ( - l )(p - l)/2 = 1.] (b) Use part (a) to show that any positive divisor of a sum of two relatively prime squares is itself a sum of two squares. 12. Establish that every prime number p of the form 8k + 1 or 8k + 3 can be written as p = a2 + 2b2 for some choice of integers a and b. [Hint: Mimic the proof of Theorem 13.2.] 13. Prove the following: (a) A positive integer is representable as the difference of two squares if and only if it is the product of two factors that are both even or both odd. (b) A positive even integer can be written as the difference of two squares if and only if it is divisible by 4. 14. Verify that 45 is the smallest positive integer admitting three distinct representations as the difference of two squares. [Hint: See part (a) of the previous problem.] 272 ELEMENTARY NUMBER THEORY 15. For any n > 0, show that there exists a positive integer that can be expressed inn distinct ways as the difference of two squares. [Hint: Note that, fork = 1, 2, ... , n, 22n+l = (22n-k + 2k-1)2 _ (22n-k _ 2k-1)2.] 16. Prove that every prime p = 1 (mod 4) divides the sum of two relatively prime squares, where each square exceeds 3. [Hint: Given an odd primitive root r of p, we have rk - 2 (mod p) for some k; hence r2[k+(p-l)/4l = -4 (mod p).] 17. For a prime p = 1or3 (mod 8), show that the equation x2 + 2y2 = p has a solution. 18. The English number theorist G. H. Hardy relates the following story about his young protege Ramanujan: \"I remember going to see him once when he was lying ill in Putney. I had ridden in taxi-cab No. 1729, and remarked that the number seemed to me rather a dull one, and that I hoped it was not an unfavorable omen. 'No,' he reflected, 'it is a very interesting number; it is the smallest number expressible as the sum of two cubes in two different ways.\"' Verify Ramanujan's assertion. 13.3 SUMS OF MORE THAN TWO SQUARES Although not every positive integer can be written as the sum of two squares, what about their representation in terms of three squares (02 still permitted)? With an extra square to add, it seems reasonable that there should be fewer exceptions. For instance, when only two squares are allowed, we have no representation for such integers as 14, 33, and 67, but 14 = 32 + 22 + 12 33 = 52 + 22 + 22 67 = 72 + 32 + 32 It is still possible to find integers that are not expressible as the sum of three squares. Theorem 13.5 speaks to this point. Theorem 13.5. No positive integer of the form 4n(8m + 7) can be represented as the sum of three squares. Proof. To start, let us show that the integer 8m + 7 is not expressible as the sum of three squares. For any integer a, we have a2 = 0, 1, or 4 (mod 8). It follows that a2 + b2 + c2 = 0, 1, 2, 3, 4, 5, or 6 (mod 8) for any choice of integers a, b, c. Because we have 8m + 7 = 7 (mod 8), the equation a2 + b2 + c2 = 8m + 7 is impossible. Next, let us suppose that 4n(8m + 7), where n 2:: 1, can be written as 4n(8m + 7) = a2 + b2 + c2 Then each of the integers a, b, c must be even. Putting a = 2a1, b = 2b1, c = 2c1, we get 4n -1(8m + 7) = ai +bi+ ci If n - 1 2:: 1, the argument may be repeated until 8m + 7 is eventually represented as the sum of three squared integers; this, of course, contradicts the result of the first paragraph. We can prove that the condition of Theorem 13.5 is also sufficient in order that a positive integer be realizable as the sum of three squares; however, the argument REPRESENTATION OF INTEGERS AS SUMS OF SQUARES 273 is much too difficult for inclusion here. Part of the trouble is that, unlike the case of two (or even four) squares, there is no algebraic identity that expresses the product of sums of three squares as a sum of three squares. With this trace of ignorance left showing, let us make a few historical remarks. Diophantus conjectured, in effect, that no number of the form 8m + 7 is the sum of three squares, a fact easily verified by Descartes in 1638. It seems fair to credit Fermat with being the first to state in full the criterion that a number can be written as a sum of three squared integers if and only if it is not of the form 4n(8m + 7), where m and n are nonnegative integers. This was proved in a complicated manner by Legendre in 1798 and more clearly (but by no means easily) by Gauss in 1801. As just indicated, there exist positive integers that are not representable as the sum of either two or three squares (take 7 and 15, for simple examples). Things change dramatically when we tum to four squares: there are no exceptions at all! The first explicit reference to the fact that every positive integer can be written as the sum of four squares, counting 02, was made by Bachet (in 1621) and he checked this conjecture for all integers up to 325. Fifteen years later, Fermat claimed that he had a proof using his favorite method of infinite descent. However, as usual, he gave no details. Both Bachet and Fermat felt that Diophantus must have known the result; the evidence is entirely conjectural: Diophantus gave necessary conditions in order that a number be the sum of two or three squares, while making no mention of a condition for a representation as a sum of four squares. One measure of the difficulty of the problem is the fact that Euler, despite his brilliant achievements, wrestled with it for more than 40 years without success. Nonetheless, his contribution toward the eventual solution was substantial; Euler discovered the fundamental identity that allows one to express the product of two sums of four squares as such a sum, and the crucial result that the congruence x2 + y2 + 1 _ 0 (mod p) is solvable for any prime p. A complete proof of the four-square conjecture was published by Lagrange in 1772, who acknowledged his indebtedness to the ideas of Euler. The next year, Euler offered a much simpler demonstration, which is essentially the version to be presented here. It is convenient to establish two preparatory lemmas, so as not to interrupt the main argument at an awkward stage. The proof of the first contains the algebraic identity (Euler's identity) that allows us to reduce the four-square problem to the consideration of prime numbers only. Lemma 1 Euler. If the integers m and n are each the sum of four squares, then mn is likewise so representable. Proof. If m = at + a� + a� + a� and n = bf + b� + b� + b� for integers ai, bi, then mn = (ar +a�+ a�+ a�)(br + b� + b� + bD = (a1 bi + a2b2 + a3b3 + a4b4)2 + (a1b2 - a2b1 + a3b4 - a4b3)2 + (a1b3 - a2b4 - a3b1 + a4b2)2 + (a1b4 + a2b3 - a3b2 - a4b1)2 27 4 ELEMENTARY NUMBER THEORY We confirm this cumbersome identity by brute force: Just multiply everything out and compare terms. The details are not suitable for the printed page. Another basic ingredient in our development is Lemma 2. Lemma 2. If p is an odd prime, then the congruence x2 + y2 + 1 = 0 (mod p) has a solution xo, Yo where 0 S xo S (p -1)/2 and 0 S Yo S (p -1)/2. Proof. The idea of the proof is to consider the following two sets: 2 2 2 p -1 { ( ) 2} S1 = 1 + 0 , 1 + 1 , 1 + 2 , ... , 1 + - 2- 2 2 2 p -1 { ( ) 2} S2 = -0 , -1 , -2 , ... , - - 2 - No two elements of the set S1 are congruent modulo p. For ifl + xf = 1 +xi (mod p), then either x1 = x2 (mod p) or x1 = -x2 (mod p). But the latter consequence is impossible, because 0 < x1 + x2 < p (unless x1 = x2 = 0), whence x1 = x2 (mod p ), which implies that x1 = x2. In the same vein, no two elements of S2 are congruent modulo p. Together S1 and S2 contain 2[1 + � (p - l)] = p + 1 integers. By the pigeonhole principle, some integer in S1 must be congruent modulo p to some integer in S2; that is, there exist xo, Yo such that 1 + x6 = -y5 (mod p) where 0 S xo S (p -1)/2 and 0 S Yo S (p -1)/2. Corollary. Given an odd prime p, there exists an integer k < p such that kp is the sum of four squares. Proof. According to the theorem, we can find integers x0 and y0, such that p p 0 S xo < 2 0 S Yo < 2 x5 + Y5 + 12 + 02 = kp for a suitable choice of k. The restrictions on the size of xo and Yo imply that p2 p2 kp = x5 + Y5 + 1 < 4 + 4 + 1 < p2 and so k < p, as asserted in the corollary. Example 13.2. We digress for a moment to look at an example. If we take p = 17, then the sets S1 and S2 become S1 = {l, 2, 5, 10, 17, 26, 37, 50, 65} REPRESENTATION OF INTEGERS AS SUMS OF SQUARES 277 It is important to observe that all four of r, s, t, u are divisible by k. In the case of the integer r, for example, we have r = xa + yb + zc + wd = a2 + b2 + c2 + d2 = 0 (mod k) Similarly, s = t = u = 0 (mod k). This leads to the representation np = GJ' +(ff+ (ff+ G)' where r / k, s / k, t / k, u / k are all integers. Because 0 < n < k, we therefore arrive at a contradiction to the choice of k as the smallest positive integer for which kp is the sum of four squares. With this contradiction, k = 1, and the proof is finally complete. This brings us to our ultimate objective, the classical result of Lagrange. Theorem 13. 7 Lagrange. Any positive integer n can be written as the sum of four squares, some of which may be zero. Proof. Clearly, the integer 1 is expressible as 1 = 12 + 02 + 02 + 02, a sum of four squares. Assume that n > 1 and let n = P1P2 ··· Pr be the factorization of n into (not necessarily distinct) primes. Because each Pi is realizable as a sum of four squares, Euler's identity permits us to express the product of any two primes as a sum of four squares. This, by induction, extends to any finite number of prime factors, so that applying the identity r - 1 times, we obtain the desired representation for n. Example 13.3. To write the integer 459 = 33 · 17 as the sum of four squares, we use Euler's identity as follows: 459 = 32 . 3 . 17 = 32(12 + 12 + 12 + 02)(42 + 12 + 02 + 02) = 32[(4 + 1+0 + 0)2 + (1 - 4 + 0 - 0)2 + (0 - 0 - 4 + 0)2 + (0 + 0 - 1 - 0)2] = 32[52 + 32 + 42 + 121 = 152 + 92 + 122 + 32 Lagrange's theorem motivated the more general problem of representing each positive integer as a four-variable expressions of the form ax2 + by2 + cz2 + dw2 where a, b, c, d are given positive integers. In 1916, the famous Indian math­ ematician Srinivasa Ramanujan presented 53 such \"universal quadratics,\" four of which had been previously known. For instance, the expression x2 + 2y2 + 3z2 + 8w2 yields all positive integers: the integer 39, say, can be produced as 39 = 22 + 2 . 02 + 3 . 32 + 8 . 12 In 2005, Manjul Bhargava proved that there are only 204 of the desired quadratics. Finally, in a completion to the question, Bhargava and Jonathan Hanke found a particular set of 29 positive integers that will serve as a check for any quadratic 278 ELEMENTARY NUMBER THEORY expression. If the quadratic expression can represent each of those 29 integers, it can represent all positive integers. Although squares have received all our attention so far, many of the ideas in­ volved generalize to higher powers. In his book, Meditationes Algebraicae (1770), Edward Waring stated that each positive integer is expressible as a sum of at most 9 cubes, also a sum of at most 19 fourth powers, and so on. This assertion has been interpreted to mean the following: Can each positive integer be written as the sum of no more than a fixed number g(k) of kth powers, where g(k) depends only on k, not the integer being represented? In other words, for a given k, a number g(k) is sought such that every n > 0 can be represented in at least one way as k k k n = a1 + a2 + · · · + ag(k) where the ai are nonnegative integers, not necessarily distinct. The resulting problem was the starting point of a large body of research in number theory on what has become known as \"Waring's problem.\" There seems little doubt that Waring had limited numerical grounds in favor of his assertion and no shadow of a proof. As we have reported in Theorem 13.7, g(2) = 4. Except for squares, the first case of a Waring-type theorem actually proved is attributed to Liouville (1859): Every positive integer is a sum of at most 53 fourth powers. This bound for g( 4) is somewhat inflated, and through the years it was progressively reduced. The existence of g(k) for each value of k was resolved in the affirmative by Hilbert in 1909; unfortunately, his proof relies on heavy machinery (including a 25-fold integral at one stage) and is in no way constructive. Once it is known that Waring's problem admits a solution, a natural question to pose is \"How big is g(k)?\" There is an extensive literature on this aspect of the problem, but the question itself is still open. A sample result, due to Leonard Dickson, is that g(3) = 9, whereas and 23 = 23 + 2 3 + 13 + 1 3 + 13 + 1 3 + 1 3 + 1 3 + 13 239 = 43 + 43 + 33 + 33 + 33 + 33 + 1 3 + 13 + 13 are the only integers that actually require as many as 9 cubes in their representation; each integer greater than 239 can be realized as the sum of at most 8 cubes. In 1942, Linnik proved that only a finite number of integers need 8 cubes; from some point onward 7 will suffice. Whether 6 cubes are also sufficient to obtain all but finitely many positive integers is still unsettled. The cases k = 4 and k = 5 have turned out to be the most subtle. For many years, the best-known result was that g(4) lay somewhere in the range 19 � g(4) < 35, whereas g(5) satisfied 37 < g(5) � 54. Subsequent work (1964) has shown that g(5) = 37. The upper bound on g(4) was decreased dramatically during the 1970s, the sharpest estimate being g ( 4) < 22. It was also proved that every integer less than 10140 or greater than 10367 can be written as a sum of at most 19 fourth powers; thus, in principle, g(4) could be calculated. The relatively recent (1986) announcement that, in fact, 19 fourth powers suffice to represent all integers settled this case completely. REPRESENTATION OF INTEGERS AS SUMS OF SQUARES 279 As far as k � 6 is concerned, it has been established that the formula g(k) = [(3/2)kl + 2k - 2 holds, except possibly for a finite number of values of k. There is considerable evidence to suggest that this expression is correct for all k. For k > 3, all sufficiently large integers require fewer than g(k) kth powers in their representations. This suggests a general definition: Let G(k) denote the smallest integer r with the property that every sufficiently large integer is the sum of at most r kth powers. Clearly, G(k) < g(k). Exact values of G(k) are known only in two cases, namely, G(2) = 4 and G(4) = 16. Linnik's result on cubes indicates that G(3) < 7, while as far back as 1851 Jacobi conjectured that G(3) =::: 5. Although more than half a century has passed without an improvement in the size of G(3), nevertheless, it is felt that G(3) = 4. In recent years, the bounds G(5) =::: 17 and G(6) < 24 have been established. Below are listed known values and estimates for the first few g(k) and G(k ): g(2) = 4 G(2) = 4 g(3) = 9 4 < G(3)::::: 7 g(4) = 19 G(4) = 16 g(5) = 37 6 < G(5)::::: 17 g(6) = 73 9 < G(6)::::: 24 g(7) = 143 8 < G(7)::::: 33 g(8) = 279 32 < G(8)::::: 42 Another problem that has attracted considerable attention is whether an nth power can be written as a sum of n nth powers, with n > 3. Progress was first made in 1911 with the discovery of the smallest solution in fourth powers, 353 4 = 304 + 1204 + 2724 + 3154 In fifth powers, the smallest solution is 725 = 195 + 435 + 465 + 475 + 675 However, for sixth or higher powers no solution is yet known. There is a related question; it may be asked, \"Can an nth power ever be the sum of fewer than n nth powers?\" Euler conjectured that this is impossible; however, in 1968, Lander and Parkin came across the representation 1445 = 275 + 845 + 1105 + 1335 With the subsequent increase in computer power and sophistication, N. Elkies was able to show (1987) that for fourth powers there are infinitely many counterexamples to Euler's conjecture. The one with the smallest value is 4224814 = 958004 + 217519 4 + 4145604 280 ELEMENTARY NUMBER THEORY PROBLEMS 13.3 1. Without actually adding the squares, confirm that the following relations hold: (a) 12 + 22 + 32 + · · · + 232 + 242 = 702. (b) 182 + 192 + 202 + ... + 272 + 282 = 772. ( c) 22 + 52 + 82 + ... + 232 + 262 = 482. (d) 62 + 122 + 182 + ... + 422 + 482 = 952 -412. 2. Regiomontanus proposed the problem of finding 20 squares whose sum is a square greater than 300,000. Furnish two solutions. [Hint: Consider the identity 3. If p =qr+ qi+ qf, where p, qi, q1, and q 3 are all primes, show that some qi = 3. 4. Establish that the equation a2 + b2 + c2 + a + b + c = 1 has no solution in the integers. [Hint: The equation in question is equivalent to the equation (2a + 1)2 + (2b + 1)2 + (2c + 1)2 = 7. ] 5. For a given positive integer n, show that n or 2n is a sum of three squares. 6. An unanswered question is whether there exist infinitely many prime numbers p such that p = n2 + (n + 1)2 + (n + 2)2, for some n > 0. Find three of these primes. 7. In our examination of n = 459, no representation as a sum of two squares was found. Express 459 as a sum of three squares. 8. Verify each of the statements below: (a) Every positive odd integer is of the form a2 + b2 + 2c2, where a, b, c are integers. [Hint: Given n > 0, 4n + 2 can be written as 4n + 2 = x2 + y2 + z2, with x and y odd and z even. Then x+y x-y z 2 ( ) 2 ( ) 2 2n + 1 = - 2- + - 2- +2 ( 2) .] (b) Every positive integer is either of the form a2 + b2 + c2 or a2 + b2 + 2c2, where a, b, care integers. [Hint: If n > 0 cannot be written as a sum a2 + b2 + c2, then it is of the form 4m(8k + 7). Apply part (a) to the odd integer 8k + 7. ] (c) Every positive integer is of the form a2 + b2 -c2, where a, b, c are integers. [Hint: Given n > 0, choose a such that n - a2 is a positive odd integer and use Theorem 13.4. ] 9. Establish the following: (a) No integer of the form 9k + 4 or 9k + 5 can be the sum of three or fewer cubes. [Hint: Notice that a3 - 0, 1, or 8 (mod 9) for any integer a. ] (b) The only prime p that is representable as the sum of two positive cubes is p = 2. [Hint: Use the identity a3 + b3 =(a+ b)((a -b)2 +ab). ] ( c) A prime p can be represented as the difference of two cubes if and only if it is of the form p = 3k(k + 1) + 1, for some k. 10. Express each of the primes 7, 19, 37, 61, and 127 as the difference of two cubes. REPRESENTATION OF INTEGERS AS SUMS OF SQUARES 281 11. Prove that every positive integer can be represented as a sum of three or fewer triangular numbers. [Hint: Given n > 0, express 8n + 3 as a sum of three odd squares and then solve for n.] 12. Show that there are infinitely many primes p of the form p = a2 + b2 + c2 + 1, where a, b, c are integers. [Hint: By Theorem 9.8, there are infinitely many primes of the form p = 8k + 7. Write p - 1 = 8k + 6 = a2 + b2 + c2 for some a, b, c.] 13. Express the integers 231 = 3 · 7 · 11, 391 = 17 · 23, and 2109 = 37 · 57 as sums of four squares. 14. (a) Prove that every integer n ::'.'.: 170 is a sum of five squares, none of which are equal to zero. [Hint: Write n - 169 = a2 + b2 + c2 + d2 for some integers a, b, c, d and consider the cases in which one or more of a, b, c is zero.] (b) Prove that any positive multiple of 8 is a sum of eight odd squares. [Hint: Assuming n = a2 + b2 + c2 + d2, then 8n + 8 is the sum of the squares of 2a ± 1, 2b ± 1, 2c ± 1, and 2d ± 1.] 15. From the fact that n 3 = n (mod 6) conclude that every integer n can be represented as the sum of the cubes of five integers, allowing negative cubes. [Hint: Utilize the identity n3 - 6k = n3 - (k + 1)3 - (k - 1)3 + k3 + k3 .] 16. Prove that every odd integer is the sum of four squares, two of which are consecutive. [Hint: For n > 0, 4n + 1 is a sum of three squares, only one being odd; notice that 4n + 1 = (2a)2 + (2b)2 + (2c + 1)2 gives 2n + 1 = (a+ b)2 +(a - b)2 + c2 + (c + 1)2 .] 17. Prove that there are infinitely many triangular numbers that are simultaneously express­ ible as the sum of two cubes and the difference of two cubes. Exhibit the representations for one such triangular number. [Hint: In the identity (27k6)2 - 1 = (9k4 - 3k)3 + (9k3 - 1)3 = (9k4 + 3k )3 - (9k3 + 1)3 take k to be an odd integer to get (2n + 1)2 - 1 = (2a )3 + (2b )3 = (2c )3 - (2d)3 or equivalently, tn = a3 + b3 = c3 - d3 .] 18. (a) If n - 1 and n + 1 are both primes, establish that the integer 2n2 + 2 can be repre­ sented as the sum of 2, 3, 4, and 5 squares. (b) Illustrate the result of part (a) in the cases in which n = 4, 6, and 12. This page intentionally left blank CHAPTER 14 FIBONACCI NUMBERS ... what is physical is subject to the laws of mathematics, and what is spiritual to the laws of God, and the laws of mathematics are but the expression of the thoughts of God. THOMAS HILL 14.1 FIBONACCI Perhaps the greatest mathematician of the Middle Ages was Leonardo of Pisa ( 1180- 1250), who wrote under the name of Fibonacci-a contraction of \"filius Bonacci,\" that is, Bonacci's son. Fibonacci was born in Pisa and educated in North Africa, where his father was in charge of a customhouse. In the expectation of entering the mercantile business, the youth traveled about the Mediterranean visiting Spain, Egypt, Syria, and Greece. The famous Liber Abaci, composed upon his return to Italy, introduced the Latin West to Islamic arithmetic and algebraic mathematical practices. A briefer work of Fibonacci's, the Liber Quadratorum (1225), is devoted entirely to Diophantine problems of second degree. It is regarded as the most important contribution to Latin Middle-Ages number theory before the works of Bachet and Fermat. Like those before him, Fibonacci allows (positive) real numbers as solutions. One problem, for instance, calls for finding a square that remains square when increased or decreased by 5; that is, obtain a simultaneous solution to the pair of equations x2 + 5 = y2, x2 - 5 = z 2, where x, y, z are unknowns. Fibonacci gave 41/12 as an answer, for (41/12)2 + 5 = (49/12)2, (41/12)2 - 5 = (31/12)2 283 284 ELEMENTARY NUMBER THEORY Leonardo of Pisa (Fibonacci) (1180-1250) (David Eugene Smith Collection, Rare Book and Manuscript Library, Columbia University) Also noteworthy is the remarkably accurate estimate in 1224 of the only real root of the cubic equation x3 + 2x2 + lOx = 20. His value, in decimal notation, of 1.3688081075 ... , is correct to nine decimal places. Christian Europe became acquainted with the Hindu-Arabic numerals through the Liber Abaci, which was written in 1202 but survives only in a revised 1228 edition. (The word \"Abaci \" in the title does not refer to the abacus, but rather means counting in general.) Fibonacci sought to explain the advantages of the Eastern decimal system, with its positional notation and zero symbol, \"in order that the Latin race might no longer be deficient in that knowledge.\" The first chapter of his book opens with the following sentence: These are the nine figures of the Indians: 9 8 7 6 5 4 3 2 1 With these nine figures, and with this sign 0 ... any number may be written, as will be demonstrated. General acceptance of the new numerals had to wait for another two centuries. In 1299, the city of Florence issued an ordinance forbidding merchants from us­ ing the Arabic symbols in bookkeeping, ordering them either to employ Roman numerals or to write out numerical words in full. The decree was probably due to the great variation in the shapes of certain digits-some quite different from those used today-and the consequent opportunity for ambiguity, misunderstanding, and outright fraud. While the zero symbol, for instance, might be changed to a 6 or a 9, it is not so easy to falsify Roman numerals. It is ironic that, despite his many achievements. Fibonacci is remembered today mainly because the 19th century number theorist Edouard Lucas attached his name to a certain infinite set of positive integers that arose in a trivial problem in the Liber Abaci. This celebrated sequence of integers 1, 1,2,3,5,8, 13,21,34,55,89, ... occurs in nature in a variety of unexpected ways. For instance, lilies have 3 petals, buttercups 5, marigolds 13, asters 21, while most daisies have 34, 55, or 89 petals. The seeds of a sunflower head radiate from its center in two families of interlaced ABONACCI NUMBERS 285 spirals, one winding clockwise and the other counterclockwise. There are usually 34 spirals twisting clockwise and 55 in the opposite direction, although some large heads have been found with 55 and 89 spirals present. The number of whorls of scale of a pineapple or a fir cone also provides excellent examples of numbers appearing in Fibonacci's sequence. 14.2 THE FIBONACCI SEQUENCE In the Liber Abaci, Fibonacci posed the following problem dealing with the number of offspring generated by a pair of rabbits conjured up in the imagination: A man put one pair of rabbits in a certain place entirely surrounded by a wall. How many pairs of rabbits can be produced from that pair in a year, if the nature of these rabbits is such that every month each pair bears a new pair which from the second month on becomes productive? Assuming that none of the rabbits dies, then a pair is born during the first month, so that there are two pairs present. During the second month, the original pair has produced another pair. One month later, both the original pair and the firstborn pair have produced new pairs, so that three adult and two young pairs are present, and so on. (The figures are tabulated in the chart below.) The point to bear in mind is that each month the young pairs grow up and become adult pairs, making the new \"adult\" entry the previous one plus the previous \"young\" entry. Each of the pairs that was adult last month produces one young pair, so that the new \"young\" entry is equal to the previous \"adult\" entry. When continued indefinitely, the sequence encountered in the rabbit problem 1, 1,2,3,5,8, 13,21,34,55,89, 144,233,377, ... is called the Fibonacci sequence and its terms the Fibonacci numbers. The position of each number in this sequence is traditionally indicated by a subscript, so that u1 = 1, u2 = 1, u3 = 2, and so forth, with Un denoting the nth Fibonacci number. Growth of rabbit colony Months Adult pairs Young pairs Total 1 1 1 2 2 2 1 3 3 3 2 5 4 5 3 8 5 8 5 13 6 13 8 21 7 21 13 34 8 34 21 55 9 55 34 89 10 89 55 144 11 144 89 233 12 233 144 377 286 ELEMENTARY NUMBER THEORY The Fibonacci sequence exhibits an intriguing property, namely, 2=1+1 or U3 = U2 + U1 3=2+1 or U4 = U3 + U2 5=3+2 or U5 = U4 + U3 8=5+3 or U6 = U5 + U4 By this time, the general rule of formulation should be discernible: Un = Un-l + Un-2 for n > 3 That is, each term in the sequence (after the second) is the sum of the two that immediately precede it. Such sequences, in which from a certain point on every term can be represented as a linear combination of preceding terms, are said to be recursive sequences. The Fibonacci sequence is the first known recursive sequence in mathematical work. Fibonacci himself was probably aware of the recursive nature of his sequence, but it was not until 1634-by which time mathematical notation had made sufficient progress-that the formula appeared in a posthumously published paper by Albert Girard. The Fibonacci numbers grow rapidly. A result indicating this behavior is that usn+2 > ion for n > 1, so that U7 > 10, U12 > 100, U17 > 1000, U22 > 10000 ... The inequality can be established using induction on n, the case n = 1 being obvious because u7 = 13 > 10. Now assume that the inequality holds for an arbitrary integer n; we wish to show that it also holds for n + 1. The recursion rule u k = u k-l + u k-2 can be used several times to express uscn+l)+2 = usn+? in terms of previous Fibonacci numbers to arrive at Usn+7 = 8usn+2 + 5usn+l > 8usn+2 + 2(usn+l + Usn) = l0usn+2 > 10 · lO n = 1on+l completing the induction step and the argument. It may not have escaped attention that in the portion of the Fibonacci sequence that we have written down, successive terms are relatively prime. This is no accident, as is now proved. Theorem 14.1. For the Fibonacci sequence, gcd(un, Un+ I) = 1 for every n '.'.'.:: 1. Proof. Let us suppose that the integer d > 1 divides both Un and Un+I· Then their difference Un+I - Un = Un-I is also divisible by d. From this and from the relation ABONACCI NUMBERS 287 Un - Un-1 = Un-2, it may be concluded that d I Un-2· Working backward, the same argument shows that d I Un-3, d I Un-4, ... , and finally that d I u1. But u1 = 1, which is certainly not divisible by any d > 1. This contradiction ends our proof. Because u3 = 2, us = 5, u7 = 13, andu11 = 89 are all prime numbers, we might be tempted to guess that Un is prime whenever the subscript n > 2 is a prime. This conjecture fails at an early stage, for a little figuring indicates that U19 = 4181=37·113 Not only is there no known device for predicting which Un are prime, but it is not even certain whether the number of prime Fibonacci numbers is infinite. Nonetheless, there is a useful positive result whose cumbersome proof is omitted: for any prime p, there are infinitely many Fibonacci numbers that are divisible by p and these are all equally spaced in the Fibonacci sequence. To illustrate, 3 divides every fourth term of the Fibonacci sequence, 5 divides every fifth term, and 7 divides every eighth term. With the exception of ui, u2, u6, and u12, each Fibonacci number has a \"new\" prime factor, that is, a prime factor that does not occur in any Fibonacci number with a smaller subscript. For example, 29 divides u14 = 377 = 13 · 29, but divides no earlier Fibonacci number. As we know, the greatest common divisor of two positive integers can be found from the Euclidean Algorithm after finitely many divisions. By suitably choosing the integers, the number of divisions required can be made arbitrarily large. The precise statement is this: Given n > 0, there exist positive integers a and b such that to calculate gcd(a, b) by means of the Euclidean Algorithm exactly n divisions are needed. To verify the contention, it is enough to let a = Un+2 and b = Un+l· The Euclidean Algorithm for obtaining gcd(un+z, Un+i) leads to the system of equations Un+2 = 1 · Un+l +Un Un+l = 1 ·Un + Un-1 U4 = 1 · U3 + Uz U3 = 2 · Uz + 0 Evidently, the number of divisions necessary here is n. The reader will no doubt recall that the last nonzero remainder appearing in the algorithm furnishes the value of gcd(un+2, Un+1). Hence, which confirms anew that successive Fibonacci numbers are relatively prime. 288 ELEMENTARY NUMBER THEORY Suppose, for instance, that n = 6. The following calculations show that we need 6 divisions to find the greatest common divisor of the integers u8 = 21 and u7 = 13: 21=1 . 13 + 8 13 = 1 . 8 + 5 8=1·5+3 5=1·3+2 3=1·2+1 2=2·1+0 Gabriel Lame observed in 1844 that if n division steps are required in the Euclidean Algorithm to compute gcd(a, b), where a > b > 0, then a > Un+2, b '.'.'.:: Un+l· Consequently, it was common at one time to call the sequence Un the Lame sequence. Lucas discovered that Fibonacci had been aware of these numbers six centuries ear­ lier; and, in an article published in the inaugural volume (1878) of the American Journal of Mathematics, he named it the Fibonacci sequence. One of the striking features of the Fibonacci sequence is that the greatest common divisor of two Fibonacci numbers is itself a Fibonacci number. The identity (1) is central to bringing out this fact. For fixed m > 2, this identity is established by induction on n. When n = 1, Eq. (1) takes the form which is obviously true. Let us therefore assume that the formula in question holds when n is one of the integers 1, 2, ... , k and try to verify it when n = k + 1. By the induction assumption, Um+k = Um-lUk + UmUk+l Um+(k-1) = Um-lUk-1 + UmUk Addition of these two equations gives us By the way in which the Fibonacci numbers are defined, this expression is the same as which is precisely Eq. (1) with n replaced by k + 1. The induction step is thus complete and Eq. (1) holds for all m > 2 and n '.'.'.:: 1. One example of Eq. (1) should suffice: ABONACCI NUMBERS 289 U9 = U6+3 = U5U3 + U6U4 = 5 · 2 + 8 · 3 = 34 The next theorem, aside from its importance to the ultimate result we seek, has an interest all its own. Theorem 14.2. For m :=::: 1, n :=::: 1, Umn is divisible by Um. Proof. We again argue by induction on n, the result being certainly true when n = 1. For our induction hypothesis, let us assume that u mn is divisible by um for n = 1, 2, ... , k. The transition to the case Um(k+l) = Umk+m is realized using Eq. (l); indeed, Because Um divides Umk by supposition, the right-hand side of this expression (and, hence, the left-hand side) must be divisible by Um· Accordingly, Um I Um(k+l). which was to be proved. Preparatory to evaluating gcd(um, u n ), we dispose of a technical lemma. Lemma. If m = qn + r, then gcd(um, Un)= gcd(u7, Un). Proof. To begin with, Eq. (1) allows us to write gcd(um, Un) = gcd(uqn+r, Un) gcd(Uqn-lUr + UqnUr+l• Un) An appeal to Theorem 14.2 and the fact that gcd(a + c, b) = gcd(a, b), whenever b I c, gives Our claim is that gcd(uqn-l, Un)= 1. To see this, set d = gcd(uqn-l• Un). The relations d I Un and Un I Uqn imply that d I Uqn• and therefore d is a (positive) com­ mon divisor of the successive Fibonacci numbers Uqn-l and Uqn· Because successive Fibonacci numbers are relatively prime, the effect of this is that d = 1. To finish the proof, the reader is left the task of showing that when gcd( a, c) = 1, then gcd(a, be)= gcd(a, b). Knowing this, we can immediately pass on to gcd(um, Un)= gcd(uqn-tU7, Un)= gcd(ur, Un) the desired equality. This lemma leaves us in the happy position in which all that is required is to put the pieces together. Theorem 14.3. The greatest common divisor of two Fibonacci numbers is again a Fibonacci number; specifically, where d = gcd(m, n) 290 ELEMENTARY NUMBER THEORY Proof. Assume that rn 2: n. Applying the Euclidean Algorithm torn and n, we get the following system of equations: rn = q1n + r1 n = q1r1 + r2 r1 = q3r2 + r3 'n-2 = qnrn-1 + rn Tn-1 = qn+lrn + 0 In accordance with the previous lemma, 0 < r1 < n 0 < r2 < r1 0 < r3 < r2 gcd(um, Un)= gcd(u,1, Un)= gcd(u,1, u,2) = · · · = gcd(u,\"_1, u,n) Because rn I 'n-l• Theorem 14.2 tells us that u,\" I u,n-1' whence gcd(u,\"_1, u,\") = u,\". But rn, being the last nonzero remainder in the Euclidean Algorithm for rn and n, is equal to gcd(rn, n). Tying up the loose ends, we get gcd(um, Un) = Ugcd(m,n) and in this way the theorem is established. It is interesting to note that the converse of Theorem 14.2 can be obtained from the theorem just proved; in other words, if Un is divisible by Um, then we can conclude that n is divisible by m. Indeed, if Um I Un, then gcd(um, Un) = Um· But according to Theorem 14.3, the value of gcd(um, un) must be equal to Ugcd(m,n)· The implication of all this is that gcd(m, n) = m, from which it follows that m In. We summarize these remarks in the following corollary. Corollary. In the Fibonacci sequence, Um I Un if and only if rn In for n 2: rn 2: 3. A good illustration of Theorem 14.3 is provided by calculating gcd(u16, u12) = gcd(987, 144). From the Euclidean Algorithm, 987 = 6. 144 + 123 144 = 1 . 123 + 21 123 = 5 . 21 + 18 21=1 . 18 + 3 18 = 6. 3 + 0 and therefore gcd(987, 144) = 3. The net result is that gcd(u16, u12) = 3 = U4 = Ugcd(l6,12) as asserted by Theorem 14.3. When the subscript n > 4 is composite, then u n will be composite. For if n = rs, where r > s '.'.:: 2, the last corollary implies that u, lun and Us lun. To illustrate: u4lu20 and u5iu20 or, phrased differently, both 3 and 5 divide 6765. Thus, primes can occur in the Fibonacci sequence only for prime subscripts-the exceptions being u2 = 1 and u4 = 3. But when pis prime, up may very well be composite, as we saw with ABONACCINUMBERS 291 u 19 = 37 · 11 3. Prime Fibonacci numbers are somewhat sparse; only 42 of them are presently known, the largest being the 126377-digit u604711. Let us present one more proof of the infinitude of primes, this one involv­ ing Fibonacci numbers. Suppose that there are only finitely many primes, say r primes 2, 3, 5, ... , Pr, arranged in ascending order. Next, consider the correspond­ ing Fibonacci numbers u2, u3, us, ... , up,· According to Theorem 14.3, these are relatively prime in pairs. Exclude u2 = 1. Each of the remaining r - 1 numbers is divisible by a single prime with the possible exception that one of them has two prime factors (there being only r primes in all). A contradiction occurs because u37 = 73 · 149 · 2221 has three prime factors. PROBLEMS 14.2 1. Given any prime p =I- 5, it is known that either Up-l or Up+l is divisible by p. Confirm this in the cases of the primes 7, 11, 13, and 17. 2. For n = 1, 2, ... , 10, show that 5u� + 4(-l) n is always a perfect square. 3. Prove that if 21 Un, then 41 (u� +l - u� _1); and similarly, if 3 I Un, then 91 (u� +l - u� _1). 4. For the Fibonacci sequence, establish the following: (a) Un+3 = Un (mod 2), hence u3, u6, u9, ... are all even integers. (b) Un+5 = 3un (mod 5), hence u5, u10, u15, ... are all divisible by 5. 5. Show that the sum of the squares of the first n Fibonacci numbers is given by the formula 2 2 2 2 Ul + U2 + U3 + ···+ Un = UnUn+l [Hint: For n ::'.:'.: 2, u� = UnUn+l - UnUn-1.] 6. Utilize the identity in Problem 5 to prove that for n ::=::: 3 u� +l = u� + 3u� _1 + 2(u� _2 + u� _3 + · · · + u� + ui) 7. Evaluate gcd(u9, u12), gcd(u1s, u20), and gcd(u24, U36). 8. Find the Fibonacci numbers that divide both u24 and U36· 9. Use the fact that Um I Un if and only if m In to verify each of the assertions below: (a) 21 Un if and only if 3 In. (b) 31un if and only if41n. (c) 51 Un if and only if 5 In. (d) 81 Un if and only if 61 n. 10. If gcd(m, n) = 1, prove that UmUn divides Umn for all m, n ::'.:'.: 1. 11. It can be shown that when Un is divided by Um (n > m ), then the remainder r is a Fibonacci number or Um - r is a Fibonacci number. Give examples illustrating both cases. 12. It was proved in 1989 that there are only five Fibonacci numbers that are also triangular numbers. Find them. 13. For n ::'.:'.: 1, prove that 2n-l un = n (mod 5). [Hint: Use induction and the fact that 2nun+l = 2(2 n-lun) + 4(2n-2un-1).] 14. If Un < a < Un+l < b < Un+2 for some n ::'.:'.: 4, establish that the sum a+ b cannot be a Fibonacci number. 15. Prove that there is no positive integer n for which U1 + u2 + U3 + ... + U3n = 16! [Hint: By Wilson's theorem, the equation is equivalent to u3n+2 = 0 (mod 17). Because 171u9,171 Um if and only if 9 Im.] 16. If 3 divides n + m, show that Un-m-lUn + Un-mUn+l is an even integer. 17. For n ::'.:'.: 1, verify that there exist n consecutive composite Fibonacci numbers. 292 ELEMENTARY NUMBER THEORY 18. Prove that 91 Un+24 if and only if 91 Un. [Hint: Use Eq. (1) to establish that Un+24 = Un (mod 9).] 19. Use induction to show that U2n = nc-1r+1 (mod 5) for n � 1. 20. Derive the identity [Hint: Apply Eq. (1).] Un+3 = 3Un+l - Un-1 n � 2 14.3 CERTAIN IDENTITIES INVOLVING FIBON ACCI NUMBERS We move on and develop several of the basic identities involving Fibonacci numbers; these should be useful in doing the problems at the end of the section. One of the simplest asserts that the sum of the first n Fibonacci numbers is equal to Un+2 - 1. For instance, when the first eight Fibonacci numbers are added together, we obtain 1 + 1 + 2 + 3 + 5 + 8 + 13 + 21 = 54 = 55 - 1 = UlQ - 1 That this is typical of the general situation follows by adding the relations U1 = U3 - U2 U2 = U4 - U3 U3 = U5 - U4 Un-1 = Un+l - Un Un = Un+2 - Un+l On doing so, the left-hand side yields the sum of the first n Fibonacci numbers, whereas on the right-hand side the terms cancel in pairs leaving only Un+2 - u2. But u2 = 1. The consequence is that u 1 + U2 + U3 + ... + Un = Un+2 - 1 Another Fibonacci property worth recording is the identity U� = Un+!Un-1 + (-lt-l This may be illustrated by taking, say, n = 6 and n = 7; then U� = 82 = 13 · 5 - 1 = U7U5 - 1 u� = 132 = 21 · 8 + 1 = usu6 + 1 The plan for establishing Eq. (3) is to start with the equation U� - Un+lUn-1 = Un(Un-1 + Un-2) - Un+lUn-1 = (Un - Un+1)Un-l + UnUn-2 (2) (3) From the rule of formation of the Fibonacci sequence, we have Un+l = Un+ Un-1, and so the expression in parentheses may be replaced by the term -un-l to produce U� - Un+lUn-1 = (-l)(u�-1 - UnUn-2) The important point is that except for the initial sign the right-hand side of this equation is the same as the left-hand side, but with all the subscripts decreased by 1. ABONACCI NUMBERS 293 By repeating the argument u�_1 - UnUn-2 can be shown to be equal to the expression (-l)(u�_2 - Un-1Un_3), whence U� - Un+lUn-1 = (-1)2(u�-2 - Un-lUn-3) Continue in this pattern. After n - 2 such steps, we arrive at U� - Un+lUn-1 = (-l)n-2(u� - U3u1) = (-l)n-2(12 _ 2. 1) = (-l)n-1 which we sought to prove. For n = 2k, Eq. (3) becomes U�k = U2k+1U2k-l - 1 (4) While we are on the subject, we might observe that this last identity is the basis of a well-known geometric deception whereby a square 8 units by 8 can be broken up into pieces that seemingly fit together to form a rectangle 5 by 13. To accomplish this, divide the square into four parts as shown below on the left and rearrange them as indicated on the right. 8 3 a 5 5 5 5 13 d The area of the square is 82 = 64, whereas that of the rectangle that seems to have the same constituent parts is 5 · 13 = 65, and so the area has apparently been increased by 1 square unit. The puzzle is easy to explain: the points a, b, c, d do not all lie on the diagonal of the rectangle, but instead are the vertices of a parallelogram whose area, of course, is exactly equal to the extra unit of area. The foregoing construction can be carried out with any square whose sides are equal to a Fibonacci number u2k. When partitioned in the manner indicated c D 294 ELEMENTARY NUMBER THEORY the pieces may be reformed to produce a rectangle having a slot in the shape of a slim parallelogram (our figure is greatly exaggerated): The identity u2k_1u2k+l - 1 = u�k may be interpreted as asserting that the area of the rectangle minus the area of the parallelogram is precisely equal to the area of the original square. It can be shown that the height of the parallelogram-that is, the width of the slot at its widest point-is 1 Ju�k + u�k-2 When u2k has a reasonably large value (say, u2k = 144, so that u2k_2 = 55), the slot is so narrow that it is almost imperceptible to the ey e. The First 50 Fibonacci Numbers u1 1 U26 121393 u2 1 U27 196418 U3 2 U28 317811 U4 3 U29 514229 U5 5 U30 832040 U6 8 u31 1346269 U7 13 u32 2178309 Ug 21 U33 3524578 Ug 34 U34 5702887 u10 55 U35 9227465 uu 89 U36 14930352 u12 144 U37 24157817 U13 233 U3g 39088169 u14 377 U39 63245986 u15 610 U4Q 102334155 U16 987 U41 165580141 U17 1597 U42 267914296 U18 2584 U43 433494437 u19 4181 U44 701408733 uw 6765 U45 1134903170 u21 10946 U46 1836311903 u22 17711 U47 2971215073 u23 28657 U4g 4807526976 u24 46368 U49 7778742049 u25 75025 U50 12586269025 ABONACCI NUMBERS 295 There are only three Fibonacci numbers that are squares (u1 = u2 = 1, u12 = 12 2) and only three that are cubes (u1 = u2 = 1, u6 = 23). Five of them are triangular numbers, namely, u1 = u2 = 1, u4 = 3, u8 = 2 1, and u10 = 55. Also, no Fibonacci number is perfect. The next result to be proved is that every positive integer can be written as a sum of distinct Fibonacci numbers. For instance, looking at the first few positive integers: 1 = U1 2 = U3 3 = U4 4 = U4 + U1 5 = U5 = U4 + U3 6 = U5 + U1 = U4 + U3 + U1 7 = U5 + U3 = U4 + U3 + U2 + U 1 8 = U6 = U5 + U4 It will be enough to show by induction on n > 2 that each of the integers 1, 2, 3, ... , Un - 1 is a sum of numbers from the set { u 1, u 2, ... , Un-z}, none repeated. Assuming that this holds for n = k, choose N with uk - 1 < N < uk+I· Because N - uk-l < uk+I - uk-1 = uk. we infer that the integer N - uk-1 is representable as a sum of distinct numbers from {u1, u2, ... , uk-z}. Then N and, in consequence, each of the integers 1, 2, 3, ... , uk+I - 1 can be expressed as a sum (without repetitions) of numbers from the set {u1, u2, ... , Uk-2, Uk-d· This completes the induction step. Because two consecutive members of the Fibonacci sequence may be combined to give the next member, it is superfluous to have consecutive Fibonacci numbers in our representation of an integer. Thus, uk +Uk-I is replaced by Uk+I whenever possible. If the possibility of using u 1 is ignored (because u2 also has the value 1 ), then the smallest Fibonacci number appearing in the representation is either u2 or u3. We arrive at what is known as the Zeckendorf representation. Theorem 14.4. Any positive integer N can be expressed as a sum of distinct Fibonacci numbers, no two of which are consecutive; that is, wherek1::: 2 andkH1::: kj + 2 for j = 1, 2, ... , r - 1. When representing the integer N, where u r < N < u r+ 1, as a sum of nonconsec­ utive Fibonacci numbers, the number u, must appear explicitly. If the representation did not contain u,, then even if all the admissible Fibonacci numbers were used their sum would not add up to N. For when r is even, say r = 2s, we have the easily established identity U3 + U5 + U7 + · · · + U2s-l = U2s - 1 = Ur - 1 whereas if r is odd, say r = 2s + 1, then In either case, the resulting sum is less than N. Any other Zeckendorf represen­ tation would not have a sum large enough to reach u, - 1. 296 ELEMENTARY NUMBER THEORY To take a simple example, pick N = 50. Here, u9 < 50 < u10 and the Zeckendorf representation is 50 = U4 + U7 + U9 In 1843, the French mathematician Jacques-Philippe-Marie Binet (1786-1856) discovered a formula for expressing Un in terms of the integer n; namely, This formula can be obtained by considering the two roots a= 1 + v'5 2 and 1- v's {3= -- 2 of the quadratic equation x2 -x - 1 = 0. As roots of this equation, they must satisfy a2 =a+ 1 and When the first of these relations is multiplied by an, and the second by 13n, the result IS and 13n+2=13n+l+13n Subtracting the second equation from the first, and dividing by a - f3, leads to an+2 _ 13n+2 an+l _ 13n+l an _ 13n -----= + --- a- {3 a- {3 a- {3 If we put Hn =(an - f3n)/(a -{3), the previous equation can be restated more concisely as Hn+2 = Hn+l + Hn Now notice a few things about a and f3: n � 1 Hence, a+f3=l a- {3 H1 = = 1 a- {3 af3 = -1 a2_132 H2 = =a+ f3 = 1 a -{3 What all this means is that the sequence H1, H2, H3, ···is precisely the Fibonacci sequence, which gives an - 13n Un= n > 1 a - f3 With the help of this rather awkward-looking expression for Un known as the Binet formula, it is possible to derive conveniently many results connected with the Fibonacci numbers. Let us, for example, show that 2 2 Un+2 - Un = U2n+2 ABONACCI NUMBERS 297 As we start, recall that af3 = -1 which has the immediate consequence that (af3)2k = 1 fork � 1. Then u2 - u2 = (an+2 - f3n+2)2 - (an - f3n )2 n+2 n a _ f3 a _ f3 a2(n+2) - 2 + f32(n+2) a2n - 2 + f32n (a - f3)2 (a - f3)2 a2(n+2) + f32(n+2) - a2n - f32n (a - f3)2 Now the expression in the numerator may be rewritten as On doing so, we get (a2 _ f32)(a2n+2 _ f32n+2) u2 - u2 = ---------n+2 n (a _ {3)2 (a2n+2 - f32n+2) = (a + {3) a - f3 = 1 · U2n+2 = U2n+2 For a second illustration of the usefulness of the Binet formula, let us once again derive the relation u2n+1U2n-1 - 1 = u�n. First, we calculate _ _ (a2n+l _ {32n+l) (a2n-1 _ {32n-1) _ U2n+1U2n-l 1 - ,JS ,JS 1 = �(a4n + f34n _ (af3)2n-la2 _ (af3)2n-1 {32 _ 5) 5 1 = -(a4n + f34n + (a2 + {32) _ 5) 5 Because a2 + {32 = 3, this last expression becomes �(a4n + f34n _ Z) = �(a4n + f34n _ Z(af3)2n) 5 5 leading to the required identity. _ (a2n _ {32n)2 _ 2 - ,JS - U2n 298 ELEMENTARY NUMBER THEORY The Binet formula can also be used to obtain the value of Fibonacci numbers. The inequality 0 < l.B I < 1 implies that l.Bn I = 1,8 In < 1 for n > 1. Hence an u - - - n � - --- - - l,Bnl 1 1 = -- <- <- � � 2 which indicates that Un is the nearest integer to � ·For instance, ::i � 377.0005 tells us that the Fibonacci number u14 = 377. Similarly, u1s = 610 because ::; � 609.9996. Our result can be viewed as asserting that Un is the largest integer not exceeding � + �, or expressed in terms of the greatest integer function, [ an 1] Un= � + Z n > 1 We conclude this section with two theorems concerning prime factors of Fibonacci numbers. The first shows that every prime divides some Fibonacci number. Because 21 u3, 3 1 u4, and 5 1 u5, it suffices to consider those primes p > 5. Theorem 14.5. For a prime p > 5, either p I Up-l or p I Up+l• but not both. Proof. By Binet's formula, up= (aP - f3P)j,./5. When the pth powers of a and f3 are expanded by the binomial theorem, we obtain Up= 2p� [ 1 + (f) Vs+(�) 5 + (�) 5Vs + ... + (;) 5(p-l)f2Js] - 2P� [ 1-( f) Vs+(�) 5 - (�) 5Vs + ... -(;) 5Cp-l)f2Js] Recall that (f) = 0 (mod p) for 1 s k s p - 1, and also 2p-l = 1 (mod p). These facts allow us to write the expression for u P more simply as Up= 2p-lUp = (;) 5Cp-l)/2 = 5Cp-l)/2 (mod p) Theorem 9.2 then yields up= (5/p) = ±1 (mod p), so that u; = 1 (mod p). The final touch is to treat the familiar identity u� = u p-1up+1 + ( -1 )P-1 as a congruence modulo p, thereby reducing it to up-IUp+l - 0 (mod p). This, however, is just the statement that one of up-l and up+ 1 is divisible by p. Because gcd(p - 1, p + 1) = 2, Theorem 14.3 tells us that gcd(up-1 • Up+1) = u2 = 1 and the pieces of the theorem are established. We should point out that p - 1 or p + 1 is not necessarily the smallest subscript of a Fibonacci number divisible by p. For instance, 13 I u14, but also 13 I u7. ABONACCI NUMBERS 299 Having considered a divisibility feature of up- l or up+ 1, we next tum to u P, where pis a prime. Of course, up could itself be prime as with us = 5 and u7 = 13. There are several results dealing with the composite nature of certain u P. We conclude the section with one of these. Theorem 14.6. Let p :=::: 7 be a prime for which p = 2 (mod 5), or p = 4 (mod 5). If 2p - 1 is also prime, then 2p - 1 lu p· Proof. Suppose that p has the form 5k + 2 for some k. The starting point is to square the formula up= (aP -f3P)j,J5, then expand a2P and f32P by the binomial theorem to get 5u� = 22�_1 [ 1 + (�P) 5 + (i) 52 + ... + (;;) sP J + 2 Observe that ( 2{) = 0 (mod 2p - 1) for 2:::: k < 2p - 1 while, because 2p - 1 is prime, 22P- l = 2 (mod 2p - 1). This enables us to reduce the expression for u; to 2(5up)2 = (1+sP)+4 (mod 2p - 1) or simply, to 2u; = 1+y-1(mod 2p - 1). Now y-1 = 5<2p-Z)/Z = (5/2p - 1) (mod 2p - 1) From Theorems 9.9 and 9.10, it is easy to see that (5/2p - 1) = (2p - 1/5) = (lOk + 3/5) = (3/5) = -1 Last, we arrive at 2u; = 1 + (-1) = O(mod 2p - 1), from which it may be concluded that 2p - 1 divides up. The case p = 4 (mod 5) can be handled in much the same way upon noting that (2/5) = -1. As illustrations, we mention u19 = 37 · 113, where 19 = 4 (mod 5); and u37 = 73 · 330929, where 37 _ 2 (mod 5). The Fibonacci numbers provide a continuing source of questions for investiga­ tion. Here is a recent result: the largest Fibonacci number that is the sum of two fac­ torials is u 12 = 144 = 4 ! + 5 ! . Another is that the only squares among the Fibonacci numbers are u 1 = 1 and u 12 = 12 2, with the only other power being u6 = 2 3. PROBLEMS 14.3 1. Using induction on the positive integer n, establish the following formulas: (a) u1 + 2u2 + 3u3 +···+nun = (n + l)un+2 - Un+4 + 2. (b) u2 + 2u4 + 3u6 + · · · + nu2n = nu2n+ l - Uzn· 2. (a) Show that the sum of the first n Fibonacci numbers with odd indices is given by the formula U1 + U3 + U5 + ... + Uzn-1 = Uzn [Hint: Add the equalities U1 = Uz, U3 = U4 - Uz, U5 = U6 - U4, .... ] (b) Show that the sum of the first n Fibonacci numbers with even indices is given by the formula Uz + U4 + U6 + · · · + Uzn = Uzn+ 1 - 1 [Hint: Apply part (a) in conjunction with identity in Eq. (2).] 300 ELEMENTARY NUMBER THEORY ( c) Derive the following expression for the alternating sum of the first n :=::: 2 Fibonacci numbers: 3. From Eq. (1), deduce that 4. Use the results of Problem 3 to obtain the following identities: (a) u�+I + u�_2 = 2u2n-I, n '.'.::: 3. (b) u�+2 + u�-I = 2(u� + u�+I), n '.'.::: 2. 5. Establish that the formula UnUn-I = u� - u�-I + ( - lt n :=::: 2 holds for n :=::: 2 and use this to conclude that consecutive Fibonacci numbers are relatively prime. 6. Without resorting to induction, derive the following identities: (a) u�+I - 4unun-I = u�_2, n '.'.::: 3. [Hint: Start by squaring both Un-2 =Un - Un-I and Un+I =Un+ Un-I·] (b) Un+IUn-I - Un+2Un-2 = 2(-lt, n '.'.::: 3. [Hint: Put Un+2 = Un+I +Un, Un-2 =Un - Un-I and use Eq. (3).] (c) u� - Un+2Un-2 = (-l)n, n '.'.::: 3. [Hint: Mimic the proof of Eq. (3).] (d) U� - Un+3Un-3 = 4(-l)n+I , n '.'.::: 4. (e) UnUn+IUn+3Un+4 = U�+2 - 1, n '.'.::: 1. [Hint: By part (c), Un+4Un = u�+2 + (-l)n+I , whereas by Eq. (3), Un+IUn+3 = U�+2 + (-lt+2.] 7. Represent the integers 50, 75, 100, and 125 as sums of distinct Fibonacci numbers. 8. Prove that every positive integer can be written as a sum of distinct terms from the sequence u2, u3, u4, ... (that is, the Fibonacci sequence with uI deleted). 9. Establish the identity n :=::: 1 and use this to generate five primitive Pythagorean triples. 10. Prove that the product UnUn+IUn+2Un+3 of any four consecutive Fibonacci numbers is equal to the area of a Pythagorean triangle. [Hint: See the previous problem.] 11. From the Binet formula for Fibonacci numbers, derive the relation n :=::: 1 12. For n '.'.::: 1, show that the product u2n-IU2n+5 can be expressed as the sum of two squares. [Hint: Problem 6(d).] 13. (a) Prove that if p = 4k + 3 is prime, then p cannot divide a Fibonacci number with an odd index; that is, p l u2n-I for all n '.'.::: 1. [Hint: In the contrary case, u� + u�-I = u2n-I = 0 (mod p). See Problem 12, Section 5.3.] (b) From part (a) conclude that there are infinitely many primes of the form 4k + 1. [Hint: Consider the sequence {up}, where p > 5 is prime.] ABONACCI NUMBERS 301 14. Verify that the product u2nu2n+2u2n+4 of three consecutive Fibonacci numbers with even indices is the product of three consecutive integers; for instance, we have u4u6us = 504 = 7 . 8 . 9. [Hint: First show that u2nU2n+4 = u�n+2 - l.] 15. Use Eqs. (1) and (2) to show that the sum of any 20 consecutive Fibonacci numbers is divisible by u10. 16. For n ::'.'.: 4, prove that Un + 1 is not a prime. [Hint: It suffices to establish the identities U4k + 1 = U2k-l (u2k + U2k+2) U4k+l + 1 = U2k+l(U2k-l + U2k+l) U4k+2 + 1 = U2k+2(U2k+l + U2k-I) U4k+3 + 1 = U2k+l (U2k+l + U2k+3).] 17. The Lucas numbers are defined by the same recurrence formula as the Fibonacci numbers, n ::'.'.: 3 but with Li = 1 and L1 = 3; this gives the sequence 1, 3, 4, 7, 11, 18, 29, 47, 76, 123, 199, 322, .... For the Lucas numbers, derive each of the identities below: (a) Li + L1 + L3 + · · · + Ln = Ln+2 - 3, n ::'.'.: 1. (b) Li + L3 +Ls+···+ L1n-1 = L1n - 2, n ::'.'.: 1. ( c) L1 + L4 + L6 + · · · + L1n = L1n+ i - 1, n ::'.'.: 1. (d) L� = Ln+lLn-1 + 5(-lt, n ::'.'.: 2. (e) LI + L� + L� + · · · + L� = LnLn+I - 2, n ::'.'.: 1. (f) L�+1 - L� = Ln-1Ln+2, n ::'.'.: 2. 18. Establish the following relations between the Fibonacci and Lucas numbers: (a) Ln = Un+l +Un-I = Un + 2un-l, n ::'.'.: 2. [Hint: Argue by induction on n .] (b) Ln = Un+2 - Un-2· n ::: 3. (c) U2n = UnLn, n ::'.'.: 1. (d) Ln+I + Ln-1 = Sun, n ::'.'.: 2. (e) L� = u� + 4un+IUn-I, n ::'.'.: 2. (f) 2um+n = UmLn + LmUn, m ::: 1, n ::: 1. (g) gcd(un, Ln) = 1 or 2, n ::'.'.: 1. 19. lfa = (1 + ,,/5)/2 andf3 = (1 - ,,/5)/2, obtain theBinetformulafor theLucas numbers n ::'.'.: 1 20. For the Lucas sequence, establish the following results without resorting to induction: (a) L� = L1n + 2(-l) n, n ::'.'.: 1. (b) LnLn+I - L1n+i = (-lt, n ::'.'.: 1. (c) L� - Ln-1Ln+l = 5(-lt, n ::'.'.: 2. (d) L1n + 7(-lt = Ln-2Ln+2, n ::'.'.: 3. 21. Use the Binet formulas to obtain the relations below: (a) L� - 5u� = 4(-l) n , n ::'.'.: 1. (b) L1n+l = SunUn+l + (-lt, n::: 1. (c) L� - u� = 4un-1Un+1, n ::'.'.: 2. (d) LmLn + 5UmUn = 2Lm+n• m ::: 1, n ::: 1. 22. Show that the Lucas numbers L4, L8, L16, L32, ... all have 7 as the final digit; that is, L1· = 7 (mod 10) for n ::'.'.: 2. [Hint: Induct on the integer n and appeal to the formula L� = L2n + 2(-lt .] CHAPTER 15 CONTINUED FRACTIONS A mathematician, like a painter or a poet, is a maker of patterns. If his patterns are more permanent than theirs, it is because they are made with ideas. G. H.HARDY 15.1 SRINIVASA RAMANUJAN From time to time India has produced mathematicians of remarkable power, but Srinivasa Ramanujan (1887-1920) is universally considered to have been its greatest genius. He was born in the southern Indian town of Erode, near Madras, the son of a bookkeeper in a cloth merchant's shop. He began his single-minded pursuit of mathematics when, at the age of 15 or 16, he borrowed a copy of Carr's Synopsis of Pure Mathematics. This unusual book contained the statements of over 6000 theorems, very few with proofs. Ramanujan undertook the task of establishing, without help, all the formulas in the book. In 1903, he won a scholarship to the University of Madras, only to lose it a year later for neglecting other subjects in favor of mathematics. He dropped out of college in disappointment and wandered the countryside for the next several years, impoverished and unemployed. Compelled to seek a regular livelihood after marrying, Ramanujan secured (1912) a clerical position with the Madras Port Trust Office, a job that left him enough time to continue his work in mathematics. After publishing his first paper in 1911, and two more the next year, he gradually gained recognition. At the urging of influential friends, Ramanujan began a correspondence with the leading British pure mathematician of the day, G. H. Hardy. Appended to his letters to Hardy were lists of theorems, 120 in all, some definitely proved and others only 303 304 ELEMENTARY NUMBER THEORY This photograph does not appear in the Srinivasa Ramanujan eBook version of this text. (1887-1920) (Trinity College Library, Cambridge) conjectured. Examining these with bewilderment, Hardy concluded that \"they could only be written down by a mathematician of the highest class; they must be true because if they were not true, no one would have the imagination to invent them.\" Hardy immediately invited Ramanujan to come to Cambridge University to develop his already great, but untrained, mathematical talent. Up to that time, Ramanujan had worked almost totally isolated from modem European mathematics. Supported by a special scholarship, Ramanujan arrived in Cambridge in April 1914. There he had 3 years of uninterrupted activity, doing much of his best work in collaboration with Hardy. Hardy wrote to Madras University saying, \"He will return to India with a scientific standing and reputation such as no Indian has en­ joyed before.\" However, in 1917, Ramanujan became incurably ill. His disease was diagnosed at that time as tuberculosis, but it is now thought to have been a severe vitamin deficiency. (A strict vegetarian who cooked all of his own food, Ramanujan had difficulty maintaining an adequate diet in war-rationed England.) Early in 1919 when the seas were finally considered safe for travel, he returned to India. In ex­ treme pain, Ramanujan continued to do mathematics while lying in bed. He died the following April, at the age of 32. The theory of partitions is one of the outstanding examples of the success of the Hardy-Ramanujan collaboration. A partition of a positive integer n is a way of writing n as a sum of positive integers, the order of the summands being irrelevant. The integer 5, for example, may be partitioned in seven ways: 5, 4 + 1, 3 + 2, 3 + 1 + 1, 2 + 2 + 1, 2 + 1 + 1 + 1, 1 + 1 + 1 + 1 + 1. If p(n) denotes the total number of partitions of n, then the values of p(n) for the first six positive integers are p(l) = 1, p(2) = 2, p(3) = 3, p(4) = 5, p(5) = 7 and p(6) = 11. Actual computation shows that the partition function p(n) increases very rapidly with n; for instance, p(200) has the enormous value p(200) = 3972999029388 CONTINUED FRACTIONS 307 where a0, a 1, ... , an are real numbers, all of which except possibly a0 are positive. The numbers ai, a1, ... , an are the partial denominators of this fraction. Such a fraction is called simple if all of the ai are integers. Although giving due credit to Fibonacci, most authorities agree that the theory of continued fractions begins with Rafael Bombelli, the last of the great algebraists of Renaissance Italy. In his L'Algebra Opera (1572), Bombelli attempted to find square roots by means of infinite continued fractions-a method both ingenious and novel. He essentially proved that ,JU could be expressed as the continued fraction ,JU= 3 + __ 4_ 4 _ 6+ 4 6+ - 6+ It may be interesting to mention that Bombelli was the first to popularize the work of Diophantus in the Latin West. He set out initially to translate the Vatican Library's copy of Diophantus's Arithmetica (probably the same manuscript uncovered by Regiomontanus), but, carried away by other labors, never finished the project. In­ stead, he took all the problems of the first four Books and embodied them in his Algebra, interspersing them with his own problems. Although Bombelli did not dis­ tinguish between the problems, he nonetheless acknowledged that he had borrowed freely from the Arithmetica. Evidently, the value of any finite simple continued fraction will always be a rational number. For instance, the continued fraction 1 3+ ------ 1 4+ --- 1 1 + 1 4+ 2 can be condensed to the value 170/53: 3+ 1 1 = 3+ 1 1 4+ 1 4+ 1+ � 1+ 9 4+ 1 2 1 =3+ -- 4+ i1 11 = 3+ 53 170 53 308 ELEMENTARY NUMBER THEORY Theorem 15.1. Any rational number can be written as a finite simple continued fraction. Proof. Let a/b, where b > 0, be an arbitrary rational number. Euclid's algorithm for finding the greatest common divisor of a and b gives us the equations a = bao + ri 0 < ri < b b = r1a1 + rz 0 < rz < ri ri = rza2 + r3 0 < r3 < rz rn-2 = rn-lan-1 + rn 0 < rn < rn-1 rn-1 = rnan + 0 Notice that because each remainder rk is a positive integer, a1, a2, ... , an are all posi­ tive. Rewrite the equations of the algorithm in the following manner: a ri 1 b = ao + b = ao + b rl b rz 1 -=al + -= a1 + r rl ri 1 rz rl r3 1 -= az + -= az + r r2 r2 2 r3 If we use the second of these equations to eliminate b / r1 from the first equation, then a 1 1 -=ao+-=ao+ --- b b 1 al+ -r-1 In this result, substitute the value of r1 / r2 as given in the third equation: a 1 b = ao + ----l-- a1 + ---1 az + T2 r3 Continuing in this way, we can go on to get a 1 b = ao + ----l-- a1 + ---- 1 a1+ -­ a3 + thereby finishing the proof. 1 CONTINUED FRACTIONS 309 To illustrate the procedure involved in the proof of Theorem 15.1, let us represent 19/51 as a continued fraction. An application of Euclid's algorithm to the integers 19 and 51 gives the equations 51=2 . 19 + 13 or 51/19 = 2 + 13/19 19 = 1 . 13 + 6 or 19/13 = 1 +6/13 13 = 2 . 6 + 1 or 13/6 = 2 + 1/6 6=6·1+0 or 6/6 = 1 Making the appropriate substitutions, it is seen that 19 51 1 1 � - 2+ 11 19 19 1 1 2+ 19 TI 1 1 2+ 6 1 + TI 1 2+ 1 1 1+13 6 1 2+ 1 1 1+ 1 2+- 6 which is the continued fraction expansion for 19/51. 310 ELEMENTARY NUMBER THEORY Because continued fractions are unwieldy to print or write, we adopt the conven­ tion of denoting a continued fraction by a symbol that displays its partial quotients, say, by the symbol [a0;a1, ... , an]. In this notation, the expansion for 19/51 is indi­ cated by [O; 2, 1, 2, 6] and for 172 / 51 = 3 + 19 / 51 by [3; 2, 1, 2, 6] The initial integer in the symbol [a0; a1, ... , an] will be zero when the value of the fraction is positive but less than one. The representation of a rational number as a finite simple continued fraction is not unique; once the representation has been obtained, we can always modify the last term. For, if an > 1, then 1 an = (an - 1) + 1 = (an - 1) + - 1 where an - 1 is a positive integer; hence, [ ao; a 1. . .. , an] = [ ao; a 1 , ... , an - 1, 1] On the other hand, if an = 1, then so that 1 1 an-1 + -= an-1 + -= an-1 + 1 an 1 Every rational number has two representations as a simple continued fraction, one with an even number of partial denominators and one with an odd number (it turns out that these are the only two representations). In the case of 19/51, 19/51=[0;2,1,2,6] = [0;2, 1,2,5, 1] Example 15.1. We go back to the Fibonacci sequence and consider the quotient of two successive Fibonacci numbers (that is, the rational number Un+if un) written as a simple continued fraction. As pointed out earlier, the Euclidean Algorithm for the greatest common divisor of Un and Un+l produces then - 1 equations Un+l = 1 . Un+ Un-1 Un = 1 · Un-1 + Un-2 U4 = 1 · U3 + U2 U3 = 2 · U2 + 0 Because the quotients generated by the algorithm become the partial denominators of the continued fraction, we may write Un+l - = [l; 1, 1, ... ' 1, 2] Un CONTINUED FRACTIONS 311 But Un+ifun is also represented by a continued fraction having one more partial de­ nominator than does [1; 1, 1, ... , 1, 2]; namely, Un+l - = [1; 1, 1, ... ' 1, 1, 1] Un where the integer 1 appears n times. Thus, the fraction Un+i/un has a continued fraction expansion that is very easy to describe: There are n - 1 partial denominators all equal to 1. As a final item on this part of our program, we would like to indicate how the theory of continued fractions can be applied to the solution of linear Diophantine equations. This requires knowing a few pertinent facts about the \"convergents\" of a continued fraction, so let us begin proving them here. Definition 15.2. The continued fraction made from [a0; a1, ... , an] by cutting off the expansion after the kth partial denominator ak is called the kth convergent of the given continued fraction and denoted by Ck; in symbols, We let the zeroth convergent Co be equal to the number ao. A point worth calling attention to is that for k < n if ak is replaced by the value ak + 1/ak+1, then the convergent Ck becomes the convergent Ck+ 1; [ao; al, ... , ak-1 • ak + - 1 -] ak+l = [ao; ai, ... , ak-1 ·ab ak+il = Ck+l It hardly needs remarking that the last convergent Cn always equals the rational number represented by the original continued fraction. are Going back to our example 19/51 = [0; 2, 1, 2, 6], the successive convergents Co= 0 1 1 c 1 = [0; 2] = 0 + 2 = 2 1 1 C2 = [O; 2, 1] = 0 + 2 + ! 3 1 1 C3 = [0; 2, 1, 2] = 0 + --- 1 - 2+ 1 1+2 C4 = [0;2, 1, 2, 6] = 19/51 3 8 Except for the last convergent C4, these are alternately less than or greater than 19/51, each convergent being closer in value to 19/51 than the previous one. Much of the labor in calculating the convergents of a finite continued fraction [ao; ai, ... , an] can be avoided by establishing formulas for their numerators and 312 ELEMENTARY NUMBER THEORY denominators. To this end, let us define numbers Pk and qk (k = 0, 1, ... , n) as follows: Po= ao Pl= aiao + 1 Pk= akPk-1 + Pk-2 qo = 1 qi= ai qk = akqk-1 + qk-2 fork = 2, 3, ... , n. are A direct computation shows that the first few convergents of [a0; a1, ... , an] ao Po Co =ao = -= - 1 qo 1 aiao + 1 Pl C1 = ao + -= ---- a1 ai qi 1 C2 = ao + --- 1- a 1 +­ a2 a2(a1ao + 1) + ao a2a1 + 1 Success hinges on being able to show that this relationship continues to hold. This is the content of Theorem 15.2. Theorem 15.2. The kth convergent of the simple continued fraction [a0; aI, ... , an] has the value Proof. The previous remarks indicate that the theorem is true for k = 0, 1, 2. Let us assume that it is true fork= m, where 2:::::;: m < n; that is, for this m, Pm amPm-I + Pm-2 Cm = - = ------ qm amqm-I + qm-2 (1) Note that the integers Pm-I, qm-I, Pm-2. qm-2 depend on the first m - 1 partial de­ nominators a I , a1, ... , am-1 and, hence, are independent of am. Thus, Eq. ( 1) remains valid if am is replaced by the value am + 1/am+1: [ao;aI, ... , am-I. am+ - 1-] am+I (am+ - 1-) Pm-I+ Pm-2 am+l CONTINUED FRACTIONS 313 As has been explained earlier, the effect of this substitution is to change Cm into the convergent Cm+l • so that (am+ - 1-) Pm-l + Pm-2 am+l Cm+l = - ( ----- ) ----� am+ _l_ qm-l + qm-2 am+l am+1(amPm-1 + Pm-2) + Pm-1 am+1(amqm-l + qm-2) + qm-l am+lPm + Pm-l am+lqm + qm-1 However, this is precisely the form that the theorem should take in the case in which k = m + 1. Therefore, by induction, the stated result holds. Let us see how this works in a specific instance, say, 19/51 = [O; 2, 1, 2, 6]: Po= 0 Pl= 0 · 2 + 1=1 P2 = 1·1+0 = 1 p3 = 2. 1+1 = 3 p4 = 6. 3 + 1 = 19 and qo = 1 qi= 2 q2 = 1. 2 + 1 = 3 q3 = 2. 3 + 2 = 8 q4 = 6. 8 + 3 = 51 This says that the convergents of [O; 2, 1, 2, 6] are Co= Po = 0 qo p3 3 C3 = - = - q3 8 as we know that they should be. The integers Pk and qk were defined recursively for 0 _:::: k _:::: n. We might have chosen to put P-2 = 0, P-1 = 1 and One advantage of this agreement is that the relations Pk = akPk-1 + Pk-2 and k = 0, 1, 2, ... , n would allow the successive convergents of a continued fraction [a0; a1, ... , an] to be calculated readily. There is no longer a need to treat p0/ q0 and pi/ q1 separately, because they are obtained directly from the first two values of k. It is often convenient to arrange the required calculations in tabular form. To illustrate with the continued it is apparent that Uk ck= -- k � 2 Uk+l CONTINUED FRACTIONS 315 where the symbol Uk denotes the kth Fibonacci number. In the present context, the identity Pkqk-1 - qkPk-1 = (-l)k-l of Theorem 15.3 assumes the form 2 ( l)k-1 Uk - Uk+lUk-1 = - This is precisely Eq. (3) on page 292. Let us now turn to the linear Diophantine equation ax+ by= c where a, b, c are given integers. Because no solution of this equation exists if d ;( c, where d = gcd(a, b), there is no harm in assuming that d I c. In fact, we need only concern ourselves with the situation in which the coefficients are relatively prime. For if gcd(a, b) = d > 1, then the equation may be divided by d to produce a b c d x + d y = d Both equations have the same solutions and, in the latter case, we know that gcd(a/d, b/d) = 1. Observe, too, that a solution of the equation ax + by = c gcd(a, b) = 1 may be obtained by first solving the Diophantine equation ax +by= 1 gcd(a,b) = 1 Indeed, if integers xo and Yo can be found for which axo + byo = 1, then multipli­ cation of both sides by c gives a(cxo) + b(cyo) = c Hence, x = cx0 and y = cy0 is the desired solution of ax + by = c. To secure a pair of integers x and y satisfying the equation ax + by = 1, expand the rational number a/ b as a simple continued fraction; say, a b = [ ao; a i, ... , an] Now the last two convergents of this continued fraction are Pn-l Pn a Cn-l = -- and Cn = - = - qn-l qn b Because gcd(pn, qn) = 1 = gcd(a, b), it may be concluded that Pn =a By virtue of Theorem 15.3, we have and Pnqn-1 - qnPn-l = (-1r -1 or, with a change of notation, aqn-1 - bpn-1 = (-1r-1 316 ELEMENTARY NUMBER THEORY Thus, with x = qn-1 and y = -Pn-1, we have ax+ by= (-lt-1 If n is odd, then the equation ax+ by = 1 has the particular solution xo = qn_1, Yo = -Pn-1; whereas if n is an even integer, then a solution is given by xo = -qn-1. Yo = Pn-1· Our earlier theory tells us that the general solution is X =XO+ bt y =Yo - at t = 0, ±1, ±2, ... Example 15.3. Let us solve the linear Diophantine equation 172x + 20y = 1000 by means of simple continued fractions. Because gcd(l 72, 20) = 4, this equation may be replaced by the equation 43x +Sy= 2SO The first step is to find a particular solution to 43x +Sy= 1 To accomplish this, we begin by writing 43/S (or if one prefers, S/43) as a simple continued fraction. The sequence of equalities obtained by applying the Euclidean Algorithm to the numbers 43 and S is so that 43 = 8 . s + 3 S=1·3+2 3=1·2+1 2 = 2 · 1 1 43/S = [8; 1, 1, 2] = 8 + 1 1+ -- 1 + .1 2 The convergents of this continued fraction are Co= 8/1 C1 = 9/1 C2=17/2 C3 = 43/S from which it follows that p2 = 17, q1 = 2, p3 = 43, and q3 = S. Falling back on Theorem lS.3 again, or in equivalent terms, 43 . 2 - s . 17 = 1 When this relation is multiplied by 2SO, we obtain 43 . soo + S( -42SO) = 2SO Thus, a particular solution of the Diophantine equation 43x + Sy = 2SO is Xo =SQQ Yo= -42SO CONTINUED FRACTIONS 317 The general solution is given by the equations x = 500 + 5t y = -4250 - 43t t = 0, ±1, ±2, ... Before proving a theorem concerning the behavior of the odd- and even­ numbered convergents of a simple continued fraction, we need a preliminary lemma. Lemma. If qk is the denominator of the kth convergent Ck of the simple continued fraction [ao;a1, ... , an], then qk-l ::S qk for 1 ::S k ::Sn, with strict inequality when k > 1. Proof. We establish the lemma by induction. In the first place, q0 = 1 ::S a1 = q1, so that the asserted equality holds when k = 1. Assume, then, that it is true fork= m, where 1 ::Sm < n. Then so that the inequality is also true for k = m + 1. With this information available, it is an easy matter to prove Theorem 15.4. Theorem 15.4. (a) The convergents with even subscripts form a strictly increasing sequence; that is, Co< C2 < C4 < · · · (b) The convergents with odd subscripts form a strictly decreasing sequence; that is, Ci> C3 >Cs>··· ( c) Every convergent with an odd subscript is greater than every convergent with an even subscript. Proof. With the aid of Theorem 15.3, we find that ck+2 - ck = (Ck+2 -Ck+1) + (Ck+l -Ck ) = (Pk+2 _ Pk+I) + (Pk+l _Pk) �� �+1 �+l � (-l)k+l (-l)k = + -- qk+2qk+l qk+lqk (-l)k(qk+2 -qk) qkqk+lqk+2 Recalling that qi > 0 for all i � 0 and that qk+Z -qk > 0 by the lemma, it is evident that Ck+2 - Ck has the same algebraic sign as does (-l)k. Thus, if k is an even integer, say k = 2j, then C2j+2 > C2j; whence Co< C2 < C4 < · · · Similarly, if k is an odd integer, say k = 2j - 1, then C2j+l < C2j-1; whence C1 > C3 >Cs>··· 318 ELEMENTARY NUMBER THEORY It remains only to show that any odd-numbered convergent C2,_1 is greater than any even-numbered convergent C2s. Because Pkqk-1 - qk Pk-1 = (-1 )k-l , upon dividing both sides of the equation by qkqk-1, we obtain Pk Pk-1 (-l)k-l Ck - Ck-t = - - -- = --- qk qk-1 qkqk-1 This means that C2j < C2j-l · The effect of tying the various inequalities together is that as desired. To take an actual example, consider the continued fraction [2; 3, 2, 5, 2, 4, 2]. A little calculation gives the convergents Co= 2/1 C1 = 7 /3 C2 = 16/7 C3 = 87 /38 C4 = 190/83 Cs= 847 /370 c6 = 1884/8 23 According to Theorem 15 .4, these convergents satisfy the chain of inequalities 2 < 16/7 < 190/83 < 1884/8 23 < 847/370 < 87/38 < 7/3 This is readily visible when the numbers are expressed in decimal notation: 2 < 2.28571 ... < 2.28915 ... < 2.28918 ... < 2.28947 ... < 2.33333 ... PROBLEMS 15.2 1. Express each of the rational numbers below as finite simple continued fractions: (a) -19/51. (b) 187/57. (c) 71155. ( d) 118/303. 2. Determine the rational numbers represented by the following simple continued fractions: (a) [-2;2,4,6,8]. (b) [4; 2, 1, 3, 1, 2, 4]. (c) [0; 1, 2, 3, 4, 3, 2, 1]. 3. If r = [ao; ai, az, ... , an], where r > 1, show that 1 - = [O;ao, a1, ... , an ] r 4. Represent the following simple continued fractions in an equivalent form, but with an odd number of partial denominators: (a) [O; 3, 1, 2, 3]. (b) [-1;2, 1, 6, 1]. (c) [2; 3, 1, 2, 1, 1, l]. 5. Compute the convergents of the following simple continued fractions: (a) [1; 2, 3, 3, 2, 1]. (b) [-3; 1, 1, 1, 1, 3]. (c) [O; 2, 4, 1, 8, 2]. CONTINUED FRACTIONS 319 6. (a) If Ck = Pk/qk denotes the kth convergent of the finite simple continued fraction [1; 2, 3, 4, ... , n, n + 1] , show that Pn = nPn-1 + npn-2 + (n - l)Pn-3 + · · · + 3 p1 + 2po +(po+ 1) [Hint: Add the relations Po = 1, P1 = 3, Pk = (k + OPk-1 + Pk-2 for k = 2, ... , n.] (b) Illustrate part (a) by calculating the numerator p4 for the fraction [l; 2, 3, 4, 5]. 7. Evaluate Pb qko and Ck(k = 0, 1, ... , 8) for the simple continued fractions below; notice that the convergents provide an approximation to the irrational numbers in parentheses: (a) [1; 2, 2, 2, 2, 2, 2, 2, 2] ( J2). (b) [l; 1, 2, 1, 2, 1, 2, 1, 2] (J3). (c) [2; 4, 4, 4, 4, 4, 4, 4, 4] ( J5). (d) [2; 2, 4, 2, 4, 2, 4, 2, 4] (J6). (e) [2; 1, 1, 1, 4, 1, 1, 1, 4] (,Ji). 8. If Ck = Pk/qk is the kth convergent of the simple continued fraction [ao; ai, ... , an] , establish that q > 2Ck-1)/2 k- [Hint: Observe that qk = akqk-1 + qk-2 � 2qk-2 ·] 9. Find the simple continued fraction representation of 3.1416, and that of 3.14159. 10. If Ck = Pk/qk is the kth convergent of the simple continued fraction [ao; ai, ... , an] and ao > 0, show that and qk -- = [ak; ak-I, ... , a1, ai] qk-1 [Hint: In the first case, notice that ....!!!:__ = ak + Pk-2 Pk-1 Pk-1 1 = ak + -p - · ] k-1 Pk-2 11. By means of continued fractions determine the general solutions of each of the following Diophantine equations: (a) 19x + 51y = 1. (b) 364x + 227y = 1. (c) 18x + 5y = 24. (d) 158x - 5 1y = 1. 12. Verify Theorem 15.4 for the simple continued fraction [1; 1, 1, 1, 1, 1, 1, 1]. 15.3 INFINITE CONTINUED FRACTIONS Up to this point, only finite continued fractions have been considered; and these, when simple, represent rational numbers. One of the main uses of the theory of continued fractions is finding approximate values of irrational numbers. For this, the notion of an infinite continued fraction is necessary. 320 ELEMENTARY NUMBER THEORY An in.finite continued fraction is an expression of the form b1 ao+ ------­ b2 ai + b3 a2+ --­ a3 + ... where a0, a1, a2, ... and b1, b2, b3, ... are real numbers. An early example of a fraction of this ty pe is found in the work of William Brouncker who converted (in 1655) Wallis's famous infinite product into the identity 4 3.3.5.5.7.7 ... T( 2·4·4·6·6·8· .. 4 12 - = 1 + -------- T( 32 2+------ 52 2+---- 72 2+-- 2+··· Both Wallis's and Brouncker's discoveries aroused considerable interest, but their direct use in calculating approximations to rr is impractical. In evaluating infinite continued fractions and in expanding functions in con­ tinued fractions, Srinivasa Ramanujan has no rival in the history of mathematics. He contributed many problems on continued fractions to the Journal of the Indian Mathematical Society, and his notebooks contain about 200 results on such fractions. G. H. Hardy, commenting onRamanujan's work, said \"On this side [of mathematics] most certainly I have never met his equal, and I can only compare him with Euler or Jacobi.\" Perhaps the most celebrated of Ramanujan's fraction expansions is his assertion that e2ff /5 (/ 5+ 2 ./5 - 1 + 2 ./5) = - 1 - +--� ---2rr-- e-4rr 1 +---- e-6rr 1+--- 1 + ... Part of its fame rests on its inclusion by Ramanujan in his first letter to Hardy in 1913. Hardy found the identity startling and was unable to derive it, confessing later that a proof \"completely defeated \" him. Although most of Ramanujan's marvelous formulas have now been proved, it is still not known what passage he took to discover them. CONTINUED FRACTIONS 321 In this section, our discussion will be restricted to infinite simple continued fractions. These have the form 1 ao + -------- 1 al+ ----- 1 az+ --- a3 + ... where a0, a1, a2, ... is an infinite sequence of integers, all positive except possibly for a0. We shall use the compact notation [ao; a1, a2, ... ] to denote such a fraction. To attach a mathematical meaning to this expression, observe that each of the finite continued fractions n>O is defined. It seems reasonable therefore to define the value of the infinite continued fraction [ao; al, az, ... ] to be the limit of the sequence of rational numbers Cn, provided, of course, that this limit exists. In something of an abuse of notation, we shall use [ a0; a 1, a2, •.. ] to indicate not only the infinite continued fraction, but also its value. The question of the existence of the just-mentioned limit is easily settled. For, under our hypothesis, the limit not only exists but is always an irrational number. To see this, observe that formulas previously obtained for finite continued fractions remain valid for infinite continued fractions, because the derivation of these relations did not depend on the finiteness of the fraction. When the upper limits on the indices are removed, Theorem 15 .4 tells us that the convergents C n of [ a0; a 1, a2, ... ] satisfy the infinite chain of inequalities: Co< C2 < C4 < · · · < C2n < · · · < C2n+1 < · · · <Cs< C3 < C1 Because the even-numbered convergents C2n form a monotonically increasing se­ quence, bounded above by C 1, they will converge to a limit a that is greater than each C2n. Similarly, the monotonically decreasing sequence of odd-numbered con­ vergents C2n+ 1 is bounded below by Co and so has a limit a' that is less than each C2n+ 1. Let us show that these limits are equal. On the basis of the relation P2n+ 1 qzn - qzn+ 1 P2n = ( -1 )2n we see that whence, 1 P2n+l P2n a -a< C2n+l - C2n = -- - - qzn+l 1 1 O<la'-a l<--- <-2- q2nq2n+1 q2n 1 Because the q; increase without bound as i becomes large, the right-hand side of this inequality can be made arbitrarily small. If a' and a were not the same, then a con­ tradiction would result (that is, l/qin could be made less than the value I a' -a I). Thus, the two sequences of odd- and even-numbered convergents have the same limiting value a, which means that the sequence of convergents C n has the limit a. CONTINUED FRACTIONS 323 Theorem 15.5. The value of any infinite continued fraction is an irrational number. Proof. Let us suppose that x denotes the value of the infinite continued fraction [a0; a1, a2, ... ]; that is, x is the limit of the sequence of convergents Pn Cn = [ao;a1, a2, ... , an]= - qn Because x lies strictly between the successive convergents Cn and Cn+l• we have I Pn+l Pn I 1 0 <Ix - Cn I< I Cn+l - Cn I= -- -- = --- qn+l qn qnqn+l With the view to obtaining a contradiction, assume that x is a rational number; say, x = a/b, where a and b > 0 are integers. Then 0< --- <---I a Pn I 1 b qn qnqn+l and so, upon multiplication by the positive number bqn, b 0 < I aqn - bpn I < -­ qn+l We recall that the values of qi increase without bound as i increases. If n is chosen so large that b < qn+ 1, the result is 0 < I aqn - bpn I < 1 This says that there is a positive integer, namely I aqn - bpn I, between 0 and 1-an obvious impossibility. We now ask whether two different infinite continued fractions can represent the same irrational number. Before giving the pertinent result, let us observe that the properties of limits allow us to write an infinite continued fraction [ ao; a 1, az, ... ] as [ao; ai, az, ... ] = lim [ao; ai, ... , an] Our theorem is stated as follows. n-'HXJ = lim (ao + 1 ) n�oo [a1; az, ... , an] 1 = ao + -------­ lim [a1; az, ... , an] n�oo 1 =ao+ -----­ [a1;a2, a3, ... ] Theorem 15.6. If the infinite continued fractions [ a0; a 1, a2, ... ] and [ b0; b1, b2, ... ] are equal, then an = bn for all n :'.'.:: 0. Proof. If x = [ao; al, a1, ... ], then Co < x < C1, which is the same as saying that a0 < x < a0 + 1/a1. Knowing that the integer a 1 :'.'.:: 1, this produces the inequality a0 < x < a0 + 1. Hence, [ x] = a0, where [ x] is the traditional notation for the greatest integer or \"bracket\" function (page 117). 324 ELEMENTARY NUMBER THEORY Now assume that [a0;a1, a2, ... ] = x = [b0;b1, b2, ... ] or, to put it in a different form, 1 1 ao+ =x=bo+---- [a1;a2, ... ] [b1;b2, ... ] By virtue of the conclusion of the first paragraph, we have a0 = [ x] = b0 ,from which it may then be deduced that [a1; a2, ... ] = [b1; b2, ... ]. When the reasoning is repeated, we next conclude that a1 = b1 and that [a2; a3, ... ] = [b2; b3, ... ]. The process con- tinues by mathematical induction, thereby giving an = bn for all n :::=:: 0. Corollary. Two distinct infinite continued fractions represent two distinct irrational numbers. Example 15.4. To determine the unique irrational number represented by the infinite continued fraction x = [3; 6, 1, 4], let us write x = [3; 6, y ], where Then y = [1;4] = [1;4, y] 1 y 5y + 1 y=l+ =1+-- 4 + _!_ 4y + 1 4y + 1 y which leads to the quadratic equation 4y2 - 4y - 1=0 Inasmuch as y > 0 and this equation has only one positive root, we may infer that y= 1 + ,J2 2 From x = [3; 6, y ], we then find that that is, 1 x=3+ ---1- 6+--- 1 + ,J2 2 25 + 19,J2 8 + 6,J2 (25 + 19,J2)(8 - 6,J2) (8 + 6v'2)(8 - 6,J2) 14 - ,J2 4 - 14-,J2 [3;6, 1, 4] = 4 Our last theorem shows that every infinite continued fraction represents a unique irrational number. Turning matters around, we next establish that an arbitrary irra­ tional number x0 can be expanded into an infinite continued fraction [a0; a1, a2, ... ] CONTINUED FRACTIONS 325 that converges to the value x0. The sequence of integers a0, a1, a2, ... is defined as follows: Using the bracket function, we first let 1 X1 = ---­ Xo - [xo] and then take ao = [xo] 1 X2 = ---- X1 - [xi] az = [x2] In general, the ak are given inductively by 1 Xk+l = Xk - ak 1 X3 = ... X2 - [X2] It is evident that Xk+ 1 is irrational whenever Xk is irrational: thus, because we are confining ourselves to the case in which x0 is an irrational number, all xk are irrational by induction. Thus, and we see that 1 Xk+l = > 1 so that the integer ak+l = [xk+il > 1 for all k > 0. This process therefore leads to an infinite sequence of integers a0, a1, a2, ... , all positive except perhaps for a0. Employing our inductive definition in the form 1 Xk = ak + -­ Xk+l through successive substitutions, we obtain 1 xo = ao + - XI 1 =ao+ --- 1 ai +­ x2 1 =ao+ ----­ l ai+ --- 1 a2+­ X3 for every positive integer n. This makes one suspect-and it is our task to show-that x0 is the value of the infinite continued fraction [a0; a1, a2, ... ]. For any fixed integern,the firstn+lconvergentsCk = pk/qbwhereO < k :::=: n, of [a0; a1, a2, ... ] are the same as the first n + 1 convergents of the finite continued fraction [ao; ai, az, ... , an, Xn+1l If we denote the (n + 2)th convergent of the latter 326 ELEMENTARY NUMBER THEORY by C�+l• then the argument used in the proof of Theorem 15.2 to obtain Cn+l from Cn by replacing an by an+ 1/an+l works equally well in the present setting; this enables us to obtain c�+l from Cn+l by replacing lln+l by Xn+l: Because of this, Xn+lPn + Pn-1 Xn+lqn + qn-1 C _ Xn+lPn + Pn-1 Pn XO - n - Xn+lqn + qn-1 qn (- l)(pnqn-1 - qnPn-1) (Xn+lqn + qn-1)qn where the last equality relies on Theorem 15.3. Now Xn+l > an+h and therefore 1 1 I Xo - Cn I = < ------- (xn+lqn + qn-1)qn (an+lqn + qn-1)qn Because the integers qk are increasing, the implication is that xo = lim Cn = [ao; a1, a2, ... ] n---+oo Let us sum up our conclusions in Theorem 15.7. 1 Theorem 15. 7. Every irrational number has a unique representation as an infinite con­ tinued fraction, the representation being obtained from the continued fraction algorithm described. Incidentally, our argument reveals a fact worth recording separately. Corollary. If Pnf qn is the nth convergent to the irrational number x, then We give two examples to illustrate the use of the continued fraction algorithm in finding the representation of a given irrational number as an infinite continued fraction. Example 15.5. For our first example, consider x = J23 � 4.8. The successive irra­ tional numbers xk (and therefore the integers ak = [xk]) can be computed rather easily, CONTINUED FRACTIONS 327 with the calculations exhibited below: Xo = 53 = 4 + ( 53 -4) 1 1 J23+4 J23-3 X1 = = = = 1 + --- Xo - [xo] J23 -4 7 7 1 7 J23+3 J23-3 X2= = = =3+ --- Xt - [xi] J23 -3 2 2 1 2 J23+3 J23-4 X3 = = = = 1 + --- X2 - [x2] J23 -3 7 7 X4 = 1 = 7 = 53 + 4 = 8 + ( 53 -4) X3 - [x3] J23 -4 a0 =4 a3 = 1 Because x5 = x1, also X6 = x2, x7 = x3, xs = x4; then we get x9 = x5 = x1 , and so on, which means that the block of integers 1, 3, 1, 8 repeats indefinitely. We find that the continued fraction expansion of J23 is periodic with the form J23 = [4; 1, 3, 1, 8, 1, 3, 1, 8, ... ] = [4; 1, 3, 1, 8] Example 15.6. To furnish a second illustration, let us obtain several of the convergents of the continued fraction of the number lT = 3.141592653 ... defined by the ancient Greeks as the ratio of the circumference of a circle to its diameter. The letter n, from the Greek word perimetros, was never employed in antiquity for this ratio; it was Euler's adoption of the symbol in his many popular textbooks that made it widely known and used. By straightforward calculations, we see that xo = n = 3 + (n -3) 1 1 Xl = = = 7.0625133 0 · · · xo - [xo] 0.14159265 · · · 1 1 X2 = = = 15.9965944 0 · · · Xt - [xi] 0.0625133 0 · · · 1 1 X3 = = = 1.0 0341723 · · · X2 - [x2] 0.9965944 0 · · · 1 1 X4 = = = 292.63467 · · · X3 - [x3] 0.0 0341723 · · · Thus, the infinite continued fraction for n starts out as lT = [3; 7, 15, 1, 292, ... ] a0 = 3 a3 = 1 a4 = 292 but, unlike the case of J23 in which all the partial denominators an are explicitly known, there is no pattern that gives the complete sequence of an. The first five 330 ELEMENTARY NUMBER THEORY forthcoming theorem asserts that the convergents Pnf qn have the property of being the best approximations, in the sense of giving the closest approximation to x among all rational numbers a/ b with denominators qn or less. For clarity, the technical core of the theorem is placed in the following lemma. Lemma. Let Pnl qn be the nth convergent of the continued fraction representing the irrational number x. If a and bare integers, with 1 Sb< qn+l• then I qnx - Pn I S I bx - a I Proof. Consider the system of equations Pna + Pn+If3 =a qna + qn+I/3 = b As the determinant of the coefficients is Pnqn+l - qnPn+l = (-l)n+l, the system has the unique integral solution a = (-l)n+1(aqn+1 - hPn+1) f3 = (-1r+1(bpn - aqn) It is well to notice that a # 0. In fact, a = 0 yields aqn+l = hPn+l and, because gcd (Pn+l• qn+1) = 1, this means that qn+l I b or b 2'.: qn+l• which is contrary to the hypothesis. In the event that f3 = 0, the inequality stated in the lemma is clearly true. For f3 = 0 leads to a = Pna, b = qna and, as a result, I bx - a I = I a I I qnx - Pn I 2'.: I qnx - Pn I Thus, there is no harm in assuming hereafter that f3 # 0. When f3 # 0, we argue that a and f3 must have opposite signs. If f3 < 0, then the equation qna = b - qn+1f3 indicates that qna > 0 and, in turn, a > 0. On the other hand, if f3 > 0, then b < qn+l implies that b < f3qn+l• and therefore aqn = b - qn+1f3 < O; this makes a < 0. We also infer that, because x stands between the consecutive convergents Pnf qn and Pn+if qn+l• and will have opposite signs. The point of this reasoning is that the numbers and must have the same sign; in consequence, the absolute value of their sum equals the sum of their separate absolute values. It is this crucial fact that allows us to complete the proof quickly: I bx - a I = I (qna + qn+1f3)x - (pna + Pn+1f3) I = I a(qnx - Pn) + f3(qn+IX - Pn+1) I = I a I I qnx - Pn I+ I /31 I qn+l X - Pn+l I > I a I I qnx - Pn I 2'.: I qnx - Pn I which is the desired inequality. CONTINUED FRACTIONS 335 Journal de ['Ecol e Polytechnique. Farey, of course, had never claimed to have proved anything. We begin our investigation with one of the results stated by Farey but established earlier by Haros. Theorem 15.10. If � < fl are consecutive fractions in the Farey sequence Fn, then be -ad = 1. Proof. Because gcd(a, b) = 1, the linear equation bx -ay = 1 has a solution x = xo, y = yo. Moreover, x = xo + at, y = Yo + ht will also be a solution for any integer t. Choose t = to so that 0 :S n - b < Yo + bto :S n and set x = xo + bto, y = Yo + bto. Since y :::; n, � will be a fraction in Fn. Also, x a 1 a -=-+->- y b by b so that � occurs later in the Farey sequence than �. If � # fl, then � > fl and we obtain as well as x c --- y d c a --- d b dx -cy 1 >- dy - dy be-ad 1 >- bd - bd Adding the two inequalities gives x a 1 1 b+y --->---= -- y b - dy bd bdy But b + y > n (recall that n - b < y) and d :::; n, resulting in the contradiction 1 bx -ay x a b + y n 1 --- =---= -- >-->- by by y b bd y bd y - by Thus, � = fl and the equation bx -ay = 1 becomes be -ad = 1. If % < -J are two fractions in the Farey sequence Fn, we define their mediant fraction to be the expression ���. Theorem 15.10 allows us to conclude that the mediant lies between the given fractions. For the relations together imply that a(b + d) - b(a + e) = ad - be < 0 (a + e)d - (b + d)e = ad - be < 0 a a+ e e -< <- b b+d d Notice that if % < -J are consecutive fractions in Fn, and b + d < n, then the mediant would be a member of Fn lying between them, an obvious contradiction. Thus, for successive fractions, b + d > n + 1. CONTINUED FRACTIONS 337 Proof. The greatest integer function allows us to write x = [ x] + r where 0 < r < 1. By the theorem, there is a fraction � for which Ir - ; I < v(n � 1) Taking a= [x]v + u and b = v, it follows that I a I I [x]v + u I I u I 1 1 x - b = x - v = r - � < v(n + 1) = b(n + 1) Hence everything is proved. We finish with an example illustrating the corollary. Example 15. 7. Let us determine a fraction % with 0 < b :::; 5 such that 1,./7 - % I :::; 6� . The greatest integer function yields [ ,./7] - 2 = 0.64755 .... For the Farey sequence F5, the value 0.64755 ... lies in the interval between consecutive fractions � and �­ The mediant of the two fractions is i = 0.625 so that i < 0.64755 .... It follows from Theorem 15 .11 that 10.64755 ... - �I < _ l _ 3 6-3 The argument employed in the corollary shifts this inequality into IJ7- �1 < _ 1 3 6-3 so that � is the fraction sought. PROBLEMS 15.4 1. List in ascending order the fractions that appear in the Farey sequences F7 and F8. 2. In terms of the Euler </>-function, show that the number of fractions in the Farey sequence Fn is 1 + </J(l) + </>(2) + · · · + </J(n). 3. If % < -J are consecutive fractions in the sequence Fn, prove that either b > �or d > �- 4. Verify that if % < -J are two fractions in Fn adjacent to �, then % + -J = 1. 5. Obtain the immediate successor to the fraction i in the Farey sequence Fu. [Hint: Use the initial part of Theorem 15.10.] 6. Find a fraction % , with 0 < b :::; 7, such that I J3 - % I :::; 81b. 7. Obtain a fraction % , with 0 < b :::; 8, satisfying In - % I :::; 9 1b • 15.5 PELL'S EQUATION What little action Fermat took to publicize his discoveries came in the form of challenges to other mathematicians. Perhaps he hoped in this way to convince them that his new style of number theory was worth pursuing. In January of 1657, Fermat proposed as a challenge to the European mathematical community-thinking 338 ELEMENTARY NUMBER THEORY probably in the first place of John Wallis, England's most renowned practitioner be­ fore Newton-a pair of problems: 1. Find a cube which, when increased by the sum of its proper divisors, becomes a square; for example, 73 + (1+7 + 72) = 202. 2. Find a square which, when increased by the sum of its proper divisors, becomes a cube. On hearing of the contest, Fermat's favorite correspondent, Bernhard Frenicle de Bessy, quickly supplied a number of answers to the first problem; typical of these is (2 · 3 · 5 · 13 · 41 · 47)3, which when increased by the sum of its proper divisors becomes (27 · 32 · 52 · 7 · 13 · 17 · 29)2. While Frenicle advanced to solutions in still larger composite numbers, Wallis dismissed the problems as not worth his effort, writing, \"W hatever the details of the matter, it finds me too absorbed by numerous occupations for me to be able to devote my attention to it immediately; but I can make at this moment this response: The number 1 in and of itself satisfies both demands.\" Barely concealing his disappointment, Frenicle expressed astonishment that a mathematician as experienced as Wallis would have made only the trivial response when, in view of Fermat's stature, he should have sensed the problem's greater depths. Fermat's interest, indeed, lay in general methods, not in the wearying compu­ tation of isolated cases. Both Frenicle and Wallis overlooked the theoretic aspect that the challenge problems were meant to reveal on careful analysis. Although the phrasing was not entirely precise, it seems clear that Fermat had intended the first of his queries to be solved for cubes of prime numbers. To put it otherwise, the problem called for finding all integral solutions of the equation 1 + x + x 2 + x 3 = y2 or equivalently, (1 + x )(1 + x2) = y2 where xis an odd integer. Because 2 is the only prime that divides both factors on the left-hand side of this equation, it may be written as gcd(a, b) = 1 But if the product of two relatively prime integers is a perfect square, then each of them must be a square; hence, a = u2, b = v2 for some u and v, so that 1 + x = 2a = 2u2 1 + x 2 = 2b = 2v 2 This means that any integer x that satisfies Fermat's first problem must be a solution of the pair of equations x = 2u2 - 1 x 2 = 2v 2 - 1 the second being a particular case of the equation x 2 = dy 2 ± 1. CONTINUED FRACTIONS 339 In February 1657, Fermat issued his second challenge, dealing directly with the theoretic point at issue: Find a number y that will make dy2 + 1 a perfect square, where d is a positive integer that is not a square; for example, 3 · 12 + 1 = 22 and 5 · 42 + 1 = 92. If, said Fermat, a general rule cannot be obtained, find the small­ est values of y that will satisfy the equations 61y2 + 1 = x2; or 109y2 + 1 = x2. Frenicle proceeded to calculate the smallest positive solutions of x2 - dy2 = 1 for all permissible values of d up to 150 and suggested that Wallis extend the table to d = 200 or at least solve x2 - 151y2 = 1 and x2 - 313y2 = 1, hinting that the sec­ ond equation might be beyond Wallis's ability. In reply, Wallis's patron Lord William Brouncker of Ireland stated that it had only taken him an hour or so to discover that (126862368)2 - 313(7170685)2 = -1 and therefore y = 2 · 7170685 · 126862368 gives the desired solution to x2 - 313y2 = 1; Wallis solved the other concrete case, furnishing (1728148040)2 - 151(140634693)2 = 1 The size of these numbers in comparison with those arising from other values of d suggests that Fermat was in possession of a complete solution to the problem, but this was never disclosed (later, he affirmed that his method of infinite descent had been used with success to show the existence of an infinitude of solutions of x2 - dy2 = 1). Brouncker, under the mistaken impression that rational and not necessarily integral values were allowed, had no difficulty in supplying an answer; he simply divided the relation (r2 + d)2 - d(2r)2 = (r2 - d)2 by the quantity (r2 - d)2 to arrive at the solution r2 + d 2r x = r2 - d y = r2 - d where r -=/=- ,Jd, is an arbitrary rational number. This, needless to say, was rejected by Fermat, who wrote that \"solutions in fractions, which can be given at once from the merest elements of arithmetic, do not satisfy me.\" Now informed of all the conditions of the challenge, Brouncker and Wallis jointly devised a tentative method for solving x2 - dy2 = 1 in integers, without being able to give a proof that it will always work. Apparently the honors rested with Brouncker, for Wallis congratulated Brouncker with some pride that he had \"preserved untarnished the fame that Englishmen have won in former times with Frenchmen.\" After having said all this, we should record that Fermat's well-directed effort to institute a new tradition in arithmetic through a mathematical joust was largely a failure. Save for Frenicle, who lacked the talent to vie in intellectual combat with Fermat, number theory had no special appeal to any of his contemporaries. The subject was permitted to fall into disuse, until Euler, after the lapse of nearly a century, picked up where Fermat had left off. Both Euler and Lagrange contributed to the resolution of the celebrated problem of 1657. By converting ,Jd, into an infinite 340 ELEMENTARY NUMBER THEORY continued fraction, Euler (in 1759) invented a procedure for obtaining the smallest integral solution of x2 -dy2 = 1; however, he failed to show that the process leads to a solution other than x = 1, y = 0. It was left to Lagrange to clear up this matter. Completing the theory left unfinished by Euler, in 1768 Lagrange published the first rigorous proof that all solutions arise through the continued fraction expansion of J(i. As a result of a mistaken reference, the central point of contention, the equation x2 -dy2 = 1, has gone into the literature with the title \"Pell's equation.\" The erro­ neous attribution of its solution to the English mathematician John Pell ( 1611-1685), who had little to do with the problem, was an oversight on Euler's part. On a cur­ sory reading of Wallis's Opera Mathematica (1693), in which Brouncker's method of solving the equation is set forth as well as information as to Pell's work on Diophantine analysis, Euler must have confused their contributions. By all rights we should call the equation x2 -dy2 = 1 \"Fermat's equation,\" for he was the first to deal with it systematically. Although the historical error has long been recognized, Pell's name is the one that is indelibly attached to the equation. Whatever the integral value of d, the equation x2 -dy2 = 1 is satisfied trivially by x = ±1, y = 0. If d < -1, thenx2-dy2 :=:::: 1 (except whenx=y=0) so that these exhaust the solutions; when d = -1, two more solutions occur, namely, x = 0, y = ±1. The case in which dis a perfect square is easily dismissed. For if d = n2 for some n, then x2 -dy2 = 1 can be written in the form (x + ny)(x - ny) = 1 which is possible if and only if x + ny = x - ny = ±1; it follows that (x +ny) + (x- ny) x = = ±1 2 and the equation has no solutions apart from the trivial ones x = ±1, y = 0. From now on, we shall restrict our investigation of the Pell equation x2 -d y2 = 1 to the only interesting situation, that where d is a positive integer that is not a square. Let us say that a solution x, y of this equation is a positive solution provided both x and y are positive. Because solutions beyond those with y = 0 can be arranged in sets of four by combinations of signs ±x, ± y, it is clear that all solutions will be known once all positive solutions have been found. For this reason, we seek only positive solutions of x2 -dy2 = 1. The result that provides us with a starting point asserts that any pair of posi­ tive integers satisfying Pell's equation can be obtained from the continued fraction representing the irrational number Jd. Theorem 15.12. If p, q is a positive solution of x2 - d y2 = 1, then p / q is a convergent of the continued fraction expansion of ,Jd. Proof. In light of the hypothesis that p2 - dq2 = 1, we have (p - qVd)(p + q./d) = 1 CONTINUED FRACTIONS 341 implying that p > q as well as that As a result, P_Jd= 1 q q(p + q,/d) ,Jd 1 --- - - A direct appeal to Theorem 15.9 indicates that p/q must be a convergent of ,Jd. In general, the converse of the preceding theorem is false: not all of the con­ vergents Pnf qn of ,Jd, supply solutions to x2 - dy2 = 1. Nonetheless, we can say something about the size of the values taken on by the sequence p� - dq;. Theorem 15.13. If p / q is a convergent of the continued fraction expansion of ,Jd, then x = p, y = q is a solution of one of the equations x2 - dy2 = k where I k I < 1 + 2,/J. Proof. If p/q is a convergent of ,Jd, then the corollary to Theorem 15.7 guarantees that and therefore 1 lp-qJdl < - q This being so, we have IP+ q,/dl =I (p -q,/d) + 2qJdl s IP -qJd I + I 2qJd I < _.!._ + 2qJd::::; (1 + 2Jd)q q These two inequalities combine to yield I p2 -dq2 I= IP -qJdl IP+ qJdl < !_(I+ 2Jd)q q = 1 +2Jd which is precisely what was to be proved. 342 ELEMENTARY NUMBER THEORY In illustration, let us take the case of d = 7. Using the continued fraction ex­ pansion ,J7 = [2; 1, 1, 1, 4], the first few convergents of ,J7 are determined to be 2/1,3/1,5/2,8/3, ... Running through the calculations of p; - 7 q?i, we find that 22 - 7. 12 = -3 32 - 7. 12 = 2 52 - 7. 22 = -3 82 - 7. 32 = 1 whence x = 8, y = 3 provides a positive solution of the equation x2 - 7 y2 = 1. Although a rather elaborate study can be made of periodic continued fractions, it is not our intention to explore this area at any length. The reader may have noticed already that in the examples considered so far, all the continued fraction expansions of ,Jd, took the form that is, the periodic part starts after one term, this initial term being [ ,Jd,]. It is also true that the last term an of the period is always equal to 2a0 and that the period, with the last term excluded, is symmetrical (the symmetrical part may or may not have a middle term). This is typical of the general situation. Without entering into the details of the proof, let us simply record the fact: if d is a positive integer that is not a perfect square, then the continued fraction expansion of ,Jd, necessarily has the form In the case in which d = 19, for instance, the expansion is � = [4;2, 1, 3, 1, 2, 8] whereas d = 73 gives ../73 = [8; 1, 1, 5, 5, 1, 1, 16] Among all d < 100, the longest period is that of ,J94, which has 16 terms: J94=[9;1, 2, 3, 1, 1, 5, 1, 8, 1, 5, 1, 1, 3, 2, 1, 18] 344 ELEMENTARY NUMBER THEORY fork= 0, 1, 2, ... , and then setting ak = [xk] when k > 0. Thus, the Xk are all irrational numbers, the ak are integers and these are related by the expression 1 Xk+l = --­ Xk - ak Another preliminary is the following somewhat technical lemma. Lemma. Given the continued fraction expansion ,Jd, = [ao; ai, a1, ... ], define sk and tk recursively by the relations so= 0 to= 1 k = 0, 1, 2, ... Then (a) sk and tk are integers, with tk =f. 0. (b) tk l(d - sl). (c) Xk = (sk + ,,/d,)/tk fork 2: 0. Proof. We proceed by induction on k, noting that the three assertions clearly hold when k = 0. Assume they are true for a fixed positive integer k. Because ab sk> and tk are all integers, Sk+l = aktk - sk will likewise be an integer. Also, tk+1 =f. 0, for otherwise d = Sf+i• contrary to the supposition that dis not a square. The equation d - sl+1 d - Sf 2 tk+l = + (2aksk - aktk) tk tk where tk l(d - sl) by the induction hy pothesis, implies that tk+l is an integer; whereas tktk+t = d - sl+i gives tk+1 l(d - sl+1). Finally, we obtain 1 Xk+l = --­ Xk - ak ,,/(j, - Sk+l tk(Sk+l + ,,/d,) Sk+l + ,,/(j, d - sl+i tk+1 and so (a), (b), and (c) hold in the case of k + 1, hence for all positive integers. We need one more collateral result before turning to the solutions of Pell's equation. Here we tie the convergents of ,Jd to the integers of tk of the lemma. Theorem 15.14. If Pk/qk are the convergents of the continued fraction expansion of ,,/J,then 2 d 2 ( l)k+l Pk - qk = - tk+1 where tk+ 1 > 0 k = 0, 1, 2, 3, ... Proof. For ,Jd, = [ao; ai, a1 ... , ab Xk+l], we know that ,Jd, = Xk+lPk + Pk-l Xk+lqk + qk-l CONTINUED FRACTIONS 345 Upon substituting Xk+ 1 = (sk+ 1 + ,Jd,) / tk+ 1 and simplifying, this reduces to ,Jd,(sk+lqk + tk+lqk-l - Pk)= sk+lPk + tk+lPk-l - dqk Because the right-hand side is rational and ,Jd, is irrational, this last equation requires that and The effect of multiplying the first of these relations by Pk and the second by -qk, and then adding the results, is pf - dqf = tk+1(pkqk-l - Pk-lqk) But Theorem 15.3 tells us that Pkqk-l - Pk-lqk = (-l)k-t = (-l)k+l and so pf - dqf = (-l)k+ttk+1 Let us next recall from the discussion of convergents that C2k < ,Jd, < C2k+1 k :'.'.: 0 Because Ck= Pk/qk. we deduce that p� - dqf < 0 fork even and p� - dqf > 0 for k odd. Thus, the left-hand side of the equation p� - dqf 2 d 2 Pk-l - qk-l k:::: 1 is always negative, which makes tk+i/ tk positive. Starting with t1 = d - a5 > 0, we climb up the quotients to arrive at tk+l > 0. A matter of immediate concern is determining when the integer t j = 1. We settle this question below. Corollary. If n is the length of the period of the expansion of ,Jd,, then if and only if nlj Proof. For ,Jd, = [ao; a1, a2, ... , an ], we have Hence, or k = 0, 1, ... Skn+l + ,J{J, St + ,J{J, tkn+l t1 346 ELEMENTARY NUMBER THEORY The irrationality of VJ implies that But then and so tkn = 1. The net result of this is that t j = 1 whenever n I j. Going in the other direction, let j be a positive integer for which t j = 1. Then x j = s j + VJ and, on taking integral parts, we can write [x j] = s j + [ JdJ = s j + ao The definition of Xj+l now yields 1 1 x j = [x j] + -- = s j + ao + -- X j+ l Xj+l Putting the pieces together 1 1 ao + - = xo = Jd = x j - s j = ao + -- x1 Xj+l therefore, Xj+I = x1. This means that the block ai, a2, ... , aj of j integers keeps repeating in the expansion of VJ. Consequently, j must be a multiple of the length n of the period. For a brief illustration, let us take the continued fraction expansion Jl5 = [3; 1, 6]. Its period is of length 2 and the first four convergents are 3/1,4/1,27/7,31/8 A calculation shows that 3 2 - 15 . 12 = 27 2 - 15 . 7 2 = -6 4 2 - 15. 12 = 31 2 - 15. 82 = 1 Hence, t1 = t3 = 6 and t2 = t4 = 1. We are finally able to describe all the positive solutions of the Pell equation x2 - dy2 = 1, where d > 0 is a nonsquare integer. Our result is stated as Theorem 15.15. Let Pk/qk be the convergents of the continued fraction expansion of VJ and let n be the length of the expansion. (a) If n is even, then all positive solutions of x2 - dy2 = 1 are given by x = Pkn-1 Y = qkn-1 k = 1, 2, 3, ... (b) If n is odd, then all positive solutions of x2 - dy2 = 1 are given by x = P2kn-1 Y = q2kn-1 k = 1, 2, 3, ... A third positive solution arises from X3 + y3,J35 = (6 + J35) 3 CONTINUED FRACTIONS 349 = (71 + 12J35)(6 + J35) = 846 + 143J35 This gives x3 = 846, y3 = 143, and in fact, 8462 - 35 . 1432 = 715716 - 715715 = 1 so that these values provide another solution. Returning to the equation x2 - d y2 = 1, our final theorem tells us that any positive solution can be calculated from the formula Xn + Yn .jd, = (x1 + Yl .Jd,t where n takes on integral values; that is, if u, v is a positive solution of x2 - dy2 = 1, then u = Xn, v = Yn for a suitably chosen integer n. We state this as Theorem 15.17. Theorem 15.17. If x1, y1 is the fundamental solution of x2 - dy2 = 1, then every positive solution of the equation is given by Xn, Yn, where Xn and Yn are the integers determined from n = 1, 2, 3, ... Proof. In anticipation of a contradiction, let us suppose that there exists a positive solutionu, v that is not obtainable by the formula(x1 + Y1 ,Jdt. Because xi +y1,Jd>1, the powers of x1 + Y1 ,Jd become arbitrarily large; this means that u + v,Jd must lie between two consecutive powers of x1 + Y1 ,Jd, say, (x1 + Yl ./dt < u + v..fd < (x1 + Yl ./dt+1 or, to phrase it in different terms, Xn + Yn./d < U + v..fd < (Xn + Yn./d)(x1 + Yl ./d) On multiplying this inequality by the positive number Xn - Yn ,Jd and noting that x; - dy; = 1, we are led to 1 < (Xn - Yn./d)(u + v./d) < X1 + Yl ./d Next define the integers rands by r + s,Jd = (xn - Yn,Jd)(u + v,Jd) ; that is, let r = XnU - YnVd S =XnV - YnU An easy calculation reveals that r2 - ds2 = (x� - dy�)(u2 - dv2) = 1 and therefore r, s is a solution of x2 - dy2 = 1 satisfying 1 < r + s./d < x1 + Y1 ./d Completion of the proof requires us to show that the pair r, s is a positive solution. Because 1 < r + s,Jd and (r + s,Jd)(r -s,Jd) = 1, we find that 0 < r -s,Jd < 1. In consequence, 2r = (r + s ,Jd) + (r -s ,Jd) > 1 + 0 > 0 2s ,Jd = (r + s ,Jd) - (r -s ,Jd) > 1 - 1 = 0 350 ELEMENTARY NUMBER THEORY which makes both r ands positive. The upshot is that because XI, YI is the fundamental solution of x2 - dy 2 = 1, we must have XI <rand YI < s; but then XI+ YI,,/d < r + s,,/d, violating an earlier inequality. This contradiction ends our argument. Pell's equation has attracted mathematicians throughout the ages. There is his­ torical evidence that methods for solving the equation were known to the Greeks some 400 years before the beginning of the Christian era. A famous problem of indeterminate analysis known as the \"cattle problem\" is contained in an epigram sent by Archimedes to Eratosthenes as a challenge to Alexandrian scholars. In it, one is required to find the number of bulls and cows of each of four colors, the eight unknown quantities being connected by nine conditions. These conditions ultimately involve the solution of the Pell equation x2 - 4729494y2 = 1 which leads to enormous numbers; one of the eight unknown quantities is a figure having 206,545 digits (assuming that 15 printed digits take up one inch of space, the number would be over 1/5 of a mile long). Although it is generally agreed that the problem originated with the celebrated mathematician of Syracuse, no one contends that Archimedes actually carried through all the necessary computations. Such equations and dogmatic rules, without any proof for calculating their so­ lutions, spread to India more than a thousand years before they appeared in Europe. In the 7th century, Brahmagupta said that a person who can within a year solve the equation x2 - 92 y2 = 1 is a mathematician; for those days, he would at least have to be a good arithmetician, because x = 151, y = 120 is the smallest positive solution. A computationally more difficult task would be to find integers satisfy­ ing x2 - 94y 2 = 1, for here the fundamental solution is given by x = 2143295, y = 221064. Fermat, therefore, was not the first to propose solving the equation x2 - dy 2 = 1 or even to devise a general method of solution. He was perhaps the first to assert that the equation has an infinitude of solutions whatever the value of the nonsquare integer d. Moreover, his effort to elicit purely integral solutions to both this and other problems was a watershed in number theory, breaking away as it did from the classical tradition of Diophantus's Arithmetica. PROBLEMS 15.5 1. If x0, y0 is a positive solution of the equation x2 - dy 2 = 1, prove that x0 > y0. 2. By the technique of successively substituting y = 1, 2, 3, ... into d y2 + 1, determine the smallest positive solution of x2 - dy 2 = 1 when d is (a) 7. (b) 11. (c) 18. (d) 30. (e) 39. CONTINUED FRACTIONS 351 3. Find all positive solutions of the following equations for which y < 250: (a) x2 - 2y2 = 1. (b) x2 - 3y2 = 1. (c) x2 - 5y2 = 1. 4. Show that there is an infinitude of even integers n with the property that both n + 1 and n /2 + 1 are perfect squares. Exhibit two such integers. 5. Indicate two positive solutions of each of the equations below: (a) x2 - 23y2 = 1. (b) x2 - 26y2 = 1. (c) x2 - 33y2 = 1. 6. Find the fundamental solutions of these equations: (a) x2 - 29y2 = 1. (b) x2 - 41y2 = 1. (c) x2 - 74y2 = 1. [Hint: J4l = [6; 2, 2, 12 ] and J74 = [8; 1, 1, 1, 1, 16].] 7. Exhibit a solution of each of the following equations: (a) x2 - 13y2 = -1. (b) x2 - 29y2 = -1. (c) x2 - 41y2 = -1. 8. Establish that if xo, Yo is a solution of the equation x2 - dy2 = -1, then x = 2dy5 - 1, y = 2x0y 0 satisfies x2 - dy2 = 1. Brouncker used this fact in solving x2 - 313y2 = 1. 9. If d is divisible by a prime p = 3 (mod 4), show that the equation x2 - dy2 = -1 has no solution. 10. If x1, y1 is the fundamental solution of x2 - dy2 = 1 and n = 1, 2, 3, ... prove that the pair of integers Xn, Yn can be calculated from the formulas 11. Verify that the integers Xn, Yn in the previous problem can be defined inductively either by for n = 1, 2, 3, ... , or by for n = 2, 3, .... Xn+l = XtXn + dy1Yn Yn+l = XtYn + XnYl Xn+l = 2XtXn - Xn-1 Yn+l = 2x1Yn - Yn-1 12. Using the information thatx1 = 15,y1 = 2is thefundamental solution ofx2 - 56y2 = 1, determine two more positive solutions. 13. (a) Prove that whenever the equation x2 - dy2 = c is solvable, it has infinitely many solutions. [Hint: If u, v satisfy x2 - dy2 = c and r, s satisfy x2 - dy2 = 1, then (ur ± dvs)2 - d(us ± vr)2 = (u 2 - dv2)(r2 - ds2) = c.] 352 ELEMENTARY NUMBER THEORY (b) Given that x = 16, y = 6 is a solution of x2 - 7y2 = 4, obtain two other positive solutions. (c) Given that x = 18, y = 3 is a solution of x2 - 35y2 = 9, obtain two other positive solutions. 14. Apply the theory of this section to confirm that there exist infinitely many primitive Pythagorean triples x, y, z in which x and y are consecutive integers. [Hint: Note the identity (s2 - t2) - 2st = (s - t)2 - 2t2.] 15. The Pell numbers Pn and qn are defined by Po= 0 qo = 1 P1 = 1 qi= 1 Pn = 2Pn-l + Pn-2 qn = 2qn-l + qn-2 This gives us the two sequences 0, 1,2,5, 12,29, 70, 169,408, .. . 1, 1,3, 7, 17,41,99,239,577, .. . n :'.'.: 2 n :'.'.: 2 If a = 1 + ,J2 and fJ = 1 - ,J2, show that the Pell numbers can be expressed as an - {Jn Pn = 2 for n :'.'.: 0. [Hint: Mimic the argument on page 296, noting that a and fJ are roots of the equation x2 - 2x - 1 = O.] 16. For the Pell numbers, derive the relations below, where n :'.'.: 1: (a) P2n = 2pnqn. (b) Pn + Pn-l = qn. (c) 2q; - q2n = (-l)n. (d) Pn + Pn+l + Pn+3 = 3Pn+2· (e) q; - 2p� = (-l)n; hence, qn/ Pn are the convergents of ,J2. CHAPTER 16 SOME MODERN DEVELOPMENTS As with everything else, so with a mathematical theory: beauty can be perceived, but not explained. ARTHUR CAYLEY 16.1 HARDY, DICKSON, AND ERDOS The vitality of any field of mathematics is maintained only as long as its practitioners continue to ask (and to find answers to) interesting and worthwhile questions. Thus far, our study of number theory has shown how that process has worked from its classical beginnings to the present day. The reader has acquired a working knowledge of how number theory is developed and has seen that the field is still very much alive and growing. This brief closing chapter indicates several of the more promising directions that growth has taken in the 20th century. We begin by looking at some contributions of three prominent number the­ orists from the past century, each from a different country: Godfrey H. Hardy, Leonard E. Dickson, and Paul Erdos. In considerably advancing our mathemati­ cal knowledge, they are worthy successors to the great masters of the past. For more than a quarter of a century, G. H. Hardy (1877-1947) dominated En­ glish mathematics through both the significance of his work and the force of his personality. Hardy entered Cambridge University in 1896 and joined its faculty in 1906 as a lecturer in mathematics, a position he continued to hold until 1919. Per­ haps his greatest service to mathematics in this early period was his well-known book A Course in Pure Mathematics. England had had a great tradition in applied mathematics, starting with Newton, but in 1900, pure mathematics was at a low 353 354 ELEMENTARY NUMBER THEORY This photograph does not appear in the Godfrey Harold Hardy eBookversion of thls text. (1877-1947) (Trinity College Library, Cambridge) ebb there. A Course in Pure Mathematics was designed to give the undergraduate student a rigorous exposition of the basic ideas of analysis. Running through nu­ merous editions and translated into several languages, it transformed the trend of university teaching in mathematics. Hardy's antiwar stand excited strong negative feelings at Cambridge, and in 1919, he was only too ready to accept the Savilian chair in geometry at Oxford. He was succeeded on the Cambridge staff by John E. Littlewood. Eleven years later, Hardy returned to Cambridge, where he remained until his retirement in 1942. Hardy's name is inevitably linked with that of Littlewood, with whom he carried on the most prolonged (35 years), extensive, and fruitful partnership in the history of mathematics. They wrote nearly 100 papers together, the last appearing a year after Hardy's death. It was often joked that there were only three great English mathemati­ cians in those days: Hardy, Littlewood, and Hardy-Littlewood. (One mathematician, upon meeting Littlewood for the first time, exclaimed, \"I thought that you were merely a name used by Hardy for those papers which he did not think were quite good enough to publish under his own name.\") There are very few areas of number theory to which Hardy did not make a significant contribution. A major interest of his was Waring's problem; that is, the question of representing an arbitrary positive integer as the sum of at most g(k) kth powers (see Section 13.3). The general theorem that g(k) is finite for all k was first proved by Hilbert in 1909 using an argument that shed no light on how many kth powers are needed. In a series of papers published during the 1920s, Hardy and Littlewood obtained upper bounds on G(k ), defined to be the least number of kth powers required to represent all sufficiently large integers. They showed (1921) that G(k) � (k - 2)2 k-l + 5 for all k, and, more particularly, that G(4) < 19, G(5) � 41, G(6) < 87, and G(7) � 193. Another of their results (1925) is that for SOME MODERN DEVELOPMENTS 355 \"almost all\" positive integers g(4) < 15, whereas g(k) < (1/2 k - 1)2k-l + 3 when k = 3ork::: 5.Because 79=4·24+15·14requires 19fourth powers,g(4) > 19; this, together with the bound G(4) � 19 suggested that g(4) = 19 and raised the possibility that its actual value could be settled by computation. Another topic that drew the attention of the two collaborators was the classical three-primes problem: Can every odd integer n > 7 be written as the sum of three prime numbers? In 1922, Hardy and Littlewood proved that if certain hypotheses are made, then there exists a positive number N such that every odd integer n > N is a sum of three primes. They also found an approximate formula for the number of such representations of n. I. M. Vinogradov later obtained the Hardy-Littlewood conclu­ sion without invoking their hypotheses. All the Hardy-Littlewood papers stimulated a vast amount of further research by many mathematicians. L. E. Dickson (1874-1954) was prominent among a small circle of those who greatly influenced the rapid development of American mathematics at the tum of the century. He received the first doctorate in mathematics from the newly founded University of Chicago in 1896, became an assistant professor there in 1900, and remained at Chicago until his retirement in 1939. Reflecting the abstract interests of his thesis advisor, the distinguished E. H. Moore, Dickson initially pursued the study of finite groups. By 1906, Dickson's prodigious output had already reached 126 papers. He would jokingly remark that, although his honeymoon was a success, he managed to get only two research arti­ cles written then. His monumental History of the Theory of Numbers (1919), which appeared in three volumes totaling more than 1600 pages, took 9 years to complete; by itself this would have been a life's work for an ordinary man. One of the century's most prolific mathematicians, Dickson wrote 267 papers and 18 books covering a broad range of topics in his field. An enduring bit of legend is his barb against appli­ cable mathematics: \"Thank God that number theory is unsullied by applications.\" (Expressing much the same view, Hardy is reported to have made the toast: \"Here's to pure mathematics! May it never have any use.\") In recognition of his work, Dickson was the first recipient of the F. N. Cole Prize in algebra and number theory, awarded in 1928 by the American Mathematical Society. Dickson stated that he always wished to work in number theory, and that he wrote the History of the Theory of Numbers so he could know all that had been done on the subject. He was particularly interested in the existence of perfect numbers, abundant and deficient numbers, and Waring's problem. A typical result of his investigations was to list (in 1914) all the odd abundant numbers less than 15,000. In a long series of papers beginning in 1927, Dickson gave an almost complete solution of the original form of Waring's problem. His final result (in 1936) was that, for nearly all k, g(k) assumes the ideal value g(k) = 2k + [(3/2)k] - 2, as was conjectured by Euler in 1772. Dickson obtained a simple arithmetic condition on k for ensuring that the foregoing formula for g(k) held, and showed that the condition was satisfied for k between 7 and 400. With the dramatic increase in computer power, it is now known that Euler's conjecture for g(k) holds when k is between 2 and 4 71600000. Paul Erdos (1913-1996), who is often described as one of the greatest modem mathematicians, is unique in mathematical folklore. The son of two high school 356 ELEMENTARY NUMBER THEORY teachers of mathematics, his genius became apparent at a very early age. Erdos entered the University of Budapest when he was 17 and graduated 4 years later with a Ph.D. in mathematics. As a first year student in college, he published his first paper, which was a simple proof of Bertrand's conjecture that for any n > 1 there is always a prime between n and 2n. After a 4-year fellowship at Manchester University, England, Erdos adopted the lifestyle of a wandering scholar, a \"Professor of the Universe.\" He traveled the world constantly, often visiting as many as 15 universities and research centers in a month. (Where Gauss's motto was \"Few, but ripe,\" Erdos took as his the words \"Another roof, another proof.\") Although Erdos never held a regular academic appointment, he had standing offers at several institutions where he could pause for short periods. In his total dedication to mathematical research, Erdos dispensed with the pleasures and possessions of daily life. He had neither property nor fixed address, carried no money and never cooked anything, not even boiled water for tea; a few close friends handled his financial affairs, including filing his income tax returns. A generous person, Erdos was apt to give away the small honoraria he picked up from his lectures, or used them to fund two scholarships that he set up for young mathematicians-one in Hungary and one in Israel. Erdos's work in number theory was always substantial and frequently monu­ mental. One feat was his demonstration (1938) that the sum of the reciprocals of the prime numbers is a divergent series. In 1949, he and Atle Selberg independently published \"elementary\"-though not easy-proofs of what is called the Prime Num­ ber Theorem. (It asserts that rr (x) � x / log x, where rr (x) is the number of primes p < x.) This veritable sensation among number theorists helped earn Selberg a Fields Medal ( 1950) and Erdos a Cole Prize (1952). Erdos received the prestigious Wolf Prize in 1983 for outstanding achievement in mathematics; of the $50,000 award, he retained only $750 for himself. Erdos published, either alone or jointly, more than 1200 papers. With over 300 coauthors, he collaborated with more people than any other mathematician. As a spur to his collaborators, Erdos attached monetary rewards to problems that he had been unable to solve. The rewards generally ranged from $10 to $10,000, depending on his assessment of the difficulty of the problem. The inducement to obtain a solution was not as much financial as prestigious, for there was a certain notoriety associated with owning a check bearing Erdos's name. The following reflect the range of questions that he would have liked to have seen answered: 1. Does there exist an odd integer that is not of the form 2k + n, with n square-free? 2. Are there infinitely many primes p (such asp = 101) for which p - k! is com­ posite whenever 1 < k ! < p? 3. Is it true that, for all k > 8, 2k cannot be written as the sum of distinct powers of 3? [Note that 28 = 35 + 32 + 3 + 1.] 4. If p(n) is the largest prime factor of n, does the inequality p(n) > p(n + 1) > p(n + 2) have an infinite number of solutions? 5. Given an infinite sequence of integers, the sum of whose reciprocals diverges, does the sequence contain arbitrarily long arithmetic progressions? ($3,000 offered for an answer) SOME MODERN DEVELOPMENTS 357 Through a host of problems and conjectures such as these, Paul Erdos stimulated two generations of number theorists. A word about a current trend: computation has always been an important inves­ tigative tool in number theory. Therefore, it is not surprising that number theorists were among the first mathematicians to exploit the research potential of modem electronic computers. The general availability of computing machinery has given rise to a new branch of our discipline, called Computational Number Theory. Among its wide spectrum of activities, this subject is concerned with testing the primality of given integers, finding lower bounds for odd perfect numbers, discovering new pairs of twin primes and amicable numbers, and obtaining numerical solutions to cer­ tain Diophantine equations (such as x 2 + 999 = y3). Another fruitful line of work is to verify special cases of conjectures, or to produce counterexamples to them; for instance, in regard to the conjecture that there exist pseudoprimes of the form 2n - 2, a computer search found the pseudoprime 2465794 - 2. The problem of fac­ toring large composite numbers has been of continuing computational interest. The most dramatic result of this kind was the recent determination of a prime factor of the twenty-eighth Fermat number F28, an integer having over 8 million decimal digits. Previously, it had been known only that F28 is composite. The extensive cal­ culations produced the 22-digit factor 25709319373 · 236 + 1. No doubt number­ theoretic records will continue to fall with the development of new algorithms and equipment. Number theory has many examples of conjectures that are plausible, are sup­ ported by seemingly overwhelming numerical evidence, and yet turn out to be false. In these instances, a direct computer search of many cases can be of assistance. One promising conjecture of long standing was due to George P6lya (1888-1985). In 1914, he surmised that for any n > 2, the number of positive integers up ton having an odd number of prime divisors is never smaller than the number having an even number of prime divisors. Let /... be the Liouville function, defined by the equation /...(n) = (-l)nCn>, where the symbol Q(n) represents the total number of prime factors of n > 2 counted according to their multiplicity (/...(1) = 1). With this notation, the P6lya conjecture may be written as a claim that the function L(n) = L/...(x) x;:S n is never positive for any n > 2. P6lya's own calculations confirmed this up to n = 1500, and the conjecture was generally believed true for the next 40 years. In 1958, C. B. Haselgrove proved the conjecture false by showing that infinitely many integers n exist for which L(n) > 0. However, his method failed to furnish any specific n for which the conjecture is violated. Shortly thereafter (1960), R. S. Lehman called attention to the fact that £(9906180359) = 1 The least value of n satisfying L(n) > 0 was discovered in 1980; it is 906150257. Another question that could not have been settled without the aid of computers is whether the string of digits 123456789 occurs somewhere in the decimal expansion for TC. In 1991, when the value of TC extended beyond one billion decimal digits, it was reported that the desired block appeared shortly after the half-billionth digit. 358 ELEMENTARY NUMBER THEORY 16.2 PRIMALITY TESTING AND FACTORIZATION In recent years, primality testing has become one of the most active areas of inves­ tigation in number theory. The dramatic improvements in power and sophistication of computing equipment have rekindled interest in large-scale calculations, leading to the development of new algorithms for quickly recognizing primes and factoring composite integers; some of these procedures require so much computation that their implementation would have been infeasible a generation ago. Such algorithms are of importance to those in industry or government concerned with safeguarding the transmission of data; for various present-day cryptosystems are based on the inherent difficulty of factoring numbers with several hundred digits. This section describes a few of the more recent innovations in integer factorization and primality testing. The two computational problems really belong together, because to obtain a complete factorization of an integer into a product of primes we must be able to guarantee­ or provide certainty beyond a reasonable doubt-that the factors involved in the representation are indeed primes. The problem of distinguishing prime numbers from composite numbers has occupied mathematicians through the centuries. In his Disquisitiones Arithmeticae, Gauss acclaimed it as \"the most important and useful in arithmetic.\" Given an integer n > 1, just how does one go about testing it for primality? The oldest and most direct method is trial division: check each integer from 2 up to Jli, to see whether any is a factor of n. If one is found, then n is composite; if not, then we can be sure that n is prime. The main disadvantage to this approach is that, even with a computer capable of performing a million trial divisions every second, it may be so hopelessly time-consuming as to be impractical. It is not enough simply to have an algorithm for determining the prime or composite character of a reasonably large integer; what we really need is an efficient algorithm. The long-sought rapid test for determining whether a positive integer is prime was devised in 2002 by three Indian computer scientists (M. Agrawal, N. Kayal, and N. Saxena). Their surprisingly simple algorithm provides a definite answer in \"polynomial time,\" that is, in about d6 steps where d is the number of binary digits of the given integer. In 197 4, John Pollard proposed a method that is remarkably successful in finding moderate-sized factors (up to about 20 digits) of formerly intractable numbers. Con­ sider a large odd integer n that is known to be composite. The first step in Pollard's factorization method is to choose a fairly simple polynomial of degree at least 2 with integer coefficients, such as a quadratic polynomial a f. 0, -2 Then, starting with some initial value x0, a \"random \" sequence x1, x2, x3, ... is created from the recursive relation k = 0, 1, 2, ... that is, the successive iterates x1 = f (xo), x2 = f (f (xo)), x3 = f (f (f (xo))), ... are computed modulo n. SOME MODERN DEVELOPMENTS 359 Let d be a nontrivial divisor of n, where dis small compared with n. Because there are relatively few congruence classes modulo d (namely, d of them), there will probably exist integers x j and Xk that lie in the same congruence class modulo d but belong to different classes modulo n; in short, we will have xk _ Xj (mod d), and xk ¥=- x j (mod n ). Because d divides xk - x j and n does not, it follows that gcd(xk - x j, n) is a nontrivial divisor of n. In practice, a divisor d of n is not known in advance. But it can most likely be detected by keeping track of the integers xk. which we do know. Simply compare Xk with earlier Xj, calculating gcd(xk - Xj, n) until a nontrivial greatest common divisor occurs. The divisor obtained in this way is not necessarily the smallest factor of n, and indeed it may not even be prime. The possibility exists that when a greatest common divisor greater than 1 is found, it may turn out to be equal ton itself; that is, Xk - x j (mod n ). Although this happens only rarely, one remedy is to repeat the computation with either a new value of x0 or a different polynomial f (x). A rather simple example is afforded by the integer n = 2189. If we choose x0 = 1 and f(x) = x2 + 1, the recursive sequence will be X1 = 2, X2 = 5, X3 = 26, X4 = 677, X5 = 829, ... Comparing different xb we find that gcd(x5 - x3, 2189) = gcd(803, 2189) = 11 and so a divisor of 2189 is 11. As k increases, the task of computing gcd(xk - x j, n) for each j < k becomes very time-consuming. We shall see that it is often more efficient to reduce the number of steps by looking at cases in which k = 2j. Let d be some (as yet undiscovered) nontrivial divisor of n. If Xk = x j (mod d), with j < k, then by the manner in which f(x) was selected It follows from this that, when the sequence {xd is reduced modulo d, a block of k - j integers is repeated infinitely often. That is, if r - s (mod k - j), where r :::: j and s > j, then Xr = Xs (mod d); and, in particular, X2t = Xt (mod d) whenever t is taken to be a multiple of k - j larger than j. It is reasonable therefore to expect that there will exist an integer k for which 1 < gcd(x2k - xk. n) < n. The drawback in computing only one greatest common divisor for each value of k is that we may not detect the first time that gcd( xi - x j , n) is a nontrivial di visor of n. A specific example will make matters come to life. Example 16.1. To factor n = 30623 using this variant of Pollard's method, let us take xo = 3 as the starting value and f(x) = x2 - 1 as the polynomial. The sequence of integers that Xk generates is 8,63,3968,4801,21104,28526, 18319, 18926, ... 360 ELEMENTARY NUMBER THEORY Making the comparison x2k with xk> we get X2 - XI = 63 - 8 = 55 X4 - X2 = 4801 - 63 = 4738 X6 - X3 = 28526 - 3968 = 24558 Xs - X4 = 18926 - 4801 = 14125 The desired factorization is 30623 = 113 · 271. gcd(55, n) = 1 gcd(4738, n) = 1 gcd(24558, n) = 1 gcd(14125, n) = 113 When the Xk are reduced modulo 113, the new sequence 8,63, 13,55,86,50, 13,55, ... is obtained. This sequence is ultimately periodic with the four integers 13, 55, 86, 50 being repeated. It is also worth observing that because xs = x4 (mod 113), the length of the period is 8 - 4 = 4. The situation can be represented pictorially as Because the figure resembles the Greek letter p (rho), this factoring method is popularly known as Pollard's rho-method. Pollard himself had called it the Monte Carlo method, in view of its random nature. A notable triumph of the rho-method is the factorization of the Fermat number F8 by Brent and Pollard in 1980. Previously F8 had been known to be composite, but its factors were undetermined. Using f(x) = x210 + 1 and x0 = 3 in the algorithm, Brent and Pollard were able to find the prime factor 1238926361552897 of F8 in only 2 hours of computer time. Although they were unable to verify that the other 62-digit factor was prime, H. C. Williams managed the feat shortly thereafter. Fermat's theorem lies behind a second factorization scheme developed by John Pollard in 1974, known as the p - 1 method. Suppose that the odd composite integer n to be factored has an unknown prime divisor p with the property that p - 1 is a product of relatively small primes. Let q be any integer such that (p - 1) I q. For instance, q could be either k ! or the least common multiple of the first k positive integers, where k is taken sufficiently large. Next choose an integer a, with 1 < a < p - 1, and calculate aq = m (mod n). Because q = (p - l)j for some j, the Fermat congruence leads to m = aq = (ap-l)j = lj = 1 (mod p) implying that p I (m - 1). This forces gcd(m - 1, n) > 1, which gives rise to a nontrivial divisor of n as long as m ¥= 1 (mod n). SOME MODERN DEVELOPMENTS 361 It is important to note that gcd(m - 1, n) can be calculated without knowing p. If it happens that gcd(m - 1, n) = 1, then one should go back and select a different value of a. The method might also fail if q is not taken to be large enough; that is, if p - 1 contains a large prime factor or a small prime occurring to a large power. Example 16.2. Let us obtain a nontrivial divisor of n = 2987 by taking a = 2 and q = 7! in Pollard's p - 1 method. To find 271 (mod 2987), we compute (((((22)3 )4)5 )6)7 (mod 2987) the sequence of calculations being 22 = 4 (mod 2987) 43 = 64 (mod 2987) 644 = 2224 (mod 2987) 22245 = 1039 (mod 2987) 10396 = 2227 (mod 2987) 22277 = 755 (mod 2987) Because gcd(7 54, 2987) = 29, we have discovered that 29 is a divisor of 2987. The continued fraction factoring algorithm also played a prominent role during the mid-1970s. This iterative procedure was contained in Legendre's Theorie des Nombres of 1798, but over the ensuing years fell into disuse owing to the drudgery of its complicated calculations. With the advent of electronic computers, there was no longer a practical reason for ignoring the method as the inhibiting computations could now be done quickly and accurately. Its first impressive success was the factorization of the 39-digit Fermat number F7, performed by Morrison and Brillhart in 1970 and published in 1975. Before considering this method, let us recall the notation of continued fractions. For a nonsquare positive integer n, the continued fraction expansion of ,J1i, is ,Jfi, = [ao; al, a2, a3, ... ] where the integers ak are defined recursively by ao = [xo], xo = ,J1i, 1 Xk+l = --­ Xk - ak fork> 0 The kth convergent Ck of ,J1i, is Ck= [ao;a1, a2, ... , ad= Pk/qk The Pk and qk can be calculated from the relations and P-2 = q_1 = 0, P-1 = q_2 = 1 Pk= akPk-1 + Pk-2 qk = akqk-1 + qk-2 fork > 0 SOME MODERN DEVELOPMENTS 363 A square t2k does not necessarily lead to a nontrivial divisor of n. Taken = 1121, for example. From JII2I = [33; 2, 12, 1, 8, 1, 1, ... ], we obtain the table of values k 0 1 2 3 4 5 6 llk 33 2 12 1 8 1 1 Sk 0 33 31 29 27 29 11 tk 1 32 5 56 7 40 25 Pk 33 67 837 904 8069 8973 17042 Now t6 is a square. The associated congruence p� = (-1) 6t6 (mod 1121) becomes 8973 2 = 52 (mod 1121) But the method fails at this point to detect a nontrivial factor of 1121, for gcd(8973 + 5, 1121) = gcd(8978, 1121) = 1 gcd(8973 - 5, 1121) = gcd(8968, 1121) = 1121 When the factoring algorithm has not produced a square t2k after having gone through many values of k, there are ways to modify the procedure. One variation is to find a set of tk 's whose product, with appropriate sign, is a square. Our next example illustrates this technique. k llk Sk tk Pk Example 16.4. Consider the integer n = 2059. The table concerning the continued fraction expansion of ,J2059 is 0 1 2 3 4 5 6 7 8 45 2 1 1 1 12 2 1 17 0 45 23 22 13 41 43 17 42 1 34 45 35 54 7 30 59 5 45 91 136 227 363 465 1293 1758 294 In search of promising tk, we notice that t2ts = 45 · 5 = (3 · 5)2. The two associated congruences are Pi - (-1)2t2 (mod 2059), Pi - (-1)8ts (mod 2059) expressed otherwise, 912 = 45 (mod 2059), 17582 = 5 (mod 2059) Multiplying these together yields (91 · 1758)2 = 15 2 (mod 2059) or, reduced modulo 2059, 1435 2 = 15 2 (mod 2059). This leads to gcd(1435 + 15, 2059) = gcd(l450, 2059) = 29 and a divisor 29 of 2059. The complete factorization is 2059 = 29 · 71. 364 ELEMENTARY NUMBER THEORY Another modification of the algorithm is to factor n by looking at the conti­ nued fraction expansion of ,J\"iil/i,, where m is often a prime or the product of the first few primes. This amounts to searching for integers x and y where x2 = y2 (mod mn) and then calculating gcd(x + y, mn) in the hope of producing a nontrivial divisor of n. As an example, let n = 713. Let us look at the integer 4278 = 6 · 713 with expansion J4278 = [65; 2, 2, 5, 1, ... ]. A square t2k arises almost immediately in the computations, since t2 = 49. Thus, we examine the congruence Pi = ( -1)2t2 (mod 4278), which is to say 1312 = ( -1)272 (mod 4278) It is seen that gcd(131+7, 4278) = gcd(138, 4278) = gcd(6 · 23, 6 · 713) = 23 which gives 23 as a factor of 713. Indeed, 713 = 23 · 31. This approach is essentially the one taken by Morrison and Brillhart in their landmark factorization of F7. From the first 1300000 of the tk 's occurring in the expansion of J257 F7, some 2059 of them were completely factored in order to find a product that is a square. Toward the end of the 20th century, the quadratic sieve algorithm was the method of choice for factoring very large composite numbers-including the 129-digit RSA Challenge Number. It systematized the factor scheme published by Kraitchik in 1926 (page 100). This earlier method was based on the observation that a composite number n can be factored whenever integers x and y satisfying x2 = y2 (mod n) x ¥= ±y (mod n) can be found; for then gcd(x - y, n) and gcd(x + y, n) are nontrivial divisors of n. Kraitchik produced the pair x and y by searching for a set of congruences xf =Yi (mod n) i = 1,2, ... ,r where the product of the Yi is a perfect square. It would follow that (x1x2 · · · Xr )2 = Y1Y2 ··· Yr = c2 (mod n) giving a solution of the desired equation x2 = y2 (mod n) and, quite possibly, a factor of n. The drawback to this technique is that the determination of a promising set of Yi is a trial and error process. In 1970, John Brillhart and Michael Morrison developed an efficient strategy for identifying congruences xf = Yi (mod n) whose product yields a square. The first step is the selection of a factor base {-1, p1, p2, .•• , Pr} consisting of p1 = 2 and small odd primes Pi such that n is a quadratic residue of each Pi; that is, the value of the Legendre symbol (n /Pi) = 1. Usually, the factor base consists of all such primes up to some fixed bound. Next the quadratic polynomial f(x) = x2 - n is evaluated for integral x \"near\" [fol, the largest integer less than fa. More explicitly, take x = [fa], ±1 +[fa], ±2 +[fa], .... The factor base is tailored SOME MODERN DEVELOPMENTS 365 to n so that each prime in it divides at least one value of f (x ), with -1 included so as to allow negative values of f (x). We are interested only in those f(x) that factor completely within the primes of the factor base, all other values being excluded. If ko = 0 or 1 ki � 0 for i = 1, 2, ... , r then the factorization can be stored in an (r + 1 )-component exponent vector de­ fined by v(x) = (ko, ji, }2, ... , jr) ji - ki (mod 2) for i = 1, 2, ... , r The components of the vector are either 0 or 1, depending on whether the prime Pi occurs in f (x) to an even or an odd power. Notice that the exponent vector of a product of f(x)'s is the sum of their respective exponent vectors modulo 2. As soon as the number of exponent vectors found in this way exceeds the number of elements of the factor base, a linear dependency will occur among the vectors­ although such a relation is often discovered earlier. In other words, there will exist a subset x1, x2, ... , Xs for which v(x1) + v(x2) + · · · + v(xs) - (0, 0, · · · , 0) (mod 2) This means that the product of the corresponding f(x) is a perfect square, say y 2, resulting in an expression of the form (x1x2 · · · Xs)2 = f (x1)f (x2) · · · f(xs) = y 2 (mod n) There is a reasonable chance that (x1x2 · · · x5) ¢. ±y (mod n), in which event gcd(x1x2 · · · Xs - y, n) is a nontrivial divisor of n. Otherwise, new linear depen­ dencies are searched for until n is factored. Example 16.5. As an example of the quadratic sieve algorithm, let us take n = 9487. Here[y'n] = 97.Thefactor base selected is{-l,2,3, 7, 11, 13, 17, 19,29}consisting of -1 and the eight primes less than 30 for which 9487 is a quadratic residue. We exam­ ine the quadratic polynomial f (x) = x2 - 9487forx = i + 97 (i = 0, ±1, ... , ±16). Those values off (x) that factor completely into primes from the factor base are listed in the table, along with the components of their exponent vectors. x f(x) -1 2 3 7 11 13 17 19 29 81 -2926 = -2 . 7 . 11 . 19 1 1 0 1 1 0 0 1 0 84 -2431=-11.13. 17 1 0 0 0 1 1 1 0 0 85 -2262 = -2. 3 . 13 . 29 1 1 1 0 0 1 0 0 1 89 -1566 = -2. 33 . 29 1 1 1 0 0 0 0 0 1 95 -462 = -2 . 3 . 7 . 11 1 1 1 1 1 0 0 0 0 97 -78=-2·3·13 1 1 1 0 0 1 0 0 0 98 117 = 32. 13 0 0 0 0 0 1 0 0 0 100 513 = 33. 19 0 0 1 0 0 0 0 1 0 101 714=2·3·7·17 0 1 1 1 0 0 1 0 0 103 1122 = 2 . 3 . 11 . 17 0 1 1 0 1 0 1 0 0 109 2394 = 2. 32 . 7 . 19 0 1 0 1 0 0 0 1 0 366 ELEMENTARY NUMBER THEORY Our table indicates that the exponent vectors for f(85), f (89), and f(98) are linearly dependent modulo 2; that is, v(85) + v(89) + v(98) = (0, 0, ... , 0) (mod 2) The congruences corresponding to these vectors are f(85) = 852 = -2 · 3 · 13 · 29 (mod 9487) f(89) = 89 2 = -2 · 33 · 29 (mod 9487) f(98) = 982 = 32 · 13 (mod 9487) which, when multiplied together, produce (85 · 89 · 98) 2 = (2 · 33 · 13 · 29) 2 (mod 9487) or 741370 2 = 203582 (mod 9487) Unfortunately, 741370 = 20358 (mod 9487) and no nontrivial factorization of 9487 will be achieved. A more fruitful choice is to employ the dependency relation v(81) + v(95) + v(lOO) = (0, 0, ... , 0) (mod 2) This will lead us to the congruence (81 · 95 · 100) 2 = (2 · 32 · 7 · 11 · 19)2 (mod 9487) or 769500 2 = 263342 (mod 9487) Reducing the values modulo 9487, we arrive at 10532 = 73602 (mod 9487) with 1053 ¢. 7360 (mod 9487). Then gcd(1053 + 7360, 9487) = gcd(8413, 9487) = 179 and 9487 is factored as 9487 = 179 · 53. It is sometimes helpful to notice that once one value of x is found for which the prime p divides f (x), then every pth value is also divisible by p; this occurs because f(x + kp) = (x + kp)2 - n = x2 - n = f(x) (mod p) fork = 0, ± 1, ±2, .... The algorithm \"sieves\" the integers x much like the sieve of Eratosthenes for locating multiples of p. In the last example, for instance 7 divides f (81) as well as /(88), f (95), /(102), .... Obtaining values f(x) that factor over the factor base can be done by performing this sieving process for each of the primes in the base. Fermat's theorem provides a way of recognizing most composite numbers. Sup­ pose that the character of an odd integer n > 1 is to be determined. If a number a can be found with 1 < a < n and a n- l ¢. 1 (mod n ), then n is definitely composite. SOME MODERN DEVELOPMENTS 369 12 · 83, where 83 > ,,/997. Thus, we need only select a suitable base for 83, say a= 2. Now 2996 _ 1 (mod 997) and gcd(2996183 - 1, 997) = gcd(4095, 997) = 1 leading to the conclusion that 997 is prime. Fermat's theorem allows us to determine whether a large odd integer n > 1 is composite without explicitly exhibiting a nontrivial divisor. There is another direct test for compositeness, which is called the Miller-Rabin test. One selects a random integer, uses it to perform this test, and announces that n is either definitely composite or that its nature is still undecided. The algorithm may be described as follows: First write n - 1 = 2h m, where m is odd. Next choose a number 1 < a < n - 1 and form, modulo n, the sequence in which each term is the square of its predecessor. Then n is said to pass the test for this particular base a if the first occurrence of 1 either is the first term or is preceded by-1. The coming theorem indicates that an odd prime will pass the above test for all such bases a. To reveal the compositeness of an odd integer, it is enough to find a value of a for which the test fails. Any such a is said to be a witness for the compositeness of n. For each odd composite n, at least three-fourths of the numbers a with 1 < a < n - 1 will be witnesses for n. Theorem 16.4. Let p be an odd prime and p - 1 = 2hm, with m odd and h 2: 1. Then any integer a (1 <a< p - 1) satisfies am= 1 (mod p) or a2jm = -1 (mod p) for some j = 1, 2, ... , h - 1. Proof. Assume that a has order k modulo p. By Theorem 8.1, k must divide p - 1 = 2hm. When k is odd, Euclid's lemma tells us that k Im; say, m = kr for some integer r. The result is that am = (akY = ir = 1 (mod p) Now, take k to be even. In this case it may be written ask= 2H1d, where j 2: 0 and dis an odd integer. The relation 2H1d I 2hm yields j + 1 :::= h and d I m . Also, from ·+1 . the congruence a2' d = 1 (mod p) we get a2' d = ± 1 (mod p ). Because a has order k, a2jd = 1 (mod p) is not possible. In consequence, a2jd = -1 (mod p). Now m = dt for an odd integer t. This leads immediately to a2jm = (a2jd)t = (-1)' = -1 (mod p) which establishes the theorem. Before continuing, let us use Theorem 16.4 to test n = 2201 for compositeness. Now n - 1 = 23 · 275. Working modulo 2201, it turns out that 2215 = 1582 2550 = 187 21100 = 1954 22200 = 1582 370 ELEMENTARY NUMBER THEORY and hence 2201 fails the Miller-Rabin test for a = 2. Thus, 2201 is correctly asserted to be composite, with 2 serving as a witness. It should be emphasized that surviving the test for a single value of a does not guarantee that n is prime. For example, if n = 2047 = 23 · 89, then n - 1 = 2 · 1023. Computing yields 21023 = 1 (mod 2047), so that 2047 passes the test. The Miller-Rabin test is often called a probabilistic primality test, because it uses random input to detect most prime numbers. Suppose that we wish to decide whether a given odd integer n is prime. Choose k integers a1, a2, ... , ak indepen­ dently at random, with 0 < ai < n. If n fails the Miller-Rabin test for some one of the ai, then n is immediately seen to be composite. Although passing the test for all a; is no actual guarantee of the primality of n, it might well make us strongly suspect that it is prime. In this situation, n is commonly described as being a probable prime (something of a misnomer, because n is either a prime or it is not). It can be shown that the probability of a composite integer surviving a series of k Miller-Rabin tests is at most ( � )k. With reasonable confidence in the correctness of the answer, we are able to declare that n is prime without any formal proof having been given. Modern computers make taking k = 100 in the random base procedure perfectly realistic, in which case the probability that n is actually prime is at least 1 - Ci)100. One consequence of the Miller-Rabin test was the determination (1999) that the repunit R49081 is a probable prime. PROBLEMS 16.2 1. Use Pollard's rho-method to factor the following integers: (a) 299. (b) 1003. (c) 8051. 2. Find a nontrivial factor of 4087 by the rho-method employing the indicated xo and f(x): (a) xo = 2, f(x) = x2 - 1. (b) xo = 3, f(x) = x2 + 1. (c) xo = 2, f(x) = x2 + x + 1. 3. By applying Pollard's p - 1 method, obtain a factorization of (a) 1711. (b) 4847. (c) 9943. 4. Use the continued fraction factorization algorithm to factor each of the following integers: (a) 1241 [Hint: ,JT24l = [35; 4,2,1,1 ... ].] (b) 2173 (c) 949 [Hint: The integer t1t3 is a square.] (d) 7811 [Hint: J7811 = [88; 2,1,1,1,2,1,1,2 ... ] leads to t2t6 = 852.] 5. Factor 1189 by applying the continued fraction factorization algorithm to 7134 = 6. 1189. 6. Use the quadratic sieve method to factor each of the following integers: (a) 8131 [Hint: Take -1,2,3,5,7 as the factor base.] (b) 13199 [Hint: Use the factor base -1,2,5,7,13,29.] (c) 17873 [Hint: Use the factor base -1,2,7,11,23.] SOME MODERN DEVELOPMENTS 371 7. Use Lucas's primality test to the base a to deduce that the integers below are prime: (a) 907, a = 2. (b) 1301, a = 2. (c) 1709, a = 3. 8. Verify the primality of the following integers by means of Pocldington's theorem: (a) 917. (b) 5023. (c) 7057. 9. Show that Pocklington's theorem leads to the following result of E. Proth (1878). Let n = k · 2m + 1, where k is odd and 1:::: k < 2m; if a<n-l)/2 = -1 (mod n) for some integer a, then n is prime. 10. Use Proth's result to establish the primality of the following: (a) 97 = 3 · 25 + 1. (b) 449 = 7 . 26 + 1. (c) 3329 = 13 · 28 + I. 11. An odd composite integer that passes the Miller-Rabin test to the base a is said to be a strong pseudoprime to the base a. Confirm the assertions below: (a) The integer 2047 is not a strong pseudoprime to the base 3. (b) 25 is a strong pseudoprime to the base 7. ( c) 65 is a strong pseudoprime to the base 8, and to the base 18. ( d) 341 is a pseudoprime, but not a strong pseudoprime to the base 2. 12. Establish that there are infinitely many strong pseudoprimes to the base 2. [Hint: If n is a pseudoprime (base 2), show that Mn = 2n - 1 is a strong pseudoprime to the base 2.] 13. For any composite Fermat number Fn = 22\" + 1, prove that Fn is a strong pseudoprime to the base 2. 16.3 AN APPLICATION TO FAC TORING: REMOTE COIN FLIPPING Suppose that two people, Alice and Bob, wish to flip a fair coin while they are conversing over the telephone. Each entertains a doubt: would the person flipping the coin possibly cheat, by telling the party who calls the outcome that they are wrong-no matter how the coin turns up? Without resorting to the services of trusted witnesses, can a procedure be set up that cannot be biased by either Alice or Bob? In 1982, Manuel Blum devised a number-theoretic scheme, a two-part protocol, which meets the specifications of a coin toss: that is, the probability of correctly guessing the outcome is 1/2. The game's security against duplicity hinges on the difficulty of factoring integers that are the products of two large primes of roughly the same size. At a certain stage in Blum's game, one of the players is required to solve the quadratic congruence x2 - a (mod n ). A solution is said to be a square root of the integer a modulo n. When n = pq, with p and q distinct odd primes, there are exactly four incongruent square roots of a modulo n. To see this, observe that 372 ELEMENTARY NUMBER THEORY x2 = a (mod n) admits a solution if and only if the two congruences x2 =a (mod p) and x2 =a (mod q) are both solvable. The solutions of these two congruences-assuming they exist­ split into two pairs ±x1 (mod p) and ±x2 (mod q ), which may be combined to form four sets of simultaneous congruences: x = x1 (mod p) x - x2 (modq) x - -x1 (mod p) x = -x2 (mod q) x - x1 (mod p) x = -x2 (mod q) x = -x1 (mod p) x - x2 (modq) We find four square roots of a modulo n when we solve these systems using the Chinese Remainder Theorem. Before going any further, we pause for an example. Example 16.7. Let us determine the solutions of the congruence x2 = 324 (mod 391) where 391 = 17 · 23; in other words, find the four square roots of 324 modulo 391. Now x2 = 324 = 1(mod17) and x2 = 324 = 2 (mod 23) have respective solutions x = ±1 (mod 17) and x = ±5 (mod 23) We therefore obtain four pairs of simultaneous linear congruences: x = 1 (mod 17) x = -5 (mod 23) x = -1(mod17) x = 5 (mod 23) x = 1 (mod 17) x = 5 (mod 23) x = -1(mod17) x = -5 (mod 23) 37 4 ELEMENTARY NUMBER THEORY leads to pq I (x + y )(x - y ). This in tum implies that each prime divides either x + y or x - y, although both cannot divide the same factor. Thus gcd(x + y, n) is either p or q, and gcd(x - y, n) produces the other prime factor. On the other hand, if Bob is sent either x or -x, then he has learned nothing new and is unable to factor n in a reasonable length of time. His failure to do so is an admission that Alice has won the game. After the game is over, she can assure Bob that she used a Blum integer by providing its factors. Bob should check that the disclosed factors are indeed primes. We close with an example of Blum's game using small prime numbers, although modern-day computers allow primes with a hundred or more digits. Example 16.8. Alice begins by choosing the primes p = 43 and q = 71 and telling Bob their product, 3053 = 43 · 71. He responds by randomly selecting 192 as his secret number; then Bob computes 192 2 = 36864 = 228 (mod 3053) and sends back the value 228. To obtain the four square roots of 228 modulo 3053, Alice first solves the quadratic congruences x 2 = 228 = 13 (mod 43) and x2 = 228 = 15 (mod 71) Because 43 = 71 = 3 (mod 4), their solutions tum out to be x = ±13C43+l)/4 = ±1311 = =1=20 (mod 43) x = ±15c71+014 = ±1518 = =f2l (mod 71) respectively. Next Alice solves the four systems of linear congruences determined by x = ±20 (mod 43) and x = ±21 (mod 71). From the Chinese Remainder Theorem, she finds thatx = ±192 (mod 3053) or x = ±1399 (mod 3053);expressed as positive numbers, x = 192, 2861, 1399, 1654 (mod 3053) Of these four numbers, two are equivalent modulo 3053 to Bob's secret number and the other two are not. Although Alice has an even chance of picking a \"correct\" number, let us suppose that she makes a nonwinning choice by guessing at 1399. This means that Bob has won the toss, but Alice prudently challenges him to prove it. So Bob determines the factorization of 3053 by calculating. gcd(192 + 1399, 3053) = gcd(1591, 3053) = 43 gcd(192 - 1399, 3053) = gcd(-1207, 3053) = 71 He sends these factors to Alice to confirm that she has chosen incorrectly. PROBLEMS 16.3 1. Determine whether 12 has a square root modulo 85; that is, whether x2 = 12 (mod 85) is solvable. 2. Find the four incongruent solutions of each of the quadratic congruences below: (a) x2 = 15 (mod 77). (b) x2 = 100 (mod 209). (c) x2 = 58 (mod 69). SOME MODERN DEVELOPMENTS 37 5 3. Carry out the details of a long-distance coin toss in which Alice selects p = 23, q = 31 and Bob chooses x = 73. 4. For a coin toss over a phone line, Alice selects p = 47, q = 79 and Bob chooses x = 123. Of the four numbers Alice then calculates, which two represent losing calls? 5. Here is another procedure for tossing coins electronically: (a) Alice and Bob agree on a prime number p such that p - 1 contains at least one large prime factor. (b) Bob chooses two primitive roots r and s of p. He sends the two roots to Alice. (c) Alice now picks an integer x, where gcd(x, p - 1) = 1. She returns to Bob one of the values y = r x (mod p) and y = sx (mod p). (This corresponds to the coin toss.) ( d) Bob \"calls the toss\" by guessing whether r or s was used to calculate y. Work through the details of a coin toss where p = 173, r = 2, s = 3, and x = 42. 16.4 THE PRIME NUMBER THEOREM AND ZETA FUNCTION Although the sequence of prime numbers exhibits great irregularities of detail, a trend is definitely apparent \"in the large.\" The celebrated Prime Number Theorem allows us to predict, at least in gross terms, how many primes there are less than a given number. It states that if the number is n, then there are about n divided by log n (here, log n denotes the natural logarithm of n) primes before it. Thus, the Prime Number Theorem tells us how the primes are distributed \"in the large,\" or \"on the average,\" or \"in a probability sense.\" One measure of the distribution of primes is the function rr (x ), which, for any real number x, represents the number of primes that do not exceed x; in symbols, rr(x) = Lp::;x 1. In Chapter 3, we proved that there are infinitely many primes, which is simply an expression of the fact that limx--+oo rr(x) = oo. Going in the other direction, it is clear that the prime numbers become on the average more widely spaced in the higher parts of any table of primes; in informal terms, one might say that almost all of the positive integers are composite. By way of justifying our last assertion, let us show that the limit limx--+oo rr(x)/x = 0. Because rr(x)/x > 0 for all x > 0, the problem is reduced to proving that rr (x) / x can be made arbitrarily small by choosing x sufficiently large. In more precise terms, what we shall prove is that if E > 0 is any number, then there must exist some positive integer N such that rr(x)/x < E whenever x > N. To start, let n be a positive integer and use Bertrand's conjecture to pick a prime p with 2n-l < p :::=: 2n. Then pl(2n)!, but p )' (2n-1)!, so that the binomial coefficient (2��1) is divisible by p. This leads to the inequalities and, upon taking the exponents of 2 on each side, the subsequent inequality (1) SOME MODERN DEVELOPMENTS 377 counterexample when x = y, because it has been shown (1975) that the inequality n (2x) < 2rr (x) holds for all x 2: 11. It was Euler (probably about 1740) who introduced into analysis the zeta function 00 1 �(s) = '°\"' - = 1- s + 2- s + 3- s + · · · � ns n=l the function on whose properties the proof of the Prime Number Theorem ultimately depended. Euler's fundamental contribution to the subject is the formula representing � (s) as a convergent infinite product; namely, ( 1 ) -l �(s) = n 1 - PS p s > 1 where p runs through all primes. Its importance arises from the fact that it asserts equality of two expressions of which one contains the primes explicitly and the other does not. Euler considered � (s) as a function of a real variable only, but his formula nonetheless indicates the existence of a deep-lying connection between the theory of primes and the analytic properties of the zeta function. Euler's expression for � (s) results from expanding each of the factors in the right-hand member as 1 = 1 + � + (�)2 + (�)3 + ... 1 - 1 I pS PS PS PS and observing that their product is the sum of all terms of the form 1 ( k1 k2 k, ) s P1 P2 ···Pr where p1, ... , Pr are distinct primes. Because every positive integer n can be written uniquely as a product of prime powers, each term 1 / ns appears once and only once in this sum; that is, the sum simply is I::i l/ns. It turns out that Euler's formula for the zeta function leads to a deceptively short proof of the infinitude of primes: the occurrence of a finite product on the right-hand side would contradict the fact that lims�l �(s) = oo. A problem that continues to attract interest concerns the value of� (n) when n > 1 is an integer. Euler showed during the 1730s that � (2n) is a rational multiple of n 2n, which makes it an irrational number: �(2) = rr2 /6, �(4) = n4 /90, �(6) = n6 /945, �(8) = rr8 /9450, ... The question remains unsettled for odd integers. Only in 1978 did the French mathe­ matician Roger Apery establish that �(3) is irrational; although the proof was hailed as \"miraculous and magnificent\" when it first appeared, it did not extend in any obvious way to �(2n + 1) for n > 1. However, in 2000 it was proved that infinitely many such values are irrational. The values of � (2n) can be expressed in terms of the so-called Bernoulli num­ bers Bn, named for James Bernoulli (1654-1705). Today these are usually defined 378 ELEMENTARY NUMBER THEORY inductively by taking Bo = 1 and, for n > 1, n-1 (n+l) (n + l)Bn = -� k Bk A little calculation shows that the first few Bn are For instance, so that B4 = -1/30. Bo= 1 B2 = 1/6 B4 = -1/30 B6 = 1/42 Bs = -1/30 Bi= -1/2 B3 = 0 Bs = 0 B1=0 Bg = 0 The Bernoulli numbers B2n+l beyond the first are all equal to zero, while all of the B2n are rational numbers, which, after the first, alternate in sign. In 1734, Euler calculated their values up to 8615841276005 B3o = 14322 Shortly thereafter he derived the remarkable formula 2n - (-l)n+1(2rr)2n B2n � ( ) - (2n) ! , n � 1 Legendre was the first to make any significant conjecture about functions that give a good approximation to n (x) for large values of x. In his book Essai sur la Theorie des Nombres (1798), Legendre ventured that n(x) is approximately equal to the function x log x - 1.08366 By compiling extensive tables on how the primes distribute themselves in blocks of one thousand consecutive integers, Gauss reached the conclusion that n (x) increases at roughly the same rate as each of the functions x /log x and f,x du Li(x) = -- 2 logu with the logarithmic integral Li(x) providing a much closer numerical approxima­ tion. Gauss's observations were communicated in a letter to the noted astronomer Johann Encke in 1849, and first published in 1863, but appear to have begun as early as 1791 when Gauss was 14 years old-well before Legendre's treatise was written. SOME MODERN DEVELOPMENTS 379 It is interesting to compare these remarks with the evidence of the tables: x x 7r(X) x 7r(x) logx - 1.08366 logx Li(x) (x/Iogx) 1000 168 172 145 178 1.159 10,000 1,229 1,231 1086 1246 1.132 100,000 9,592 9,588 8,686 9,630 1.104 1,000,000 78,498 78,543 72,382 78,628 1.084 10,000,000 664,579 665,140 620,420 664,918 1.071 100,000,000 5,761,455 5,768,004 5,428,681 5,762,209 1.061 The first demonstrable progress toward comparing 1T (x) with x / log x was made by the Russian mathematician P. L. Tchebycheff. In 1850, he proved that there exist positive constants a and b, a < 1 < b, such that a ( -x ) < rr(x) < b ( -x ) logx logx for sufficiently large x. Tchebycheff also showed that if the quotient rr (x) / (x / log x) has a limit as x increases, then its value must be 1. Tchebycheff's work, fine as it is, is a record of failure: what he could not establish is that the foregoing limit does in fact exist, and, because he failed to do this, he failed to prove the Prime Number Theorem. It was not until some 45 years later that the final gap was filled. We might observe at this point that Tchebycheff's result implies that the series Lp l/ p, extended over all primes, diverges. To see this, let Pn be the nth prime, so that 1T (Pn) = n. Because we have rr(x) > a ( -x ) logx for sufficiently large x, it follows that the inequality n = rr( pn) > a ( Pn ) > � log pn holds if n is taken sufficiently large. But n2 > Pn leads to log Pn < 2 log n, and therefore we get apn < n log Pn < 2n log n when n is large. In consequence, the series I::1 1/ Pn will diverge in comparison with the known divergent series I::2(1/n logn). A result similar to the previous one holds for primes in arithmetic progressions. We know that if gcd(a, b) = 1, then there are infinitely many primes of the form p = an + b. Dirichlet proved that the sum of 1 / p, taken over such primes, diverges. For instance, it applies to 4n + 1 primes: 1 1 1 1 1 1 I: - = - + - + - + - + - + ··· p=4n+l P 5 13 17 29 37 is a divergent series. 380 ELEMENTARY NUMBER THEORY A dramatic change takes place when the primes are allowed to run over just the twin primes. In 1919, the Norwegian mathematician Viggo Brun showed that the series formed by the reciprocals of the twin primes converges. The twin primes (even if there are infinitely many of them) are \"sufficiently scarce\" in the sequence of all primes to cause convergence. The sum B = (� + �) + (� + �) + (_!_ + _!_) + ... 3 5 5 7 11 13 which is called Brun 's constant, is estimated to be 1.9021604 ± 5 · 10-1. Notice that the prime 5 appears in the two twin pairs 3,5 and 5,7; no other prime number enjoys this property. Let n2 (x) denote the number of twin primes not exceeding x; that is, the number of primes p for which p + 2 < x is also a prime. A famous conjecture (1923) of Hardy and Littlewood is that n2(x) increases much like the function {x du Lz(x) = 2C 12 (log u)2 where C = 0.661618158 ... is known as the twin-prime constant. The next table gives some idea how closely n2 is approximated by L2(x). The radically new ideas that were to furnish the key to a proof of the Prime Num­ ber Theorem were introduced by Bernhard Riemann in his epoch-making memoir Uber die Anzahl der Primzahlen unter einer gegebenen Grosse of 1859 (his only paper on the theory of numbers). Where Euler had restricted the zeta function { (s) to real values of s, Riemann recognized the connection between the distribution of primes and the behavior of � (s) as a function of a complex variable s = a + bi. He enunciated a number of properties of the zeta function, together with a remarkable identity, known as Riemann's explicit formula, relating n(x) to the zeros of �(s) in the s-plane. The result has caught the imagination of most mathematicians because it is so unexpected, connecting two seemingly unrelated areas in mathematics; namely, number theory, which is the study of the discrete, and complex analysis, which deals with continuous processes. x 7r2(x) L2(x) - 7r2(x) 103 35 11 104 205 9 Hf 1,224 25 106 8,169 79 101 58,980 -226 108 440,312 56 109 3,424,506 802 1010 27,412,679 -1262 1011 224,376,048 -7183 In his memoir, Riemann made a number of conjectures concerning the distri­ bution of the zeros of the zeta function. The most famous is the so-called Riemann SOME MODERN DEVELOPMENTS 381 hypothesis, which asserts that all the nonreal zeros of � (s) are at points � + bi of the complex plane; that is, they lie on the \"critical line\" Re(s) = �· In 1914, G. H. Hardy provided the first concrete result by proving that there are infinitely many zeros of � (s) on the critical line. A series of large computations has been made, culminating in the recent verification that the Riemann hypothesis holds for all of the first (1.5)1010 zeros, an effort that involved over a thousand hours on a modem supercomputer. This famous conjecture has never been proved or dis­ proved, and it is undoubtedly the most important unsolved problem in mathematics today. Riemann's investigations were exploited by Jacques Hadamard and Charles de la Vallee Poussin who, in 1896, independently of each other and almost simultaneously, succeeded in proving that lim rr(x) = 1 x---+oo x /log x The result expressed in this formula has since become known as the Prime Number Theorem. De la Vallee Poussin went considerably further in his research. He showed that, for sufficiently large values of x, rr (x) is more accurately represented by the logarithmic integral Li(x) than by the function x logx - A no matter what value is assigned to the constant A, and that the most favorable choice of A in Legendre's function is 1. This is at variance with Legendre's original contention that A = 1.08366, but his estimate (based on tables extending only as far as x = 400000) had long been recognized as having little more than historical interest. Today, a good deal more is known about the relationship between rr (x) and Li(x ). We shall only mention a theorem of Littlewood to the effect that the difference rr (x) - Li(x) assumes both positive and negative values infinitely often as x runs over all positive integers. Littlewood's result is a pure \"existence theorem\" and no numerical value for x for which rr (x) - Li(x) is positive has ever been found. It is a curious fact that an upper bound on the size of the first x satisfying rr (x) > Li(x) is available; such an x must occur someplace before a number of incomprehensible magnitude. Hardy contended that it was the largest number that ever had a practical purpose. This upper limit, obtained by S. Skewes in 1933, has gone into the literature under the name of the Skewes number. Somewhat later ( 1955), Skewes decreased the top exponent in his number from 34 to 3. In 1997, this bound was reduced considerably when it was proved that there are more than 10311 successive integers x in the vicinity of (1.398) 10316 for which rr(x) > Li(x). However, an explicit numerical value of x is still beyond the reach of any computer. What is perhaps remarkable is that rr (x) < Li(x) for all x at which rr (x) has been Setting x = Pn, so that n (pn) = n, the result n log n lim = 1 n--700 Pn SOME MODERN DEVELOPMENTS 383 follows. This may be interpreted as asserting that if there are n primes in an interval, then the length of the interval is roughly n log n. Until recent times, the opinion prevailed that the Prime Number Theorem could not be proved without the help of the properties of the zeta function and without recourse to complex function theory. It came as a great surprise when in 1949 the Norwegian mathematician Atle Selberg discovered a purely arithmetical proof. His paper An Elementary Proof of the Prime Number Theorem is \"elementary\" in the technical sense of avoiding the methods of modern analysis; indeed, its content is exceedingly difficult. Selberg was awarded a Fields Medal at the 1950 International Congress of Mathematicians for his work in this area. The Fields Medal is considered to be the equivalent in mathematics of a Nobel Prize. (The thought that mathematics should be included in his areas of recognition seems never to have occurred to Alfred Nobel.) Presented every 4 years to a person under 40, the medal is the mathematical community's most distinguished award. It will be another million years, at least, before we understand the primes. PAUL ERDOS MISCELLANEOUS PROBLEMS 385 12. For n � 1, let 2n and 2n+ 1 be written in decimal form. If N is the number formed by placing these decimal representations side by side, show that 31 N. For example, when n = 6, we have 3 164128 and 3 112864. 13. For what digits Xis 242628X91715131 divisible by 3? 14. Find the last digit of 19991999 and the last two digits of 34321. 15. The three children in a family have feet that are 5, 7, and 9 inches long. Each child measures the length of the dining room in their housing using their feet, and each finds that there are 3 inches left over. How long is the dining room? 16. In the sequence of triangular numbers, suppose that tn(tn-1 + tn+l) = tk Determine k as a function of n. 17. Prove that a repunit prime Rn cannot be expressed as the sum of two squares. 18. Find the remainder when 70!/18 is divided by 71. 19. State and prove the general result illustrated by 42 = 16 342 = 1156 3342 = 111556 33342 = 11115556, ... 20. If pis a prime, show that p I (r(p)</>(p) + 2) and p I (r(p)a(p) - 2). 21. Establish the formula Ld In µ(d)2w(n/d) = I µ(n) 1. 22. Prove that n is an even integer if and only if Ld 1 n </>(d)µ(d) = 0. 23. If r(n) is divisible by an odd prime, show that µ(n) = 0. 24. Determine whether 97 divides n2 - 85 for some choice of n � 1. 25. Find all integers n that satisfy the equation (n - 1)3 + n3 + (n + 1)3 = (n + 2)3 [Hint: Work with the equation obtained by replacing n by k + 4.] 26. Prove that the Fermat numbers are such that Fn + Fn+l = 1 (mod 7) 27. Verify that 6 is the only square-free even perfect number. 28. Given any four consecutive positive integers, show that at least one cannot be written as the sum of two squares. 29. Prove that the terms of the Lucas sequence satisfy the congruence 2n Ln = 2 (mod 10) 30. Show that infinitely many Fibonacci numbers are divisible by 5, but no Lucas numbers have this property. 31. For the Fibonacci numbers, establish that 18 divides n � 1 32. Prove that there exist infinitely many positive integers n such that n and 3n - 2 are per­ fect squares. 33. If n = 5 (mod 10), show that 11 divides the sum 12n + 9n + s n + 6n 34. Establish the following: (a) 7 divides no number of the form 2n + 1, n � 0. (b) 7 divides infinitely many numbers of the form 10n + 3, n � 0. 35. For n = ±4 (mod 9), show that the equation n = a3 + b3 + c3 has no integer solution. 386 ELEMENTARY NUMBER THEORY 36. Prove that if the odd prime p divides a2 + b2, where gcd(a, b) = 1, then p = 1 (mod 4 ). 37. Find an integer n for which the product 9999 · n is a repunit. [Hint: Work with the equation 9999 · n = R4k·l 38. Verify that 10 is the only triangular number that can be written as the sum of two consecutive odd squares. 39. Determine whether there exists a Euclidean number p # + 1 = 2 . 3 . 5 . 7 ... p + 1 that is a perfect square. 40. Consider a prime p = 1 (mod 60). Show that there exist positive integers a and b with p = a2 + b2, where 3 divides a orb and 5 divides a orb. 41. Prove that the sum 299 + 2999 + 29999 + ... + 29999999999999 is divisible by 12. 42. Use Pell's equation to show that there are infinitely many integers that are simultaneously triangular numbers and perfect squares. 43. Given n > 0, show that there exist infinitely many k for which the integer (2k + 1)2n + 1 is pnme. 44. Show that each term of the sequence 16, 1156, 111556, 11115556, 1111155556 .... is a perfect square. 45. Find all primes of the form p2 + 2P, where p is a prime. 46. The primes 37,67,73,79, ... are of the form p = 36ab + 6a - 6b + 1, with a::::: 1, b ::::: 1. Show that no pair of twin primes can contain a prime of this form. 47. Prove that n ! is not a perfect square for n > 1. [Hint: Use Bertrand's conjecture.] 48. A near-repunit is an integer kRn that has n - 1 digits equal to 1, and one 0 in the k + 1 'st place from the right; that is, kRn = Rn-k-1 lO k +l + Rk = 111 ... 11011 ... 111 Show that if gcd(n - 1, 3k) > 1, then k Rn is composite. 49. Let p1, p2, ••• , Pn be the first n primes in the natural order. Show that there are at least two new primes in the interval Pn < x =:: P1P2 · · · Pn + 1 for n ::::: 2. 50. Verify that there exist no primes p and q that satisfy the condition p2 = lOq - 999. [Hint: Work modulo 7.] APPENDIXES GENERAL REFERENCES Adams, W., and L. Goldstein. 1976. Introduction to Number Theory. Englewood Cliffs, N.J.: Prentice­ Hall. Adler, Andrew, and Cloury, John. 1995. The Theory of Numbers: A Text and Source Book of Problems. Boston: Jones and Bartlett. Allenby, B. J., and J. Redfern. 1989. Introduction to Number Theory with Computing. London: Edward Arnold. Andrews, George. 1971. Number Theory. Philadelphia: W. B. Saunders. Archibald, Ralph. 1970. An Introduction to the Theory of Numbers. Columbus, Ohio: Charles E. Merrill. Baker, Alan. 1984. A Concise Introduction to the Theory of Numbers. Cambridge, England: Cambridge University Press. Barbeau, Edward. 2003. Pell's Equation. New York: Springer-Verlag. Barnett, I. A. 1972. Elements of Number Theory. Rev. ed. Boston: Prindle, Weber & Schmidt. Beck, A., M. Bleicher, and D. Crowe. 1969. Excursions into Mathematics. New York: Worth. Beiler, A.H. 1966. Recreations in the Theory of Numbers. 2d ed. New York: Dover. Bressoud, David. 1989. Factorization and Primality Testing. New York: Springer-Verlag. Brown, Ezra. \"The First Proof of the Quadratic Reciprocity Law, Revisited.\" American Mathematical Monthly 88(1981): 257-64. Burton, David. 2007. The History of Mathematics: An Introduction. 6th ed. New York: McGraw-Hill. Clawson, Calvin. 1996. Mathematical Mysteries: The Beauty and Magic of Numbers. New York: Plenum Press. Cohen, Henri. 1993. A Course in Computational Algebraic Number Theory. New York: Springer-Verlag. Crandall, Richard, and Pomerance, Carl. 2001. Prime Numbers: A Computational Perspective. New York: Springer-Verlag. Dickson, Leonard. 1920. History of the Theory of Numbers. Vols. 1, 2, 3. Washington, D.C.: Carnegie Institute of Washington. (Reprinted, New York: Chelsea, 1952.) Dirichlet, P. G. L. 1999. Lectures on Number Theory. Translated by J. Stillwell. Providence, R.I.: American Mathematical Society. 387 388 GENERAL REFERENCES Dudley, Underwood. 1978. Elementary Number Theory, 2d ed. New York: W. H. Freeman. Edwards, Harold. 1977. Fermat's Last Theorem. New York: Springer-Verlag. Erdos, Paul, and Suryani, Janos. 2003. Topics in the Theory of Numbers. New York: Springer-Verlag. Everest, G., and Ward, T. 2005. An Introduction to Number Theory. New York: Springer-Verlag. Eves, Howard. 1990. An Introduction to the History of Mathematics. 6th ed. Philadelphia: Saunders College Publishing. Goldman, Jay. 1998. The Queen of Mathematics: A Historically Motivated Guide to Number Theory. Wellesley, Natick, Mass.: A. K. Peters. Guy, Richard. 1994. Unsolved Problems in Number Theory. 2d ed. New York: Springer-Verlag. Hardy, G. H., and E. M. Wright. 1992. An Introduction to the Theory of Numbers. 5th ed. London: Oxford University Press. Heath, Thomas. 1910. Diophantus of Alexandria. Cambridge, England: Cambridge University Press. (Reprinted, New York: Dover, 1964.) Hoggatt, V. E. Jr., and E. Verner. 1969. Fibonacci and Lucas Numbers. Boston: Houghton Mifflin. Ireland, K., and M. Rosen. 1990.A Classical Introduction to Modern Number Theory. 2d ed. New York: Springer-Verlag. Koblitz, Neal. 1994. A Course in Number Theory and Cryptography, 2d ed. New York: Springer-Verlag. Koshy, Thomas. 2001. Fibonacci and Lucas Numbers with Applications. New York: John Wiley and Sons. Landau, E. 1952. Elementary Number Theory. Translated by J. Goodman. New York: Chelsea. Le Veque, William. 1977. Fundamentals of Number Theory. Reading, Mass.: Addison-Wesley. (Reprinted, New York: Dover, 1990.) Long, Calvin. 1972. Elementary Introduction to Number Theory. 2d ed. Lexington, Mass.: D. C. Heath. Loweke, George. 1982. The Lore of Prime Numbers. New York: Vantage Press. Maxfield, J., and M. Maxfield. 1972. Discovering Number Theory. Philadelphia: W. B. Saunders. Mollin, Richard. 1998. Fundamental Number Theory with Applications. Boca Raton, Fla.: CRC Press. ---. 2001. An Introduction to Cryptography. Boca Raton, Fla.: CRA Press. ---. 2002. RSA and Public-Key Cryptography. Boca Raton, Fla.: CRA Press. Nagell, Trygve. 1964. Introduction to Number Theory. 2d ed. New York: Chelsea. Nathanson, Melvyn. 2000. Elementary Methods in Number Theory. New York: Springer-Verlag. Niven, I., H. Zuckerman, and H. Montgomery. 1991. An Introduction to the Theory of Numbers. 5th ed. New York: John Wiley and Sons. Ogilvy, C. S., and J. Anderson. 1966. Excursions in Number Theory. New York: Oxford University Press. Olds, Carl D. 1963. Continued Fractions. New York: Random House. Ore, Oystein. 1948. Number Theory and Its History. New York: McGraw-Hill. (Reprinted, New York: Dover, 1988). ---. 1967. Invitation to Number Theory. New York: Random House. Parshin, A., and I. Shafarevich. 1995. Number Theory I: Fundamental Problems, Ideas, and Theories. New York: Springer-Verlag. Pomerance, Carl, ed., 1990. Cryptology and Computational Number Theory. Providence, R. I.: American Mathematical Society. Posamentier, A., and Lehmann, I. 2007. The Fabulous Fibonacci Numbers. Amherst, N.Y.: Prometheus Books. Redmond, Don. 1996. Number Theory, An Introduction. New York: Marcel Dekker. Ribenboim, Paulo. 1979. 13 Lectures on Fermat's Last Theorem. New York: Springer-Verlag. ---. 1988. The Book of Prime Number Records. New York: Springer-Verlag. ---. 1991. The Little Book of Big Primes. New York: Springer-Verlag. ---. 1994. Catalan's Conjecture. Boston: Academic Press. ---. 1995. The New Book of Prime Number Records. New York: Springer-Verlag. ---. 1999. Fermat's Last Theorem for Amateurs. New York: Springer-Verlag. ---. 2000. My Numbers My Friends: Popular Lectures in Number Theory. New York: Springer- Verlag. ---. 2004. The Little Book of Bigger Numbers. New York: Springer-Verlag. ---. \"Galimatias Arithmeticae.\" Mathematics Magazine 71(1998): 331-40. GENERAL REFERENCES 389 ---.\"Prime Number Records.\" College Mathematics Journal 25(1994): 280--90. ---.\"Selling Primes.\" Mathematics Magazine 68(1995): 175-82. Riesel, Hans. 1994. Prime Numbers and Computer Methods for Factorization. 2d ed. Boston: Birkhauser. Robbins, Neville. 1993. Beginning Number Theory. Dubuque, Iowa: Wm. C. Brown. Roberts, Joe. 1977. Elementary Number Theory. Cambridge, Mass.: MIT Press. Rose, H. E. 1994. A Course in Number Theory. 2d ed. New York: Oxford University Press. Rosen, Kenneth. 2005. Elementary Number Theory and Its Applications. 5th ed. Reading, Mass.: Addison-Wesley. Salomaa, Arto. 1996. Public-Key Cryptography. 2d ed. New York: Springer-Verlag. du Santoy, Marcus. 2004. The Music of the Primes. New York: Harper Collins. Scharlau, W., and H. Opolka. 1984. From Fermat to Minkowski. New York: Springer-Verlag. Schroeder, Manfred. 1987. Number Theory in Science and Communication. 2d ed. New York: Springer- Verlag. Schumer, Peter. 1996. Introduction to Number Theory. Boston: PWS-Kent. Shanks, Daniel. 1985. Solved and Unsolved Problems in Number Theory. 3d ed. New York: Chelsea. Shapiro, Harold. 1983. Introduction to the Theory of Numbers. New York: John Wiley and Sons. Shoemaker, Richard. 1973. Perfect Numbers. Washington, D.C.: National Council of Teachers of Mathematics. Sierpinski, Waclaw. 1988. Elementary Theory of Numbers. Translated by A. Hulaniki. 2d ed. Amsterdam: North-Holland. ---. 1962. Pythagorean Triangles. Translated by A. Sharma. New York: Academic Press. Singh, Simon. 1997. Fermat's Enigma: The Epic Quest to Solve the World's Greatest Mathematical Problem. New York: Walker and Company. Starke, Harold. 1970. An Introduction to Number Theory. Chicago: Markham. Stroik, Dirk. 1969. A Source Book in Mathematics 1200-1800. Cambridge: Harvard University Press. Tattersall, James. 1999. Elementary Number Theory in Nine Lectures. Cambridge, England: Cambridge University Press. ---. 2006. Elementary Number Theory in Nine Chapters. 2d ed. Cambridge, England: Cambridge University Press. Tenenbaum, Gerald, and France, Michel. 2000. Prime Numbers and Their Distribution. Providence, R.I.: American Mathematical Society. Uspensky, J., and M.A. Heaslet. 1939. Elementary Number Theory. New York: McGraw-Hill. Vajda, S. 1989. Fibonacci and Lucas Numbers and the Golden Section: Theory and Applications. Chichester, England: Ellis Horwood. Van der Poorten, Alf. 1996. Notes on Fermat's Last Theorem. New York: John Wiley and Sons. Vanden Eynden, Charles. 1987. Elementary Number Theory. 2d ed. New York: Random House. Vorobyov, N. 1963. The Fibonacci Numbers. Boston: D. C. Heath. Weil, Andre. 1984. Number Theory: An Approach through History. Boston: Birkhauser. Wells, David. 2005. Prime Numbers: The Most Mysterious Figures in Math. New York: John Wiley and Sons. Welsh, Dominic. 1988. Codes and Cryptography. New York: Oxford University Press. Williams, Hugh. 1998. Edouard Lucas and Primality Testing. New York: John Wiley and Sons. SUGGESTED FURTHER READING Adaz, J. M., and Bravo, A. \"Euclid's Argument on the Infinitude of Primes.\" American Mathematical Monthly 110(2003): 141-42. Apostol, Tom. \"A Primer on Bernoulli Numbers and Polynomials.\" Mathematics Magazine 81 (2008): 178-190. Bateman, Paul, and Diamond, Harold. \"A Hundred Years of Prime Numbers.\" American Mathematical Monthly 103(1996): 729-41. Bauer, Friedrich. \"Why Legendre Made a Wrong Guess about rr(x).\" The Mathematical Intelligencer 25, No. 3(2003): 7-11. Berndt, Bruce. \"Ramanujan-100 Years Old (Fashioned) or 100 Years New (Fangled)?\" The Mathe­ matical Intelligencer 10, No. 3(1988): 24-29. Berndt, Bruce, and Bhargava, S. \"Ramanujan-For Lowbrows.\" American Mathematical Monthly 100(1993): 644-56. Bezuska, Stanley. \"Even Perfect Numbers- An Update.\" Mathematics Teacher 74(1981): 460-63. Bollabas, Bela. \"To Prove and Conjecture: Paul Erdos and His Mathematics.\" American Mathematical Monthly 105(1998): 209-37. Boston, Nigel, and Greenwood, Marshall. \"Quadratics Representing Primes.\" American Mathematical Monthly 102(1995): 595-99. Brown, Ezra. \"Three Connections to Continued Fractions.\" Pi Mu Epsilon Journal 11, No. 7(2002): 353-62. Collison, Mary Joan. \"The Unique Factorization Theorem: From Euclid to Gauss.\" Mathematics Mag­ azine 53(1980): 96-100. Cox, David. \"Quadratic Reciprocity: Its Conjecture and Application.\" American Mathematical Monthly 95(1988): 442-48. ---.\"Introduction to Fermat's Last Theorem.\" American Mathematical Monthly 101(1994): 3-14. Crandall, Richard. \"The Challenge of Large Numbers.\" Scientific American 276(Feb. 1997): 74-78. Dalezman, Michael. \"From 30 to 60 is Not Twice as Hard.\" Mathematics Magazine 73(Feb. 2000): 151-53. Devlin, Keith. \"Factoring Fermat Numbers.\" New Scientist 111, No. 1527(1986): 41-44. Dixon, John. \"Factorization and Primality Tests.\" American Mathematical Monthly 91(1984): 333-51. Dudley, Underwood. \"Formulas for Primes.\" Mathematics Magazine 56(1983): 17-22. Edwards, Harold. \"Euler and Quadratic Reciprocity.\" Mathematics Magazine 56(1983): 285-91. Erdos, Paul. \"Some Unconventional Problems in Number Theory.\" Mathematics Magazine 52(1979): 67-70. ---. \"On Some of My Problems in Number Theory I Would Most Like to See Solved.\" In Lecture Notes in Mathematics 1122. New York: Springer-Verlag, 1985: 74-84. 390 SUGGESTED FURTHER READING 391 ---. \"Some Remarks and Problems in Number Theory Related to the Work of Euler.\" Mathematics Magazine 56(1983): 292-98. Feistel, Horst. \"Cryptography and Computer Security.\" Scientific American 228(May 1973): 15-23. Francis, Richard. \"Mathematical Haystacks: Another Look at Repunit Numbers.\" College Mathematics Journal 19(1988): 240-46. Gallian, Joseph. \"The Mathematics ofldentification Numbers.\" College Mathematics Journal 22(1991 ): 194-202. Gardner, Martin. \"Simple Proofs of the Pythagorean Theorem, and Sundry Other Matters.\" Scientific American 211(0ct. 1964): 118-26. ---. \"A Short Treatise on the Useless Elegance of Perfect Numbers and Amicable Pairs.\" Scientific American 218(March 1968): 121-26. ---. \"The Fascination of the Fibonacci Sequence.\" Scientific American 220(March 1969): 116-20. ---. \"Diophantine Analysis and the Problem of Fermat's Legendary 'Last Theorem'.\" Scientific American 223(July 1970): 117-19. ---.\"On Expressing Integers as the Sums of Cubes and Other Unsolved Number-Theory Problems.\" Scientific American 229(Dec. 1973): 118-21. ---. \"A New Kind of Cipher That Would Take Millions of Years to Break.\" Scientific American 237(Aug. 1977): 120-24. ---. \"Patterns in Primes Are a Clue to the Strong Law of Small Numbers.\" Scientific American 243(Dec. 1980): 18-28. Goldstein, Larry. \"A History of the Prime Number Theorem.\" American Mathematical Monthly 80(1973): 599-615. Granville, Andrew, and Greg, Martin. \"Prime Number Races.\" American Mathematical Monthly 113 (2006): 1-33. Guy, Richard. \"The Strong Law of Small Numbers.\" American Mathematical Monthly 95(1988): 697-712. ---.\"The Second Strong Law of Small Numbers.\" Mathematics Magazine 63(1990): 1-20. Higgins, John, and Campbell, Douglas. \"Mathematical Certificates.\" Mathematics Magazine 67(1994): 21-28. Hodges, Laurent. \"A Lesser-Known Goldbach Conjecture.\" Mathematics Magazine 66(1993): 45-47. Hoffman, Paul. \"The Man Who Loved Numbers.\" The Atlantic 260(Nov. 1987): 60-74. Holdener, Judy. \"A Theorem of Touchard on the Form of Odd Perfect Numbers.\" American Mathematical Monthly 109(2002): 661-63. Honsberger, Ross. \"An Elementary Gem Concerning rr(n), the Number of Primes < n.\" Two-Year College Mathematics Journal 11 (1980): 305-11. Kleiner, Israel. \"Fermat: The Founder of Modem Number Theory.\" Mathematics Magazine 78(2005): 3-14. Koshy, Thomas. \"The Ends of a Mersenne Prime and an Even Perfect Number.\" Journal of Recreational Mathematics 3(1998): 196-202. Laubenbacher, Reinhard, and Pengelley, David. \"Eisenstein's Misunderstood Geometric Proof of the Quadratic Reciprocity Theorem.\" College Mathematics Journal 25(1994): 29-34. Lee, Elvin, and Madachy, Joseph. \"The History and Discovery of Amicable Numbers-Part I.\" Journal of Recreational Mathematics 5(1972): 77-93. Lenstra, H. W. \"Solving the Pell Equation.\" Notices of the American Mathematical Society 49, No. 2(2002): 182-92. Luca, Florian. \"The Anti-Social Fermat Number.\" American Mathematical Monthly 107(2000): 171-73. Luciano, Dennis, and Prichett, Gordon. \"Cryptography: From Caesar Ciphers to Public-Key Cryptosys- tems.\" College Mathematics Journal 18(1987): 2-17. Mackenzie, Dana. \"Hardy's Prime Problem Solved.\" New Scientist 2446 (May 8, 2004): 13. Mahoney, Michael. \"Fermat's Mathematics: Proofs and Conjectures.\" Science 178(0ct. 1972): 30-36. Matkovic, David. \"The Chinese Remainder Theorem: An Historical Account.\" Pi Mu Epsilon Journal 8(1988): 493-502. McCarthy, Paul. \"Odd Perfect Numbers.\" Scripta Mathematica 23(1957): 43-47. McCartin, Brian. \"e: The Master of All.\" The Mathematical Intelligencer 28 (2006): 10-26. 392 SUGGESTED FURTHER READING Mallin, Richard. \"A Brief History of Factoring and Primality Testing B. C. (Before Computers).\" Math­ ematics Magzine 75(2002): 18-29. Ondrejka, Rudolf. \"Ten Extraordinary Primes.\" Journal of Recreational Mathematics 18(1985-86): 87-92. Ondrejka, Rudolf, and Dauber, Harvey. \"Primer on Palindromes.\" Journal of Recreational Mathematics 26(1994): 256-67. Pomerance, Carl. \"Recent Developments in Primality Testing.\" The Mathematical Intelligencer 3( 1981 ): 97-105. ---.\"The Search for Prime Numbers.\" Scientific American 247(Dec. 1982): 122-30. ---.''A Tale of 1\\vo Sieves.\" Notices of the American Mathematical Society 43(1996): 1473-85. Reid, Constance. \"Perfect Numbers.\" Scientific American 88(March 1953): 84-86. Ribenboim, Paulo. \"Lecture: Recent Results on Fermat's Last Theorem.\" Canadian Mathematical Bulletin 20(1977): 229-42. Sander, Jurgen. \"A Story of Binomial Coefficients and Primes.\" American Mathematical Monthly 102(1995): 802-7. Schroeder, Manfred. \"Where Is the Next Mersenne Prime Hiding?\" The Mathematical Intelligencer 5, No. 3(1983): 31-33. Sierpinski, Waclaw. \"On Some Unsolved Problems of Arithmetic.\" Scripta Mathematica 25(1960): 125-36. Silverman, Robert. \"A Perspective on Computation in Number Theory.\" Notices of the American Math­ ematical Society 38(1991): 562-568. Singh, Simon, and Ribet, Kenneth. \"Fermat's Last Stand.\" Scientific American 277(Nov. 1997): 68-73. Slowinski, David. \"Searching for the 27th Mersenne Prime.\" Journal of Recreational Mathematics 11(1978-79): 258-61. Small, Charles. \"Waring's Problems.\" Mathematics Magazine 50(1977): 12-16. Stewart, Ian. \"The Formula Man.\" New Scientist 1591(Dec. 17, 1987): 24-28. ---.\"Shifting Sands of Factorland.\" Scientific American 276(June 1997): 134-37. ---.\"Proof and Beauty.\" New Scientist 2192(June 26, 1999): 29-32. ---.\"Prime Time.\" New Scientist 251l(August 6, 2005): 40-43. Uhler, Horace. \"A Brief History of the Investigations on Mersenne Numbers and the Latest Immense Primes.\" Scripta Mathematica 18(1952): 122-31. Vanden Eynden, Charles. \"Flipping a Coin over the Telephone.\" Mathematics Magazine 62(1989): 167-72. Vandiver, H. S. \"Fermat's Last Theorem.\" American Mathematical Monthly 53(1946): 555-78. Vardi, Ilan. \"Archimedes' Cattle Problem.\" American Mathematical Monthly 105(1998): 305-19. Wagon, Stan. \"Fermat's Last Theorem.\" The Mathematical Intelligencer 8, No. 1(1986): 59-61. ---.\"Carmichael's 'Empirical Theorem'.\" The Mathematical Intelligencer 8, No. 2(1986): 61-63. Yates, Samuel. \"Peculiar Properties of Repunits.\" Journal of Recreational Mathematics 2(1969): 139-46. ---. \"The Mystique of Repunits.\" Mathematics Magazine 51(1978): 22-28. TABLES TABLE 1 The least primitive root r of each prime p, where 2 ::5 p < I 000. p r p r p r p r p r p r 2 I 127 3 283 3 467 2 661 2 877 2 3 2 131 2 293 2 479 13 673 5 881 3 5 2 137 3 307 5 487 3 677 2 883 2 7 3 139 2 311 17 491 2 683 5 887 5 1 l 2 149 2 313 10 499 7 691 3 907 2 13 2 l 51 6 317 2 503 5 701 2 911 17 17 3 157 5 331 3 509 2 709 2 919 7 19 2 163 2 337 10 521 3 719 I 1 929 3 23 5 167 5 347 2 523 2 727 5 937 5 29 2 173 2 349 2 541 2 733 6 941 2 31 3 179 2 353 3 547 2 739 3 947 2 37 2 181 2 359 7 557 2 743 5 953 3 41 6 191 19 367 6 563 2 751 3 967 5 43 3 193 5 373 2 569 3 757 2 971 6 47 5 197 2 379 2 571 3 761 6 977 3 53 2 199 3 383 5 577 5 769 11 983 5 59 2 211 2 389 2 587 2 773 2 99 1 6 61 2 223 3 397 5 593 3 787 2 997 7 67 2 227 2 401 3 599 7 797 2 71 7 229 6 409 21 601 7 809 3 73 5 233 3 419 2 607 3 811 3 79 3 239 7 421 2 613 2 821 2 83 2 241 7 431 7 617 3 823 3 89 3 251 6 433 5 619 2 827 2 97 5 257 3 439 15 631 3 829 2 101 2 263 5 443 2 641 3 839 11 103 5 269 2 449 3 643 11 853 2 107 2 271 6 457 13 647 5 857 3 109 6 277 5 461 2 653 2 859 2 113 3 281 3 463 3 659 2 863 5 393 394 TABLES TABLE 2 The smallest prime factor of each odd tnteger n, 3 .:s: n .:s: 4999, not divisible by 5; a dash in the table indicates that n is itself prime. 1 IOI - 201 3 301 7 401 - 3 - 103 - 203 7 303 3 403 13 7 - 107 - 207 3 307 - 407 11 9 3 109 - 209 11 309 3 409 - 11 - 111 3 211 - 311 - 411 3 13 - 113 - 213 3 313 - 413 7 17 - 117 3 217 7 317 - 417 3 19 - 119 7 219 3 319 11 419 - 21 3 121 11 221 13 321 3 421 - 23 - 123 3 223 - 323 17 423 3 27 3 1 27 - 227 - 327 3 427 7 29 - 129 3 229 - 329 7 429 3 31 - 131 - 231 3 331 - 431 - 33 3 133 7 233 - 333 3 433 - 37 - 137 - 237 3 337 - 437 19 39 3 139 - 239 - 339 3 439 - 41 - 141 3 241 - 341 11 441 3 43 - 143 11 243 3 343 7 443 - 47 - 147 3 247 13 347 - 447 3 49 7 149 - 249 3 349 - 449 - SI 3 151 - 251 - 351 3 451 11 53 - 153 3 253 11 353 - 453 3 57 3 157 - 257 - 357 3 457 - 59 - 159 3 259 7 359 - 4 59 3 61 - 161 7 261 3 361 19 461 - 63 3 163 - 263 - 363 3 463 - 67 - 167 - 267 3 367 - 467 - 69 3 169 13 269 - 369 3 469 7 71 - 171 3 271 - 371 7 471 3 73 - 173 - 273 3 373 - 473 11 77 7 177 3 277 - 377 13 477 3 79 - 179 - 279 3 379 - 479 - 81 3 181 - 281 - 381 3 481 13 83 - 183 3 283 - 383 - 483 3 87 3 187 11 287 7 387 3 487 - 89 - 189 3 289 17 389 - 489 3 91 7 191 - 291 3 391 17 491 - 93 3 193 - 293 - 393 3 493 17 97 - 197 - 297 3 397 - 497 7 99 3 199 - 299 13 399 3 499 - 501 3 601 50_) 60_) 3 507 3 607 509 609 .-\\ 51 1 7 611 13 513 3 613 517 I 1 617 519 3 619 521 621 3 523 623 527 17 627 3 529 25 629 17 5:H 3 631 533 13 6.B 3 537 3 6.-\\7 7 539 7 6.'\\9 3 541 641 543 3 643 547 647 549 3 649 1 1 551 19 651 3 553 7 6'H 557 657 3 559 13 659 561 3 661 563 663 3 %7 3 667 23 569 669 3 571 671 11 573 3 673 577 677 579 3 679 7 581 7 681 3 583 I l 683 587 687 ) 589 19 689 13 591 3 691 593 693 3 597 3 697 17 599 699 3 TABLE 2 (cont'd) 701 801 3 703 19 803 11 707 ..., 807 _) f 709 809 7] l 3 811 \"7] 3 23 813 3 ..., 1 7 3 817 19 719 819 .'..\\ 721 7 821 723 3 823 727 827 729 5 829 7.'\\ 1 )7 8.'\\l 5 733 833 7 737 1 1 8.)7 .'..\\ 7.W 839 74 l 3 841 29 743 843 .'..\\ 747 3 847 7 749 7 849 3 751 851 23 153 3 853 757 857 759 3 859 \"761 861 3 \"763 7 863 767 13 867 3 769 869 l 1 771 3 871 13 773 873 3 777 3 877 779 19 879 3 781 I I 881 783 3 883 787 887 789 3 889 7 791 7 891 3 793 13 893 19 797 897 3 799 17 899 29 901 903 907 909 911 913 917 919 921 923 927 929 931 933 937 939 941 945 947 949 951 953 957 959 961 963 967 969 971 973 977 979 981 98) 987 989 991 993 997 999 TABLES 395 17 3 .'..\\ I I 7 3 13 .3 7 3 3 23 13 3 3 7 31 3 3 7 11 3 3 23 3 3 396 TABLES 1001 7 1 003 17 1007 19 1009 - 1011 3 1013 - 1017 3 1019 - 1021 - 1023 3 1027 13 1029 3 1031 - 1033 - 1037 17 1039 - 1041 3 1043 7 1047 3 1049 - 1051 - 1053 3 1057 7 1059 3 1061 - 1063 - 1067 11 1069 - 1071 3 1073 29 1077 3 1079 13 1081 23 1083 3 1087 - 1089 3 1091 - 1093 - 1097 - 1099 7 1 101 3 1103 - 1107 3 1109 - 1 1 11 11 1113 3 1117 - 1119 3 1121 19 1123 - 1127 7 1129 - 1131 3 1133 11 1137 3 1139 17 1141 7 1143 3 1147 31 1149 3 1151 - 1153 - 1157 13 1159 19 1161 3 1163 - 1167 3 1169 7 1171 - 1173 3 1177 11 1179 3 1181 - 1183 7 1187 - 1189 29 1191 3 1193 - 1197 3 1199 11 TABLE 2 (cont'd) 1201 - 1301 - 1401 3 1203 3 1303 - 1403 23 1207 17 1307 - 1407 3 1209 3 1309 7 1409 - 1211 7 1311 3 1411 17 1213 - 1313 13 1413 3 1217 - 13 17 3 1417 13 1219 23 1319 - 1419 3 1 22 1 3 1321 - 1421 7 1223 - 1323 3 1423 - 1227 3 1327 - 1427 - 1229 - 1329 3 1429 - 1231 - 1331 11 1431 3 123 3 3 1333 31 1433 - 1237 - 1337 7 1437 3 1239 3 1339 13 1439 - 1241 17 1341 3 1441 11 1243 11 1343 17 1 443 3 1247 29 1347 3 1447 - 1249 - 1349 19 1449 3 1251 3 1351 7 1451 - 1253 7 1353 3 1453 - 1257 3 1357 23 1457 31 1259 - 1359 3 1459 - 1261 13 1361 - 1461 3 1 263 3 1363 29 1463 7 1267 7 1367 - 1467 3 1269 3 1369 37 1469 13 1271 31 1 371 3 1471 - 1273 19 1373 - 1473 3 1277 - 1377 3 1477 7 1279 - 1379 7 1479 3 1281 3 1381 - 1481 - 1283 - 1383 3 1483 - 1287 3 1387 19 1487 - 1289 - 1389 3 1489 - 1291 - 1391 13 1491 3 1293 3 1393 7 1493 - 1297 - 1397 11 1497 3 1299 3 1399 - 1499 - TABLE 2 (cont'd) 1501 19 1601 - 1 701 3 1503 3 1603 7 1703 13 1507 1 1 1607 - 1707 3 1509 3 1609 - 1709 - 1511 - 1611 3 1711 29 1513 17 1613 - 1713 3 1517 37 1617 3 1717 17 1519 7 1619 - 1719 3 152 1 3 1621 - 1721 - 1523 - 1623 3 1723 - 1527 3 1627 - 1727 I 1 1529 1 1 1629 3 1729 7 1531 - 1631 7 1731 3 1533 3 1633 2 3 1733 - 1537 29 1637 - 1737 3 1539 3 1639 11 1739 37 1541 23 1641 3 1741 - 1543 - 1643 31 1743 3 1547 7 164 7 3 1747 - 1549 - 1649 17 1749 3 1551 3 1651 13 1751 17 1553 - 1653 3 1753 - 1557 3 1657 - 1757 7 1559 - 1659 3 1759 - 1561 7 1661 11 1761 3 1563 3 1663 - 1763 41 1567 - 1667 - 1767 3 1569 3 1669 - 1769 29 1571 - 1671 3 1771 7 1573 11 1673 7 1773 3 1577 19 1677 3 1777 - 1579 - 1679 23 1779 3 1581 3 1681 41 1781 13 1583 - 168 3 3 1783 - 1587 3 1687 7 1787 - 1589 7 1689 3 1789 - 1591 37 1691 19 1791 3 1593 3 1693 - 1793 11 1597 - 1697 - 1797 3 15 99 3 16 9 9 - 17 99 7 1801 - 1803 3 1807 13 1809 3 18 11 - 1813 7 1817 23 181 9 17 1821 3 1823 - 1827 3 1829 31 1831 - 1833 3 1837 11 1839 3 1841 7 1843 19 1847 - 1849 43 1851 3 185 3 17 1857 3 1859 II 1861 - 1863 3 1867 - 1869 3 1871 - 187 3 - 1877 - 1879 - 1881 3 1883 7 1887 3 1889 - 1891 31 1893 3 1897 7 18 99 3 TABLES 397 1901 - 1903 11 1907 - 1909 23 1911 3 1913 - 1917 3 1919 19 1921 17 1923 3 1927 41 1929 3 1931 - 1933 - 1937 13 1939 7 1941 3 194 3 29 1947 3 1949 - 1951 - 1953 3 1957 19 1959 3 1961 37 1963 13 1967 7 1969 11 19 71 3 1973 - 1977 3 1979 - 1981 7 1983 3 1987 - 1989 3 1991 11 1993 - 1997 - 1 9 9 9 - 398 TABLES 2001 3 2003 - 2007 3 2009 7 2011 - 2013 3 2017 - 2019 3 2021 43 2023 7 2027 - 2029 - 2031 3 2033 19 2037 3 2039 - 2041 13 2043 3 2047 23 2049 3 2051 7 2053 - 2057 11 2059 29 2061 3 2063 - 2067 3 2069 - 2071 19 207 3 3 2077 31 2079 3 2081 - 2083 - 2087 - 2089 - 2091 3 2093 7 2097 3 2099 - 2101 11 2103 3 2107 7 2109 3 2111 - 2113 - 2117 29 2119 13 2121 3 2123 11 2127 3 2129 - 2131 - 2133 3 2137 - 2139 3 2141 - 2143 - 2147 19 2149 7 2151 3 2153 - 21 57 3 2159 17 21 6 1 - 2163 3 2167 11 2169 3 2171 13 2173 41 2177 7 2179 - 2181 3 2183 37 2187 3 2189 11 2191 7 2193 3 2197 13 2199 3 TABLE 2 (cont'd) 2201 31 2301 3 2401 7 2203 - 2303 7 2403 3 2207 - 2307 3 2407 29 2209 47 2309 - 2409 3 2211 3 2311 - 2411 - 221 3 - 2313 3 2413 19 2217 3 2317 7 2417 - 2219 7 2319 3 2419 41 2221 - 2321 11 2421 3 2223 3 2323 23 2423 - 2227 17 2327 13 2427 3 2229 3 2329 17 2429 7 2231 23 2331 3 2431 11 2233 7 2333 - 2433 3 2237 - 2337 3 2437 - 2239 - 2339 - 2439 3 2241 3 234 l - 2441 - 2243 - 2343 3 2443 7 2247 3 2347 - 2447 - 2249 13 2349 3 2449 31 2251 - 2351 - 2451 3 2253 3 2353 13 2453 11 2257 37 2357 - 2457 3 2559 3 2359 7 2459 - 2261 7 2361 3 2461 23 2263 31 2363 17 2463 3 2267 - 2367 3 2467 - 2269 - 2369 23 2469 3 2271 3 2371 - 2471 7 2273 - 2373 3 2473 - 2277 3 2377 - 2477 - 2279 43 2379 3 2479 37 2281 - 2381 - 2481 3 2283 3 2383 - 2483 13 2287 - 2387 7 2487 3 2 289 3 2389 - 2489 19 2291 29 2391 3 2491 47 2293 - 2393 - 2493 3 2297 - 2397 3 2497 I 1 2299 11 2399 - 2499 3 2501 41 2601 3 2503 - 2603 19 2507 23 2607 3 2509 13 2609 - 2511 3 2611 7 2513 7 2613 3 2517 3 2617 - 2519 11 2619 3 2521 - 2621 - 2523 3 2623 43 2527 7 2627 37 2529 3 2629 11 2531 - 2631 3 2533 17 2633 - 2537 43 26 3 7 3 2539 - 2639 7 2541 3 2641 19 2543 - 2643 3 2547 3 2647 - 2549 - 2649 3 2551 - 2651 11 2553 3 2653 7 2557 - 2657 - 2559 3 2659 - 2561 13 2661 3 2563 11 2663 - 2567 17 2667 3 2569 7 2669 17 2571 3 2671 - 2573 31 2673 3 2577 3 2677 - 2579 - 2679 3 2581 29 2681 7 2583 3 2683 - 2587 13 2687 - 2589 3 2689 - 2591 - 2691 3 2593 - 2693 - 2597 7 2697 3 2599 23 2699 - TABLE 2 (cont'd) 2701 37 2801 2703 3 2803 2707 - 2807 2709 3 2809 2711 - 28 l l 2713 - 2813 2717 11 2817 2719 - 2819 2721 3 2821 2723 7 2823 2727 3 2827 2729 - 2829 2731 - 2831 2733 3 2833 2737 7 2837 2739 3 2839 2741 - 2841 2743 13 2843 2747 41 2847 2749 - 2849 2751 3 2851 2753 - 2853 2757 3 2857 2759 31 2859 2761 11 2861 2763 3 2863 2767 - 2867 2769 3 2869 2771 17 2871 2773 47 2873 2777 - 2877 2779 7 2879 278 1 3 2881 2783 11 2883 2787 3 2887 2789 - 2889 2791 - 2891 2793 3 2893 2797 - 2897 2799 3 2899 - 2901 - 2903 7 29 07 53 2909 3 291 l 29 2913 3 2917 - 2919 7 2921 3 2923 11 2927 3 2929 19 2931 - 2933 - 2937 17 2939 3 2941 - 2943 3 2947 7 2949 - 2951 3 2953 - 2957 3 2959 - 2961 7 2963 47 2967 19 2969 3 2971 13 2973 3 2977 - 2979 43 2981 3 2983 - 2987 3 2989 7 2991 11 2993 - 2997 n 2999 TABLES 399 3 - 3 - 41 3 - 3 23 37 - 29 3 7 3 - 17 3 7 3 13 - - 11 3 - 3 - - 3 13 3 11 19 29 7 3 41 3 - 400 TABLES 3001 - 3003 3 3007 31 3009 3 301 1 - 3013 23 3017 7 3019 - 3021 3 3023 - 3027 3 3029 13 3031 7 3033 3 3037 - 3039 3 3041 - 3043 17 3047 11 3049 - 3051 3 3053 43 3057 3 3059 7 3061 - 3063 3 3067 - 3069 3 3071 37 3073 7 3077 17 3079 - 3081 3 3083 - 3087 3 3089 - 309 1 11 3093 3 3097 19 3099 3 3101 7 3103 29 3107 13 3109 - 3111 3 3113 11 3117 3 3119 - 3121 - 3123 3 3127 53 3129 3 3131 31 3133 13 3 1 37 - 3139 43 3141 3 3143 7 3147 3 3149 47 3151 23 3153 3 3157 7 3159 3 3161 29 3163 - 3167 - 3169 - 3171 3 3173 19 3177 3 3179 11 3181 - 3183 3 3187 - 3189 3 3191 - 3193 31 3197 23 3199 7 TABLE 2 (cont'd) 3201 3 3301 - 3401 19 3203 - 3303 3 3403 41 3207 3 3307 - 3407 - 3209 - 3309 3 3409 7 3211 13 3311 7 3411 3 3213 3 3313 - 3413 - 3217 - 3317 31 3417 3 3219 3 3319 - 3419 13 3221 - 3321 3 3421 11 3223 11 3323 - 3423 3 3227 7 3327 3 3427 23 3229 - 3329 - 3429 3 3231 3 3331 - 3431 47 3233 53 3333 3 3433 - 3237 3 3337 47 3437 7 3239 41 3339 3 3439 19 32 41 7 3341 13 3441 3 3243 3 3343 - 3443 11 3247 17 3347 - 3447 3 3249 3 3349 17 3449 - 3251 - 3351 3 3451 7 3253 - 3353 7 3453 3 3257 - 3357 3 3457 - 3259 - 3359 - 3459 3 3261 3 3361 - 3461 - 3263 13 3363 3 3463 - 3267 3 3367 7 3467 - 3269 7 3369 3 3469 - 3271 - 3371 - 3471 3 3273 3 3373 - 3473 23 3277 29 3377 11 3477 3 3279 3 3379 31 3479 7 3281 17 3381 3 3481 59 3283 7 3383 17 3483 3 3287 19 3387 3 3487 11 3289 11 3389 - 3489 3 3291 3 339 1 - 3491 - 3293 37 3393 3 3493 7 3297 3 3397 43 3497 13 3299 - 3 399 3 3 499 - 3501 3 3601 13 3503 31 3603 3 3507 3 3607 - 3509 l 1 3609 3 3511 - 3611 23 3513 3 3613 - 3517 - 3617 - 3519 3 3619 7 3521 7 3621 3 3523 13 3623 - 3527 - 3627 3 3529 - 3629 19 3531 3 3631 - 3533 - 3633 3 3537 3 3637 - 3539 - 3639 3 3541 - 3641 1 1 3543 3 3643 - 3547 - 3647 7 3549 3 3649 41 3551 53 3651 3 3553 1 1 3653 13 3557 - 3657 3 3559 - 3659 - 3561 3 3661 7 3563 7 3663 3 3567 3 3667 19 3569 43 3669 3 3571 - 3671 - 3573 3 3673 - 3577 7 3677 - .�579 3 3679 13 3581 - 3681 3 3583 - 3683 29 3587 17 3687 3 3589 37 3689 7 3591 3 3691 - 3593 - 3693 3 3597 3 3697 - 3 599 59 3699 3 TABLE 2 (cont'd) 3701 - 3801 3 3703 7 3803 - 3707 I I 3807 3 3709 - 3809 13 3711 3 3811 37 3713 47 3813 3 3717 3 3817 I I 3719 - 3819 3 3721 61 3821 - 3723 3 3823 - 3727 - 3827 43 3729 3 3829 7 3731 7 3831 3 3733 - 3833 - 3737 37 3837 3 3739 - 3839 11 3741 3 3841 23 3743 19 3843 3 3747 3 3847 - 3749 23 3849 3 3751 11 3851 - 3753 3 3853 - 3757 13 3857 7 3759 3 3859 17 3761 - 3861 3 3763 53 3863 - 3767 - 3867 3 3769 - 3869 53 3771 3 3871 7 3773 7 3873 3 3777 3 3877 - 3 779 - 3879 3 3781 19 3881 - 3783 3 3883 1 1 3787 7 3887 13 3789 3 3889 - 3791 17 3891 3 3793 - 3893 17 3797 - 3897 3 3799 29 3899 7 3901 3903 3907 3909 3911 3913 3917 3919 3921 3923 3927 3929 3931 3933 3937 3939 3941 3943 3947 3949 3951 3953 3957 3959 3961 3963 3967 3969 3971 3973 3977 3979 3981 3983 3987 3989 3991 3993 3997 3999 TABLES 401 47 3 - 3 - 7 - - 3 - 3 - - 3 31 3 7 - - 11 3 59 3 37 17 3 - 3 11 29 41 23 3 7 3 - 13 3 7 3 402 TABLES 4001 - 4003 - 4007 - 4009 19 4011 3 4013 - 4017 3 4019 - 4021 - 4023 3 4027 - 4029 3 403 1 29 4033 37 4037 11 4039 7 4041 3 4043 13 4047 3 4049 - 4051 - 4053 3 4057 - 4059 3 4061 31 4063 17 4067 7 4069 13 4071 3 4073 - 4077 3 4079 - 4081 7 4083 3 4087 61 4089 3 4091 - 4093 - 4097 17 4099 - 4101 3 4103 11 4107 3 4109 7 4111 - 4113 3 4117 23 4119 3 4121 13 4123 7 4127 - 4129 - 4131 3 4133 - 4137 3 4139 - 4141 41 4143 3 4147 11 4149 3 4151 7 4153 - 4157 - 4159 - 4161 3 4163 23 4167 3 4169 11 4171 43 4173 3 4177 - 4179 3 4181 37 4183 47 4187 53 4189 59 4191 3 4193 7 4197 3 4199 13 TABLE 2 (cont'd) 4201 - 4301 11 4401 3 4203 3 4303 13 440 3 7 4207 7 4307 59 4407 3 4209 3 4309 31 4409 - 4211 - 4311 3 4411 1 1 4213 11 4313 19 44 13 3 42 1 7 - 43 1 7 3 4417 7 4219 - 4319 7 4419 3 422 1 3 4321 29 4421 - 4223 41 4323 3 4423 - 4227 3 4327 - 4427 19 4229 - 4329 3 4429 43 4231 - 4331 61 4431 3 4233 3 4 333 7 4433 11 4237 19 4337 - 4437 3 4239 3 4339 - 4439 23 4241 - 4341 3 4441 - 4243 - 4 343 43 4443 3 4247 31 4347 3 4447 - 4249 7 4349 - 4449 3 4251 3 43 5 1 19 4451 - 4253 - 4353 3 4453 61 4257 3 4357 - 4457 - 4259 - 4359 3 4459 7 4261 - 4361 7 4461 3 4263 3 4363 - 4463 - 4267 17 4367 11 4467 3 4269 3 4369 17 4469 41 4271 - 4371 3 4471 17 4273 - 4373 - 4473 3 4277 7 4377 3 4477 11 4279 11 4379 29 4479 3 4281 3 4381 13 4481 - 4283 - 4383 3 4483 - 4287 3 43 87 41 4487 7 4289 - 4389 3 4489 67 4291 7 4391 - 4491 3 4293 3 4393 23 4493 - 4297 - 4397 - 4497 3 4299 3 4399 53 4499 11 TABLE 2 (cont'd) 4501 7 4601 43 4701 3 4801 4503 3 4603 - 4703 - 4803 4507 - 4607 17 4707 3 4807 4509 3 4609 11 4709 17 4809 4511 13 4611 3 4711 7 4811 4513 - 4613 7 4713 3 4813 4517 - 4 6 1 7 3 4717 53 4817 4519 - 4619 31 4719 3 4819 4521 3 4621 - 47 21 - 4821 4523 - 4623 3 4723 - 4823 4527 3 4627 7 4727 29 4827 4529 7 4629 3 4729 - 4829 4531 23 4631 11 4731 3 4831 4533 3 4633 41 4733 - 4833 4537 13 4637 - 4737 3 4837 4539 3 4639 - 4739 7 4839 4541 19 4641 3 4741 11 4841 4543 7 4643 - 4743 3 4843 4547 - 4647 3 4747 47 4847 4549 - 4649 - 4749 3 4849 4551 3 4651 - 4751 - 4851 4553 29 4653 3 4753 7 4853 4557 3 4657 - 4757 67 4857 4559 47 4659 3 4759 - 4859 4561 - 4661 59 4761 3 4861 4563 3 4663 - 4763 I l 4863 4567 - 4667 13 4767 3 4867 4569 3 4669 7 4769 19 4869 4571 7 467 1 3 4771 13 4871 4573 17 4673 - 4773 3 4873 4577 23 4677 3 4777 17 4877 4579 19 4679 - 4779 3 4879 4581 3 4681 31 4781 7 4881 4583 - 4683 3 4783 - 4883 4587 3 4687 43 4787 - 4887 4589 13 4689 3 4789 - 4889 4591 - 4691 - 4791 3 4891 4593 3 4693 13 4793 - 4893 4597 - 4697 7 4797 3 4 89 7 4599 3 4699 37 4799 - 4899 - 4901 3 4903 11 4907 3 4909 17 4911 - 4913 - 4917 61 4919 3 4921 7 4923 3 4927 11 4929 - 4931 3 4933 7 4937 3 4939 47 4941 29 4943 37 4947 13 4949 3 4951 23 4953 3 4957 43 4959 - 4961 3 4963 31 4967 3 4969 - 4971 11 4973 - 4977 7 4979 3 4981 19 4983 3 4987 - 4989 67 4991 3 4993 59 4997 3 4999 TABLES 403 13 - 7 - 3 17 3 - 7 3 13 3 - - - 11 3 - 3 7 - 3 - 3 1 l 7 - - 3 - 3 13 17 3 - 3 7 - 19 - 404 TABLES TABLE 3 The prime numbers between 5000 and 10,000. 5003 5387 5693 6053 5009 5393 5701 6067 501 1 5399 5711 6073 5021 5407 5717 6079 5023 54 1 3 5737 6089 5039 5417 5741 6091 5051 5419 57.43 6101 5059 5431 5749 6113 5077 5437 5779 6121 5081 5441 5783 6131 5087 5443 5791 6133 5099 5449 5801 6143 5101 5471 5807 6151 5107 5477 5813 6163 5113 5479 5821 6173 5 1 19 5483 5827 6197 5147 5501 5839 6199 ·5153 5503 5843 6203 5167 5507 5849 6211 5171 5519 5851 6217 5179 5521 5857 6221 5189 5527 5861 6229 5197 5531 5867 6247 5209 5557 5869 6257 5227 5563 5879 6263 5231 5569 5881 6269 5233 5573 5891 6271 5237 5581 5903 6277 5261 5591 5923 6287 5273 5623 5927 6299 5279 5639 5939 6301 5281 5641 5953 6311 5297 5647 5981 6317 5303 5651 5987 6323 5309 5653 6007 6329 5323 5657 6011 6337 5333 5659 6029 6343 5347 5669 6037 6353 5351 5683 6043 6359 5381 5689 6047 6361 6367 676 1 71 03 6373 6 76 3 7109 6379 6779 71 2 1 6389 6781 71 27 6397 6791 7129 6421 6793 7151 6427 6803 7159 6449 6823 7177 6451 6827 7187 6469 6829 7193 6473 6833 7207 6481 6841 7211 6491 6857 7213 6521 6863 7219 6529 6869 7229 6547 6871 7237 6551 6883 7243 6553 6899 7247 6563 6907 7253 6569 6911 7283 6571 6917 7297 6577 6947 7307 6581 6949 7309 6599 6959 7321 6607 6961 7331 6619 6967 7333 6637 6971 7349 6653 6977 7351 6659 6983 7369 6661 6991 7393 6673 6997 74 11 6679 700 1 7417 6689 7013 7433 6691 7019 7451 6701 7027 7457 6703 7039 7459 6709 7043 7477 6719 7057 7481 6733 7069 7487 6737 7079 7489 TABLE 3 (cont'd) 7499 7759 Bl 11 8431 8741 7507 7789 8117 8443 8747 7517 7793 8123 8447 8753 7523 7817 8147 8461 8761 7529 7823 8161 8467 8779 7537 7829 8167 8501 8783 7541 7841 8171 8513 8803 7547 7853 8179 8521 8807 7549 7867 8191 8527 8819 7559 7873 8209 8537 8821 7561 7877 8219 8539 8831 7573 7879 8221 8543 8837 7577 7883 8231 8563 8839 7583 7901 8233 8573 8849 7589 7907 8237 8581 8861 7591 7919 8243 8597 8863 7603 7927 8263 8599 8867 7607 7933 8269 8609 8887 7621 7937 8273 8623 8893 7639 7949 8287 8627 8923 7643 7951 8291 8629 8929 7649 7963 8293 8641 89 33 7669 7993 8297 8647 8941 7673 8009 8311 8663 8951 7681 8011 8317 8669 8963 7687 8017 8329 8677 8969 7691 8039 8353 8681 8971 7699 8053 8363 8689 8999 7703 8059 8369 8693 9001 7717 8069 8377 8699 9007 7723 8081 8387 8707 9011 7727 8087 8389 8713 9013 7741 8089 8419 8719 9029 7753 8093 8423 8731 9041 7757 8101 8429 8737 9043 9049 9377 9059 9391 9067 9397 9091 9403 9103 9413 9109 9419 9127 9421 9133 9431 9137 9433 9151 9437 9157 9439 9161 9461 9173 9463 9181 9467 9187 9473 9199 9479 9203 9491 9209 9497 9221 95 I 1 9227 9521 9239 9533 9241 9539 9257 9547 9277 9551 9281 9587 9283 9601 9293 9613 9311 9619 9319 9623 9323 9629 9337 9631 9341 9643 9343 9649 9349 9661 9371 9677 TABLES 405 9679 9689 9697 9719 9721 9733 9739 9743 9749 9767 9769 9781 9787 9791 9803 9811 9817 9829 9833 9839 9851 9857 9859 9871 9883 9887 9901 9907 9923 9929 9931 9941 9949 9967 9973 406 TABLES TABLE4 Tbe number of primes and tbe number of pairs of twin primes in tbe indicated intervals. Number of Number of pairs of Interval primes twin primes 1-100 25 8 101-200 21 7 201-300 16 4 301-400 16 2 401-500 17 3 501-600 14 2 601-700 16 3 701-800 14 0 801-900 15 5 901-1000 14 0 2501-2600 11 2 260 1 -2700 15 2 2701-2800 14 3 2801-2900 12 1 2901-3000 11 1 10001-10100 11 4 10101-10200 12 1 10201-10300 10 1 10301-10400 12 2 10401-10500 10 2 29501-29600 10 29601-29700 8 1 29701-29800 7 1 29801-29900 10 1 29901-30000 7 0 100001-100100 6 0 100101-100200 9 1 100201-100300 8 0 100301-100400 9 2 100401-100500 8 0 299501-299600 7 1 299601-299700 8 1 299701-299800 8 0 299801-299900 6 0 299901-300000 9 0 TABLE 5 The values of'r(n), a(n), ¢(n), and µ(n), where 1 ::5 n ::5 100. n r(n) a(n) ¢(n) µ(n) n r(n) 1 l I 1 l 41 2 2 2 3 l -1 42 8 3 2 4 2 -) 43 2 4 3 7 2 0 44 6 5 2 6 4 -) 45 6 6 4 12 2 1 46 4 7 2 8 6 -1 47 2 8 4 15 4 0 48 10 9 3 13 6 0 49 3 10 4 18 4 1 50 6 11 2 12 10 -1 51 4 12 6 28 4 0 52 6 13 2 14 12 -1 53 2 14 4 24 6 1 54 8 15 4 24 8 1 55 4 16 5 31 8 0 56 8 17 2 18 16 -1 57 4 18 6 39 6 0 58 4 19 2 20 18 -1 59 2 20 6 42 8 0 60 12 21 4 32 12 1 61 2 22 4 36 10 1 62 4 23 2 24 22 -1 63 6 24 8 60 8 0 64 7 25 3 31 20 0 65 4 26 4 42 12 1 66 8 27 4 40 18 0 67 2 28 6 56 12 0 68 6 29 2 30 28 -1 69 4 30 8 72 8 -1 70 8 31 2 32 30 -1 71 2 32 6 63 16 0 72 12 33 4 48 20 1 73 2 34 4 54 16 I 74 4 35 4 48 24 1 75 6 36 9 91 12 0 76 6 37 2 38 36 -1 77 4 38 4 60 18 1 78 8 39 4 56 24 I 79 2 40 8 90 16 0 80 10 a(n) 42 96 44 84 78 72 48 124 57 93 72 98 54 120 72 120 80 90 60 168 62 96 104 127 84 144 68 126 96 144 72 195 74 114 124 140 96 168 80 186 TABLES 407 <P(n) µ(n) 40 -1 12 -1 42 -) 20 0 24 0 22 I 46 -1 16 0 42 0 20 0 32 1 24 0 52 -1 18 0 40 l 24 0 36 l 28 l 58 -1 16 0 60 -1 30 1 36 0 32 0 48 1 20 -1 66 -1 32 0 44 1 24 -1 70 -1 24 0 72 -I 36 1 40 0 36 0 60 I 24 -I 78 -I 32 0 408 TABLES n r(n) 81 5 82 4 83 2 84 12 85 4 86 4 87 4 88 8 89 2 90 12 u(n) cf>(n) 121 54 126 40 84 82 224 24 108 64 132 42 120 56 180 40 90 88 234 24 TABLE 5 (cont'd) µ(n) n r(n) u(n) <J>(n) µ(n) 0 91 4 112 72 I 1 92 6 168 44 0 -1 93 4 128 60 1 0 94 4 144 46 1 l 95 4 120 72 1 1 96 12 252 32 0 1 97 2 98 96 -1 0 98 6 171 42 0 -I 99 6 156 60 0 0 100 9 217 40 0 TABLES 409 TABLE 6 Known Mersenne primes. Mersenne number Number of digits Date of discovery I 22 - l unknown 2 23 - l I unknown 3 2s - l 2 unknown 4 27 - l 3 unknown 5 213 - l 4 1456 6 217 - l 6 1588 7 219 - l 6 1588 8 231 - l IO I772 9 261 - l I9 1883 IO 289 - I 27 1911 11 2107 - I 33 1914 12 2121 _I 39 1876 13 2s21 _I 157 1952 14 2607 _I 183 1952 15 21219 _ I 386 1952 16 22203 _ I 664 1952 17 22281 _ I 687 1952 18 23211 _ I 969 1957 19 24253 _ I 1281 1961 20 24423 _ I 1332 1961 21 29689 _ I 2917 1963 22 29941 - 1 2993 1963 23 211213_1 3376 1963 24 219937 - 1 6002 1971 25 221701 - 1 6533 1978 26 223209 - 1 6987 1978 27 244497 - 1 13395 1979 28 286243 - 1 25962 1983 29 2110503 _ I 33265 1989 30 2132049 _ I 39751 1983 31 2216091 _ I 65050 1985 32 2756839 _ I 227832 1992 33 2859433 _ I 258716 1994 34 21257787 _ I 378632 1996 35 21398269 _ I 42092I 1996 36 22976221 _ I 895932 1996 37 23021377 _ I 909526 1998 38 26972593 - l 2098960 1999 39 2 I 34669 I 7 _ 1 4059346 2001 40 220996011 - 1 6320430 2003 41 224036583 - 1 7235733 2004 42 225964951 - l 7816230 2005 43 230402457 - 1 9152052 2005 44 232582657 - l 9808358 2006 45 243112609 _ l 12978189 2008 46 237156667 _ 1 11185272 2008 47 242643801 _ 1 12837064 2009 ANSWERS TO SELECTED PROBLEMS SECTION 1.1 5. (a) 4, 5, and 7. (b) (3 . 2)! =!= 3!2!, (3 + 2)! =!= 3! + 2!. SECTION 2.1 5. (a) t6 = 21 and ts = 15. 6. (b) 12 = t1, 62 =ts, 2042 = t1ss- 9. (b) Two examples are t6 = t3 +ts, t10 = t4 + t9. SECTION 2.4 1. 1, 9, and 17. 2. (a) x = 4, y = -3. (b) x = 6, y = -1. (c) x = 7, y = -3. (d) x = 39, y = -29. 8. 32,461, 22,338, and 23,664. 12. x = 171, y = -114, z = -2. SECTION 2.5 2. (a) x = 20 + 9t, y = -15 - 7t. (b) x = 18+23t, y = -3- 4t. (c) x = 176 + 35t, y = -1111 - 221t. 3. (a) x = 1, y = 6. (b) x = 2, y = 38; x = 9, y = 20; x = 16, y = 2. ( c) No solutions (d) x = 17 - 57t, y = 47 - 158t, where t ::S 0. 5. (a) The fewest coins are 3 dimes and 17 quarters, whereas 43 dimes and 1 quarter give the largest number. It is possible to have 13 dimes and 13 quarters. 410 ANSWERS TO SELECTED PROBLEMS 411 (b) There may be 40 adults and 24 children, or 45 adults and 12 children, or 50 adults. (c) Six 6's and ten 9's. 6. There may be 5 calves, 41 lambs, and 54 piglets; or 10 calves, 22 lambs, and 68 piglets; or 15 calves, 3 lambs, and 82 piglets. 7. $10.21 8. (b) 28 pieces per pile is one answer. ( d) One answer is 1 man, 5 women, and 14 children. (e) 56 and 44. SECTION 3.1 2. 25 is a counterexample. 7. All primes:::: 47. 11. (a) One example: 213 - 1 is prime. SECTION 3.2 11. Two solutions are 59 - 53 = 53 - 47, 157 - 151 = 163 - 157. 14. R10 = 11 · 41 · 271 · 9091. SECTION 3.3 3. 2 and 5 11. h(22) = 23 . 67. 14. 71, 13859 16. 37 = -1+2 + 3 + 5 + 7 + 11 - 13 + 17 - 19 + 23 - 29 + 31, 31=-1+2 - 3 + 5 - 7 - 11+13 + 17 - 19 - 23 + 2(29). 19. 81 = 3 + 5 + 73, 125 = 5 + 13 + 107. 28. (b) n = 1. SECTION 4.2 4. (a) 4 and 6 (b) 0 SECTION 4.3 1. 14147 = 658 (mod 1537) 1953 = 406 (mod 503) 3. 89 6. (a) 9 (b) 4 (c) 5 (d) 9 9. 7 11. x = 7, y = 8. 12. 143. 15. n = 1, 3. 412 ANSWERS TO SELECTED PROBLEMS 21. R6 = 3 · 7 · 11 · 13 · 37. 23. x = 3, y = 2. 24. x = 8, y = 0, z = 6. 26. (a) Check digits are 7; 5. (b) a4 = 9. 27. (b) Incorrect SECTION 4.4 1. (a) x = 18 (mod 29). (b) x = 16 (mod 26). (c) x = 6, 13, and 20 (mod 21). ( d) No solutions (e) x = 45, and 94 (mod 98). (f) x = 16, 59, 102, 145, 188, 231, and 274 (mod 301). 2. (a) x = 15+51t, y = -1-4t. (b) x = 13 + 25t, y = 7 - 12t. (c) x = 14+53t, y = 1 +5t. 3. x = 11 + t (mod 13), y = 5 + 6t (mod 13). 4. (a) x = 52 (mod 105). (b) x = 4944 (mod 9889). (c) x = 785 (mod 1122). (d) x = 653 (mod 770). 5. x = 99 (mod 210). 6. 62 7. (a) 548, 549, 550 (b) 521350, 33 1351, 241352 8. 119 9. 301 10. 3930 14. 838 15. (a) 17 (b) 59 (c) 1103 16. n = 1, 7, 13 (mod 15). 17. x = 7, y = 9 (mod 13). 18. x - 59, 164 (mod 210). 19. x = 7, y = O; x = 3, y = 1; x = 7, y = 2; x = 3, y = 3; x = 7, y = 4; x = 3, y = 5; x = 7, y = 6; x = 3, y = 7. 20. (a) x = 4 (mod 7), y = 3 (mod 7). (b) x - 9 (mod 11), y - 3 (mod 11). (c) x = 7 (mod 20), y = 2 (mod 20). SECTION 5.2 6. (a) 1 9. (b) x = 16 (mod 31), x = 10 (mod 11), x = 25 (mod 29). SECTION 5.3 8. 5, 13 11. 12, 17; 6, 31 SECTION 5.4 1. (b) 127 . 83 ( c) 691 . 29 . 17 3. 89 . 23 4. 29 . 17, 32 . 52 . 132 5. (a) 2911 = 71 · 41. (b) 4573 = 17 . 269. (c) 6923 = 23 · 301. 6. (a) 13561 = 71 · 191 7. (a) 4537 = 13 · 349. (b) 14429 = 47 . 307. 8. 20437 = 107 . 191. SECTION 6.1 2. 6; 6,300,402 12. (a) p9 and p4q; 48 = 24 · 3. SECTION 6.3 3. 249, 330 5. (b) 150, 151, 152, 153, 154 8. (b) 36, 396 9. 405 SECTION 6.4 1. (a) 54 (b) 84 (c) 115 3. (a) Thursday (b) Wednesday (c) Monday ( d) Thursday (e) Tuesday (f) Tuesday 5. (a) 1, 8, 15, 22, 29 (b) August 6. 2009 SECTION 7.2 1. 720, 1152, 9600 18. c/>(n) = 16 when n = 17, 32, 34, 40, 48, and 60. ANSWERS TO SELECTED PROBLEMS 413 c/>(n) = 24 when n = 35, 39, 45, 52, 56, 70, 72, 78, 84, and 90. 414 ANSWERS TO SELECTED PROBLEMS SECTION 7.3 7. 1 8. (b) x = 19 (mod 26), x = 34 (mod 40), x = 7 (mod 49). SECTION 7.4 10. (b) 29348, 29349, 29350, 29351 SECTION 8.1 1. (a) 8, 16, 16 (b) 18, 18, 9 (c) 11, 11, 22 8. (c) 217 - 1 is prime; 2331229 - 1. 11. (a) 3, 7 (b) 3, 5, 6, 7, 10, 11, 12, 14 12. (b) 41, 239 SECTION 8.2 2. 1, 4, 11, 14; 8, 18, 47, 57; 8, 14, 19, 25 3. 2, 6 = 29' 7 = 27' 8 = 23; 2, 3=213, 10=217, 13=25, 14=27, 15=211; 5, 7=519, 10=53, 11=59, 14=521, 15=517, 17=57, 19=515, 20 = 55, 21 = 513. 4. (a) 7, 37 (b) 9, 10, 13, 14, 15, 17,23,24,25,31,38,40 5. 11, 50 SECTION 8.3 1. (a) 7, 11, 15, 19; 2, 3, 8, 12, 13, 17, 22, 23 (b) 2, 5; 2,5, 11, 14,20,23; 2,5, 11, 14,20,23,29,32,38,41,47,50,56,59,65,68, 74, 77 4. (b) 3 5. 6, 7, 11, 12, 13, 15, 17, 19, 22, 24, 26, 28, 29, 30, 34, 35; 7, 11, 13, 15, 17, 19,29,35,47,53,63,65,67,69, 71, 75 11. (b) x - 34 (mod 40), x - 30 (mod 77). SECTION 8.4 1. ind2 5 = 9, ind6 5 = 9, ind1 5 = 3, indu 5 = 3. 2. (a) x = 7 (mod 11). (b) x = 5, 6 (mod 11). (c) No solutions. 3. (a) x = 6, 7, 10, 11 (mod 17). (b) x = 5 (mod 17). (c) x = 3, 5, 6, 7, 10, 11, 12, 14 (mod 17). (d) x = 1 (mod 16). 4. 14 8. (a) In each case, a = 2, 5, 6. (b) 1, 2, 4; 1, 3, 4, 5, 9; 1, 3, 9 12. Only the first congruence has a solution. ANSWERS TO SELECTED PROBLEMS 415 16. (b) x = 3, 7, 11, 15 (mod 16); x = 8, 17 (mod 18). 17. b = 1, 3, 9 (mod 13). SECTION 9.1 1. (a) x = 6, 9 (mod 11). (b) x = 4, 6 (mod 13). (c) x = 9, 22 (mod 23). 8. (b) x = 6, 11 (mod 17); x = 17, 24 (mod 41) 11. (a) 1, 4, 5, 6, 7, 9, 11, 16, 17 (b) 1, 4,5, 6, 7, 9, 13, 16,20, 22, 23,24,25, 28; 1,2, 4,5, 7,8, 9, 10, 14, 16, 18, 19,20, 25, 28 SECTION 9.2 1. (a) -1 (b) 1 (c) 1 (d) -1 (e) 1 2. (a) (-1)3 (b) (-1)3 (c) (- 1)4 (d) (- 1)5 (e) (- 1)9 SECTION 9.3 1. (a) 1 (b) -1 (c) -1 (d) 1 (e) 1 3. (a) Solvable (b) Not solvable ( c) Solvable 6. p = 2 or p = 1 (mod 4); p = 2 or p = 1or3 (mod 8); p = 2, p = 3 or p = 1 (mod 6). 8. 73 14. x = 9, 16, 19, 26 (mod 35). 16. -1, -1, 1 20. Not solvable 416 ANSWERS TO SELECTED PROBLEMS SECTION 9.4 1. (b) x = 57, 68 (mod 53). 2. (a) x = 13, 14 (mod 33). (b) x = 42, 83 (mod 53). (c) x = 108, 235 (mod 73). 3. x = 5008, 9633 (mod 11 4). 4. x = 122, 123 (mod 53); x = 11, 15 (mod 33). 6. x = 41, 87, 105 (mod 27). 7. (a) When a= 1, x = 1, 7, 9, 15 (mod 2 4). When a = 9, x = 3, 5, 11, 13 (mod 2 4). (b) When a = 1, x = 1, 15, 17, 31 (mod 25). When a= 9, x = 3, 13, 19, 29 (mod 25). When a= 17, x = 7, 9, 23, 25 (mod 25). When a = 25, x = 5, 11, 21, 27 (mod 25). (c) When a = 1, x = 1, 31, 33, 63 (mod 2 6). When a = 9, x = 3, 29, 35, 61 (mod 2 6). When a = 17, x = 9, 23, 41, 55 (mod 2 6). When a= 25, x = 5, 27, 37, 59 (mod 2 6). When a= 33, x = 15, 17, 47, 49 (mod 26). When a = 41, x - 13, 19, 45, 51 (mod 2 6). When a = 49, x = 7, 25, 39, 57 (mod 2 6). When a= 57, x = 11, 21, 43, 53 (mod 26). 9. (a) 4, 8 (b) x = 3, 147, 153, 297, 303, 447, 453, 597 (mod 23 · 3 · 52). 10. (b) x = 51, 70 (mod 112). SECTION 10.1 4. (a) C = 3P + 4 (mod 26). (b) GIVE THEM UP. 5. (a) TAOL M NBJQ TKPB. (b) DO NOT SHOOT FIRST. 6. (b) KEEP THIS SECRET 7. (a) UYJB FHSI HLQA. (b) RIGHT CHOICEX. 8. (a) C1 = P1 + 2P2 (mod 26), C2 = 3P1 + 5P2 (mod 26). (b) HE AR THE BELLS. 9. HS TZM 10. FRIDAY 11. 1747, 157 12. 253 13. 2014 1231 1263 0508 1106 1541 1331 14. REPLY NOW 15. SELL SHORT SECTION 10.2 1. X2 = X4 = X6 = 1, XI = X3 = X5 = 0. X3 = X4 = X5 = 1, X1 = X2 = X6 = 0. X1 = X2 = X4 = X5 = 1, X3 = X6 = 0. Xl = X2 = X3 = X6 = 1, X4 = X5 = 0. 2. (a) and (c) are superincreasing. 3. (a) Xl = X 2 = X3 = X6 = 1, X4 = X5 = 0. (b) X 2 = X3 = X5 = 1, X1 = X4 = 0. (c) X3 = X4 = X6 = 1, X1 = X2 = X5 = 0. 5. 3, 4, 10, 21 6. CIPHER. 7. (a) 14, 21, 49, 31, 9 (b) 45 49 79 40 70 101 79 49 35 SECTION 10.3 ANSWERS TO SELECTED PROBLEMS 417 (43, 35) (43, 11) (43, 06) (43, 42) (43, 19) 1. (a) (43, 17) (43, 15) (43, 20) (43, 00) (43, 19) 2. BEST WISHES 3. (23, 20) (23, 01) (12, 17) (12, 35) (13, 16) (13, 04) (1424,2189) (1424, 127) (1424,2042) 4· (1424,2002) (1424,669) (1424,469) SECTION 11.2 1. u (n) = 2160(211 - 1)-=/= 2048(211 - 1). 8. 56 11. p3, pq 14. (b) There are none. 16. No. SECTION 11.3 3. 2331 M19. SECTION 11.4 3. (b) 3 I 22n + 5. 7. 2ss + 1 = (229 - 215 + 1)(229 + 215 + 1) = 5 . 107367629 · 536903681. 9. (c) 831241 + 1 and 591229 + 1. 10. n = 315, p = 71, and q = 73. 11. 3123 + 1. SECTION 12.1 1. (a) (16, 12, 20), (16, 63, 65), (16, 30, 34) (b) (40, 9, 41), (40, 399, 401); (60, 11, 61), (60, 91, 109), (60, 221, 229), (60, 899, 901) 8. (12, 5, 13), (8, 6, 10) 12. (a) (3, 4, 5), (20, 21, 29), (119, 120, 169), (696, 697, 985), (4059, 4060, 5741) (b) (t6, f?, 35), (t40, t41, 1189), (t23g, t239, 40391) 13. t1 = 12, ts= 62, t49 = 352, t2ss = 2042, t16s1 = 11892. 418 ANSWERS TO SELECTED PROBLEMS SECTION 13.2 1. 113 = 72 + 82, 229 = 22 + 152, 373 = 72 + 182. 2. (a) 172 + 182 = 613, 42 + 52 = 41, 52 + 62 = 61, 92 + 102 = 181, 122 + 132 = 313. 5. (b) 3185 = 562 + 72, 39690 = 1892 + 632, 62920 = 2422 + 662. 6. 1105 = 5 . 13 . 17 = 92 + 322 = 122 + 312 = 232 + 242; Note that 325 = 52 · 13 = 12 + 182 = 62 + 172 = 102 + 152. 14. 45 = 72 - 22 = 92 - 62 = 232 - 222. 18. 1729 = 13 + 123 = 93 + 103. SECTION 13.3 2. (2870)2 = (12 + 22 + 32 + .. · + 202)2 leads to 5742 = 4142 + 82 + 162 + 242 + 322+ ... + 1522, which is one solution. 6. One example is 509 = 122 + 132 + 142. 7. 459 = 152 + 152 + 32. 10. 61 = 53 - 43' 127 = 73 - 63. 13. 231 = 152 + 22 + 12 + 12' 391 = 152 + 92 + 92 + 22' 2109 = 442 + 122 + 52 + 22. 17. t13 = 33 +43 = 63 -53. 18. (b) When n = 12, 290 = 132 + 112 = 162 + 52 + 32 = 142 + 92 + 32 + 22 = 152 + 62 + 42 + 32 + 22. SECTION 14.2 7. 2, 5, 144 8. u1, u2, U 3, U4, U6, u12 11. u11 = 2u9 +us, u12 = 6us +(us - u4). 12. U1, U2, U4, Ug, UlQ SECTION 14.3 7. 50 = U4 + U7 + U9, 75 = U3 + U5 + U7 + UlQ, 100 = u1 + U3 + U6 + u11, 125=u3 +u9 +u11. 9. (3, 4, 5), (5, 12, 13), (8, 15, 17), (39, 80, 89), (105, 208, 233) SECTION 15.2 1. (a) [-1; 1, 1, 1, 2, 6] (b) [3; 3, 1, 1, 3, 2] (c) [l; 3, 2, 3, 2] (d) [O; 2, 1, 1, 3, 5, 3] 2. (a) -710/457 (b) 7411170 (c) 321/460 4. (a) [O; 3, 1, 2, 2, l] (b) [-1;2, 1, 7] (c) [2; 3, 1, 2, 1, 2] 420 ANSWERS TO SELECTED PROBLEMS SECTION 15.5 2. (a) x = 8, y = 3. (b) x = 10, y = 3. (c) x = 17, y = 4. ( d) x = 11, y = 2. (e) x = 25, y = 4. 3. (a) x = 3, y = 2; x = 17, y = 12; x = 99, y = 70. (b) x = 2, y = 1; x = 7, y = 4; x = 26, y = 15; x = 97, y = 56; x = 362, y = 209. (c) x = 9, y = 4; x = 161, y = 72. 4. 48, 1680 5. (a) x = 24, y = 5; x = 1151, y = 240. (b) x = 51, y = 10; x = 5201, y = 1020. (c) x = 23, y = 4; x = 1057, y = 184. 6. (a) x = 9801, y = 1820. (b) x = 2049, y = 320. (c) x = 3699, y = 430. 7. (a) x = 18, y = 5. (b) x = 70, y = 13. (c) x = 32, y = 5. 12. x = 449, y = 60; x = 13455, y = 1798. 13. (b) x = 254, y = 96; x = 4048, y = 1530. (c) x = 213, y = 36; x = 2538, y = 429. SECTION 16.2 1. (a) 299 = 13 · 23. (b) 1003 = 17 . 59. (c) 8051 = 83 · 97. 2. 4087 = 61 . 67. 3. (a) 1711 = 29 · 59. (b) 4847 = 37 . 131. (c) 9943 = 61 · 163. 4. (a) 1241=17 · 73. (b) 2173 = 41 . 53. (c) 949 = 13 · 73. (d) 7811 = 73 . 107. 5. 1189 = 29 . 41. 6. (a) 8131 = 47 · 173. (b) 13199 = 67 . 197. (c) 17873 = 61 · 293. SECTION 16.3 2. (a) x = 13, 20, 57, 64 (mod 77). (b) x = 10, 67, 142, 199 (mod 209). (c) x = 14, 32, 37, 55 (mod 69). 3. Alice wins if she chooses x = ±73 (mod 713). 4. Alice loses if she chooses x = ±676 (mod 3713). absolute pseudoprime numbers, 91-92, 93, 367 abundant numbers, 236 Academie des Sciences, 61, 129, 131, 220, 261-262 Academy of Science at Gottingen, 255 Adleman, Leonard (b. 1945), 205 Agrawal, Manindra (b. 1966), 358 Alcuin of York (c. 732-804), 38, 222 Alembert, Jean Le Rand d' (1717-1783), 63 Alexandrian Museum, 14-15 L'Algebra Opera (Bombelli), 307 algebraic numbers, 254 American Journal of Mathematics, 288 American Mathematical Society, 228,355 amicable numbers, 234-237 amicable pairs, 234 amicable triples, 237 Anthoniszoon, Adriaen (1527-1617), 332 Apery, Roger (1916-1994), 377 Arabic numerals, 284 Archimedean property, 2 Archimedean value of rr, 331 Archimedes (c.287-212 B.C.), 331, 350 area, of Pythagorean triangles, 250 arithmetic functions. See number-theoretic functions arithmetic of remainders. See congruences arithmetic progressions of primes, 54-55, 59,379 Arithmetica (Diophantus) Bombelli and, 307 INDEX Fermat and,87,245-246,257,350 history of, 32-33, 85-86 arithmetica, in Pythagorean school, 13 Artin, Emil (1898-1962), 157 Artin's conjecture, 157 Aryabhata (c. 476-550), 15 astrologia, in Pythagorean school, 13 astronomy, Gauss and, 63 Augustine (Saint) (354-430), 222 authentication of messages, 217-218 autokey ciphers, 200-201, 208 Bachet, Claude (1581-1638), 86, 245, 273 Barlow, Peter (1776-1862), 231 bases in place-value notation, 69-70 basis for induction, 4 basket-of-eggs problem, 83 Baudot code,202,208 Baudot, Jean-Maurice-Emile (1845-1903), 202 Bennett, G., 238 Berlin Academy, 130, 262, 329 Bernoulli, Daniel (1700-1782), 129, 130 Bernoulli inequality, 7 Bernoulli, James (1654-1705), 377 Bernoulli, Johann (1667-1748), 129 Bernoulli, Nicolaus ( 1695-1726), 129, 130 Bernoulli numbers, 377-378 Bertrand, Joseph (1822-1900), 48 Bertrand's conjecture, 48-49 Beta, as nickname, 45 Bhargava, Manjul, 277 Bhaskara (1114 - c. 1185), 83 421 422 INDEX Biblical references to numbers, 222, 235 binary exponential algorithm, 70-71 binary number system, 70-71 Binet formula, 296-298, 301 Binet, Jacques-Philippe-Marie (1786-1856), 296 binomial coefficients defined, 8 Fibonacci numbers formula, 302 identities of, 8, 10-12 as integers, 119 binomial congruences, 164, 165-166 binomial theorem, 9-10 Blum integers, 373 Blum, Manuel (b. 1938), 371 Blum's coin flipping game, 371-374 Bombelli, Rafael (1526-1572), 307 Bonse's inequality, 48 Borozdkin, K. G., 53 bracket function, 117-122 Brahmagupta (598 - c. 665), 83, 350 Brent, Richard, 241, 242, 360 Brillhart, John (b. 1930), 241, 361, 364 Brouncker, William (1620-1684), 320, 339, 340,351 Brun, Viggo (1882-1978), 380 Brun's constant, 380 Caesar, Julius (100-44 B.C.) cipher system, 198, 207 Julian calendar, 122, 123 calendars, 122-127 cancellation of terms, in congruences, 66-67 canonical form, 42 Carlyle, Thomas (1795-1881), 175 Carmichael numbers, 91-92, 93, 367 Carmichael, Robert Daniel (1879-1967), 91 Carmichael's conjecture, 136 Carr, George Shoobridge (1837-1914), 303 Catalan equation, 257-258 Catalan, Eugene (1814-1894), 12 Catalan numbers, 12 Catalan's conjecture, 258 Cataldi, Pietro (1548-1626), 224 cattle problem, 350 Cauchy, Augustin (1789-1857), 334 century years, 123, 124 Ceres (dwarf planet), 63 chain of inequalities, 317-318, 321 Chang Ch'iu-chien (6th century A.D.), 37 Chebyshev, Pafnuty (1821-1894), 48, 53, 379 check digits, 72-73, 75 Chinese mathematics Chinese remainder theorem, 79-81, 139-140 Diophantine equations, 36-37 pirate problem, 83 Chinese remainder theorem, 79-81, 139-140 Cicero, Marcus (106-43 B.C.), 198 ciphers. See cryptography ciphertext, 197 circles, inscribed in Pythagorean triangles, 250 Clavius, Christoph (1537-1612), 123 Cogitata Physica-Mathematica (Mersenne), 227 coin flipping, remote, 371-374, 375 Cole, Frank Nelson (1861-1926), 228 Cole prize, 355, 356 common divisors, 20-21 See also greatest common divisor common multiple, 29 complete set of residues modulo n, 64, 68 complex analysis, in prime number theorem proof, 380-382 composite numbers defined,39 highly composite, 305 primitive roots for, 158-163 See also factorization into primes; primality tests computation aids congruences as, 66 Fermat's little theorem as, 89, 92-93 computational number theory, 357 computers in number theory as aid in proving conjectures, 357 amicable pairs discovery and, 235 Blum's coin flipping game and, 373,374 cryptography and, 197, 205, 206-207 factorization into primes and, 357 Fermat numbers and, 242 Fermat's last theorem and, 255 Mersenne primes and, 231-232 Mertens's conjecture and, 115-116 primality tests and, 358 congruence modulo n, 63-64 congruences,61-84 basic congruence properties, 63-68 binomial, 164, 165-166 check digits and, 72-73, 75 Chinese remainder theorem, 79-81 cryptography and, 198, 199, 201 day of the week calculations and, 123-127 divisibility tests, 69, 71-72, 73, 74 exponential, 168 Gauss and, 61-63 indices for solving, 164-167 linear in one variable, 76-78, 82, 83, 162 linear in two variables, 81-82, 83, 84 order of a modulo n, 147-150 place-value notation systems, 69-71 polynomial, 71-72, 152-154 simultaneous linear, 78-81, 83, 84 See also quadratic congruences consecutive integers, divisibility relations of, 25 consecutive primes, 50-51, 55-56 continued fractions defined,306-307 expansion algorithm, 326-328 factoring method, 361-364 Pell's equation solutions, 340-347 See also finite continued fractions; infinite continued fractions convergents finite continued fractions, 311-315, 317-319 infinite continued fractions, 321-322, 325-326,329-331,332 .rrcontinued fraction expansion, 327-328 A Course in Pure Mathematics (Hardy), 353 cryptography, 197-218 autokey systems, 200-201, 208 Caesar system, 198, 207 defined, 197 ElGamal system, 214--218 exponential systems, 203-205, 209 Hill system, 201, 208 knapsack problems, 209-211, 213, 214 Merkle-Hellman knapsack system, 211-214 modular exponential systems, 209 INDEX 423 monoalphabetic systems, 198, 199, 207-208 polyalphabetic systems, 198-201, 208 public-key systems, 205-207 RSA system, 205-207, 209 running key system, 200 Verman one-time pad system, 202-203, 208 Vigenere system, 199-201, 208 cubes of numbers divisibility relations, 25 division algorithm applications, 19 Fermat's challenge on, 337-338 Cunningham, Allen Joseph (1848-1928), 231 d' Alembert, Jean Le Rond (1717-1783), 63, 262 day of the week calculations, 123-127 de la Vallee-Poussin, Charles-Jean (1866-1962), 381 de Polignac, Alphonse (1817-1890), 59 decimal number system, 71, 284 deciphering/decrypting, defined, 197 See also cryptography deficient numbers, 236 definitions, using mathematical induction, 5,6 denominator( s) continued fractions, 311-312, 313, 314 Legendre symbol, 17 5 partial, 310 Descartes, Rene (1596-1650) amicable pair discovery, 235, 236 Mersenne and, 219, 220 sum of three squares verification, 273 Dickson, Leonard Eugene (1874-1954), 278,355 difference of two squares, integers as, 269-270,271-272 Diffie, Bailey Whitfield (b. 1944 ), 205 digital signatures, 217-218 digits, defined, 71 Diophantine equations ax+ by= c, 33-36, 37-38, 315-317, 319 ax+ by+ cz = d, 37 continued fraction solutions, 315-317, 319 defined,33 Fibonacci and, 283-284 424 INDEX history of, 32-33 linear congruences and, 76, 78, 82 linear in three unknowns, 37 linear in two unknowns, 33-36, 37-38, 315-317,319 solvability conditions, 33-34 word problems, 36-37, 38 x2 + y2 = z2, 245-250 x4 + y4 = z2, 252-253 x4 - y4 = z2, 255-257 x4 + y4 = z4,253 xn + yn = zn , 245-246, 254-255 Diophantus of Alexandria (fl A.D. 250), 32-33,273 See also Arithmetica Dirichlet, Peter Gustav Lejeune (1805-1859) divergent series, 379 Euler's criterion proof, 172 Fermat's last theorem and, 254 pigeonhole principle, 264 on primes in arithmetic progressions, 54, 186 Dirichlet's theorem, 54-55 Discorsi (Galileo), 220 discrete logarithm problems, 214-215 Disquisitiones Arithmeticae (Gauss) history of, 61, 63 importance of primality tests, 358 index of a relative tor, 163 on primitive roots, 157 quadratic reciprocity law and, 186 as standard work, 17 5 straightedge and compass constructions, 238 divergent series, 379 divisibility tests congruences and,69, 71-72, 73, 74 Fermat's little theorem and, 92 divisibility theory, 17-32 division algorithm, 17-19 Euclidean algorithm, 26-29 greatest common divisor, 19-26, 30-32 least common multiple, 29-30 divisible, as term, 20 division algorithm, 17-19 division, using congruences, 66, 67-68 divisors common, 20-21 defined,20 Mersenne numbers, 23G-231 See also greatest common divisor double Wieferich primes, 258 e (natural log base), 328-329 early number theory, 13-16 eggs-in-a-basket problem, 83 Eisenstein, Ferdinand (1823-1852), 186 El Madschriti of Madrid (11th cent.), 235 An Elementary Proof of the Prime Number Theorem (Selberg), 383 Elements de Geometrie (Legendre), 175 Elements (Euclid) Diophantine equations and, 33 Euclidean algorithm, 26 Euclid's theorem, 46-48 history of, 15, 85 perfect numbers and, 222 proposition 14, 39-40 Pythagorean triangle formula, 246 Pythagoreans and, 42 eleven (number), divisibility tests for, 71, 72 ElGamal cryptosystem, 214-218 ElGamal, Taher (b. 1955), 214 Elkies, Noam (b. 1966), 279 enciphering/encrypting, defined, 197 See also cryptography Encke, Johann Franz (1791-1865), 378 encryption keys. See keys for cryptosystems equality, congruence properties and, 65-66, 76 Eratosthenes of Cyrene (c. 276-194 B.C.), 45,350 Erdos,Paul(1913-1996),355-357,383 Essai sur la Theorie des Nombre (Legendre), 175, 186,378 Essay pour les coniques (Pascal), 219 Euclid (fl. 300 B.C.), 15, 246 See also Elements Euclidean algorithm, 26-29 Euclidean numbers, 46-47 Euclid's lemma, 24 Euclid's theorem, 46-48, 54, 134-135 Euler, Leonhard (1707-1783), 279 amicable pairs discovery, 235, 236 biographical information, 129-131, 262 Catalan equation and, 25 8 Diophantine equations, 38 Diophantus's Arithmetica and, 33 e representation, 328 on even perfect numbers, 223 Fermat numbers and, 238, 240, 241 Fermat's last theorem and, 254 Fermat's little theorem proof, 87 fundamental theorem of algebra proof, 63 Goldbach correspondence, 51, 52, 58, 130 illustration of, 130 Mersenne numbers and, 227-228 odd perfect numbers and, 232, 233 .rrterminology, 327 Pell's equation solution, 339-340 prime number formulas, 265, 273, 279 prime-producing functions and, 56-57 primitive roots for primes, 162 quadratic reciprocity law and, 185 on triangular numbers, 15 Waring's problem conjecture, 355 zeta function formulas, 377, 378 Euler polynomial, 56-57 Euler's criterion, 171-17 4, 180 Euler's generalization of Fermat's theorem applications of, 139-141 defined, 136-137 Fermat's corollary of, 138 proofs of, 137-138, 139, 141 RSA cryptosystem and, 206 Euler's identity, 273-274, 277 Euler's phi-function ¢(n) applications of, 145-146 defined, 131-132 Euclid's theorem and, 134-135 as even integer, 134 Gauss's theorem and, 141-143, 146 Mobius inversion formula and, 144-145 as multiplicative function, 133, 142 prime-power factorization of n and, 132-133, 134 primitive roots and, 150-151 properties of, 135-136 sum of integers identity, 143 table of, 407-408 even-numbered convergents, 317-318 even numbers defined, 18 Goldbach's conjecture and, 51-53 perfect,223,225,226,227 Pythagorean views, 14 everything-is-a-number philosophy, 14 exponential congruences, 168 INDEX 425 exponential cryptosystems, 203-205, 209 exponents in binary exponential algorithm, 70-71 discrete logarithm problems and, 214-215 of highest power of p in factorials, 117-118, 121, 122 universal exponent A.(n), 162 to which a belongs modulo n, 147-150 cf>(n). See Euler's phi-function factor bases, 364-365 factorials ( ! ) exponent of pin, 117-118, 121, 122 inductively defined, 5 factorization into primes canonical form, 42 computers and, 357 continued fraction method, 361-364 exponent of p in factorials, 117-118, 121, 122 Fermat method, 97-100, 102 of Fermat numbers, 238, 240-243, 357, 360,361,364 of Fibonacci numbers, 287, 298-299 fundamental theorem of arithmetic and, 40,41-42 Kraitchik method, 100-101, 102 of Mersenne numbers, 228 p - 1 method, 360-361 quadratic sieve algorithm, 364-366 remote coin flipping and, 371-374, 375 rho (p) method, 358-360 RSA cryptosystem and, 205, 206-207 uniqueness of, 41 factors. See divisors Faltings, Gerd (b. 1954 ), 254 Farey fractions, 334-337 Farey, John (1766-1826), 334, 335 Fermat-Kraitchik factorization method, 97-102 Fermat numbers Catalan equation and, 258 defined,237 factorization into primes, 238, 240-243, 357,360,361,364 primality tests, 228, 239-240, 241 properties of, 238-239, 243-244, 385 as sum of two squares, 265 426 INDEX Fermat, Pierre de (1601-1665) amicable pair discovery, 235, 236 biographical information, 85-87 corollary of Euler's generalization, 138 cubes of prime numbers challenge, 337-338 Diophantus's Arithmetica and, 32-33, 245 Fermat numbers and, 237-238 illustration of, 86 Mersenne and, 220, 265 Mersenne number divisors, 230 Pell's equation challenge, 339, 340, 350 primes as sums of squares, 265-267, 273 Pythagorean triangle areas, 250, 257 Fermat primes, 237, 238-239 Fermat's last theorem history of, 245-246, 254--255 x4 + y4 = z2 case, 252-253 x4 - y4 = z2 case, 255-257 x4 + y4 = z4 case, 253 Fermat's little theorem as computation aid, 89, 92-93 defined,87-89 Euler's generalization of, 136-141 Euler's proof of, 87 falseness of converse of, 89-90 Lucas's converse of, 367-368 p - 1 factorization method and, 360 primality tests and, 366-369 Fermat's method of infinite descent, 252, 254,258,273,339 Fermat's test for nonprimality, 366-367 Fibonacci (Leonardo of Pisa) (1180-1250) biographical information, 283-285 continued fractions, 306 illustration of, 284 recursive sequences, 286 Fibonacci numbers, 284--302 Binet formula, 296-298, 301 continued fractions representation, 310-311 defined,284-285 greatest common divisors of, 287-290 Lucas numbers and, 301 prime factors of, 287, 298-299 properties of, 291-295, 299-302, 385 sequence of, 285-287 square/rectangle geometric deception, 293-294 table of, 294 Zeckendorf representation, 295-296 Fibonacci sequence,285-287 Fields medal, 356, 383 finite continued fractions convergents of, 311-315, 317-319 defined,306-307 linear Diophantine equation solutions, 315-317,319 rational numbers as, 307-311, 318 first principle of finite induction, 2, 5 five, as number, 14 four, as number, 14 fourth powers, division algorithm applications, 19 Frederick the Great (1712-1786), 130, 262 French Academy of Sciences. See Academie des Sciences French Revolution, 262-263 Frenicle de Bessy, Bernard (c. 1605-1675), 87,220,337,338 Friday the thirteenth, 126 functions greatest integer, 117-122 Liouville A.-function, 116-117, 122 Mangoldt A-function, 116 Mobius µ, function, 112-117, 407--408 prime counting, 53-54, 375-377, 378-380,381-382 prime-producing, 56-57 zeta, 377-378, 380-381 See also Euler's phi-function; multiplicative functions; number-theoretic functions fundamental solution of Pell's equation, 347-349 fundamental theorem of algebra, 63 fundamental theorem of arithmetic, 39--42 Galilei, Galileo (1564-1642), 220 Gauss, Carl Friedrich (1777-1855) biographical information, 61-63 congruence concept, 61 illustration of, 62 motto of, 356 on notationes vs. notiones, 94 on primality tests, 358 primes as sums of squares, 273 on primitive roots, 157, 162 n (x ) approximation, 378-379 quadratic reciprocity law and, 169, 186 straightedge and compass constructions, 62-63,238-239,243 See also Disquisitiones Arithmeticae Gauss's lemma defined, 179-180 Legendre symbol and, 182, 184 quadratic residue of 2 and, 180-181 Gauss's theorem on c/>(n), 141-143, 146 generalized Fermat factorization method, 99-100, 102 generalized quadratic reciprocity law, 192 generalized Riemann hypothesis, 52 geometria, in Pythagorean school, 13 Germain primes, 182 Germain, Sophie (1776-1831), 182 Gershom, Levi ben (1288-1344), 258 Girard, Albert (1593-1632), 63, 265, 286 The Gold Bug (Poe), 199 Goldbach, Christian (1690-1764), 51, 52, 58, 130 Goldbach's conjecture equivalent statement of, 58 Euler's phi-function </>(n) and, 136 overview, 51-53 sum of divisors a (n) and, 111 greatest common divisor (gcd) defined,21,24 divisibility relations, 19-21, 23, 25 of Fibonacci numbers, 287-290 least common multiple and, 30, 31 linear combination representation, 21-23 of more than two integers, 30-31 prime factorizations and, 42 of relatively prime numbers, 22-23 greatest integer function, 117-122 Gregorian calendar, 122-123 Gregory XIII (pope) (1502-1585), 122-123 Hadamard, Jacques-Salomon (1865-1963), 381 Hagis, Peter, 233 Halley, Edmund (1656-1742), 261 Halley's comet, 92 Hamilton, William Rowan (1805-1865), 262 Hanke, Jonathan, 277 Hardy, Godfrey Harold (1877-1947) biographical information, 353-355 Goldbach's conjecture and, 52 INDEX 427 Littlewood collaboration, 52, 57, 354-355,376-377,380 photo of, 354 on positive integers, 384 primes of the form n2 + 1, 57-58 on pure mathematics, 355 Ramanujan collaboration, 272, 303-305, 320 Riemann hypothesis and, 3 81 on Skewes number, 381 Hardy-Littlewood conjectures, 57, 376-377, 380 harmonia, in Pythagorean school, 13 harmonic mean H (n ), 227 Haros, C. H., 334-335 Haselgrove, Colin Brian (1926-1964), 357 Hellman, Martin (b. 1945), 205, 211 highly composite numbers, 305 Hilbert, David (1862-1943), 278, 354 Hill cipher, 201, 208 Hill, Lester (1890-1961), 201 Hindu-Arabic numerals, 284 History of the Theory of Numbers (Moore), 355 Hobbes, Thomas (1588-1679), 220 Holzmann, Wilhelm (Guilielmus Xylander) (1532-1576), 86 hundred fowls problem, 37 Hurwitz, Alexander, 241, 333 Huygens, Christiaan (1629-1695), 220 Iamblichus of Chalcis (c. 250-330 A.D.), 234 ideal numbers, 254 identification numbers, check digits for, 72-73 incongruence modulo n, 64 indeterminate problems. See Diophantine equations; puzzle problems indicator. See Euler's phi-function indices (index of a relative to r) defined, 163 properties of, 164, 167-168 solvability criterion, 166-167 for solving congruences, 164-167 tables of, 165, 167 induction. See mathematical induction induction hypotheses, 4 induction step, 4 inductive definitions, 5, 6 428 INDEX infinite continued fractions continued fraction algorithm, 326-328 defined,319-320 e representation, 328-329 irrational numbers representation, 323-328,329-331,332 rrrepresentation, 320, 327-328 properties of, 320-322 square roots as, 307 infinite descent, Fermat's method of, 252, 254,258,273,339 infinite series e representation, 328 rrrepresentation, 306 partition function, 305 infinitude of primes arithmetic progressions of, 55-56 Dirichlet's theorem, 54-55 Euclid's theorem, 46-48, 54 Euler's zeta function and, 377 Fermat numbers and, 239 Fibonacci numbers and, 291 of the form 4k + 1, 177-178 of the form 8k - 1, 182 Hardy-Littlewood conjecture, 57-58 integers. See numbers International Congress of Mathematicians, 383 International Standard Book Numbers (ISBNs), 75 Introductio Arithmeticae (Nicomachus), 79, 222 inverse of a modulo n, 77 irrational numbers e as, 328-329 Farey fraction approximations of, 334-337 finite continued fraction representation, 319 infinite continued fraction representation, 307,323-328,329-331 rras, 329 rational number approximations of, 329-331,332 square root of 2, 42-43 zeta function values, 377 irregular primes, 254 ISBN s (International Standard Book Numbers), 75 Jacob and Esau story, 235 Jacobi, Carl Gustav (1804-1851), 279 Jacobi symbol(a/b), 191, 192 Jensen, K. L., 254 Journal de ['Ecole Polytechnique, 335 Journal of the Indian Mathematical Society, 320 Julian calendar, 122, 123 k-perfect numbers, 226 Kanold, Hans-Joachim, 232 Kayal, Neeraj, 358 keys for cryptosystems automatic, 200 ElGamal system, 215-216, 217 Merkle-Hellman knapsack system, 211, 212, 213-214 modular exponentiation systems, 203, 205 running, 200 Verman,202 knapsack cryptosystems, 211-214 knapsack problems, 209-211, 213, 214 Kraitchik factorization method, 100-101, 102 Kraitchik, Maurice (1882-1957), 100, 364 Kronecker, Leopold (1823-1891), 1, 61 Kulp, G. W., 199 Kummer, Ernst Eduard (1810-1893), 254 Lagrange, Joseph Louis (1736-1813) biographical information, 261-263 conjecture on primes, 58 four-square theorem, 263, 273, 277 illustration of, 262 Pell's equation solution, 339-340 polynomial congruence theorem, 152-154 Wilson's theorem proof, 94 Lambert, Johann Heinrich ( 1728-1777), 329 Lame, Gabriel (1795-1870), 28, 254, 288 Landau, Edmund (1877-1938), 53 Lander, L. J., 279 Landry,Fortune,240,243 Laplace, Pierre-Simon de (1749-1827), 63 leap years, 123, 124 least absolute remainder, 28 least common multiple, 29-30, 31 least nonnegative residues modulo n, 64 least positive primitive roots, 156, 393 Lebesgue, V. A., 258 Legendre, Adrien-Marie (1752-1833) amicable pair discovery, 235 continued fraction factoring method, 361 Fermat's last theorem and, 254 overview of mathematical contributions, 175 primes as sums of squares, 273 primitive roots for primes, 162 .rr(x) approximation, 378-379, 381 quadratic reciprocity law and, 185-186 Legendre formula, 119 Legendre symbol (alp) defined, 175 properties of, 176-179, 183-184 quadratic congruences with composite moduli, 189-190, 192-196 Lehman, R. S., 357 Lehmer, Derrick (1905-1991), 232 Leibniz, Gottfried Wilhelm ( 1646-1716), 87,94 length of period (continued fraction expansions), 322, 343, 345 Lenstra, W. Hendrik, Jr., 242 Leonardo of Pisa. See Fibonacci Levi ben Gershon (1288-1344), 258 Liber Abaci (Fibonacci), 283, 284, 285, 306 Liber Quadratorum (Fibonacci), 283 liberal arts, 13 linear combinations, 21-22 linear congruences defined, 76 one variable, 76-78, 82, 83, 162 simultaneous, 78-81, 82, 83, 84 two variables, 81-82, 83, 84 Linnik, Y. V. (1915-1972), 278, 279 Liouville, Joseph (1809-1882), 278 Liouville A.-function, 116-117, 122, 357 Littlewood, John Edensor (1885-1977) Goldbach's conjecture and, 52 Hardy collaboration, 52, 57, 354-355, 376-377,380 prime counting inequality, 53 primes of the form n2 + 1, 57-58 .rr(x) approximation, 381 logarithmic integral function Li(x ), 378-379,381-382 long-distance coin flipping, 371-374, 375 Louis XVI (1754-1793), 262 Lucas, Edouard (1842-1891) Fermat numbers and, 241 INDEX 429 Fibonacci numbers and, 284, 288, 302 Mersenne numbers and, 228, 231, 232 primality test, 367-368 Lucas-Lehmer test, 232 Lucas numbers, 301 Lucas sequence,6,301,385 Lucas's converse of Fermat's theorem, 367-368 µ, function. See Mobius µ, function Mahaviracarya (c. 850), 38 Manasse, M. S., 242 Mangoldt A-function, 116 mathemata, in Pythagorean school, 13 Mathematical Classic (Chang), 37 mathematical induction basis for the induction, 4 first principle of finite induction, 2, 5 induction hypotheses, 4 induction step, 4 method of infinite descent, 252, 254, 258, 273,339 second principle of finite induction, 5-6 McDaniel, Wayne, 233 Measurement of a Circle (Archimedes), 331 Mecanique Analytique (Lagrange), 262 Les Mecaniques de Galilee (Mersenne), 220 mediant fractions, 335-336 Meditationes Algebraicae (Waring), 93, 278 Merkle-Hellman knapsack cryptosystem, 211-214 Merkle, Ralph (b. 1952), 211 Mersenne, Marin (1588-1648) biographical information, 219-221 Descartes correspondence, 235 on factorization, 102 Fermat correspondence,97,235,238,265 illustration of, 221 Mersenne numbers defined, 227 primality tests, 227-228, 229, 231-232 properties of, 230-231, 236 search for larger numbers, 231-232 table of, 409 Mersenne primes, 227, 228, 231 Mertens, Franz (1840-1927), 115 Mertens's conjecture, 115-116 430 INDEX method of infinite descent, 252, 254, 258, 273,339 Mihailescu, Preda, 258 Miller-Rabin primality test, 369-370, 371 Mills, W. H. (b. 1921), 57 Mobius inversion formula applications of, 115 defined, 113-114 Euler's phi-function <f>(n) and, 144-145 Mobius µ, function basic properties, 112-113, 117 defined, 112 greatest integer function and, 122 Mertens conjecture and, 115-116 Mobius inversion formula and, 113-114 table of, 407-408 modular exponentiation cryptosystems, 203-205,209 monoalphabetic cryptosystems, 198, 199, 207-208 Monte Carlo (p) factorization method, 358-360 Moore, Eliakim Hastings (1862-1932), 355 Morain, Frarn;ois, 242 Morehead, J.C., 240, 241 Morrison, Michael A., 241, 361, 364 multiples, defined, 20 multiplicative functions basic properties, 107-108, 111, 112 defined, 107 Mobius inversion formula and, 115 Mobius µ, function as, 112 rand O' as, 108-110 multiplicative inverse of a modulo n, 77 multiplicatively perfect numbers, 226 multiply perfect numbers, 226 Museum of Alexandria, 14-15 n ! . See factorials National Bureau of Standards, 232 natural numbers, defined, 1 near-repunit numbers, 386 \"New Directions in Cryptography\" (Diffie and Hellman), 205 Newton's identity, 10 Nickel, Laura, 231 Nicomachus of Gerasa (fl. 100), 15, 79,222 nine, divisibility tests for, 71, 72 Noll, Landon Curt (b. 1960), 231 notation and symbols binomial coefficients, 8 congruence,63,64 continued fractions, 306-307, 310 e,328 factorials, 5 infinite continued fractions, 321, 322 Legendre symbol (alp), 175 TC, 327 Ilf(d), 106-107 bf(d), 104, 109-110 use of, in Arithmetica, 32 number mysticism, 14 number of divisors r(n) basic properties, 103-107 defined, 103 Euler's phi-function <f>(n) and, 135 greatest integer function and, 120-121, 122 as multiplicative function, 108-110 table of, 407-408 number-theoretic functions, 103-127 calendar applications, 122-127 defined, 103 greatest integer function, 117-122 Mobius µ,function, 112-117, 122, 407-408 number of divisors r(n), 103-107, 108-110, 120-121, 122, 135,407-408 See also Euler's phi-function; multiplicative functions; sum of divisors numbers absolute pseudoprime, 91-92, 93, 367 abundant, 236 algebraic, 254 amicable, 234-237 Bernoulli, 377-378 Blum, 373 Carmichael, 91-92, 93, 367 Catalan, 12 composite, 39, 158-163, 305 deficient, 236 Euclidean, 46-4 7 even (see even numbers) factorization into primes (see factorization into primes) Fermat (see Fermat numbers) Fibonacci (see Fibonacci numbers) highly composite, 305 ideal, 254 irrational (see irrational numbers) k-perfect, 226 Lucas, 301 Mersenne,227-228,229,230-232,236, 409 multiplicatively perfect, 226 multiply perfect, 226 natural, 1 near-repunit, 386 odd (see odd numbers) palindromes, 7 5 Pell,352 pentagonal, 15 perfect (see perfect numbers) primality tests for (see primality tests) prime (see prime numbers) pseudoprime,90-92,93,243,367 rational, 307-311, 318, 329-331, 332, 334-337 relatively prime (see relatively prime numbers) representation of (see representation of numbers) Skewes, 381 sociable chains of, 237 square, 15, 16, 19,25,59 square-free,44,91-92, 110,242-243 square-full, 44 strong pseudoprime, 367 superperfect, 227 triangular, 15-16, 26, 59, 252, 257, 281 numerals, Hindu-Arabic, 284 numerators continued fractions, 311-312, 313, 314 Legendre symbol, 175 odd-numbered convergents, 317-318 odd numbers defined, 18 divisibility relations, 25 Goldbach's conjecture and, 52-53 Legendre symbol and, 183-184 perfect, 232-234 Pythagorean views, 14 table of prime factors of, 394-403 odd primes as difference of two squares, 269-270 Gauss's lemma and, 180-181 integers as sums of, 51-53, 58, 59 INDEX 431 Legendre symbol and, 183-185 primitive roots for, 160-162, 181-182 properties of, 43, 92-93, 135, 151-152 as sum of four squares, 274-275 theory of indices and, 167, 168 Wilson's theorem and, 95-96, 97 Odlyzko, Andrew, 116 one, as number, 14 one-time cryptosystems, 202-203 Ono, Ken, 305 Opera Mathematica (Wallis), 340 order of a modulo n, 147-150 n(pi) continued fraction representation, 320 decimal expansion of, 357 historical approximations of, 331-332 infinite series representation, 306 irrationality of, 329 n(x) (prime counting function) approximations of, 378-380, 381-382 of the form p = an + b, 53-54 prime number theorem and, 375-377 TI notation, 106-107 p - 1 factorization method, 360-361 palindromes, 7 5 Parkin, Thomas, 279 partial denominators, 307, 310 partial quotients, 310 partition theory, 304-305 Pascal, Blaise (1623-1662) Fermat and, 86 mathematical induction work, 10 Mersenne and, 219, 220 Pascal, Etienne (1588-1651), 220 Pascal's rule, 8-9 Pascal's triangle, 9 Pell, John (1611-1685), 220, 340 Pell numbers, 352 Pell's equation, 339-352 algebraic formula for, 349-350 continued fraction solutions, 340-347 fundamental solution, 347-349 history of, 339-340, 350 positive solutions, 340, 343, 346-350 successive substitution solutions, 348 pentagonal numbers, 15 Pepin, Theophile (1826-1904), 239 Pepin's test, 239-240, 241 432 INDEX perfect numbers defined,221 final digits of, 222, 225 general form of, 222-223 multiplicatively perfect, 226 multiply perfect, 226 odd,232-234 properties of, 223-227 search for larger numbers, 228, 231-232 superperf ect, 227 period (continued fraction expansions), 322, 342-343 periodic continued fractions, 322, 334, 342-347,345-346 Peter the Great (1672-1725), 130 Pfaff, Johann Friedrich (1765-1825), 63 Philosophical Magazine, 334 philosophy, early number theory and, 14 Piazzi, Giuseppi (1746-1826), 63 pigeonhole principle, 264 pirate problem, 83 place-value notation systems, 69-71 plaintext, defined, 197 Plutarch (c. 46-120), 15 Pocklington, Henry (1870-1952), 368 Pocklington's theorem, 368-369, 371 Poe, Edgar Allan (1809-1849), 199 Pohlig-Hellman cryptosystem, 203-205 Polignac, Alphonse de (1817-1890), 59 Pollard, John M., 241, 242, 358-361 P6lya, George (1888-1985), 357 P6lya's conjecture, 357 polyalphabetic cryptosystems, 198-201, 208 polygons, construction of, 62-63, 238-239, 243 polynomial congruences, 71-72, 152-154 polynomial time primality test, 358 polynomials, prime-producing, 56-57 positive integers, defined, 1 powerful numbers, 44 powers of numbers odd primes, primitive roots for, 160-162 order of a modulo n and, 149-150 Powers, R. E., 231 primality tests computers and, 358 efficient algorithms for, 358 for Fermat numbers, 228, 239-240, 241 Fermat's little theorem methods, 89, 366-369 for Mersenne numbers, 227-228, 229, 231-232 Miller-Rabin test, 369-370, 371 Pepin's test, 239-240, 241 Pocklington's theorem method, 368-369, 371 Wilson's theorem method, 95 prime factorization. See factorization into pnmes prime number theorem arithmetical proof of, 356, 383 complex proofs of, 380-382 defined,375 length of interval of primes and, 381-382 prime counting function and, 375-377, 381-383 zeta function and, 377-378, 380-381 prime numbers, 39-60 arithmetic progressions of, 54-55, 59 Bertrand's conjecture, 48--49 consecutive, 50-51, 55-56 defined,39 Fermat, 237 Fibonacci numbers as, 287, 290-291 of the form 2k - 1, 223-224 of the form 3n ± 1, 54 of the form 4n + 1, 53-54, 155-156, 177-178,265-267 of the form 4n + 3, 53-54, 264, 267-268 of the form 8k ± 1, 181 of the form n2 + 1, 57-58 of the form p# + 1, 46 fundamental theorem of arithmetic, 39--42 Germain, 182 Goldbach's conjecture, 51-53, 58, 111 intervals between, 50-51 irregular, 254 Mersenne, 227, 228, 231 near-repunit, 386 prime-producing functions, 56-57 primitive roots of, 150, 154-158, 182 regular, 254 repunit, 49, 50, 370, 386 sieve of Eratosthenes and, 44--46, 49 as sum of four squares, 275-277 tables of, 404--405 three-primes problem, 355 twin,50,58,59 Wieferich, 25 8 See also infinitude of primes; odd primes prime-producing functions, 56-57 primers (autokey cryptosystems), 200 primitive Pythagorean triples, 246-250, 251-252 primitive roots for composite numbers, 158-163 defined, 150 ElGamal cryptosystem and, 214-218 Legendre symbol and, 181-182 number of, 151 for powers of odd primes, 160-162 for prime numbers, 154-158, 162 properties of, 151-152 tables of, 156, 393 probabilistic primality test, 370 Probationers (Pythagorean school), 14 proofs, using mathematical induction, 2-6 Proth, E., 371 pseudoprime numbers absolute, 91-92, 93, 367 defined, 90 Fermat numbers as, 243 properties of, 90-92, 93 with respect to base a, 91, 367 strong, 371 public-key cryptosystems ElGamal system, 214--218 Merkle-Hellman knapsack system, 211-214 origin of, 205 RSA system, 205-207 puzzle problems cattle problem, 350 Chinese remainder theorem and, 79-81 Diophantine equations, 36-37, 38 hundred fowls problem, 37 Pythagoras (c. 585-501 B.C.) amicable pair discovery, 236 early number theory, 13-14 on irrational numbers, 42-43 Pythagorean triangle formula, 246 on triangular numbers, 15 Pythagorean triangles, 246, 250, 257, 259, 260 Pythagorean triples, 246-250, 251-252 Pythagoreans amicable numbers and, 235 history of, 14 number classification, 42 on perfect numbers, 221 quadratic congruences INDEX 433 in Blum's coin flipping game, 371-373 with composite moduli, 189-190, 192-196 defined, 95 indices for solving, 164-165 primitive roots, 155-156 quadratic reciprocity law and, 169, 189-190 simplification of, 169-171 solvability criteria, 170, 174, 177, 192, 194--195 Wilson's theorem and, 95-96, 97 quadratic nonresidues defined, 171 Euler's criterion and, 171-174, 180 Legendre symbol and, 178-179 quadratic reciprocity law applications of, 187-192 defined, 186 Gauss's lemma and, 179 generalized, 192 history of, 169, 185-186 quadratic residues defined, 171 Euler's criterion, 171-17 4 Gauss's lemma and, 180-181 Legendre symbol and, 178-179 sum of four squares problem and, 275 quadratic sieve factoring algorithm, 364--366 quadrivium, 13 quotients, 17, 310 p factorization method, 358-360 rabbit problem, 285 radius of circles inscribed in Pythagorean triangles, 250 Ramanujan, Srinivasa Aaiyangar (1887-1920) biographical information, 303-306 continued fractions, 320 illustration of, 304 on the number 1729, 272 universal quadratics, 277 rapid primality tests, 358 434 INDEX rational numbers Farey fraction approximations of, 334-337 as finite continued fractions, 307-311, 318 as irrational numbers approximation, 329-331,332 \"Recherches d' Analyse Indeterminee\" (Legendre), 175 rectangle/square geometric deception, 293-294 recursive sequences, 286 reduced set of residues modulo n, 141, 168 Regiomontanus (Johann Miiller) (1436-1476),83,85-86,280 Regius, Hudalrichus (fl. 1535), 224 regular polygons, 62-63, 238-239 regular primes, 254 relatively prime numbers as coefficients in Diophantine equations, 35-36,38 congruence solutions and, 77-78 continued fraction numerators and denominators, 314 defined,22-23 Fermat numbers as, 239 Fibonacci numbers as, 286-288 in Pythagorean triples, 237 in triples vs. pairs, 31 remainder( s) Chinese remainder theorem, 79-81 congruences and,64-65,66,67 defined, 17 Euclidean algorithm and, 26-29 least absolute, 28 remote coin flipping, 371-374 representation of numbers, 261-281 base b place-value notation, 69-70 binary system, 70-71 with continued fractions, 307-311 decimal system, 71 as difference of two squares, 269-270, 271-272 e,328-329 irrational numbers, 323-328, 329-331, 332 rr,306,320,327-328 as sum of cubes, 272, 278 as sum of fifth powers, 278 as sum of four squares, 263, 273-278 as sum of fourth powers, 278 as sum of higher powers, 278-279, 280, 281 as sum of three squares, 272-273 as sum of two squares, 264-269, 270-271,272 Waring's problem and, 278-279 repunit primes, 49, 50, 370, 386 rho (p) factorization method, 358-360 Riemann, Georg (1826-1866), 380-381 Riemann's hypothesis, 52, 380-381 Riemann's explicit formula, 380 Rivest, Ronald (b. 1947), 205 RSA challenge numbers, 207, 364 RSA cryptosystem, 205-207 Rudolff, Christoff (c. 1500-1545), 38 running key ciphers, 200 a(n). See sum of divisors L notation, 104, 109-110 St. Petersburg Academy, 130, 131 Saxena, Nitin (b. 1981), 358 Scientific American, 200, 207 second principle of finite induction, 5-6 seeds (autokey cryptosystems), 200 Selberg, Atle (1917-2007), 356, 383 Selfridge, John, 241 set of residues modulo n complete, 64, 68 reduced, 141, 168 seven liberal arts, 13 Shamir, Adi (b. 1952), 205, 213 sieve of Eratosthenes, 44-46 signatures for encrypted messages, 217-218 simple finite continued fractions, 307 See also finite continued fractions simple infinite continued fractions, 321, 322 See also infinite continued fractions simultaneous linear congruences one variable, 78-81, 82, 83 two variables, 81-82, 83, 84 Skewes number, 381 Skewes, Stanley (1899-1988), 381 smallest positive primitive roots, 156, 393 sociable chains, 237 Sophia Dorothea (Queen Mother of Prussia), 130 square-free numbers Euler's phi-function </J(n) and, 135 Fermat numbers as, 242-243 number of divisors r (n) and, 110 properties of, 44 pseudoprimes as, 91-92 square-full numbers, 44 square numbers divisibility relations, 19, 25 final digits of, 102 as mean of twin primes, 59 properties of, 15, 16 sum and number of divisors and, 110 square/rectangle geometric deception, 293-294 square roots, continued fractions and, 307 squares of numbers, division algorithm applications, 18, 19 Standards Western Automatic Computer (SWAC), 232 Steuerwald, R., 232 story problems. See puzzle problems straightedge and compass constructions, 62-63,238-239,243 strong pseudoprime numbers, 371 subset sum (knapsack) problems, 209-211 sum of cubes, 272, 278 sum of divisors a(n) amicable numbers and, 234 basic properties, 103-107, 111 defined, 103 Euler's phi-function ¢(n) and, 135 greatest integer function and, 120-121 as multiplicative function, 108-110 perfect numbers and, 221-222 table of, 407-408 sum of fifth powers, 278, 279 sum of four squares, 263, 273-278 sum of fourth powers, 278, 279 sum of n nth powers, 279 sum of three squares, 272-273 sum of two squares, 270-271, 272 Sun-Tsu (c. 250), 79, 80 superincreasing sequences, 210 superperfect numbers, 227 SWAC (Standards Western Automatic Computer), 232 Swiss Society of Natural Sciences, 131 Sylvester, James Joseph (1814-1897), 58, 234 symbols. See notation and symbols Synopsis of Pure Mathematics (Carr), 303 INDEX 435 systems of congruences. See simultaneous linear congruences r(n). See number of divisors Tchebycheff, Pafnuty L. (1821-1894), 48, 53,379 te Riele, Herman, 116 terminating zeros in factorials, 118, 121 Thabit ibn Qurrah (c. 836-901), 235, 237 Theon of Alexandria (4th cent. AD.), 15 Theorie des Fonctions Analytique (Lagrange), 262-263 Theorie des Nombres (Legendre), 175, 361 Theorie des Nombres (Lucas), 367 theory of congruences. See congruences Theory of Numbers (Barlow), 231 theory of partitions, 304-305 three, as number, 14, 249-250 three-primes problem, 355 Thue, Alex (1863-1922), 264 Thue's lemma, 264-265 Tijdeman, R., 258 Torricelli, Evangelista ( 1608-164 7), 220 Traicte des Chiffres (Vigenere ), 199 Traite du Triangle Arithmetique (Pascal), 10 triangles Pascal's, 9 Pythagorean,246,250,257,259,260 triangular numbers defined, 15 divisibility relations, 26 expressible as sum and difference of cubes,281 as mean of twin primes, 59 properties of, 15-16 Pythagorean triples and, 252 as sides of Pythagorean triangles, 257 trivium, 13 Tsu Chung-chi (430-501), 332 Turcaninov, A., 234 twin prime constant, 380 twin primes convergent series of, 380 defined, 50 Euler's phi-function ¢(n) and, 135 perfect numbers and, 227 properties of, 50, 58, 59 sum of divisors a (n) and, 111 table of number of pairs of, 406 two, as number, 14 436 INDEX Uber die Anzahl der Primzahlen unter einer gegebenen Grosse (Riemann), 380 uniqueness of prime factorization, 41 uniqueness of representation of integers, 265-266,267 universal exponent 'A(n), 162 University of Basel, 129, 130 Utriusque Arithmetices (Regius), 224 Vallee-Poussin, Charles-Jean de la (1866-1962), 381 Verman cryptosystem, 202-203, 208 Verman, Gilbert S., 202 Vigenere, Blaise de (1523-1596), 199-200 Vigenere cryptosystem, 199-201, 208 Vinogradov, Ivan M. (1891-1983), 52-53, 355 Wagstaff, Samuel S., 255 Wallis, John (1616-1703), 320, 338, 339 Waring, Edward (1734-1798), 93-94, 278 Waring's problem, 278-279, 354-355 Washington, George (1732-1799), 123 weekday number w calculations, 125-126, 127 well-ordering principle, 1-2, 17 Western, Alfred E. (1873-1961), 240, 241 Wieferich, Arthur (1884-1954), 258 Wieferich primes, 258 Wiles, Andrew (b. 1953), 255 Williams, H. C., 360 Wilson, John (1741-1793), 93 Wilson's theorem defined,93-95 Lagrange's theorem and, 154 quadratic congruences and, 95-96, 97, 173 witnesses, for compositeness, 369 Wolf prize, 356 word problems. See puzzle problems work factors, in computerized factorization, 206-207 Xylander, Guilielmus (Wilhelm Holtzman) (1532-1576), 86 Yen Kung (14th century), 38 Yih-hing (d. 717), 83 Zeckendorf representation, 295-296 zero(s) congruence to, 67 terminating, in factorials, 118, 121 of the zeta function, 38G-381 zeta function �(s), 377-378 INDEX OF SYMBOLS Page Symbol Meaning Reference n! n factorial 5 (�) binomial coefficient 8 tn nth triangular number 15 a l b a divides b 20 a l b a does not divide b 20 gcd(a, b) greatest common divisor of a and b 21 lcm(a, b) least common multiple of a and b 29 p # product of primes not exceeding p 46 Rn nth repunit 49 7Ta b (x ) number of primes of the form an + b not exceeding x 53 a= b (mod n) a is congruent to b modulo n 63 a¢. b (mod n) a is incongruent to b modulo n 64 (amam-1 · · · aza1ao)b base b place-value notation for an integer 70 r(n) number of positive divisors of n 103 cr(n) sum of positive divisors of n 103 Ld1n sum over divisors d of n 104 ndln product over divisors d of n 106 w(n) number of distinct prime divisors of n 111 CJs (n) sum of sth powers of positive divisors of n 111 µ,(n) Mobius mu function 112 A(n) Mangoldt lambda function 116 A.(n) Liouville lambda function 116 [x] greatest integer not exceeding x 117 r/>(n) Euler phi function 131-132 indra index of a relative to r 163 (a/p) Legendre symbol (p prime) 175 (a/b) Jacobi symbol 191 Pn nth perfect number (in order of discovery) 222 Mn nth Mersenne number 227 Fn nth Fermat number 237 g(k) Waring's function for all positive integers 278 G(k) Waring's function for sufficiently large integers 279 Un nth Fibonacci number 285 a, {3 (1 + \"15)/2, (1 - \"15)/2 296 Ln nth Lucas number 301 p(n) number of partitions of n 304 R::j approximately equal 305 [ ao; a 1 , . . . , an ] finite simple continued fraction 310 ck= pkfqk convergent of a continued fraction 311 [ao; a1, az, ... ] infinite continued fraction 321 [ao;a1, ... ' am, b1, ... ' bn] periodic continued fraction 322 Fn Farey fractions of order n 334 n(x ) number of primes not exceeding x 356 Q(n) total number of prime factors of n 357 log n logarithm to base e 375 Li(x ) logarithmic integral 378 n2(x ) number of twin primes not exceeding x 380 {(s) Euler zeta function 380 This page intentionally left blank Mathematicians Prominent in the History of Number Theory CLASSICAL PERIOD -800 -600 --400 I Pythagoras (569-500 B.C.) - I Euclid (c. 350 B.C.) - I I Eratosthenes (276-196 B.C.) -200 B.C. A.D. Nicomachus (c. 100) - I 200 400 600 Diophantus (c. 250) - I Brahmagupta ( c. 625) I Alcuin ofYork (735-804) I I 800 1000 Thabit ibn Kurrah (826-901) - I 1200 Fibonacci (1180-1250) I I","libVersion":"0.2.1","langs":""}